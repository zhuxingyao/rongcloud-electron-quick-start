!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).RCEngine={})}(this,(function(e){"use strict";var t;!function(e){e[e.READ=1]="READ",e[e.LISTENED=2]="LISTENED",e[e.DOWNLOADED=4]="DOWNLOADED",e[e.RETRIEVED=8]="RETRIEVED",e[e.UNREAD=0]="UNREAD"}(t||(t={}));var n=t,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(e){var t={exports:{}};return e(t,t.exports),t.exports}var s=function(e){return e&&e.Math==Math&&e},o=s("object"==typeof globalThis&&globalThis)||s("object"==typeof window&&window)||s("object"==typeof self&&self)||s("object"==typeof r&&r)||function(){return this}()||Function("return this")(),a=function(e){try{return!!e()}catch(e){return!0}},u=!a((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),c={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,h={f:l&&!c.call({1:2},1)?function(e){var t=l(this,e);return!!t&&t.enumerable}:c},f=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},d={}.toString,p=function(e){return d.call(e).slice(8,-1)},v="".split,y=a((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==p(e)?v.call(e,""):Object(e)}:Object,m=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},_=function(e){return y(m(e))},E=function(e){return"object"==typeof e?null!==e:"function"==typeof e},T=function(e,t){if(!E(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!E(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!E(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!E(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},R=function(e){return Object(m(e))},I={}.hasOwnProperty,C=function(e,t){return I.call(R(e),t)},S=o.document,b=E(S)&&E(S.createElement),w=function(e){return b?S.createElement(e):{}},O=!u&&!a((function(){return 7!=Object.defineProperty(w("div"),"a",{get:function(){return 7}}).a})),N=Object.getOwnPropertyDescriptor,k={f:u?N:function(e,t){if(e=_(e),t=T(t,!0),O)try{return N(e,t)}catch(e){}if(C(e,t))return f(!h.f.call(e,t),e[t])}},A=function(e){if(!E(e))throw TypeError(String(e)+" is not an object");return e},M=Object.defineProperty,x={f:u?M:function(e,t,n){if(A(e),t=T(t,!0),A(n),O)try{return M(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},L=u?function(e,t,n){return x.f(e,t,f(1,n))}:function(e,t,n){return e[t]=n,e},U=function(e,t){try{L(o,e,t)}catch(n){o[e]=t}return t},P="__core-js_shared__",D=o[P]||U(P,{}),V=Function.toString;"function"!=typeof D.inspectSource&&(D.inspectSource=function(e){return V.call(e)});var B,F,Y,j=D.inspectSource,q=o.WeakMap,G="function"==typeof q&&/native code/.test(j(q)),H=i((function(e){(e.exports=function(e,t){return D[e]||(D[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.11.0",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})})),K=0,W=Math.random(),Q=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++K+W).toString(36)},z=H("keys"),J=function(e){return z[e]||(z[e]=Q(e))},Z={},$="Object already initialized",X=o.WeakMap;if(G){var ee=D.state||(D.state=new X),te=ee.get,ne=ee.has,re=ee.set;B=function(e,t){if(ne.call(ee,e))throw new TypeError($);return t.facade=e,re.call(ee,e,t),t},F=function(e){return te.call(ee,e)||{}},Y=function(e){return ne.call(ee,e)}}else{var ie=J("state");Z[ie]=!0,B=function(e,t){if(C(e,ie))throw new TypeError($);return t.facade=e,L(e,ie,t),t},F=function(e){return C(e,ie)?e[ie]:{}},Y=function(e){return C(e,ie)}}var se={set:B,get:F,has:Y,enforce:function(e){return Y(e)?F(e):B(e,{})},getterFor:function(e){return function(t){var n;if(!E(t)||(n=F(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},oe=i((function(e){var t=se.get,n=se.enforce,r=String(String).split("String");(e.exports=function(e,t,i,s){var a,u=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,l=!!s&&!!s.noTargetGet;"function"==typeof i&&("string"!=typeof t||C(i,"name")||L(i,"name",t),(a=n(i)).source||(a.source=r.join("string"==typeof t?t:""))),e!==o?(u?!l&&e[t]&&(c=!0):delete e[t],c?e[t]=i:L(e,t,i)):c?e[t]=i:U(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||j(this)}))})),ae=o,ue=function(e){return"function"==typeof e?e:void 0},ce=function(e,t){return arguments.length<2?ue(ae[e])||ue(o[e]):ae[e]&&ae[e][t]||o[e]&&o[e][t]},le=Math.ceil,he=Math.floor,fe=function(e){return isNaN(e=+e)?0:(e>0?he:le)(e)},ge=Math.min,de=function(e){return e>0?ge(fe(e),9007199254740991):0},pe=Math.max,ve=Math.min,ye=function(e,t){var n=fe(e);return n<0?pe(n+t,0):ve(n,t)},me=function(e){return function(t,n,r){var i,s=_(t),o=de(s.length),a=ye(r,o);if(e&&n!=n){for(;o>a;)if((i=s[a++])!=i)return!0}else for(;o>a;a++)if((e||a in s)&&s[a]===n)return e||a||0;return!e&&-1}},_e={includes:me(!0),indexOf:me(!1)},Ee=_e.indexOf,Te=function(e,t){var n,r=_(e),i=0,s=[];for(n in r)!C(Z,n)&&C(r,n)&&s.push(n);for(;t.length>i;)C(r,n=t[i++])&&(~Ee(s,n)||s.push(n));return s},Re=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ie=Re.concat("length","prototype"),Ce={f:Object.getOwnPropertyNames||function(e){return Te(e,Ie)}},Se={f:Object.getOwnPropertySymbols},be=ce("Reflect","ownKeys")||function(e){var t=Ce.f(A(e)),n=Se.f;return n?t.concat(n(e)):t},we=function(e,t){for(var n=be(t),r=x.f,i=k.f,s=0;s<n.length;s++){var o=n[s];C(e,o)||r(e,o,i(t,o))}},Oe=/#|\.prototype\./,Ne=function(e,t){var n=Ae[ke(e)];return n==xe||n!=Me&&("function"==typeof t?a(t):!!t)},ke=Ne.normalize=function(e){return String(e).replace(Oe,".").toLowerCase()},Ae=Ne.data={},Me=Ne.NATIVE="N",xe=Ne.POLYFILL="P",Le=Ne,Ue=k.f,Pe=function(e,t){var n,r,i,s,a,u=e.target,c=e.global,l=e.stat;if(n=c?o:l?o[u]||U(u,{}):(o[u]||{}).prototype)for(r in t){if(s=t[r],i=e.noTargetGet?(a=Ue(n,r))&&a.value:n[r],!Le(c?r:u+(l?".":"#")+r,e.forced)&&void 0!==i){if(typeof s==typeof i)continue;we(s,i)}(e.sham||i&&i.sham)&&L(s,"sham",!0),oe(n,r,s,e)}},De=function(){var e=A(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function Ve(e,t){return RegExp(e,t)}var Be={UNSUPPORTED_Y:a((function(){var e=Ve("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:a((function(){var e=Ve("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},Fe=RegExp.prototype.exec,Ye=H("native-string-replace",String.prototype.replace),je=Fe,qe=function(){var e=/a/,t=/b*/g;return Fe.call(e,"a"),Fe.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Ge=Be.UNSUPPORTED_Y||Be.BROKEN_CARET,He=void 0!==/()??/.exec("")[1];(qe||He||Ge)&&(je=function(e){var t,n,r,i,s=this,o=Ge&&s.sticky,a=De.call(s),u=s.source,c=0,l=e;return o&&(-1===(a=a.replace("y","")).indexOf("g")&&(a+="g"),l=String(e).slice(s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\n"!==e[s.lastIndex-1])&&(u="(?: "+u+")",l=" "+l,c++),n=new RegExp("^(?:"+u+")",a)),He&&(n=new RegExp("^"+u+"$(?!\\s)",a)),qe&&(t=s.lastIndex),r=Fe.call(o?n:s,l),o?r?(r.input=r.input.slice(c),r[0]=r[0].slice(c),r.index=s.lastIndex,s.lastIndex+=r[0].length):s.lastIndex=0:qe&&r&&(s.lastIndex=s.global?r.index+r[0].length:t),He&&r&&r.length>1&&Ye.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r});var Ke=je;Pe({target:"RegExp",proto:!0,forced:/./.exec!==Ke},{exec:Ke});var We,Qe,ze="process"==p(o.process),Je=ce("navigator","userAgent")||"",Ze=o.process,$e=Ze&&Ze.versions,Xe=$e&&$e.v8;Xe?Qe=(We=Xe.split("."))[0]+We[1]:Je&&(!(We=Je.match(/Edge\/(\d+)/))||We[1]>=74)&&(We=Je.match(/Chrome\/(\d+)/))&&(Qe=We[1]);var et=Qe&&+Qe,tt=!!Object.getOwnPropertySymbols&&!a((function(){return!Symbol.sham&&(ze?38===et:et>37&&et<41)})),nt=tt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,rt=H("wks"),it=o.Symbol,st=nt?it:it&&it.withoutSetter||Q,ot=function(e){return C(rt,e)&&(tt||"string"==typeof rt[e])||(tt&&C(it,e)?rt[e]=it[e]:rt[e]=st("Symbol."+e)),rt[e]},at=ot("species"),ut=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),ct="$0"==="a".replace(/./,"$0"),lt=ot("replace"),ht=!!/./[lt]&&""===/./[lt]("a","$0"),ft=!a((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),gt=function(e,t,n,r){var i=ot(e),s=!a((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),o=s&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[at]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!s||!o||"replace"===e&&(!ut||!ct||ht)||"split"===e&&!ft){var u=/./[i],c=n(i,""[e],(function(e,t,n,r,i){return t.exec===RegExp.prototype.exec?s&&!i?{done:!0,value:u.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:ct,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:ht}),l=c[0],h=c[1];oe(String.prototype,e,l),oe(RegExp.prototype,i,2==t?function(e,t){return h.call(e,this,t)}:function(e){return h.call(e,this)})}r&&L(RegExp.prototype[i],"sham",!0)},dt=function(e){return function(t,n){var r,i,s=String(m(t)),o=fe(n),a=s.length;return o<0||o>=a?e?"":void 0:(r=s.charCodeAt(o))<55296||r>56319||o+1===a||(i=s.charCodeAt(o+1))<56320||i>57343?e?s.charAt(o):r:e?s.slice(o,o+2):i-56320+(r-55296<<10)+65536}},pt={codeAt:dt(!1),charAt:dt(!0)},vt=pt.charAt,yt=function(e,t,n){return t+(n?vt(e,t).length:1)},mt=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==p(e))throw TypeError("RegExp#exec called on incompatible receiver");return Ke.call(e,t)};function _t(e){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Et(e,t,n,r,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function Tt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function o(e){Et(s,r,i,o,a,"next",e)}function a(e){Et(s,r,i,o,a,"throw",e)}o(void 0)}))}}function Rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ct(e,t,n){return t&&It(e.prototype,t),n&&It(e,n),e}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function At(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Mt(e,t,n){return(Mt=At()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&kt(i,n.prototype),i}).apply(null,arguments)}function xt(e){var t="function"==typeof Map?new Map:void 0;return(xt=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Mt(e,arguments,Nt(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),kt(r,e)})(e)}function Lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ut(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?Lt(e):t}function Pt(e){var t=At();return function(){var n,r=Nt(e);if(t){var i=Nt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ut(this,n)}}function Dt(e,t,n){return(Dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nt(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,i,s=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(s.push(r.value),!t||s.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw i}}return s}(e,t)||Ft(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bt(e){return function(e){if(Array.isArray(e))return Yt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ft(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(e,t){if(e){if("string"==typeof e)return Yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yt(e,t):void 0}}function Yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}gt("match",1,(function(e,t,n){return[function(t){var n=m(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=A(e),s=String(this);if(!i.global)return mt(i,s);var o=i.unicode;i.lastIndex=0;for(var a,u=[],c=0;null!==(a=mt(i,s));){var l=String(a[0]);u[c]=l,""===l&&(i.lastIndex=yt(s,de(i.lastIndex),o)),c++}return 0===c?null:u}]}));var jt=Array.isArray||function(e){return"Array"==p(e)},qt=function(e,t,n){var r=T(t);r in e?x.f(e,r,f(0,n)):e[r]=n},Gt=ot("species"),Ht=function(e,t){var n;return jt(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!jt(n.prototype)?E(n)&&null===(n=n[Gt])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Kt=ot("species"),Wt=function(e){return et>=51||!a((function(){var t=[];return(t.constructor={})[Kt]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Qt=ot("isConcatSpreadable"),zt=9007199254740991,Jt="Maximum allowed index exceeded",Zt=et>=51||!a((function(){var e=[];return e[Qt]=!1,e.concat()[0]!==e})),$t=Wt("concat"),Xt=function(e){if(!E(e))return!1;var t=e[Qt];return void 0!==t?!!t:jt(e)};Pe({target:"Array",proto:!0,forced:!Zt||!$t},{concat:function(e){var t,n,r,i,s,o=R(this),a=Ht(o,0),u=0;for(t=-1,r=arguments.length;t<r;t++)if(Xt(s=-1===t?o:arguments[t])){if(u+(i=de(s.length))>zt)throw TypeError(Jt);for(n=0;n<i;n++,u++)n in s&&qt(a,u,s[n])}else{if(u>=zt)throw TypeError(Jt);qt(a,u++,s)}return a.length=u,a}});var en,tn,nn=72e5,rn=5e3,sn=["https://nav.cn.ronghub.com","https://nav2-cn.ronghub.com"],on=3e4,an=131072,un="RCV4-",cn={"RC:TxtMsg":{isCounted:!0,isPersited:!0},"RC:ImgMsg":{isCounted:!0,isPersited:!0},"RC:VcMsg":{isCounted:!0,isPersited:!0},"RC:ImgTextMsg":{isCounted:!0,isPersited:!0},"RC:FileMsg":{isCounted:!0,isPersited:!0},"RC:HQVCMsg":{isCounted:!0,isPersited:!0},"RC:LBSMsg":{isCounted:!0,isPersited:!0},"RC:PSImgTxtMsg":{isCounted:!0,isPersited:!0},"RC:PSMultiImgTxtMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpOpendMsg":{isCounted:!0,isPersited:!0},"RC:CombineMsg":{isCounted:!0,isPersited:!0},"RC:ReferenceMsg":{isCounted:!0,isPersited:!0},"RC:SightMsg":{isCounted:!0,isPersited:!0},"RC:GIFMsg":{isCounted:!0,isPersited:!0},"RC:InfoNtf":{isCounted:!1,isPersited:!0},"RC:ContactNtf":{isCounted:!1,isPersited:!0},"RC:ProfileNtf":{isCounted:!1,isPersited:!0},"RC:CmdNtf":{isCounted:!1,isPersited:!0},"RC:GrpNtf":{isCounted:!1,isPersited:!0},"RC:RcCmd":{isCounted:!1,isPersited:!0},"RC:CmdMsg":{isCounted:!1,isPersited:!1},"RC:TypSts":{isCounted:!1,isPersited:!1},"RC:PSCmd":{isCounted:!1,isPersited:!1},"RC:SRSMsg":{isCounted:!1,isPersited:!1},"RC:RRReqMsg":{isCounted:!1,isPersited:!1},"RC:RRRspMsg":{isCounted:!1,isPersited:!1},"RC:CsChaR":{isCounted:!1,isPersited:!1},"RC:CSCha":{isCounted:!1,isPersited:!1},"RC:CsEva":{isCounted:!1,isPersited:!1},"RC:CsContact":{isCounted:!1,isPersited:!1},"RC:CsHs":{isCounted:!1,isPersited:!1},"RC:CsHsR":{isCounted:!1,isPersited:!1},"RC:CsSp":{isCounted:!1,isPersited:!1},"RC:CsEnd":{isCounted:!1,isPersited:!1},"RC:CsUpdate":{isCounted:!1,isPersited:!1},"RC:ReadNtf":{isCounted:!1,isPersited:!1},"RC:chrmKVNotiMsg":{isCounted:!1,isPersited:!1},"RC:VCAccept":{isCounted:!1,isPersited:!1},"RC:VCRinging":{isCounted:!1,isPersited:!1},"RC:VCSummary":{isCounted:!1,isPersited:!1},"RC:VCHangup":{isCounted:!1,isPersited:!1},"RC:VCInvite":{isCounted:!1,isPersited:!1},"RC:VCModifyMedia":{isCounted:!1,isPersited:!1},"RC:VCModifyMem":{isCounted:!1,isPersited:!1},"RC:MsgExMsg":{isCounted:!1,isPersited:!1},"RC:RRMsg":{isCounted:!1,isPersited:!1}},ln=["RC:TypSts"];e.CONNECTION_TYPE=void 0,(en=e.CONNECTION_TYPE||(e.CONNECTION_TYPE={})).WEBSOCKET="websocket",en.COMET="comet";var hn=function(e){return tn||(tn={set:function(t,n){e.localStorage.setItem(t,JSON.stringify(n))},get:function(t){var n;try{n=JSON.parse(e.localStorage.getItem(t))}catch(e){n=null}return n},remove:function(t){return e.localStorage.removeItem(t)},getKeys:function(){var t=[];for(var n in e.localStorage)t.push(n);return t}}),tn},fn=function(){function e(t){Rt(this,e),this._caches={},t&&(this._caches=t)}return Ct(e,[{key:"set",value:function(e,t){this._caches[e]=t}},{key:"remove",value:function(e){var t=this.get(e);return delete this._caches[e],t}},{key:"get",value:function(e){return this._caches[e]}},{key:"getKeys",value:function(){var e=[];for(var t in this._caches)e.push(t);return e}}]),e}(),gn=function(){function e(t,n){Rt(this,e);var r=n?"".concat(un).concat(n):un;this._rootStorage=hn(t);var i=this._rootStorage.get(r)||{};this._cache=new fn(St({},r,i)),this._storageKey=r}return Ct(e,[{key:"_get",value:function(){var e=this._storageKey;return this._cache.get(e)||{}}},{key:"_set",value:function(e){var t=this._storageKey;e=e||{},this._cache.set(t,e),this._rootStorage.set(t,e)}},{key:"set",value:function(e,t){var n=this._get();n[e]=t,this._set(n)}},{key:"remove",value:function(e){var t=this._get();delete t[e],this._set(t)}},{key:"clear",value:function(){var e=this._storageKey;this._rootStorage.remove(e),this._cache.remove(e)}},{key:"get",value:function(e){return this._get()[e]}},{key:"getKeys",value:function(){var e=this._get(),t=[];for(var n in e)t.push(n);return t}},{key:"getValues",value:function(){return this._get()||{}}}]),e}(),dn=function(e){Ot(n,e);var t=Pt(n);function n(e){return Rt(this,n),t.call(this,"TODO => ".concat(e))}return n}(xt(Error)),pn=Wt("slice"),vn=ot("species"),yn=[].slice,mn=Math.max;Pe({target:"Array",proto:!0,forced:!pn},{slice:function(e,t){var n,r,i,s=_(this),o=de(s.length),a=ye(e,o),u=ye(void 0===t?o:t,o);if(jt(s)&&("function"!=typeof(n=s.constructor)||n!==Array&&!jt(n.prototype)?E(n)&&null===(n=n[vn])&&(n=void 0):n=void 0,n===Array||void 0===n))return yn.call(s,a,u);for(r=new(void 0===n?Array:n)(mn(u-a,0)),i=0;a<u;a++,i++)a in s&&qt(r,i,s[a]);return r.length=i,r}});var _n=Math.floor,En="".replace,Tn=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Rn=/\$([$&'`]|\d{1,2})/g,In=function(e,t,n,r,i,s){var o=n+e.length,a=r.length,u=Rn;return void 0!==i&&(i=R(i),u=Tn),En.call(s,u,(function(s,u){var c;switch(u.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(o);case"<":c=i[u.slice(1,-1)];break;default:var l=+u;if(0===l)return s;if(l>a){var h=_n(l/10);return 0===h?s:h<=a?void 0===r[h-1]?u.charAt(1):r[h-1]+u.charAt(1):s}c=r[l-1]}return void 0===c?"":c}))},Cn=Math.max,Sn=Math.min;gt("replace",2,(function(e,t,n,r){var i=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,s=r.REPLACE_KEEPS_$0,o=i?"$":"$0";return[function(n,r){var i=m(this),s=null==n?void 0:n[e];return void 0!==s?s.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!i&&s||"string"==typeof r&&-1===r.indexOf(o)){var a=n(t,e,this,r);if(a.done)return a.value}var u=A(e),c=String(this),l="function"==typeof r;l||(r=String(r));var h=u.global;if(h){var f=u.unicode;u.lastIndex=0}for(var g=[];;){var d=mt(u,c);if(null===d)break;if(g.push(d),!h)break;""===String(d[0])&&(u.lastIndex=yt(c,de(u.lastIndex),f))}for(var p,v="",y=0,m=0;m<g.length;m++){d=g[m];for(var _=String(d[0]),E=Cn(Sn(fe(d.index),c.length),0),T=[],R=1;R<d.length;R++)T.push(void 0===(p=d[R])?p:String(p));var I=d.groups;if(l){var C=[_].concat(T,E,c);void 0!==I&&C.push(I);var S=String(r.apply(void 0,C))}else S=In(_,c,E,T,I,r);E>=y&&(v+=c.slice(y,E)+S,y=E+_.length)}return v+c.slice(y)}]}));var bn=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},wn=function(e,t,n){if(bn(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},On=[].push,Nn=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,o=7==e,a=5==e||s;return function(u,c,l,h){for(var f,g,d=R(u),p=y(d),v=wn(c,l,3),m=de(p.length),_=0,E=h||Ht,T=t?E(u,m):n||o?E(u,0):void 0;m>_;_++)if((a||_ in p)&&(g=v(f=p[_],_,d),e))if(t)T[_]=g;else if(g)switch(e){case 3:return!0;case 5:return f;case 6:return _;case 2:On.call(T,f)}else switch(e){case 4:return!1;case 7:On.call(T,f)}return s?-1:r||i?i:T}},kn={forEach:Nn(0),map:Nn(1),filter:Nn(2),some:Nn(3),every:Nn(4),find:Nn(5),findIndex:Nn(6),filterOut:Nn(7)},An=kn.filter,Mn=Wt("filter");Pe({target:"Array",proto:!0,forced:!Mn},{filter:function(e){return An(this,e,arguments.length>1?arguments[1]:void 0)}});var xn=kn.map,Ln=Wt("map");Pe({target:"Array",proto:!0,forced:!Ln},{map:function(e){return xn(this,e,arguments.length>1?arguments[1]:void 0)}});var Un=Object.keys||function(e){return Te(e,Re)},Pn=a((function(){Un(1)}));Pe({target:"Object",stat:!0,forced:Pn},{keys:function(e){return Un(R(e))}});var Dn=function(e,t){var n=[][e];return!!n&&a((function(){n.call(null,t||function(){throw 1},1)}))},Vn=[].join,Bn=y!=Object,Fn=Dn("join",",");Pe({target:"Array",proto:!0,forced:Bn||!Fn},{join:function(e){return Vn.call(_(this),void 0===e?",":e)}});var Yn=function(e,t,n){if(void 0===t||void 0===n)return e.toUpperCase();var r=e.slice(t,n);return e=e.replace(r,(function(e){return e.toUpperCase()}))},jn=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8",r=0;if("utf-16"===n)for(var i=0,s=e.length;i<s;i++)r+=(t=e.charCodeAt(i))<=65535?2:4;else for(var o=0,a=e.length;o<a;o++)r+=(t=e.charCodeAt(o))<127?1:t<=2047?2:t<=65535?3:4;return r},qn=function(e){return e.match(/\d+(\.\d+){2}/)[0]};i((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,s=Object.create(i.prototype),o=new O(r||[]);return s._invoke=function(e,t,n){var r=h;return function(i,s){if(r===g)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw s;return k()}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=g;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?d:f,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=d,n.method="throw",n.arg=u.arg)}}}(e,n,o),s}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",g="executing",d="completed",p={};function v(){}function y(){}function m(){}var _={};_[s]=function(){return this};var E=Object.getPrototypeOf,T=E&&E(E(N([])));T&&T!==n&&r.call(T,s)&&(_=T);var R=m.prototype=v.prototype=Object.create(_);function I(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,s,o,a){var u=l(e[i],e,s);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,a)}),(function(e){n("throw",e,o,a)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,a)}))}a(u.arg)}var i;this._invoke=function(e,r){function s(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(s,s):s()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var s=i.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function N(e){if(e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:k}}function k(){return{value:t,done:!0}}return y.prototype=R.constructor=m,m.constructor=y,y.displayName=u(m,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,a,"GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},I(C.prototype),C.prototype[o]=function(){return this},e.AsyncIterator=C,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new C(c(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},I(R),u(R,a,"Generator"),R[s]=function(){return this},R.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=N,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(w),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var Gn=x.f,Hn=Function.prototype,Kn=Hn.toString,Wn=/^\s*function ([^ (]*)/,Qn="name";u&&!(Qn in Hn)&&Gn(Hn,Qn,{configurable:!0,get:function(){try{return Kn.call(this).match(Wn)[1]}catch(e){return""}}});var zn,Jn=u?Object.defineProperties:function(e,t){A(e);for(var n,r=Un(t),i=r.length,s=0;i>s;)x.f(e,n=r[s++],t[n]);return e},Zn=ce("document","documentElement"),$n=J("IE_PROTO"),Xn=function(){},er=function(e){return"<script>"+e+"</"+"script>"},tr=function(){try{zn=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;tr=zn?function(e){e.write(er("")),e.close();var t=e.parentWindow.Object;return e=null,t}(zn):((t=w("iframe")).style.display="none",Zn.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(er("document.F=Object")),e.close(),e.F);for(var n=Re.length;n--;)delete tr.prototype[Re[n]];return tr()};Z[$n]=!0;var nr=Object.create||function(e,t){var n;return null!==e?(Xn.prototype=A(e),n=new Xn,Xn.prototype=null,n[$n]=e):n=tr(),void 0===t?n:Jn(n,t)},rr=ot("unscopables"),ir=Array.prototype;null==ir[rr]&&x.f(ir,rr,{configurable:!0,value:nr(null)});var sr=function(e){ir[rr][e]=!0},or=_e.includes;Pe({target:"Array",proto:!0},{includes:function(e){return or(this,e,arguments.length>1?arguments[1]:void 0)}}),sr("includes");var ar={};ar[ot("toStringTag")]="z";var ur="[object z]"===String(ar),cr=ot("toStringTag"),lr="Arguments"==p(function(){return arguments}()),hr=ur?p:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),cr))?n:lr?p(t):"Object"==(r=p(t))&&"function"==typeof t.callee?"Arguments":r},fr=ur?{}.toString:function(){return"[object "+hr(this)+"]"};ur||oe(Object.prototype,"toString",fr,{unsafe:!0});var gr,dr,pr="toString",vr=RegExp.prototype,yr=vr.toString,mr=a((function(){return"/a/b"!=yr.call({source:"a",flags:"b"})})),_r=yr.name!=pr;(mr||_r)&&oe(RegExp.prototype,pr,(function(){var e=A(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in vr)?De.call(e):n)}),{unsafe:!0}),e.LogLevel=void 0,(gr=e.LogLevel||(e.LogLevel={}))[gr.LOG=0]="LOG",gr[gr.DEBUG=0]="DEBUG",gr[gr.INFO=1]="INFO",gr[gr.WARN=2]="WARN",gr[gr.ERROR=3]="ERROR",gr[gr.FATAL=4]="FATAL",gr[gr.NONE=1e3]="NONE",e.LogType=void 0,(dr=e.LogType||(e.LogType={})).IM="IM",dr.RTC="RTC";var Er={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Tr=kn.forEach,Rr=Dn("forEach")?[].forEach:function(e){return Tr(this,e,arguments.length>1?arguments[1]:void 0)};for(var Ir in Er){var Cr=o[Ir],Sr=Cr&&Cr.prototype;if(Sr&&Sr.forEach!==Rr)try{L(Sr,"forEach",Rr)}catch(e){Sr.forEach=Rr}}var br=o.Promise,wr=function(e,t,n){for(var r in t)oe(e,r,t[r],n);return e},Or=x.f,Nr=ot("toStringTag"),kr=function(e,t,n){e&&!C(e=n?e:e.prototype,Nr)&&Or(e,Nr,{configurable:!0,value:t})},Ar=ot("species"),Mr=function(e){var t=ce(e),n=x.f;u&&t&&!t[Ar]&&n(t,Ar,{configurable:!0,get:function(){return this}})},xr=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Lr={},Ur=ot("iterator"),Pr=Array.prototype,Dr=function(e){return void 0!==e&&(Lr.Array===e||Pr[Ur]===e)},Vr=ot("iterator"),Br=function(e){if(null!=e)return e[Vr]||e["@@iterator"]||Lr[hr(e)]},Fr=function(e){var t=e.return;if(void 0!==t)return A(t.call(e)).value},Yr=function(e,t){this.stopped=e,this.result=t},jr=function(e,t,n){var r,i,s,o,a,u,c,l=n&&n.that,h=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),d=wn(t,l,1+h+g),p=function(e){return r&&Fr(r),new Yr(!0,e)},v=function(e){return h?(A(e),g?d(e[0],e[1],p):d(e[0],e[1])):g?d(e,p):d(e)};if(f)r=e;else{if("function"!=typeof(i=Br(e)))throw TypeError("Target is not iterable");if(Dr(i)){for(s=0,o=de(e.length);o>s;s++)if((a=v(e[s]))&&a instanceof Yr)return a;return new Yr(!1)}r=i.call(e)}for(u=r.next;!(c=u.call(r)).done;){try{a=v(c.value)}catch(e){throw Fr(r),e}if("object"==typeof a&&a&&a instanceof Yr)return a}return new Yr(!1)},qr=ot("iterator"),Gr=!1;try{var Hr=0,Kr={next:function(){return{done:!!Hr++}},return:function(){Gr=!0}};Kr[qr]=function(){return this},Array.from(Kr,(function(){throw 2}))}catch(e){}var Wr,Qr,zr,Jr=function(e,t){if(!t&&!Gr)return!1;var n=!1;try{var r={};r[qr]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Zr=ot("species"),$r=function(e,t){var n,r=A(e).constructor;return void 0===r||null==(n=A(r)[Zr])?t:bn(n)},Xr=/(?:iphone|ipod|ipad).*applewebkit/i.test(Je),ei=o.location,ti=o.setImmediate,ni=o.clearImmediate,ri=o.process,ii=o.MessageChannel,si=o.Dispatch,oi=0,ai={},ui="onreadystatechange",ci=function(e){if(ai.hasOwnProperty(e)){var t=ai[e];delete ai[e],t()}},li=function(e){return function(){ci(e)}},hi=function(e){ci(e.data)},fi=function(e){o.postMessage(e+"",ei.protocol+"//"+ei.host)};ti&&ni||(ti=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return ai[++oi]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Wr(oi),oi},ni=function(e){delete ai[e]},ze?Wr=function(e){ri.nextTick(li(e))}:si&&si.now?Wr=function(e){si.now(li(e))}:ii&&!Xr?(zr=(Qr=new ii).port2,Qr.port1.onmessage=hi,Wr=wn(zr.postMessage,zr,1)):o.addEventListener&&"function"==typeof postMessage&&!o.importScripts&&ei&&"file:"!==ei.protocol&&!a(fi)?(Wr=fi,o.addEventListener("message",hi,!1)):Wr=ui in w("script")?function(e){Zn.appendChild(w("script")).onreadystatechange=function(){Zn.removeChild(this),ci(e)}}:function(e){setTimeout(li(e),0)});var gi,di,pi,vi,yi,mi,_i,Ei,Ti={set:ti,clear:ni},Ri=/web0s(?!.*chrome)/i.test(Je),Ii=k.f,Ci=Ti.set,Si=o.MutationObserver||o.WebKitMutationObserver,bi=o.document,wi=o.process,Oi=o.Promise,Ni=Ii(o,"queueMicrotask"),ki=Ni&&Ni.value;ki||(gi=function(){var e,t;for(ze&&(e=wi.domain)&&e.exit();di;){t=di.fn,di=di.next;try{t()}catch(e){throw di?vi():pi=void 0,e}}pi=void 0,e&&e.enter()},Xr||ze||Ri||!Si||!bi?Oi&&Oi.resolve?(_i=Oi.resolve(void 0),Ei=_i.then,vi=function(){Ei.call(_i,gi)}):vi=ze?function(){wi.nextTick(gi)}:function(){Ci.call(o,gi)}:(yi=!0,mi=bi.createTextNode(""),new Si(gi).observe(mi,{characterData:!0}),vi=function(){mi.data=yi=!yi}));var Ai,Mi,xi,Li,Ui=ki||function(e){var t={fn:e,next:void 0};pi&&(pi.next=t),di||(di=t,vi()),pi=t},Pi=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=bn(t),this.reject=bn(n)},Di={f:function(e){return new Pi(e)}},Vi=function(e,t){if(A(e),E(t)&&t.constructor===e)return t;var n=Di.f(e);return(0,n.resolve)(t),n.promise},Bi=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Fi=Ti.set,Yi=ot("species"),ji="Promise",qi=se.get,Gi=se.set,Hi=se.getterFor(ji),Ki=br,Wi=o.TypeError,Qi=o.document,zi=o.process,Ji=ce("fetch"),Zi=Di.f,$i=Zi,Xi=!!(Qi&&Qi.createEvent&&o.dispatchEvent),es="function"==typeof PromiseRejectionEvent,ts="unhandledrejection",ns=Le(ji,(function(){if(!(j(Ki)!==String(Ki))){if(66===et)return!0;if(!ze&&!es)return!0}if(et>=51&&/native code/.test(Ki))return!1;var e=Ki.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[Yi]=t,!(e.then((function(){}))instanceof t)})),rs=ns||!Jr((function(e){Ki.all(e).catch((function(){}))})),is=function(e){var t;return!(!E(e)||"function"!=typeof(t=e.then))&&t},ss=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;Ui((function(){for(var r=e.value,i=1==e.state,s=0;n.length>s;){var o,a,u,c=n[s++],l=i?c.ok:c.fail,h=c.resolve,f=c.reject,g=c.domain;try{l?(i||(2===e.rejection&&cs(e),e.rejection=1),!0===l?o=r:(g&&g.enter(),o=l(r),g&&(g.exit(),u=!0)),o===c.promise?f(Wi("Promise-chain cycle")):(a=is(o))?a.call(o,h,f):h(o)):f(r)}catch(e){g&&!u&&g.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&as(e)}))}},os=function(e,t,n){var r,i;Xi?((r=Qi.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),o.dispatchEvent(r)):r={promise:t,reason:n},!es&&(i=o["on"+e])?i(r):e===ts&&function(e,t){var n=o.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},as=function(e){Fi.call(o,(function(){var t,n=e.facade,r=e.value;if(us(e)&&(t=Bi((function(){ze?zi.emit("unhandledRejection",r,n):os(ts,n,r)})),e.rejection=ze||us(e)?2:1,t.error))throw t.value}))},us=function(e){return 1!==e.rejection&&!e.parent},cs=function(e){Fi.call(o,(function(){var t=e.facade;ze?zi.emit("rejectionHandled",t):os("rejectionhandled",t,e.value)}))},ls=function(e,t,n){return function(r){e(t,r,n)}},hs=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ss(e,!0))},fs=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Wi("Promise can't be resolved itself");var r=is(t);r?Ui((function(){var n={done:!1};try{r.call(t,ls(fs,n,e),ls(hs,n,e))}catch(t){hs(n,t,e)}})):(e.value=t,e.state=1,ss(e,!1))}catch(t){hs({done:!1},t,e)}}};ns&&(Ki=function(e){xr(this,Ki,ji),bn(e),Ai.call(this);var t=qi(this);try{e(ls(fs,t),ls(hs,t))}catch(e){hs(t,e)}},(Ai=function(e){Gi(this,{type:ji,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=wr(Ki.prototype,{then:function(e,t){var n=Hi(this),r=Zi($r(this,Ki));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=ze?zi.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&ss(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Mi=function(){var e=new Ai,t=qi(e);this.promise=e,this.resolve=ls(fs,t),this.reject=ls(hs,t)},Di.f=Zi=function(e){return e===Ki||e===xi?new Mi(e):$i(e)},"function"==typeof br&&(Li=br.prototype.then,oe(br.prototype,"then",(function(e,t){var n=this;return new Ki((function(e,t){Li.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof Ji&&Pe({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Vi(Ki,Ji.apply(o,arguments))}}))),Pe({global:!0,wrap:!0,forced:ns},{Promise:Ki}),kr(Ki,ji,!1),Mr(ji),xi=ce(ji),Pe({target:ji,stat:!0,forced:ns},{reject:function(e){var t=Zi(this);return t.reject.call(void 0,e),t.promise}}),Pe({target:ji,stat:!0,forced:ns},{resolve:function(e){return Vi(this,e)}}),Pe({target:ji,stat:!0,forced:rs},{all:function(e){var t=this,n=Zi(t),r=n.resolve,i=n.reject,s=Bi((function(){var n=bn(t.resolve),s=[],o=0,a=1;jr(e,(function(e){var u=o++,c=!1;s.push(void 0),a++,n.call(t,e).then((function(e){c||(c=!0,s[u]=e,--a||r(s))}),i)})),--a||r(s)}));return s.error&&i(s.value),n.promise},race:function(e){var t=this,n=Zi(t),r=n.reject,i=Bi((function(){var i=bn(t.resolve);jr(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var gs="RC_Logs";function ds(e){!function(e,t,n){var r;if(!e.objectStoreNames.contains(t)){var i=wt({},n.objectStoreParams);r=e.createObjectStore(t,i),n.indexs&&n.indexs.length>0&&n.indexs.forEach((function(e){r.createIndex(e.indexName,e.key,{unique:e.unique})}))}}(e,gs,{indexs:[{indexName:"time",key:"time",unique:!1}],objectStoreParams:{keyPath:"key"}})}var ps=function(){function e(){Rt(this,e)}return Ct(e,[{key:"addList",value:function(t,n){return new Promise((function(r){if(e._db){var i=e._db.transaction([t],"readwrite"),s=i.objectStore(t);n.forEach((function(e){null==s||s.add(e)})),i.oncomplete=function(e){r(!0)},i.onerror=function(e){r(!1)}}else r(!1)}))}},{key:"getRangeData",value:function(t,n,r,i){return new Promise((function(s){if(e._db){var o=e._db.transaction([t],"readwrite").objectStore(t),a=IDBKeyRange.bound(r,i),u=o.index(n),c=[];u.openCursor(a).onsuccess=function(e){var t=e.target.result;t?(c.push(t.value),t.continue()):s(c)}}else s([])}))}},{key:"getCount",value:function(t,n){return new Promise((function(r){if(e._db){var i=e._db.transaction([t],"readonly").objectStore(t).index(n),s=i.count();s.onsuccess=function(){r(s.result)},i.openCursor().onsuccess=function(e){var t=e.target.result;t&&t.continue()}}else r(0)}))}},{key:"removeFirstData",value:function(t,n,r){return new Promise((function(i){if(e._db){var s=e._db.transaction([t],"readwrite").objectStore(t),o=s.index(n).getAllKeys(IDBKeyRange.lowerBound(0),r);o.onsuccess=function(){var e=o.result;e.length>0&&(s.delete(IDBKeyRange.bound(e[0],e[e.length-1])).onsuccess=function(){i(!0)})}}else i(!1)}))}}],[{key:"init",value:function(){if("undefined"!=typeof window&&window&&window.indexedDB){var t=window.indexedDB.open("RC_ENGINE_DB",1);t.onerror=function(e){console.warn("open indexDB request failed "+e.target.error)},t.onsuccess=function(t){e._db=t.target.result,e._instance=new e},t.onupgradeneeded=function(t){e._db=t.target.result,ds(t.target.result)}}else console.warn("IndexDB is not currently supported in the environment!")}},{key:"getInstance",value:function(){return e._instance}}]),e}();ps._db=null;var vs=ot("match"),ys=function(e){var t;return E(e)&&(void 0!==(t=e[vs])?!!t:"RegExp"==p(e))},ms=Be.UNSUPPORTED_Y,_s=[].push,Es=Math.min,Ts=4294967295;gt("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(m(this)),i=void 0===n?Ts:n>>>0;if(0===i)return[];if(void 0===e)return[r];if(!ys(e))return t.call(r,e,i);for(var s,o,a,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,h=new RegExp(e.source,c+"g");(s=Ke.call(h,r))&&!((o=h.lastIndex)>l&&(u.push(r.slice(l,s.index)),s.length>1&&s.index<r.length&&_s.apply(u,s.slice(1)),a=s[0].length,l=o,u.length>=i));)h.lastIndex===s.index&&h.lastIndex++;return l===r.length?!a&&h.test("")||u.push(""):u.push(r.slice(l)),u.length>i?u.slice(0,i):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=m(this),s=null==t?void 0:t[e];return void 0!==s?s.call(t,i,n):r.call(String(i),t,n)},function(e,i){var s=n(r,e,this,i,r!==t);if(s.done)return s.value;var o=A(e),a=String(this),u=$r(o,RegExp),c=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(ms?"g":"y"),h=new u(ms?"^(?:"+o.source+")":o,l),f=void 0===i?Ts:i>>>0;if(0===f)return[];if(0===a.length)return null===mt(h,a)?[a]:[];for(var g=0,d=0,p=[];d<a.length;){h.lastIndex=ms?0:d;var v,y=mt(h,ms?a.slice(d):a);if(null===y||(v=Es(de(h.lastIndex+(ms?d:0)),a.length))===g)d=yt(a,d,c);else{if(p.push(a.slice(g,d)),p.length===f)return p;for(var m=1;m<=y.length-1;m++)if(p.push(y[m]),p.length===f)return p;d=g=v}}return p.push(a.slice(g)),p}]}),ms);var Rs,Is=function(e,t){return e+Math.floor(Math.random()*(t-e))},Cs=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Ss=function(){var e=Cs();if(e=e.replace(/-/g,"")+"a",(e=function(e){var t="0123456789abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZa0".split(""),n=t.length+1,r=+e,i=[];do{var s=r%n;r=(r-s)/n,i.unshift(t[s])}while(r);return i.join("")}(e=parseInt(e,16))).length>22&&(e=e.slice(0,22)),e.length<22)for(var t=22-e.length,n=0;n<t;n++)e+="0";return e};!function(e){e[e.NONE=0]="NONE",e[e.PRIVATE=1]="PRIVATE",e[e.DISCUSSION=2]="DISCUSSION",e[e.GROUP=3]="GROUP",e[e.CHATROOM=4]="CHATROOM",e[e.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",e[e.SYSTEM=6]="SYSTEM",e[e.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",e[e.PUBLIC_SERVICE=8]="PUBLIC_SERVICE",e[e.RTC_ROOM=12]="RTC_ROOM"}(Rs||(Rs={}));var bs,ws=Rs;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=4]="FILE",e[e.SIGHT=5]="SIGHT",e[e.COMBINE_HTML=6]="COMBINE_HTML"}(bs||(bs={}));var Os,Ns=bs,ks=function(e){return"string"==typeof e},As=function(e){return"boolean"==typeof e},Ms=function(e){return"number"==typeof e&&!isNaN(e)},xs=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")},Ls=function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)},Us=function(e){return ks(e)&&e.length>0},Ps=function(e){return"[object Object]"===Object.prototype.toString.call(e)},Ds=function(e){return"[object Function]"===Object.prototype.toString.call(e)},Vs=function(e){return void 0===e||"[object Undefined]"===Object.prototype.toString.call(e)},Bs=function(e){return"[object Null]"===Object.prototype.toString.call(e)},Fs=function(e){for(var t in e)return!0;return!1},Ys=(St(Os={},e.LogLevel.DEBUG,console.debug.bind(console)),St(Os,e.LogLevel.INFO,console.info.bind(console)),St(Os,e.LogLevel.WARN,console.warn.bind(console)),St(Os,e.LogLevel.ERROR,console.error.bind(console)),St(Os,e.LogLevel.FATAL,console.log.bind(console)),Os),js=function(e){return ks(e)||Ms(e)||Vs(e)||As(e)?e:e instanceof Error?JSON.stringify({name:e.name,message:e.message,stack:e.stack}):JSON.stringify(e)},qs=0,Gs=function(){function t(n,r,i){Rt(this,t),this.tag=n,this.type=r,this.initiator=i,this._outLevel=e.LogLevel.WARN,this.debug=this.log.bind(this,e.LogLevel.DEBUG),this.info=this.log.bind(this,e.LogLevel.INFO),this.warn=this.log.bind(this,e.LogLevel.WARN),this.error=this.log.bind(this,e.LogLevel.ERROR),this.fatal=this.log.bind(this,e.LogLevel.FATAL)}var n;return Ct(t,[{key:"_defaultStdout",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];Ys[e].apply(Ys,["".concat(t,":")].concat(r))}},{key:"__pushLocalLog",value:function(n,r,i){var s;s=this.type?this.type:["RCRTCLog","RCCall","RCRTC","RTC-A"].includes(this.tag)?e.LogType.RTC:e.LogType.IM;var o=Date.now();o===Math.floor(qs/1e3)?qs++:qs=1e3*o,jn(r)>=1e3&&(r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"utf-8";if(!e||!t)return"";var r="utf-8"===n?3:2,i=0,s=0,o="";for(s=0;s<e.length;s++){if(e.charCodeAt(s)>255?i+=r:i++,i>t)return o;o+=e.charAt(s)}return e}(r,1e3));var a=JSON.stringify({message:r,userId:t.userId}).replace(/"/g,'""'),u=/^[\w]+-[\w]+-[\w]+?/.test(i)?i:"".concat(this.initiator||"L","-").concat(i,"-O"),c={sessionId:t.sessionId,time:o,level:4-n,content:"".concat(t.sessionId,",").concat(Date.now(),",").concat(s,",").concat(4-n,",").concat(u,',"').concat(a,'"\n'),key:t.sessionId+"_"+qs.toString(),userId:t.userId};t.databaseLogList.push(c),t.databaseLogList.length>=100&&this.__insertLogIntoDatabase()}},{key:"__insertLogIntoDatabase",value:(n=Tt(regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Bt(t.databaseLogList),t.databaseLogList=[],!(r=ps.getInstance())){e.next=14;break}return e.next=6,r.addList(gs,n);case 6:return i=e.sent,e.next=9,r.getCount(gs,"time");case 9:return e.sent>1e5&&r.removeFirstData(gs,"time",2e3),e.abrupt("return",i);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"setLogLevel",value:function(t){this._outLevel="number"!=typeof t?e.LogLevel.WARN:t}},{key:"setLogStdout",value:function(e){this._logStdout=e}},{key:"log",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(this.__pushLocalLog(t,r.map(js).join(" "),this.tag),!(t<this._outLevel)){var s="".concat((new Date).toISOString(),"[").concat(this.tag,"][").concat(e.LogLevel[t],"]"),o="".concat(s," - ").concat(r.map(js).join(" "));this._logStdout?this._logStdout(t,o):this._stdout?this._stdout(t,o):this._defaultStdout.apply(this,[t,s].concat(r))}}},{key:"reportLog",value:function(e,n,r){this.__pushLocalLog(4-e,r,n);var i=JSON.stringify({message:r}).replace(/"/g,'""');i='"'.concat(i,'"');var s={level:e,content:[t.sessionId,Date.now(),this.type,e,n,i].join()+"\n"};t.realTimeLogList.push(s),t.realTimeLogList.length>=600&&(t.realTimeLogList=t.realTimeLogList.slice(-500))}},{key:"set",value:function(e,t){this.warn("logger.set has being deprecated!")}},{key:"setStdout",value:function(e){this._stdout=e}},{key:"__clearRealTimeLog",value:function(){t.realTimeLogList=[]}}],[{key:"init",value:function(e){t.userId=e}},{key:"reset",value:function(){t.userId=""}}]),t}();Gs.databaseLogList=[],Gs.realTimeLogList=[],Gs.sessionId=Ss(),Gs.userId="";var Hs=new Gs("RCLog"),Ks=Wt("splice"),Ws=Math.max,Qs=Math.min,zs=9007199254740991,Js="Maximum allowed length exceeded";Pe({target:"Array",proto:!0,forced:!Ks},{splice:function(e,t){var n,r,i,s,o,a,u=R(this),c=de(u.length),l=ye(e,c),h=arguments.length;if(0===h?n=r=0:1===h?(n=0,r=c-l):(n=h-2,r=Qs(Ws(fe(t),0),c-l)),c+n-r>zs)throw TypeError(Js);for(i=Ht(u,r),s=0;s<r;s++)(o=l+s)in u&&qt(i,s,u[o]);if(i.length=r,n<r){for(s=l;s<c-r;s++)a=s+n,(o=s+r)in u?u[a]=u[o]:delete u[a];for(s=c;s>c-r+n;s--)delete u[s-1]}else if(n>r)for(s=c-r;s>l;s--)a=s+n-1,(o=s+r-1)in u?u[a]=u[o]:delete u[a];for(s=0;s<n;s++)u[s+l]=arguments[s+2];return u.length=c-r+n,i}});var Zs,$s,Xs=function(){function e(){Rt(this,e),this._map={}}return Ct(e,[{key:"on",value:function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n})}},{key:"once",value:function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n,once:!0})}},{key:"off",value:function(e,t,n){var r=this._map[e];r&&((r=r.filter((function(e){return e.listener!==t||e.target!==n}))).length?this._map[e]=r:delete this._map[e])}},{key:"emit",value:function(e){var t=this._map[e];if(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var s=t.length-1;s>=0;s-=1){var o=t[s],a=o.target,u=o.once,c=o.listener;u&&t.splice(s,1);try{c.call.apply(c,[a].concat(r))}catch(e){Hs.error(e)}}}}},{key:"removeAll",value:function(e){delete this._map[e]}},{key:"clear",value:function(){Object.keys(this._map).forEach(this.removeAll,this)}}]),e}();e.AssertRules=void 0,($s=e.AssertRules||(e.AssertRules={}))[$s.STRING=0]="STRING",$s[$s.ONLY_STRING=1]="ONLY_STRING",$s[$s.NUMBER=2]="NUMBER",$s[$s.BOOLEAN=3]="BOOLEAN",$s[$s.OBJECT=4]="OBJECT",$s[$s.ARRAY=5]="ARRAY",$s[$s.CALLBACK=6]="CALLBACK";var eo=(St(Zs={},e.AssertRules.STRING,Us),St(Zs,e.AssertRules.ONLY_STRING,ks),St(Zs,e.AssertRules.NUMBER,Ms),St(Zs,e.AssertRules.BOOLEAN,(function(e){return"boolean"==typeof e})),St(Zs,e.AssertRules.OBJECT,Ps),St(Zs,e.AssertRules.ARRAY,xs),St(Zs,e.AssertRules.CALLBACK,(function(e){var t=!0;return Ps(e)||(t=!1),(e=e||{}).onSuccess&&!Ds(e.onSuccess)&&(t=!1),e.onError&&!Ds(e.onError)&&(t=!1),t})),Zs),to=function(e){Ot(n,e);var t=Pt(n);function n(e){var r;return Rt(this,n),(r=t.call(this,e)).name="RCAssertError",r}return n}(xt(Error)),no=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n=eo[n]||n;var i=r&&!n(t)||!r&&!(Vs(t)||null===t||n(t));return i&&Hs.error("'".concat(e,"' is invalid: ").concat(JSON.stringify(t))),!i},ro=[].slice,io=/MSIE .\./.test(Je),so=function(e){return function(t,n){var r=arguments.length>2,i=r?ro.call(arguments,2):void 0;return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};Pe({global:!0,bind:!0,forced:io},{setTimeout:so(o.setTimeout),setInterval:so(o.setInterval)});var oo,ao=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return A(n),function(e){if(!E(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),uo=function(e,t,n){var r,i;return ao&&"function"==typeof(r=t.constructor)&&r!==n&&E(i=r.prototype)&&i!==n.prototype&&ao(e,i),e},co=x.f,lo=Ce.f,ho=se.enforce,fo=ot("match"),go=o.RegExp,po=go.prototype,vo=/a/g,yo=/a/g,mo=new go(vo)!==vo,_o=Be.UNSUPPORTED_Y;if(u&&Le("RegExp",!mo||_o||a((function(){return yo[fo]=!1,go(vo)!=vo||go(yo)==yo||"/a/i"!=go(vo,"i")})))){for(var Eo=function(e,t){var n,r=this instanceof Eo,i=ys(e),s=void 0===t;if(!r&&i&&e.constructor===Eo&&s)return e;mo?i&&!s&&(e=e.source):e instanceof Eo&&(s&&(t=De.call(e)),e=e.source),_o&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var o=uo(mo?new go(e,t):go(e,t),r?this:po,Eo);_o&&n&&(ho(o).sticky=!0);return o},To=function(e){e in Eo||co(Eo,e,{configurable:!0,get:function(){return go[e]},set:function(t){go[e]=t}})},Ro=lo(go),Io=0;Ro.length>Io;)To(Ro[Io++]);po.constructor=Eo,Eo.prototype=po,oe(o,"RegExp",Eo)}Mr("RegExp"),function(e){e[e.TIMEOUT=-1]="TIMEOUT",e[e.UNKNOWN=-2]="UNKNOWN",e[e.PARAMETER_ERROR=-3]="PARAMETER_ERROR",e[e.EXTRA_METHOD_UNDEFINED=-4]="EXTRA_METHOD_UNDEFINED",e[e.MAIN_PROCESS_ERROR=-5]="MAIN_PROCESS_ERROR",e[e.SUCCESS=0]="SUCCESS",e[e.RC_MSG_UNAUTHORIZED=20406]="RC_MSG_UNAUTHORIZED",e[e.RC_DISCUSSION_GROUP_ID_INVALID=20407]="RC_DISCUSSION_GROUP_ID_INVALID",e[e.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",e[e.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",e[e.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",e[e.RECALL_MESSAGE=25101]="RECALL_MESSAGE",e[e.NOT_IN_GROUP=22406]="NOT_IN_GROUP",e[e.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",e[e.FORBIDDEN_IN_CHATROOM=23408]="FORBIDDEN_IN_CHATROOM",e[e.RC_CHATROOM_USER_KICKED=23409]="RC_CHATROOM_USER_KICKED",e[e.RC_CHATROOM_NOT_EXIST=23410]="RC_CHATROOM_NOT_EXIST",e[e.RC_CHATROOM_IS_FULL=23411]="RC_CHATROOM_IS_FULL",e[e.RC_CHATROOM_PATAMETER_INVALID=23412]="RC_CHATROOM_PATAMETER_INVALID",e[e.CHATROOM_GET_HISTORYMSG_ERROR=23413]="CHATROOM_GET_HISTORYMSG_ERROR",e[e.CHATROOM_NOT_OPEN_HISTORYMSG_STORE=23414]="CHATROOM_NOT_OPEN_HISTORYMSG_STORE",e[e.CHATROOM_KV_EXCEED=23423]="CHATROOM_KV_EXCEED",e[e.CHATROOM_KV_OVERWRITE_INVALID=23424]="CHATROOM_KV_OVERWRITE_INVALID",e[e.CHATROOM_KV_STORE_NOT_OPEN=23426]="CHATROOM_KV_STORE_NOT_OPEN",e[e.CHATROOM_KEY_NOT_EXIST=23427]="CHATROOM_KEY_NOT_EXIST",e[e.SENSITIVE_SHIELD=21501]="SENSITIVE_SHIELD",e[e.SENSITIVE_REPLACE=21502]="SENSITIVE_REPLACE",e[e.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",e[e.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",e[e.INVITE_DICUSSION=21409]="INVITE_DICUSSION",e[e.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",e[e.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",e[e.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",e[e.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",e[e.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",e[e.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",e[e.RC_HTTP_REQ_TIMEOUT=30005]="RC_HTTP_REQ_TIMEOUT",e[e.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",e[e.RC_NAVI_RESOURCE_ERROR=30007]="RC_NAVI_RESOURCE_ERROR",e[e.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",e[e.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",e[e.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",e[e.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",e[e.RC_PING_SEND_FAIL=30012]="RC_PING_SEND_FAIL",e[e.RC_PONG_RECV_FAIL=30013]="RC_PONG_RECV_FAIL",e[e.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",e[e.RC_MSG_CONTENT_EXCEED_LIMIT=30016]="RC_MSG_CONTENT_EXCEED_LIMIT",e[e.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",e[e.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",e[e.RC_CONN_ID_REJECT=31002]="RC_CONN_ID_REJECT",e[e.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",e[e.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR",e[e.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",e[e.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",e[e.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",e[e.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",e[e.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",e[e.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",e[e.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",e[e.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",e[e.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",e[e.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",e[e.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",e[e.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",e[e.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",e[e.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",e[e.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",e[e.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",e[e.MSG_INSERT_ERROR=33008]="MSG_INSERT_ERROR",e[e.MSG_DEL_ERROR=33009]="MSG_DEL_ERROR",e[e.TAG_NOT_EXIST=33101]="TAG_NOT_EXIST",e[e.NO_TAG_IN_CONVER=33102]="NO_TAG_IN_CONVER",e[e.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",e[e.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",e[e.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",e[e.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",e[e.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",e[e.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",e[e.CONVER_CLEAR_ERROR=34007]="CONVER_CLEAR_ERROR",e[e.EXPANSION_LIMIT_EXCEET=34010]="EXPANSION_LIMIT_EXCEET",e[e.MESSAGE_KV_NOT_SUPPORT=34008]="MESSAGE_KV_NOT_SUPPORT",e[e.CLEAR_HIS_TIME_ERROR=34011]="CLEAR_HIS_TIME_ERROR",e[e.CONVER_OUT_LIMIT_ERROR=34013]="CONVER_OUT_LIMIT_ERROR",e[e.CONVER_GET_ERROR=34009]="CONVER_GET_ERROR",e[e.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",e[e.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",e[e.READ_RECEIPT_ERROR=35003]="READ_RECEIPT_ERROR",e[e.PACKAGE_ENVIRONMENT_ERROR=35006]="PACKAGE_ENVIRONMENT_ERROR",e[e.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",e[e.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",e[e.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",e[e.CHATROOM_KV_NOT_FOUND=36004]="CHATROOM_KV_NOT_FOUND",e[e.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",e[e.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",e[e.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",e[e.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",e[e.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",e[e.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",e[e.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",e[e.NOT_SUPPORT=39002]="NOT_SUPPORT",e[e.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",e[e.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",e[e.COOKIE_ENABLE=51001]="COOKIE_ENABLE",e[e.GET_MESSAGE_BY_ID_ERROR=61001]="GET_MESSAGE_BY_ID_ERROR",e[e.HAVNODEVICEID=24001]="HAVNODEVICEID",e[e.DEVICEIDISHAVE=24002]="DEVICEIDISHAVE",e[e.FEILD=24009]="FEILD",e[e.VOIPISNULL=24013]="VOIPISNULL",e[e.NOENGINETYPE=24010]="NOENGINETYPE",e[e.NULLCHANNELNAME=24011]="NULLCHANNELNAME",e[e.VOIPDYANMICERROR=24012]="VOIPDYANMICERROR",e[e.NOVOIP=24014]="NOVOIP",e[e.INTERNALERRROR=24015]="INTERNALERRROR",e[e.VOIPCLOSE=24016]="VOIPCLOSE",e[e.CLOSE_BEFORE_OPEN=51001]="CLOSE_BEFORE_OPEN",e[e.ALREADY_IN_USE=51002]="ALREADY_IN_USE",e[e.INVALID_CHANNEL_NAME=51003]="INVALID_CHANNEL_NAME",e[e.VIDEO_CONTAINER_IS_NULL=51004]="VIDEO_CONTAINER_IS_NULL",e[e.DELETE_MESSAGE_ID_IS_NULL=61001]="DELETE_MESSAGE_ID_IS_NULL",e[e.CANCEL=1]="CANCEL",e[e.REJECT=2]="REJECT",e[e.HANGUP=3]="HANGUP",e[e.BUSYLINE=4]="BUSYLINE",e[e.NO_RESPONSE=5]="NO_RESPONSE",e[e.ENGINE_UN_SUPPORTED=6]="ENGINE_UN_SUPPORTED",e[e.NETWORK_ERROR=7]="NETWORK_ERROR",e[e.REMOTE_CANCEL=11]="REMOTE_CANCEL",e[e.REMOTE_REJECT=12]="REMOTE_REJECT",e[e.REMOTE_HANGUP=13]="REMOTE_HANGUP",e[e.REMOTE_BUSYLINE=14]="REMOTE_BUSYLINE",e[e.REMOTE_NO_RESPONSE=15]="REMOTE_NO_RESPONSE",e[e.REMOTE_ENGINE_UN_SUPPORTED=16]="REMOTE_ENGINE_UN_SUPPORTED",e[e.REMOTE_NETWORK_ERROR=17]="REMOTE_NETWORK_ERROR",e[e.VOIP_NOT_AVALIABLE=18]="VOIP_NOT_AVALIABLE"}(oo||(oo={}));var Co,So=oo,bo=function(e){if(!Ps(e)||void 0===e.low||void 0===e.high)return e;var t=e.low;return t<0&&(t+=4294967296),t=t.toString(16),parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{"+t.length+"}$"),t),16)},wo=function(e,t){var n=Math.floor(1e3*Math.random()%1e4),r=Cs(),i=function(e){e=e||"-";var t=new Date,n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate();return"".concat(n).concat(e).concat(r).concat(e).concat(i)}(),s=(new Date).getTime(),o="";if(t){var a=t.split(".");o="."+a[a.length-1]}return"".concat(e,"__RC-").concat(i,"_").concat(n,"_").concat(s).concat(r).concat(o)},Oo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.threadId,r=e.apnsCollapseId,i=e.category,s=e.richMediaUri,o=t.channelIdMi,a=t.channelIdHW,u=t.channelIdOPPO,c=t.typeVivo,l=t.googleConfig,h={};h["thread-id"]=n||"",h["apns-collapse-id"]=r||"",h.category=i||"",h.richMediaUri=s||"";var f={};f.collapse_key=null==l?void 0:l.collapseKey,f.imageUrl=null==l?void 0:l.imageUrl;var g=null==l?void 0:l.priority;g&&!["high","normal"].includes(g)&&(g="normal"),f.priority=g;var d=[{HW:{channelId:a||""}},{MI:{channelId:o||""}},{OPPO:{channelId:u||""}},{VIVO:{classification:c||""}},{APNS:h},{FCM:f}];return JSON.stringify(d)},No=function(e,t){var n={},r={notificationId:t||""};if(!e)return{iOSConfig:n,androidConfig:r};try{var i=JSON.parse(e);null==i||i.forEach((function(e){var t,i,s,o,a=Object.keys(e);if(0!==a.length){var u=a[0];switch(u){case"HW":return void(r.channelIdHW=null===(t=e[u])||void 0===t?void 0:t.channelId);case"MI":return void(r.channelIdMi=null===(i=e[u])||void 0===i?void 0:i.channelId);case"OPPO":return void(r.channelIdOPPO=null===(s=e[u])||void 0===s?void 0:s.channelId);case"VIVO":return void(r.typeVivo=null===(o=e[u])||void 0===o?void 0:o.classification);case"APNS":return n.threadId=e[u]["thread-id"],n.apnsCollapseId=e[u]["apns-collapse-id"],n.category=e[u].category,void(n.richMediaUri=e[u].richMediaUri);case"FCM":r.googleConfig={collapseKey:e[u].collapse_key||"",imageUrl:e[u].imageUrl||"",priority:e[u].priority||""}}}}))}catch(t){Hs.error("Wrong format for pushConfigs field! content: "+e)}return{iOSConfig:n,androidConfig:r}},ko=function(e){var t=/^[A-Za-z0-9_=+-]+$/.test(e),n=e.length;return t&&(n<=128&&n>=1)},Ao=function(e){var t=e.length;return t<=4096&&t>=1},Mo=function(e,t,n){t=t||function(){};var r=(n=n||{}).isReverse;Ps(e)&&function(){for(var n in e)t(e[n],n,e)}(),(xs(e)||ks(e))&&function(){if(r)for(var n=e.length-1;n>=0;n--)t(e[n],n);else for(var i=0,s=e.length;i<s;i++)t(e[i],i)}()},xo=function(e,t){return Mo(e,(function(n,r){e[r]=t(n,r)})),e},Lo=function(e,t){if(e.indexOf)return e.indexOf(t);var n=-1;return Mo(e,(function(e,r){t===e&&(n=r)})),n},Uo=function(e,t){var n=[];return Mo(e,(function(e){n.push(e)})),-1!==Lo(n,t)},Po=function(e){return JSON.parse(JSON.stringify(e))},Do=function(){return"undefined"!=typeof RCCppEngine},Vo=function(e){if("browser"!==e.tag)return{type:e.tag,version:"UnKonw"};var t,n,r=navigator.userAgent,i={IE:/rv:([\d.]+)\) like Gecko|MSIE ([\d.]+)/,Edge:/Edge\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Opera:/(?:OPERA|OPR).([\d.]+)/,WeChat:/MicroMessenger\/([\d.]+)/,QQBrowser:/QQBrowser\/([\d.]+)/,Chrome:/Chrome\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari/,iOSChrome:/Mobile\/([\d.]+).*Safari/};for(var s in i)if(i.hasOwnProperty(s)){var o=r.match(i[s]);if(o){n=s,t=o[1]||o[2];break}}return{type:n||"UnKonw",version:t||"UnKonw"}};!function(e){e[e.UPDATE=1]="UPDATE",e[e.DELETE=2]="DELETE"}(Co||(Co={}));var Bo,Fo,Yo,jo=Co,qo=function(e){var t={},n=JSON.parse(e);return Mo(n,(function(e,n){t[n]=e.v})),t},Go={_delayTime:0,setTime:function(e){var t=(new Date).getTime();Go._delayTime=t-e},getTime:function(){var e=Go._delayTime;return(new Date).getTime()-e}},Ho=!a((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Ko=J("IE_PROTO"),Wo=Object.prototype,Qo=Ho?Object.getPrototypeOf:function(e){return e=R(e),C(e,Ko)?e[Ko]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Wo:null},zo=ot("iterator"),Jo=!1;[].keys&&("next"in(Yo=[].keys())?(Fo=Qo(Qo(Yo)))!==Object.prototype&&(Bo=Fo):Jo=!0),(null==Bo||a((function(){var e={};return Bo[zo].call(e)!==e})))&&(Bo={}),C(Bo,zo)||L(Bo,zo,(function(){return this}));var Zo={IteratorPrototype:Bo,BUGGY_SAFARI_ITERATORS:Jo},$o=Zo.IteratorPrototype,Xo=function(){return this},ea=Zo.IteratorPrototype,ta=Zo.BUGGY_SAFARI_ITERATORS,na=ot("iterator"),ra="keys",ia="values",sa="entries",oa=function(){return this},aa=function(e,t,n,r,i,s,o){!function(e,t,n){var r=t+" Iterator";e.prototype=nr($o,{next:f(1,n)}),kr(e,r,!1),Lr[r]=Xo}(n,t,r);var a,u,c,l=function(e){if(e===i&&v)return v;if(!ta&&e in d)return d[e];switch(e){case ra:case ia:case sa:return function(){return new n(this,e)}}return function(){return new n(this)}},h=t+" Iterator",g=!1,d=e.prototype,p=d[na]||d["@@iterator"]||i&&d[i],v=!ta&&p||l(i),y="Array"==t&&d.entries||p;if(y&&(a=Qo(y.call(new e)),ea!==Object.prototype&&a.next&&(Qo(a)!==ea&&(ao?ao(a,ea):"function"!=typeof a[na]&&L(a,na,oa)),kr(a,h,!0))),i==ia&&p&&p.name!==ia&&(g=!0,v=function(){return p.call(this)}),d[na]!==v&&L(d,na,v),Lr[t]=v,i)if(u={values:l(ia),keys:s?v:l(ra),entries:l(sa)},o)for(c in u)(ta||g||!(c in d))&&oe(d,c,u[c]);else Pe({target:t,proto:!0,forced:ta||g},u);return u},ua=pt.charAt,ca="String Iterator",la=se.set,ha=se.getterFor(ca);aa(String,"String",(function(e){la(this,{type:ca,string:String(e),index:0})}),(function(){var e,t=ha(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=ua(n,r),t.index+=e.length,{value:e,done:!1})}));var fa="Array Iterator",ga=se.set,da=se.getterFor(fa),pa=aa(Array,"Array",(function(e,t){ga(this,{type:fa,target:_(e),index:0,kind:t})}),(function(){var e=da(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");Lr.Arguments=Lr.Array,sr("keys"),sr("values"),sr("entries");var va=ot("iterator"),ya=ot("toStringTag"),ma=pa.values;for(var _a in Er){var Ea=o[_a],Ta=Ea&&Ea.prototype;if(Ta){if(Ta[va]!==ma)try{L(Ta,va,ma)}catch(e){Ta[va]=ma}if(Ta[ya]||L(Ta,ya,_a),Er[_a])for(var Ra in pa)if(Ta[Ra]!==pa[Ra])try{L(Ta,Ra,pa[Ra])}catch(e){Ta[Ra]=pa[Ra]}}}var Ia="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ca=function(e){if(void 0===e)return 0;var t=fe(e),n=de(t);if(t!==n)throw RangeError("Wrong length or index");return n},Sa=Math.abs,ba=Math.pow,wa=Math.floor,Oa=Math.log,Na=Math.LN2,ka=function(e,t,n){var r,i,s,o=new Array(n),a=8*n-t-1,u=(1<<a)-1,c=u>>1,l=23===t?ba(2,-24)-ba(2,-77):0,h=e<0||0===e&&1/e<0?1:0,f=0;for((e=Sa(e))!=e||e===1/0?(i=e!=e?1:0,r=u):(r=wa(Oa(e)/Na),e*(s=ba(2,-r))<1&&(r--,s*=2),(e+=r+c>=1?l/s:l*ba(2,1-c))*s>=2&&(r++,s/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(e*s-1)*ba(2,t),r+=c):(i=e*ba(2,c-1)*ba(2,t),r=0));t>=8;o[f++]=255&i,i/=256,t-=8);for(r=r<<t|i,a+=t;a>0;o[f++]=255&r,r/=256,a-=8);return o[--f]|=128*h,o},Aa=function(e,t){var n,r=e.length,i=8*r-t-1,s=(1<<i)-1,o=s>>1,a=i-7,u=r-1,c=e[u--],l=127&c;for(c>>=7;a>0;l=256*l+e[u],u--,a-=8);for(n=l&(1<<-a)-1,l>>=-a,a+=t;a>0;n=256*n+e[u],u--,a-=8);if(0===l)l=1-o;else{if(l===s)return n?NaN:c?-1/0:1/0;n+=ba(2,t),l-=o}return(c?-1:1)*n*ba(2,l-t)},Ma=function(e){for(var t=R(this),n=de(t.length),r=arguments.length,i=ye(r>1?arguments[1]:void 0,n),s=r>2?arguments[2]:void 0,o=void 0===s?n:ye(s,n);o>i;)t[i++]=e;return t},xa=Ce.f,La=x.f,Ua=se.get,Pa=se.set,Da="ArrayBuffer",Va="DataView",Ba="Wrong index",Fa=o.ArrayBuffer,Ya=Fa,ja=o.DataView,qa=ja&&ja.prototype,Ga=Object.prototype,Ha=o.RangeError,Ka=ka,Wa=Aa,Qa=function(e){return[255&e]},za=function(e){return[255&e,e>>8&255]},Ja=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Za=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},$a=function(e){return Ka(e,23,4)},Xa=function(e){return Ka(e,52,8)},eu=function(e,t){La(e.prototype,t,{get:function(){return Ua(this)[t]}})},tu=function(e,t,n,r){var i=Ca(n),s=Ua(e);if(i+t>s.byteLength)throw Ha(Ba);var o=Ua(s.buffer).bytes,a=i+s.byteOffset,u=o.slice(a,a+t);return r?u:u.reverse()},nu=function(e,t,n,r,i,s){var o=Ca(n),a=Ua(e);if(o+t>a.byteLength)throw Ha(Ba);for(var u=Ua(a.buffer).bytes,c=o+a.byteOffset,l=r(+i),h=0;h<t;h++)u[c+h]=l[s?h:t-h-1]};if(Ia){if(!a((function(){Fa(1)}))||!a((function(){new Fa(-1)}))||a((function(){return new Fa,new Fa(1.5),new Fa(NaN),Fa.name!=Da}))){for(var ru,iu=(Ya=function(e){return xr(this,Ya),new Fa(Ca(e))}).prototype=Fa.prototype,su=xa(Fa),ou=0;su.length>ou;)(ru=su[ou++])in Ya||L(Ya,ru,Fa[ru]);iu.constructor=Ya}ao&&Qo(qa)!==Ga&&ao(qa,Ga);var au=new ja(new Ya(2)),uu=qa.setInt8;au.setInt8(0,2147483648),au.setInt8(1,2147483649),!au.getInt8(0)&&au.getInt8(1)||wr(qa,{setInt8:function(e,t){uu.call(this,e,t<<24>>24)},setUint8:function(e,t){uu.call(this,e,t<<24>>24)}},{unsafe:!0})}else Ya=function(e){xr(this,Ya,Da);var t=Ca(e);Pa(this,{bytes:Ma.call(new Array(t),0),byteLength:t}),u||(this.byteLength=t)},ja=function(e,t,n){xr(this,ja,Va),xr(e,Ya,Va);var r=Ua(e).byteLength,i=fe(t);if(i<0||i>r)throw Ha("Wrong offset");if(i+(n=void 0===n?r-i:de(n))>r)throw Ha("Wrong length");Pa(this,{buffer:e,byteLength:n,byteOffset:i}),u||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},u&&(eu(Ya,"byteLength"),eu(ja,"buffer"),eu(ja,"byteLength"),eu(ja,"byteOffset")),wr(ja.prototype,{getInt8:function(e){return tu(this,1,e)[0]<<24>>24},getUint8:function(e){return tu(this,1,e)[0]},getInt16:function(e){var t=tu(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=tu(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return Za(tu(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return Za(tu(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return Wa(tu(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return Wa(tu(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){nu(this,1,e,Qa,t)},setUint8:function(e,t){nu(this,1,e,Qa,t)},setInt16:function(e,t){nu(this,2,e,za,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){nu(this,2,e,za,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){nu(this,4,e,Ja,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){nu(this,4,e,Ja,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){nu(this,4,e,$a,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){nu(this,8,e,Xa,t,arguments.length>2?arguments[2]:void 0)}});kr(Ya,Da),kr(ja,Va);var cu={ArrayBuffer:Ya,DataView:ja},lu=cu.ArrayBuffer,hu=cu.DataView,fu=lu.prototype.slice,gu=a((function(){return!new lu(2).slice(1,void 0).byteLength}));Pe({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:gu},{slice:function(e,t){if(void 0!==fu&&void 0===t)return fu.call(A(this),e);for(var n=A(this).byteLength,r=ye(e,n),i=ye(void 0===t?n:t,n),s=new($r(this,lu))(de(i-r)),o=new hu(this),a=new hu(s),u=0;r<i;)a.setUint8(u++,o.getUint8(r++));return s}});var du,pu=x.f,vu=o.Int8Array,yu=vu&&vu.prototype,mu=o.Uint8ClampedArray,_u=mu&&mu.prototype,Eu=vu&&Qo(vu),Tu=yu&&Qo(yu),Ru=Object.prototype,Iu=Ru.isPrototypeOf,Cu=ot("toStringTag"),Su=Q("TYPED_ARRAY_TAG"),bu=Ia&&!!ao&&"Opera"!==hr(o.opera),wu=!1,Ou={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Nu={BigInt64Array:8,BigUint64Array:8},ku=function(e){if(!E(e))return!1;var t=hr(e);return C(Ou,t)||C(Nu,t)};for(du in Ou)o[du]||(bu=!1);if((!bu||"function"!=typeof Eu||Eu===Function.prototype)&&(Eu=function(){throw TypeError("Incorrect invocation")},bu))for(du in Ou)o[du]&&ao(o[du],Eu);if((!bu||!Tu||Tu===Ru)&&(Tu=Eu.prototype,bu))for(du in Ou)o[du]&&ao(o[du].prototype,Tu);if(bu&&Qo(_u)!==Tu&&ao(_u,Tu),u&&!C(Tu,Cu))for(du in wu=!0,pu(Tu,Cu,{get:function(){return E(this)?this[Su]:void 0}}),Ou)o[du]&&L(o[du],Su,du);var Au={NATIVE_ARRAY_BUFFER_VIEWS:bu,TYPED_ARRAY_TAG:wu&&Su,aTypedArray:function(e){if(ku(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(ao){if(Iu.call(Eu,e))return e}else for(var t in Ou)if(C(Ou,du)){var n=o[t];if(n&&(e===n||Iu.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(u){if(n)for(var r in Ou){var i=o[r];i&&C(i.prototype,e)&&delete i.prototype[e]}Tu[e]&&!n||oe(Tu,e,n?t:bu&&yu[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(u){if(ao){if(n)for(r in Ou)(i=o[r])&&C(i,e)&&delete i[e];if(Eu[e]&&!n)return;try{return oe(Eu,e,n?t:bu&&vu[e]||t)}catch(e){}}for(r in Ou)!(i=o[r])||i[e]&&!n||oe(i,e,t)}},isView:function(e){if(!E(e))return!1;var t=hr(e);return"DataView"===t||C(Ou,t)||C(Nu,t)},isTypedArray:ku,TypedArray:Eu,TypedArrayPrototype:Tu},Mu=Au.NATIVE_ARRAY_BUFFER_VIEWS,xu=o.ArrayBuffer,Lu=o.Int8Array,Uu=!Mu||!a((function(){Lu(1)}))||!a((function(){new Lu(-1)}))||!Jr((function(e){new Lu,new Lu(null),new Lu(1.5),new Lu(e)}),!0)||a((function(){return 1!==new Lu(new xu(2),1,void 0).length})),Pu=function(e,t){var n=function(e){var t=fe(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}(e);if(n%t)throw RangeError("Wrong offset");return n},Du=Au.aTypedArrayConstructor,Vu=function(e){var t,n,r,i,s,o,a=R(e),u=arguments.length,c=u>1?arguments[1]:void 0,l=void 0!==c,h=Br(a);if(null!=h&&!Dr(h))for(o=(s=h.call(a)).next,a=[];!(i=o.call(s)).done;)a.push(i.value);for(l&&u>2&&(c=wn(c,arguments[2],2)),n=de(a.length),r=new(Du(this))(n),t=0;n>t;t++)r[t]=l?c(a[t],t):a[t];return r},Bu=i((function(e){var t=Ce.f,n=kn.forEach,r=se.get,i=se.set,s=x.f,a=k.f,c=Math.round,l=o.RangeError,h=cu.ArrayBuffer,g=cu.DataView,d=Au.NATIVE_ARRAY_BUFFER_VIEWS,p=Au.TYPED_ARRAY_TAG,v=Au.TypedArray,y=Au.TypedArrayPrototype,m=Au.aTypedArrayConstructor,_=Au.isTypedArray,R="BYTES_PER_ELEMENT",I="Wrong length",S=function(e,t){for(var n=0,r=t.length,i=new(m(e))(r);r>n;)i[n]=t[n++];return i},b=function(e,t){s(e,t,{get:function(){return r(this)[t]}})},w=function(e){var t;return e instanceof h||"ArrayBuffer"==(t=hr(e))||"SharedArrayBuffer"==t},O=function(e,t){return _(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},N=function(e,t){return O(e,t=T(t,!0))?f(2,e[t]):a(e,t)},A=function(e,t,n){return!(O(e,t=T(t,!0))&&E(n)&&C(n,"value"))||C(n,"get")||C(n,"set")||n.configurable||C(n,"writable")&&!n.writable||C(n,"enumerable")&&!n.enumerable?s(e,t,n):(e[t]=n.value,e)};u?(d||(k.f=N,x.f=A,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),Pe({target:"Object",stat:!0,forced:!d},{getOwnPropertyDescriptor:N,defineProperty:A}),e.exports=function(e,a,u){var f=e.match(/\d+$/)[0]/8,m=e+(u?"Clamped":"")+"Array",T="get"+e,C="set"+e,b=o[m],O=b,N=O&&O.prototype,k={},A=function(e,t){s(e,t,{get:function(){return function(e,t){var n=r(e);return n.view[T](t*f+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var i=r(e);u&&(n=(n=c(n))<0?0:n>255?255:255&n),i.view[C](t*f+i.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};d?Uu&&(O=a((function(e,t,n,r){return xr(e,O,m),uo(E(t)?w(t)?void 0!==r?new b(t,Pu(n,f),r):void 0!==n?new b(t,Pu(n,f)):new b(t):_(t)?S(O,t):Vu.call(O,t):new b(Ca(t)),e,O)})),ao&&ao(O,v),n(t(b),(function(e){e in O||L(O,e,b[e])})),O.prototype=N):(O=a((function(e,t,n,r){xr(e,O,m);var s,o,a,u=0,c=0;if(E(t)){if(!w(t))return _(t)?S(O,t):Vu.call(O,t);s=t,c=Pu(n,f);var d=t.byteLength;if(void 0===r){if(d%f)throw l(I);if((o=d-c)<0)throw l(I)}else if((o=de(r)*f)+c>d)throw l(I);a=o/f}else a=Ca(t),s=new h(o=a*f);for(i(e,{buffer:s,byteOffset:c,byteLength:o,length:a,view:new g(s)});u<a;)A(e,u++)})),ao&&ao(O,v),N=O.prototype=nr(y)),N.constructor!==O&&L(N,"constructor",O),p&&L(N,p,m),k[m]=O,Pe({global:!0,forced:O!=b,sham:!d},k),R in O||L(O,R,f),R in N||L(N,R,f),Mr(m)}):e.exports=function(){}}));Bu("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var Fu=Math.min,Yu=[].copyWithin||function(e,t){var n=R(this),r=de(n.length),i=ye(e,r),s=ye(t,r),o=arguments.length>2?arguments[2]:void 0,a=Fu((void 0===o?r:ye(o,r))-s,r-i),u=1;for(s<i&&i<s+a&&(u=-1,s+=a-1,i+=a-1);a-- >0;)s in n?n[i]=n[s]:delete n[i],i+=u,s+=u;return n},ju=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("copyWithin",(function(e,t){return Yu.call(ju(this),e,t,arguments.length>2?arguments[2]:void 0)}));var qu=kn.every,Gu=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("every",(function(e){return qu(Gu(this),e,arguments.length>1?arguments[1]:void 0)}));var Hu=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("fill",(function(e){return Ma.apply(Hu(this),arguments)}));var Ku=Au.aTypedArrayConstructor,Wu=function(e,t){for(var n=$r(e,e.constructor),r=0,i=t.length,s=new(Ku(n))(i);i>r;)s[r]=t[r++];return s},Qu=kn.filter,zu=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("filter",(function(e){var t=Qu(zu(this),e,arguments.length>1?arguments[1]:void 0);return Wu(this,t)}));var Ju=kn.find,Zu=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("find",(function(e){return Ju(Zu(this),e,arguments.length>1?arguments[1]:void 0)}));var $u=kn.findIndex,Xu=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("findIndex",(function(e){return $u(Xu(this),e,arguments.length>1?arguments[1]:void 0)}));var ec=kn.forEach,tc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("forEach",(function(e){ec(tc(this),e,arguments.length>1?arguments[1]:void 0)}));var nc=_e.includes,rc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("includes",(function(e){return nc(rc(this),e,arguments.length>1?arguments[1]:void 0)}));var ic=_e.indexOf,sc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("indexOf",(function(e){return ic(sc(this),e,arguments.length>1?arguments[1]:void 0)}));var oc=ot("iterator"),ac=o.Uint8Array,uc=pa.values,cc=pa.keys,lc=pa.entries,hc=Au.aTypedArray,fc=Au.exportTypedArrayMethod,gc=ac&&ac.prototype[oc],dc=!!gc&&("values"==gc.name||null==gc.name),pc=function(){return uc.call(hc(this))};fc("entries",(function(){return lc.call(hc(this))})),fc("keys",(function(){return cc.call(hc(this))})),fc("values",pc,!dc),fc(oc,pc,!dc);var vc=Au.aTypedArray,yc=[].join;(0,Au.exportTypedArrayMethod)("join",(function(e){return yc.apply(vc(this),arguments)}));var mc=Math.min,_c=[].lastIndexOf,Ec=!!_c&&1/[1].lastIndexOf(1,-0)<0,Tc=Dn("lastIndexOf"),Rc=Ec||!Tc?function(e){if(Ec)return _c.apply(this,arguments)||0;var t=_(this),n=de(t.length),r=n-1;for(arguments.length>1&&(r=mc(r,fe(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:_c,Ic=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("lastIndexOf",(function(e){return Rc.apply(Ic(this),arguments)}));var Cc=kn.map,Sc=Au.aTypedArray,bc=Au.aTypedArrayConstructor;(0,Au.exportTypedArrayMethod)("map",(function(e){return Cc(Sc(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(bc($r(e,e.constructor)))(t)}))}));var wc=function(e){return function(t,n,r,i){bn(n);var s=R(t),o=y(s),a=de(s.length),u=e?a-1:0,c=e?-1:1;if(r<2)for(;;){if(u in o){i=o[u],u+=c;break}if(u+=c,e?u<0:a<=u)throw TypeError("Reduce of empty array with no initial value")}for(;e?u>=0:a>u;u+=c)u in o&&(i=n(i,o[u],u,s));return i}},Oc={left:wc(!1),right:wc(!0)},Nc=Oc.left,kc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("reduce",(function(e){return Nc(kc(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var Ac=Oc.right,Mc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("reduceRight",(function(e){return Ac(Mc(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var xc=Au.aTypedArray,Lc=Au.exportTypedArrayMethod,Uc=Math.floor;Lc("reverse",(function(){for(var e,t=this,n=xc(t).length,r=Uc(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t}));var Pc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("set",(function(e){Pc(this);var t=Pu(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=R(e),i=de(r.length),s=0;if(i+t>n)throw RangeError("Wrong length");for(;s<i;)this[t+s]=r[s++]}),a((function(){new Int8Array(1).set({})})));var Dc=Au.aTypedArray,Vc=Au.aTypedArrayConstructor,Bc=[].slice;(0,Au.exportTypedArrayMethod)("slice",(function(e,t){for(var n=Bc.call(Dc(this),e,t),r=$r(this,this.constructor),i=0,s=n.length,o=new(Vc(r))(s);s>i;)o[i]=n[i++];return o}),a((function(){new Int8Array(1).slice()})));var Fc=kn.some,Yc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("some",(function(e){return Fc(Yc(this),e,arguments.length>1?arguments[1]:void 0)}));var jc=Au.aTypedArray,qc=[].sort;(0,Au.exportTypedArrayMethod)("sort",(function(e){return qc.call(jc(this),e)}));var Gc=Au.aTypedArray;(0,Au.exportTypedArrayMethod)("subarray",(function(e,t){var n=Gc(this),r=n.length,i=ye(e,r);return new($r(n,n.constructor))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,de((void 0===t?r:ye(t,r))-i))}));var Hc=o.Int8Array,Kc=Au.aTypedArray,Wc=Au.exportTypedArrayMethod,Qc=[].toLocaleString,zc=[].slice,Jc=!!Hc&&a((function(){Qc.call(new Hc(1))}));Wc("toLocaleString",(function(){return Qc.apply(Jc?zc.call(Kc(this)):Kc(this),arguments)}),a((function(){return[1,2].toLocaleString()!=new Hc([1,2]).toLocaleString()}))||!a((function(){Hc.prototype.toLocaleString.call([1,2])})));var Zc=Au.exportTypedArrayMethod,$c=o.Uint8Array,Xc=$c&&$c.prototype||{},el=[].toString,tl=[].join;a((function(){el.call({})}))&&(el=function(){return tl.call(this)});var nl=Xc.toString!=el;Zc("toString",el,nl);var rl,il,sl,ol,al="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",ul=RegExp("^"+al+al+"*"),cl=RegExp(al+al+"*$"),ll=function(e){return function(t){var n=String(m(t));return 1&e&&(n=n.replace(ul,"")),2&e&&(n=n.replace(cl,"")),n}},hl={start:ll(1),end:ll(2),trim:ll(3)},fl=Ce.f,gl=k.f,dl=x.f,pl=hl.trim,vl="Number",yl=o.Number,ml=yl.prototype,_l=p(nr(ml))==vl,El=function(e){var t,n,r,i,s,o,a,u,c=T(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=pl(c)).charCodeAt(0))||45===t){if(88===(n=c.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=(s=c.slice(2)).length,a=0;a<o;a++)if((u=s.charCodeAt(a))<48||u>i)return NaN;return parseInt(s,r)}return+c};if(Le(vl,!yl(" 0o1")||!yl("0b1")||yl("+0x1"))){for(var Tl,Rl=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof Rl&&(_l?a((function(){ml.valueOf.call(n)})):p(n)!=vl)?uo(new yl(El(t)),n,Rl):El(t)},Il=u?fl(yl):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),Cl=0;Il.length>Cl;Cl++)C(yl,Tl=Il[Cl])&&!C(Rl,Tl)&&dl(Rl,Tl,gl(yl,Tl));Rl.prototype=ml,ml.constructor=Rl,oe(o,vl,Rl)}!function(e){e[e.AT_MOST_ONCE=0]="AT_MOST_ONCE",e[e.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",e[e.EXACTLY_ONCE=2]="EXACTLY_ONCE",e[e.DEFAULT=3]="DEFAULT"}(rl||(rl={})),function(e){e[e.SYMMETRIC=0]="SYMMETRIC",e[e.CONNECT=1]="CONNECT",e[e.CONN_ACK=2]="CONN_ACK",e[e.PUBLISH=3]="PUBLISH",e[e.PUB_ACK=4]="PUB_ACK",e[e.QUERY=5]="QUERY",e[e.QUERY_ACK=6]="QUERY_ACK",e[e.QUERY_CONFIRM=7]="QUERY_CONFIRM",e[e.SUBSCRIBE=8]="SUBSCRIBE",e[e.SUB_ACK=9]="SUB_ACK",e[e.UNSUBSCRIBE=10]="UNSUBSCRIBE",e[e.UNSUB_ACK=11]="UNSUB_ACK",e[e.PING_REQ=12]="PING_REQ",e[e.PING_RESP=13]="PING_RESP",e[e.DISCONNECT=14]="DISCONNECT",e[e.RESERVER2=15]="RESERVER2"}(il||(il={})),function(e){e.CONN_ACK="ConnAckMessage",e.DISCONNECT="DisconnectMessage",e.PING_REQ="PingReqMessage",e.PING_RESP="PingRespMessage",e.PUBLISH="PublishMessage",e.PUB_ACK="PubAckMessage",e.QUERY="QueryMessage",e.QUERY_CON="QueryConMessage",e.QUERY_ACK="QueryAckMessage"}(sl||(sl={})),function(e){e.PUB="pub",e.QUERY="qry"}(ol||(ol={}));var Sl,bl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rl.AT_LEAST_ONCE,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Rt(this,e),this._retain=!1,this.qos=rl.AT_LEAST_ONCE,this._dup=!1,this.syncMsg=!1;var s=t>0;t&&s&&1===arguments.length?(this._retain=(1&t)>0,this.qos=(6&t)>>1,this._dup=(8&t)>0,this.type=t>>4&15,this.syncMsg=8==(8&t)):(this.type=t,this._retain=n,this.qos=r,this._dup=i)}return Ct(e,[{key:"encode",value:function(){var e=this.type<<4;return e|=this._retain?1:0,e|=this.qos<<1,e|=this._dup?8:0}}]),e}(),wl=function(){function e(){Rt(this,e)}return Ct(e,null,[{key:"writeUTF",value:function(e,t){var n=[],r=0;if(ks(e))for(var i=0,s=e.length;i<s;i++){var o=e.charCodeAt(i);o>=0&&o<=127?(r+=1,n.push(o)):o>=128&&o<=2047?(r+=2,n.push(192|31&o>>6),n.push(128|63&o)):o>=2048&&o<=65535&&(r+=3,n.push(224|15&o>>12),n.push(128|63&o>>6),n.push(128|63&o))}for(var a=0,u=n.length;a<u;a++)n[a]>255&&(n[a]&=255);return t?n:r<=255?[0,r].concat(n):[r>>8,255&r].concat(n)}},{key:"readUTF",value:function(e){for(var t,n,r=[],i=-1,s=e,o="";++i<s.length;){var a=Number(s[i]);if(a===(127&a)||(240==(240&a)?a=(a=(a=(a^=240)<<6|128^s[++i])<<6|128^s[++i])<<6|128^s[++i]:224==(224&a)?a=(a=(a^=224)<<6|128^s[++i])<<6|128^s[++i]:192==(192&a)&&(a=(a^=192)<<6|128^s[++i])),!isFinite(a)||a<0||a>1114111||Math.floor(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(t=(a-=65536)>>10|55296,n=a%1024|56320,r.push(t,n)),(i+1===s.length||r.length>16384)&&(o+=String.fromCharCode.apply(null,r),r.length=0)}return o}}]),e}(),Ol=function(){function e(t){Rt(this,e),this._position=0,this._poolLen=0,this._pool=t,this._poolLen=t.length}return Ct(e,[{key:"check",value:function(){return this._position>=this._pool.length}},{key:"readInt",value:function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<4;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r.toString()}return parseInt(t,16)}},{key:"readLong",value:function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<8;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r}return parseInt(t,16)}},{key:"readByte",value:function(){if(this.check())return-1;var e=this._pool[this._position++];return e>255&&(e&=255),e}},{key:"readUTF",value:function(){if(this.check())return"";var e=this.readByte()<<8|this.readByte(),t=this._pool.subarray(this._position,this._position+=e);return wl.readUTF(t)}},{key:"readAll",value:function(){return this._pool.subarray(this._position,this._poolLen)}}]),e}(),Nl=function(){function e(){Rt(this,e),this._pool=[],this._position=0,this._writen=0}return Ct(e,[{key:"write",value:function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")?this._pool=this._pool.concat(e):e>=0&&(e>255&&(e&=255),this._pool.push(e),this._writen++),e}},{key:"writeArr",value:function(e){return this._pool=this._pool.concat(e),e}},{key:"writeUTF",value:function(e){var t=wl.writeUTF(e);this._pool=this._pool.concat(t),this._writen+=t.length}},{key:"getBytesArray",value:function(){return this._pool}}]),e}(),kl="UpStreamMessage",Al="PushExtra",Ml="DownStreamMessage",xl="DownStreamMessages",Ll="SessionsAttQryInput",Ul="SessionsAttOutput",Pl="SyncRequestMsg",Dl="ChrmPullMsg",Vl="NotifyMsg",Bl="HistoryMsgInput",Fl="HistoryMsgOuput",Yl="RelationQryInput",jl="RelationsOutput",ql="DeleteSessionsInput",Gl="SessionInfo",Hl="DeleteSessionsOutput",Kl="RelationsInput",Wl="DeleteMsgInput",Ql="CleanHisMsgInput",zl="SessionMsgReadInput",Jl="ChrmInput",Zl="QueryChatRoomInfoInput",$l="QueryChatRoomInfoOutput",Xl="RtcInput",eh="RtcUserListOutput",th="SetUserStatusInput",nh="RtcSetDataInput",rh="RtcUserSetDataInput",ih="RtcDataInput",sh="RtcSetOutDataInput",oh="MCFollowInput",ah="RtcTokenOutput",uh="RtcQryOutput",ch="RtcQryUserOutDataInput",lh="RtcUserOutDataOutput",hh="RtcQueryListInput",fh="RtcRoomInfoOutput",gh="RtcValueInfo",dh="RtcKeyDeleteInput",ph="GetQNupTokenInput",vh="GetQNupTokenOutput",yh="GetQNdownloadUrlInput",mh="GetDownloadUrlInput",_h="GetQNdownloadUrlOutput",Eh="GetDownloadUrlOutput",Th="SetChrmKV",Rh="ChrmKVOutput",Ih="QueryChrmKV",Ch="SetUserSettingInput",Sh="SetUserSettingOutput",bh="PullUserSettingInput",wh="PullUserSettingOutput",Oh="UserSettingNotification",Nh="SessionReq",kh="SessionStates",Ah="SessionState",Mh="SessionStateItem",xh="SessionStateModifyReq",Lh="SessionStateModifyResp",Uh="GrpReadReceiptMsg",Ph="GrpReadReceiptQryReq",Dh="GrpReadReceiptQryResp",Vh="GrpMsgReadUser",Bh="SessionTagAddInput",Fh="SessionTagItem",Yh="SessionTagDelInput",jh="SessionDisTagReq",qh="ReportSDKInput",Gh="ReportSDKOutput",Hh=(St(Sl={},kl,["sessionId","classname","content","pushText","userId","configFlag","appData","extraContent","pushExt"]),St(Sl,xl,["list","syncTime","finished"]),St(Sl,Ml,["fromUserId","type","groupId","classname","content","dataTime","status","msgId","extraContent","pushContent","configFlag","pushExt"]),St(Sl,Al,["title","templateIdNoUse","pushId","pushConfigs","templateId"]),St(Sl,Ll,["nothing"]),St(Sl,Ul,["inboxTime","sendboxTime","totalUnreadCount"]),St(Sl,Pl,["syncTime","ispolling","isweb","isPullSend","isKeeping","sendBoxSyncTime"]),St(Sl,Dl,["syncTime","count"]),St(Sl,Vl,["type","time","chrmId"]),St(Sl,Bl,["targetId","time","count","order"]),St(Sl,Fl,["list","syncTime","hasMsg"]),St(Sl,Yl,["type","count","startTime","order"]),St(Sl,jl,["info"]),St(Sl,ql,["sessions"]),St(Sl,Gl,["type","channelId"]),St(Sl,Hl,["nothing"]),St(Sl,Kl,["type","msg","count","offset","startTime","endTime"]),St(Sl,Wl,["type","conversationId","msgs"]),St(Sl,Ql,["targetId","dataTime","conversationType"]),St(Sl,zl,["type","msgTime","channelId"]),St(Sl,Jl,["nothing"]),St(Sl,Zl,["count","order"]),St(Sl,$l,["userTotalNums","userInfos"]),St(Sl,ph,["type","key","httpMethod","queryString"]),St(Sl,yh,["type","key","fileName"]),St(Sl,mh,["type","key","fileName"]),St(Sl,vh,["deadline","token","bosToken","bosDate","path","osskeyId","ossPolicy","ossSign","ossBucketName"]),St(Sl,_h,["downloadUrl"]),St(Sl,Eh,["downloadUrl"]),St(Sl,Th,["entry","bNotify","notification","type"]),St(Sl,Rh,["entries","bFullUpdate","syncTime"]),St(Sl,Ih,["timestamp"]),St(Sl,Ch,["version","value"]),St(Sl,Sh,["version","reserve"]),St(Sl,bh,["version","reserve"]),St(Sl,wh,["items","version"]),St(Sl,"UserSettingItem",["targetId","type","key","value","version","status","tags"]),St(Sl,Nh,["time"]),St(Sl,kh,["version","state"]),St(Sl,Ah,["type","channelId","time","stateItem"]),St(Sl,Mh,["sessionStateType","value","tags"]),St(Sl,xh,["version","state"]),St(Sl,Lh,["version"]),St(Sl,Uh,["msgId","busChannel"]),St(Sl,Ph,["msgId","busChannel"]),St(Sl,Dh,["totalMemberNum","list"]),St(Sl,Vh,["readTime","userId"]),St(Sl,Bh,["version","tags"]),St(Sl,Fh,["tagId","name","createdTime","isTop"]),St(Sl,Yh,["version","tags"]),St(Sl,jh,["tagId"]),St(Sl,Oh,["version","reserve"]),St(Sl,qh,["sdkInfo"]),St(Sl,Gh,["nothing"]),Sl),Kh={},Wh=function(e){var t=Hh[e];Kh[e]=function(){for(var e={},n={getArrayData:function(){return e}},r=function(r){var i=t[r],s="set".concat(Yn(i,0,1));n[s]=function(t){e[i]=t}},i=0;i<t.length;i++)r(i);return n},Kh[e].decode=function(e){var t={};ks(e)&&(e=JSON.parse(e));var n=function(n){var r="get".concat(Yn(n,0,1));t[n]=e[n],t[r]=function(){return e[n]}};for(var r in e)n(r);return t}};for(var Qh in Hh)Wh(Qh);Kh.getModule=function(e){return Kh[e]()},Bu("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var zh="\npackage Modules;\nmessage probuf {\n  message ".concat(th,"\n  {\n    optional int32 status=1;\n  }\n\n  message SetUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusInput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusOutput\n  {\n    optional string status=1;\n    optional string subUserId=2;\n  }\n\n  message SubUserStatusInput\n  {\n    repeated string userid =1;\n  }\n\n  message SubUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n  message VoipDynamicInput\n  {\n    required int32  engineType = 1;\n    required string channelName = 2;\n    optional string channelExtra = 3;\n  }\n\n  message VoipDynamicOutput\n  {\n      required string dynamicKey=1;\n  }\n  message ").concat(Vl," {\n    required int32 type = 1;\n    optional int64 time = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(Pl," {\n    required int64 syncTime = 1;\n    required bool ispolling = 2;\n    optional bool isweb=3;\n    optional bool isPullSend=4;\n    optional bool isKeeping=5;\n    optional int64 sendBoxSyncTime=6;\n  }\n  message ").concat(kl," {\n    required int32 sessionId = 1;\n    required string classname = 2;\n    required bytes content = 3;\n    optional string pushText = 4;\n    optional string appData = 5;\n    repeated string userId = 6;\n    optional int64 delMsgTime = 7;\n    optional string delMsgId = 8;\n    optional int32 configFlag = 9;\n    optional int64 clientUniqueId = 10;\n    optional string extraContent = 11;\n    optional PushExtra pushExt = 12;\n  }\n  message ").concat(Al," {\n    optional string title = 1;\n    optional int32  templateIdNoUse= 2;\n    optional string pushId = 3;\n    optional string pushConfigs = 4;\n    optional string templateId = 5;\n  }\n  message ").concat(xl," {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    optional bool finished = 3;\n  }\n  message ").concat(Ml," {\n    required string fromUserId = 1;\n    required ChannelType type = 2;\n    optional string groupId = 3;\n    required string classname = 4;\n    required bytes content = 5;\n    required int64 dataTime = 6;\n    required int64 status = 7;\n    optional int64 extra = 8;\n    optional string msgId = 9;\n    optional int32 direction = 10;\n    optional int32 plantform =11;\n    optional int32 isRemoved = 12;\n    optional string source = 13;\n    optional int64 clientUniqueId = 14;\n    optional string extraContent = 15;\n    optional string pushContent = 16;\n    optional int32 configFlag = 17;\n    optional PushExtra pushExt = 18;\n  }\n  enum ChannelType {\n    PERSON = 1;\n    PERSONS = 2;\n    GROUP = 3;\n    TEMPGROUP = 4;\n    CUSTOMERSERVICE = 5;\n    NOTIFY = 6;\n    MC=7;\n    MP=8;\n  }\n  message CreateDiscussionInput {\n    optional string name = 1;\n  }\n  message CreateDiscussionOutput {\n    required string id = 1;\n  }\n  message ChannelInvitationInput {\n    repeated string users = 1;\n  }\n  message LeaveChannelInput {\n    required int32 nothing = 1;\n  }\n  message ChannelEvictionInput {\n    required string user = 1;\n  }\n  message RenameChannelInput {\n    required string name = 1;\n  }\n  message ChannelInfoInput {\n    required int32 nothing = 1;\n  }\n  message ChannelInfoOutput {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    required string channelName = 3;\n    required string adminUserId = 4;\n    repeated string firstTenUserIds = 5;\n    required int32 openStatus = 6;\n  }\n  message ChannelInfosInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message ChannelInfosOutput {\n    repeated ChannelInfoOutput channels = 1;\n    required int32 total = 2;\n  }\n  message MemberInfo {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n    required string extension = 4;\n  }\n  message GroupMembersInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message GroupMembersOutput {\n    repeated MemberInfo members = 1;\n    required int32 total = 2;\n  }\n  message GetUserInfoInput {\n    required int32 nothing = 1;\n  }\n  message GetUserInfoOutput {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n  }\n  message GetSessionIdInput {\n    required int32 nothing = 1;\n  }\n  message GetSessionIdOutput {\n    required int32 sessionId = 1;\n  }\n  enum FileType {\n    image = ").concat(Ns.IMAGE,";\n    audio = ").concat(Ns.AUDIO,";\n    video = ").concat(Ns.VIDEO,";\n    file = ").concat(Ns.FILE,";\n  }\n  message ").concat(ph," {\n    required FileType type = 1;\n    optional string key = 2;\n    optional string httpMethod = 3;\n    optional string queryString = 4;\n  }\n  message ").concat(yh," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string  fileName = 3;\n  }\n  message ").concat(mh," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string fileName = 3;\n   }\n  message ").concat(vh," {\n    required int64 deadline = 1;\n    required string token = 2;\n    optional string bosToken = 3;\n    optional string bosDate = 4;\n    optional string path = 5;\n    optional string osskeyId = 6;\n    optional string ossPolicy = 7;\n    optional string ossSign = 8;\n    optional string ossBucketName = 9;\n    optional string s3Credential = 10;\n    optional string s3Algorithm = 11;\n    optional string s3Date = 12;\n    optional string s3Policy = 13;\n    optional string s3Signature = 14;\n    optional string s3BucketName = 15;\n    optional string stcAuthorization = 16;\n    optional string stcContentSha256 = 17;\n    optional string stcDate = 18;\n    optional string stcBucketName = 19;\n  }\n  message ").concat(_h," {\n    required string downloadUrl = 1;\n  }\n  message ").concat(Eh," {\n    required string downloadUrl = 1;\n  }\n  message Add2BlackListInput {\n    required string userId = 1;\n  }\n  message RemoveFromBlackListInput {\n    required string userId = 1;\n  }\n  message QueryBlackListInput {\n    required int32 nothing = 1;\n  }\n  message QueryBlackListOutput {\n    repeated string userIds = 1;\n  }\n  message BlackListStatusInput {\n    required string userId = 1;\n  }\n  message BlockPushInput {\n    required string blockeeId = 1;\n  }\n  message ModifyPermissionInput {\n    required int32 openStatus = 1;\n  }\n  message GroupInput {\n    repeated GroupInfo groupInfo = 1;\n  }\n  message GroupOutput {\n    required int32 nothing = 1;\n  }\n  message GroupInfo {\n    required string id = 1;\n    required string name = 2;\n  }\n  message GroupHashInput {\n    required string userId = 1;\n    required string groupHashCode = 2;\n  }\n  message GroupHashOutput {\n    required GroupHashType result = 1;\n  }\n  enum GroupHashType {\n    group_success = 0x00;\n    group_failure = 0x01;\n  }\n  message ").concat(Jl," {\n    required int32 nothing = 1;\n  }\n  message ChrmOutput {\n    required int32 nothing = 1;\n  }\n  message ").concat(Dl," {\n    required int64 syncTime = 1;\n    required int32 count = 2;\n  }\n\n  message ChrmPullMsgNew\n  {\n    required int32 count = 1;\n    required int64 syncTime = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(Yl,"\n  {\n    optional ChannelType type = 1;\n    optional int32 count = 2;\n    optional int64 startTime = 3;\n    optional int32 order = 4;\n  }\n  message ").concat(Kl,"\n  {\n    required ChannelType type = 1;\n    optional DownStreamMessage msg =2;\n    optional int32 count = 3;\n    optional int32 offset = 4;\n    optional int64 startTime = 5;\n    optional int64 endTime = 6;\n  }\n  message ").concat(jl,"\n  {\n    repeated RelationInfo info = 1;\n  }\n  message RelationInfo\n  {\n    required ChannelType type = 1;\n    required string userId = 2;\n    optional DownStreamMessage msg =3;\n    optional int64 readMsgTime= 4;\n    optional int64 unreadCount= 5;\n    optional string channelId = 6;\n  }\n  message RelationInfoReadTime\n  {\n    required ChannelType type = 1;\n    required int64 readMsgTime= 2;\n    required string targetId = 3;\n  }\n  message ").concat(Ql,"\n  {\n      required string targetId = 1;\n      required int64 dataTime = 2;\n      optional int32 conversationType= 3;\n  }\n  message HistoryMessageInput\n  {\n    required string targetId = 1;\n    required int64 dataTime =2;\n    required int32 size  = 3;\n  }\n\n  message HistoryMessagesOuput\n  {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    required int32 hasMsg = 3;\n  }\n  message ").concat(Zl,"\n  {\n    required int32 count= 1;\n    optional int32 order= 2;\n  }\n\n  message ").concat($l,"\n  {\n    optional int32 userTotalNums = 1;\n    repeated ChrmMember userInfos = 2;\n  }\n  message ChrmMember\n  {\n    required int64 time = 1;\n    required string id = 2;\n  }\n  message MPFollowInput\n  {\n    required string id = 1;\n  }\n\n  message MPFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message ").concat(oh,"\n  {\n    required string id = 1;\n  }\n\n  message MCFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message MpInfo\n  {\n    required string mpid=1;\n    required string name = 2;\n    required string type = 3;\n    required int64 time=4;\n    optional string portraitUrl=5;\n    optional string extra =6;\n  }\n\n  message SearchMpInput\n  {\n    required int32 type=1;\n    required string id=2;\n  }\n\n  message SearchMpOutput\n  {\n    required int32 nothing=1;\n    repeated MpInfo info = 2;\n  }\n\n  message PullMpInput\n  {\n    required int64 time=1;\n    required string mpid=2;\n  }\n\n  message PullMpOutput\n  {\n    required int32 status=1;\n    repeated MpInfo info = 2;\n  }\n  message ").concat(Bl,"\n  {\n    optional string targetId = 1;\n    optional int64 time = 2;\n    optional int32 count  = 3;\n    optional int32 order = 4;\n  }\n\n  message ").concat(Fl,"\n  {\n    repeated DownStreamMessage list=1;\n    required int64 syncTime=2;\n    required int32 hasMsg=3;\n  }\n  message ").concat(hh,"{\n    optional int32 order=1;\n  }\n\n  message ").concat(dh,"{\n    repeated string key=1;\n  }\n\n  message ").concat(gh,"{\n    required string key=1;\n    required string value=2;\n  }\n\n  message RtcUserInfo{\n    required string userId=1;\n    repeated ").concat(gh," userData=2;\n  }\n\n  message ").concat(eh,"{\n    repeated RtcUserInfo list=1;\n    optional string token=2;\n    optional string sessionId=3;\n  }\n  message RtcRoomInfoOutput{\n    optional string roomId = 1;\n    repeated ").concat(gh," roomData = 2;\n    optional int32 userCount = 3;\n    repeated RtcUserInfo list=4;\n  }\n  message ").concat(Xl,"{\n    required int32 roomType=1;\n    optional int32 broadcastType=2;\n  }\n  message RtcQryInput{\n    required bool isInterior=1;\n    required targetType target=2;\n    repeated string key=3;\n  }\n  message ").concat(uh,"{\n    repeated ").concat(gh," outInfo=1;\n  }\n  message RtcDelDataInput{\n    repeated string key=1;\n    required bool isInterior=2;\n    required targetType target=3;\n  }\n  message ").concat(ih,"{\n    required bool interior=1;\n    required targetType target=2;\n    repeated string key=3;\n    optional string objectName=4;\n    optional string content=5;\n  }\n  message ").concat(nh,"{\n    required bool interior=1;\n    required targetType target=2;\n    required string key=3;\n    required string value=4;\n    optional string objectName=5;\n    optional string content=6;\n  }\n  message ").concat(rh," {\n    repeated ").concat(gh," valueInfo = 1;\n    required string objectName = 2;\n    repeated ").concat(gh," content = 3;\n  }\n  message RtcOutput\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(ah,"{\n    required string rtcToken=1;\n  }\n  enum targetType {\n    ROOM =1 ;\n    PERSON = 2;\n  }\n  message ").concat(sh,"{\n    required targetType target=1;\n    repeated ").concat(gh," valueInfo=2;\n    optional string objectName=3;\n    optional string content=4;\n  }\n  message ").concat(ch,"{\n    repeated string userId = 1;\n  }\n  message ").concat(lh,"{\n    repeated RtcUserInfo user = 1;\n  }\n  message ").concat(Ll,"{\n    required int32 nothing = 1;\n  }\n  message ").concat(Ul,"{\n    required int64 inboxTime = 1;\n    required int64 sendboxTime = 2;\n    required int64 totalUnreadCount = 3;\n  }\n  message ").concat(zl,"\n  {\n    required ChannelType type = 1;\n    required int64 msgTime = 2;\n    required string channelId = 3;\n  }\n  message SessionMsgReadOutput\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(ql,"\n  {\n    repeated SessionInfo sessions = 1;\n  }\n  message ").concat(Gl,"\n  {\n    required ChannelType type = 1;\n    required string channelId = 2;\n  }\n  message ").concat(Hl,"\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(Wl,"\n  {\n    optional ChannelType type = 1;\n    optional string conversationId = 2;\n    repeated DeleteMsg msgs = 3;\n  }\n  message DeleteMsg\n  {\n    optional string msgId = 1;\n    optional int64 msgDataTime = 2;\n    optional int32 direct = 3;\n  }\n  message ChrmKVEntity {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n  }\n  message ").concat(Th," {\n    required ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(Rh," {\n    repeated ChrmKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3;\n  }\n  message ").concat(Ih," {\n    required int64 timestamp = 1;\n  }\n  message ").concat(Ch," {\n    required int64 version=1;\n    required string value=2;\n  }\n  message ").concat(Sh," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(bh," {\n    required int64 version=1;\n    optional bool reserve=2;\n  }\n  message ").concat(wh," {\n    repeated UserSettingItem items = 1;\n    required int64 version=2;\n  }\n  message UserSettingItem {\n    required string targetId= 1;\n    required ChannelType type = 2;\n    required string key = 4;\n    required bytes value = 5;\n    required int64 version=6;\n    required int32 status=7;\n    repeated SessionTagItem tags= 8;\n  }\n  message ").concat(Nh," {\n    required int64 time = 1;\n  }\n  message ").concat(kh," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(Ah," {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    optional int64 time = 3;\n    repeated SessionStateItem stateItem = 4;\n  }\n  message ").concat(Mh," {\n    required SessionStateType sessionStateType = 1;\n    required string value = 2;\n    repeated SessionTagItem tags = 3;\n  }\n  enum SessionStateType {\n    IsSilent = 1;\n    IsTop = 2;\n    Tags = 3;\n  }\n  message ").concat(xh," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(Lh," {\n    required int64 version=1;\n  }\n  message ").concat(Uh," {\n    repeated string msgId=1; //å·²è¯»æ¶æ¯ID\n    optional string busChannel = 2; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(Ph," {\n    repeated string msgId=1; //å·²è¯»æ¶æ¯ID\n    optional string busChannel = 2; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(Dh," {\n    required int32 totalMemberNum = 1;//ç¾¤åæ»äººæ°\n    repeated GrpMsgReadUser list = 2;//å·²è¯»ç¨æ·åè¡¨ï¼listå¤ç±»åï¼\n  }\n  message ").concat(Vh," {\n    required int64 readTime = 1;//å·²è¯»æ¶é´\n    required string userId = 2;//å·²è¯»ç¨æ·id\n  }\n  message ").concat(Bh," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(Fh," {\n    required string tagId=1;\n    optional string name=2;\n    optional int64 createdTime=3;\n    optional bool isTop=4;\n  }\n  message ").concat(Yh," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(jh," {\n    repeated string tagId=1;\n  }\n  message ").concat(Oh," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(qh,' {\n    required string sdkInfo=1; // ç¨æ·éæç sdk ä¿¡æ¯,json æ ¼å¼ {"web-rtc": "4.0.3.7"}\n  }\n  message ').concat(Gh,"\n  {\n    optional int32 nothing=1; //å ä½\n  }\n}\n"),Jh=/"/g;Pe({target:"String",proto:!0,forced:function(e){return a((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}("sub")},{sub:function(){return e="sub",t="",n="",r=String(m(this)),i="<"+e,""!==t&&(i+=" "+t+'="'+String(n).replace(Jh,"&quot;")+'"'),i+">"+r+"</"+e+">";var e,t,n,r,i}});var Zh="ArrayBuffer",$h=cu.ArrayBuffer,Xh=o.ArrayBuffer;Pe({global:!0,forced:Xh!==$h},{ArrayBuffer:$h}),Mr(Zh),Pe({target:"Array",proto:!0},{fill:Ma}),sr("fill");var ef,tf,nf,rf=(ef=zh,function(e,t){var n,r,i={};return i.ByteBuffer=e,i.c=e,n=e,i.Long=t||null,i.VERSION="5.0.1",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},float:{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=function(){var e={};return e.IS_NODE=!("object"!==("undefined"==typeof process?"undefined":_t(process))||process+""!="[object process]"||process.browser),e.XHR=function(){var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=null;for(e=0;e<t.length;e++){try{n=t[e]()}catch(e){continue}break}if(!n)throw Error("XMLHttpRequest is not supported");return n},e.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),e.IS_NODE)if(n)g.readFile(t,(function(e,t){n(e?null:""+t)}));else try{return g.readFileSync(t)}catch(e){return null}else{var r=e.XHR();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},e}(),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.DotProto=function(e,t){function n(e,n){var r=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=parseInt(e);else if(t.NUMBER_HEX.test(e))r=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(i<0?"-":"")+e);r=parseInt(e.substring(1),8)}if(r=0|i*r,!n&&r<0)throw Error("illegal id value: "+(i<0?"-":"")+e);return r}function r(e){var n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return n*parseInt(e,10);if(t.NUMBER_HEX.test(e))return n*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return n*parseInt(e.substring(1),8);if("inf"===e)return 1/0*n;if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return n*parseFloat(e);throw Error("illegal number value: "+(n<0?"-":"")+e)}function i(e,t,n){void 0===e[t]?e[t]=n:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(n))}var s,o,a={},u=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},c=u.prototype;return c._readString=function(){var e,n='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;if(n.lastIndex=this.index-1,!(e=n.exec(this.source)))throw Error("unterminated string");return this.index=n.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,e[1]},c.next=function(){var e,n,r,i,s;if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null;n=r,r=this.source.charAt(this.index)}while("*"!==n||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;if(i=this.index,t.DELIM.lastIndex=0,!t.DELIM.test(this.source.charAt(i++)))for(;i<this.source.length&&!t.DELIM.test(this.source.charAt(i));)++i;return('"'===(s=this.source.substring(this.index,this.index=i))||"'"===s)&&(this._stringOpen=s),s},c.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},c.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},c.omit=function(e){return this.peek()===e&&(this.next(),!0)},c.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},a.Tokenizer=u,(o=(s=function(e){this.tn=new u(e),this.proto3=!1}).prototype).parse=function(){var e,n={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},r=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!r||null!==n.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),n.package=e;break;case"import":if(!r)throw Error("unexpected 'import'");"public"===(e=this.tn.peek())&&this.tn.next(),e=this._readString(),this.tn.skip(";"),n.imports.push(e);break;case"syntax":if(!r)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(n.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(n,null),r=!1;break;case"enum":this._parseEnum(n),r=!1;break;case"option":this._parseOption(n);break;case"service":this._parseService(n);break;case"extend":this._parseExtend(n);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete n.name,n},s.parse=function(e){return new s(e).parse()},o._readString=function(){var e,t,n="";do{if("'"!==(t=this.tn.next())&&'"'!==t)throw Error("illegal string delimiter: "+t);n+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return n},o._readValue=function(e){var n=this.tn.peek();if('"'===n||"'"===n)return this._readString();if(this.tn.next(),t.NUMBER.test(n))return r(n);if(t.BOOL.test(n))return"true"===n.toLowerCase();if(e&&t.TYPEREF.test(n))return n;throw Error("illegal value: "+n)},o._parseOption=function(e,n){var r,i=this.tn.next(),s=!1;if("("===i&&(s=!0,i=this.tn.next()),!t.TYPEREF.test(i))throw Error("illegal option name: "+i);r=i,s&&(this.tn.skip(")"),r="("+r+")",i=this.tn.peek(),t.FQTYPEREF.test(i)&&(r+=i,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,r),n||this.tn.skip(";")},o._parseOptionValue=function(e,n){var r=this.tn.peek();if("{"!==r)i(e.options,n,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+n+"."+r);this.tn.omit(":")?i(e.options,n+"."+r,this._readValue(!0)):this._parseOptionValue(e,n+"."+r)}},o._parseService=function(e){var n,r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal service name at line "+this.tn.line+": "+r);for(n={name:r,rpc:{},options:{}},this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if("rpc"!==r)throw Error("illegal service token: "+r);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},o._parseServiceRPC=function(e){var n,r,i="rpc",s=this.tn.next();if(!t.NAME.test(s))throw Error("illegal rpc service method name: "+s);if(n=s,r={request:null,response:null,request_stream:!1,response_stream:!1,options:{}},this.tn.skip("("),"stream"===(s=this.tn.next()).toLowerCase()&&(r.request_stream=!0,s=this.tn.next()),!t.TYPEREF.test(s))throw Error("illegal rpc service request type: "+s);if(r.request=s,this.tn.skip(")"),"returns"!==(s=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+s);if(this.tn.skip("("),"stream"===(s=this.tn.next()).toLowerCase()&&(r.response_stream=!0,s=this.tn.next()),r.response=s,this.tn.skip(")"),"{"===(s=this.tn.peek())){for(this.tn.next();"}"!==(s=this.tn.next());){if("option"!==s)throw Error("illegal rpc service token: "+s);this._parseOption(r)}this.tn.omit(";")}else this.tn.skip(";");void 0===e[i]&&(e[i]={}),e[i][n]=r},o._parseMessage=function(e,r){var i=!!r,s=this.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(s))throw Error("illegal "+(i?"group":"message")+" name: "+s);for(o.name=s,i&&(this.tn.skip("="),r.id=n(this.tn.next()),o.isGroup=!0),"["===(s=this.tn.peek())&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(s=this.tn.next());)if(t.RULE.test(s))this._parseMessageField(o,s);else if("oneof"===s)this._parseMessageOneOf(o);else if("enum"===s)this._parseEnum(o);else if("message"===s)this._parseMessage(o);else if("option"===s)this._parseOption(o);else if("service"===s)this._parseService(o);else if("extensions"===s)o.extensions=this._parseExtensionRanges();else if("reserved"===s)this._parseIgnored();else if("extend"===s)this._parseExtend(o);else{if(!t.TYPEREF.test(s))throw Error("illegal message token: "+s);if(!this.proto3)throw Error("illegal field rule: "+s);this._parseMessageField(o,"optional",s)}return this.tn.omit(";"),e.messages.push(o),o},o._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},o._parseMessageField=function(e,r,i){var s,o,a;if(!t.RULE.test(r))throw Error("illegal message field rule: "+r);if(s={rule:r,type:"",name:"",options:{},id:0},"map"===r){if(i)throw Error("illegal type: "+i);if(this.tn.skip("<"),o=this.tn.next(),!t.TYPE.test(o)&&!t.TYPEREF.test(o))throw Error("illegal message field type: "+o);if(s.keytype=o,this.tn.skip(","),o=this.tn.next(),!t.TYPE.test(o)&&!t.TYPEREF.test(o))throw Error("illegal message field: "+o);if(s.type=o,this.tn.skip(">"),o=this.tn.next(),!t.NAME.test(o))throw Error("illegal message field name: "+o);s.name=o,this.tn.skip("="),s.id=n(this.tn.next()),"["===(o=this.tn.peek())&&this._parseFieldOptions(s),this.tn.skip(";")}else if("group"===(i=void 0!==i?i:this.tn.next())){if(a=this._parseMessage(e,s),!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);s.type=a.name,s.name=a.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field type: "+i);if(s.type=i,o=this.tn.next(),!t.NAME.test(o))throw Error("illegal message field name: "+o);s.name=o,this.tn.skip("="),s.id=n(this.tn.next()),"["===(o=this.tn.peek())&&this._parseFieldOptions(s),this.tn.skip(";")}return e.fields.push(s),s},o._parseMessageOneOf=function(e){var n,r,i,s=this.tn.next();if(!t.NAME.test(s))throw Error("illegal oneof name: "+s);for(r=s,i=[],this.tn.skip("{");"}"!==(s=this.tn.next());)(n=this._parseMessageField(e,"optional",s)).oneof=r,i.push(n.id);this.tn.omit(";"),e.oneofs[r]=i},o._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},o._parseEnum=function(e){var r,i={name:"",values:[],options:{}},s=this.tn.next();if(!t.NAME.test(s))throw Error("illegal name: "+s);for(i.name=s,this.tn.skip("{");"}"!==(s=this.tn.next());)if("option"===s)this._parseOption(i);else{if(!t.NAME.test(s))throw Error("illegal name: "+s);this.tn.skip("="),r={name:s,id:n(this.tn.next(),!0)},"["===(s=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),i.values.push(r)}this.tn.omit(";"),e.enums.push(i)},o._parseExtensionRanges=function(){var t,n,i,s=[];do{for(n=[];;){switch(t=this.tn.next()){case"min":i=e.ID_MIN;break;case"max":i=e.ID_MAX;break;default:i=r(t)}if(n.push(i),2===n.length)break;if("to"!==this.tn.peek()){n.push(i);break}this.tn.next()}s.push(n)}while(this.tn.omit(","));return this.tn.skip(";"),s},o._parseExtend=function(e){var n,r=this.tn.next();if(!t.TYPEREF.test(r))throw Error("illegal extend reference: "+r);for(n={ref:r,fields:[]},this.tn.skip("{");"}"!==(r=this.tn.next());)if(t.RULE.test(r))this._parseMessageField(n,r);else{if(!t.TYPEREF.test(r))throw Error("illegal extend token: "+r);if(!this.proto3)throw Error("illegal field rule: "+r);this._parseMessageField(n,"optional",r)}return this.tn.omit(";"),e.messages.push(n),n},o.toString=function(){return"Parser at line "+this.tn.line},a.Parser=s,a}(i,i.Lang),i.Reflect=function(t){function r(e,n){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low==e.low&&e.high==e.high)return new t.Long(e.low,e.high,void 0===n?e.unsigned:n);if("string"==typeof e)return t.Long.fromString(e,n||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,n||!1);throw Error("not convertible to Long")}function i(e,n){var r=n.readVarint32(),s=7&r,o=r>>>3;switch(s){case t.WIRE_TYPES.VARINT:do{r=n.readUint8()}while(128==(128&r));break;case t.WIRE_TYPES.BITS64:n.offset+=8;break;case t.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case t.WIRE_TYPES.STARTGROUP:i(o,n);break;case t.WIRE_TYPES.ENDGROUP:if(o===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+s)}return!0}var s,o,a,u,c,l,h,f,g,d,p,v,y,m,_,E,T={},R=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className},I=R.prototype;return I.fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},I.toString=function(e){return(e?this.className+" ":"")+this.fqn()},I.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},T.T=R,(o=(s=function(e,t,n,r,i){R.call(this,e,t,n),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=i||"proto2"}).prototype=Object.create(R.prototype)).getChildren=function(e){var t,n,r;if(null==(e=e||null))return this.children.slice();for(t=[],n=0,r=this.children.length;r>n;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},o.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof c.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof c.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},o.getChild=function(e){var t,n,r="number"==typeof e?"id":"name";for(t=0,n=this.children.length;n>t;++t)if(this.children[t][r]===e)return this.children[t];return null},o.resolve=function(e,t){var n,r="string"==typeof e?e.split("."):e,i=this,s=0;if(""===r[s]){for(;null!==i.parent;)i=i.parent;s++}do{do{if(!(i instanceof T.Namespace)){i=null;break}if(!((n=i.getChild(r[s]))&&n instanceof T.T&&(!t||n instanceof T.Namespace))){i=null;break}i=n,s++}while(s<r.length);if(null!=i)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=i);return i},o.qn=function(e){var t,n,r=[],i=e;do{r.unshift(i.name),i=i.parent}while(null!==i);for(t=1;t<=r.length;t++)if(n=r.slice(r.length-t),e===this.resolve(n,e instanceof T.Namespace))return n.join(".");return e.fqn()},o.build=function(){var e,t,n,r={},i=this.children;for(t=0,n=i.length;n>t;++t)(e=i[t])instanceof s&&(r[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(r,"$options",{value:this.buildOpt()}),r},o.buildOpt=function(){var e,t,n,r,i={},s=Object.keys(this.options);for(e=0,t=s.length;t>e;++e)n=s[e],r=this.options[s[e]],i[n]=r;return i},o.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},T.Namespace=s,u=(a=function(e,n,r,i){if(this.type=e,this.resolvedType=n,this.isMapKey=r,this.syntax=i,r&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)}).prototype,a.defaultFieldValue=function(e){if("string"==typeof e&&(e=t.TYPES[e]),void 0===e.defaultValue)throw Error("default value for type "+e.name+" is not supported");return e==t.TYPES.bytes?new n(0):e.defaultValue},u.verifyValue=function(n){var i,s,o,a=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof n||n==n&&n%1!=0)&&a(_t(n),"not an integer"),n>4294967295?0|n:n;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof n||n==n&&n%1!=0)&&a(_t(n),"not an integer"),n<0?n>>>0:n;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return r(n,!1)}catch(e){a(_t(n),e.message)}else a(_t(n),"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return r(n,!0)}catch(e){a(_t(n),e.message)}else a(_t(n),"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof n&&a(_t(n),"not a boolean"),n;case t.TYPES.float:case t.TYPES.double:return"number"!=typeof n&&a(_t(n),"not a number"),n;case t.TYPES.string:return"string"==typeof n||n&&n instanceof String||a(_t(n),"not a string"),""+n;case t.TYPES.bytes:return e.isByteBuffer(n)?n:e.wrap(n);case t.TYPES.enum:for(i=this.resolvedType.getChildren(t.Reflect.Enum.Value),o=0;o<i.length;o++){if(i[o].name==n)return i[o].id;if(i[o].id==n)return i[o].id}if("proto3"===this.syntax)return("number"!=typeof n||n==n&&n%1!=0)&&a(_t(n),"not an integer"),(n>4294967295||n<0)&&a(_t(n),"not in range for uint32"),n;a(n,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(n&&"object"===_t(n)||a(_t(n),"object expected"),n instanceof this.resolvedType.clazz)return n;if(n instanceof t.Builder.Message){for(o in s={},n)n.hasOwnProperty(o)&&(s[o]=n[o]);n=s}return new this.resolvedType.clazz(n)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+n+" (undefined type "+this.type+")")},u.calculateLength=function(e,r){if(null===r)return 0;var i;switch(this.type){case t.TYPES.int32:return r<0?n.calculateVarint64(r):n.calculateVarint32(r);case t.TYPES.uint32:return n.calculateVarint32(r);case t.TYPES.sint32:return n.calculateVarint32(n.zigZagEncode32(r));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES.float:return 4;case t.TYPES.int64:case t.TYPES.uint64:return n.calculateVarint64(r);case t.TYPES.sint64:return n.calculateVarint64(n.zigZagEncode64(r));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES.enum:return n.calculateVarint32(r);case t.TYPES.double:return 8;case t.TYPES.string:return i=n.calculateUTF8Bytes(r),n.calculateVarint32(i)+i;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return n.calculateVarint32(r.remaining())+r.remaining();case t.TYPES.message:return i=this.resolvedType.calculate(r),n.calculateVarint32(i)+i;case t.TYPES.group:return(i=this.resolvedType.calculate(r))+n.calculateVarint32(e<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},u.encodeValue=function(e,r,i){var s,o;if(null===r)return i;switch(this.type){case t.TYPES.int32:r<0?i.writeVarint64(r):i.writeVarint32(r);break;case t.TYPES.uint32:i.writeVarint32(r);break;case t.TYPES.sint32:i.writeVarint32ZigZag(r);break;case t.TYPES.fixed32:i.writeUint32(r);break;case t.TYPES.sfixed32:i.writeInt32(r);break;case t.TYPES.int64:case t.TYPES.uint64:i.writeVarint64(r);break;case t.TYPES.sint64:i.writeVarint64ZigZag(r);break;case t.TYPES.fixed64:i.writeUint64(r);break;case t.TYPES.sfixed64:i.writeInt64(r);break;case t.TYPES.bool:"string"==typeof r?i.writeVarint32("false"===r.toLowerCase()?0:!!r):i.writeVarint32(r?1:0);break;case t.TYPES.enum:i.writeVarint32(r);break;case t.TYPES.float:i.writeFloat32(r);break;case t.TYPES.double:i.writeFloat64(r);break;case t.TYPES.string:i.writeVString(r);break;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");s=r.offset,i.writeVarint32(r.remaining()),i.append(r),r.offset=s;break;case t.TYPES.message:o=(new n).LE(),this.resolvedType.encode(r,o),i.writeVarint32(o.offset),i.append(o.flip());break;case t.TYPES.group:this.resolvedType.encode(r,i),i.writeVarint32(e<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return i},u.decode=function(e,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,s;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES.enum:return e.readVarint32();case t.TYPES.float:return e.readFloat();case t.TYPES.double:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(s=e.readVarint32(),e.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+e.remaining());return(i=e.clone()).limit=i.offset+s,e.offset+=s,i;case t.TYPES.message:return s=e.readVarint32(),this.resolvedType.decode(e,s);case t.TYPES.group:return this.resolvedType.decode(e,-1,r)}throw Error("[INTERNAL] Illegal decode type")},u.valueFromString=function(e){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(e));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(e);case t.TYPES.bool:return"true"===e;case t.TYPES.string:return this.verifyValue(e);case t.TYPES.bytes:return n.fromBinary(e)}},u.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},T.Element=a,(l=(c=function(e,t,n,r,i,o){s.call(this,e,t,n,r,o),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null}).prototype=Object.create(s.prototype)).build=function(r){var i,s,o,a;if(this.clazz&&!r)return this.clazz;for(i=function(t,r){function i(e,r,s,o){var a,u,c,l,h,f,g;if(null===e||"object"!==_t(e))return o&&o instanceof t.Reflect.Enum&&null!==(a=t.Reflect.Enum.getName(o.object,e))?a:e;if(n.isByteBuffer(e))return r?e.toBase64():e.toBuffer();if(t.Long.isLong(e))return s?e.toString():t.Long.fromValue(e);if(Array.isArray(e))return u=[],e.forEach((function(e,t){u[t]=i(e,r,s,o)})),u;if(u={},e instanceof t.Map){for(l=(c=e.entries()).next();!l.done;l=c.next())u[e.keyElem.valueToString(l.value[0])]=i(l.value[1],r,s,e.valueElem.resolvedType);return u}for(g in h=e.$type,f=void 0,e)e.hasOwnProperty(g)&&(u[g]=h&&(f=h.getChild(g))?i(e[g],r,s,f.resolvedType):i(e[g],r,s));return u}var s,o,a=r.getChildren(t.Reflect.Message.Field),u=r.getChildren(t.Reflect.Message.OneOf),c=function e(i){var s,o,c,l;for(t.Builder.Message.call(this),s=0,o=u.length;o>s;++s)this[u[s].name]=null;for(s=0,o=a.length;o>s;++s)this[(c=a[s]).name]=c.repeated?[]:c.map?new t.Map(c):null,!c.required&&"proto3"!==r.syntax||null===c.defaultValue||(this[c.name]=c.defaultValue);if(arguments.length>0)if(1!==arguments.length||null===i||"object"!==_t(i)||!("function"!=typeof i.encode||i instanceof e)||Array.isArray(i)||i instanceof t.Map||n.isByteBuffer(i)||i instanceof ArrayBuffer||t.Long&&i instanceof t.Long)for(s=0,o=arguments.length;o>s;++s)void 0!==(l=arguments[s])&&this.$set(a[s].name,l);else this.$set(i)},l=c.prototype=Object.create(t.Builder.Message.prototype);for(l.add=function(e,n,i){var s=r._fieldsByName[e];if(!i){if(!s)throw Error(this+"#"+e+" is undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));if(!s.repeated)throw Error(this+"#"+e+" is not a repeated field");n=s.verifyValue(n,!0)}return null===this[e]&&(this[e]=[]),this[e].push(n),this},l.$add=l.add,l.set=function(e,n,i){var s,o,a;if(e&&"object"===_t(e)){for(s in i=n,e)e.hasOwnProperty(s)&&void 0!==(n=e[s])&&this.$set(s,n,i);return this}if(o=r._fieldsByName[e],i)this[e]=n;else{if(!o)throw Error(this+"#"+e+" is not a field: undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));this[o.name]=n=o.verifyValue(n)}return o&&o.oneof&&(a=this[o.oneof.name],null!==n?(null!==a&&a!==o.name&&(this[a]=null),this[o.oneof.name]=o.name):a===e&&(this[o.oneof.name]=null)),this},l.$set=l.set,l.get=function(e,n){if(n)return this[e];var i=r._fieldsByName[e];if(!(i&&i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));return this[i.name]},l.$get=l.get,s=0;s<a.length;s++)(o=a[s])instanceof t.Reflect.Message.ExtensionField||r.builder.options.populateAccessors&&function(e){var t,n,i,s=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}));s=s.substring(0,1).toUpperCase()+s.substring(1),t=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),n=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},i=function(){return this[e.name]},null===r.getChild("set"+s)&&(l["set"+s]=n),null===r.getChild("set_"+t)&&(l["set_"+t]=n),null===r.getChild("get"+s)&&(l["get"+s]=i),null===r.getChild("get_"+t)&&(l["get_"+t]=i)}(o);return l.encode=function(t,n){var i,s;"boolean"==typeof t&&(n=t,t=void 0),i=!1,t||(t=new e,i=!0),s=t.littleEndian;try{return r.encode(this,t.LE(),n),(i?t.flip():t).LE(s)}catch(e){throw t.LE(s),e}},c.encode=function(e,t,n){return new c(e).encode(t,n)},l.calculate=function(){return r.calculate(this)},l.encodeDelimited=function(e){var t,i=!1;return e||(e=new n,i=!0),t=(new n).LE(),r.encode(this,t).flip(),e.writeVarint32(t.remaining()),e.append(t),i?e.flip():e},l.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},l.toArrayBuffer=l.encodeAB,l.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},l.toBuffer=l.encodeNB,l.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},l.toBase64=l.encode64,l.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},l.toHex=l.encodeHex,l.toRaw=function(e,t){return i(this,!!e,!!t,this.$type)},l.encodeJSON=function(){return JSON.stringify(i(this,!0,!0,this.$type))},c.decode=function(e,t){var i,s;"string"==typeof e&&(e=n.wrap(e,t||"base64")),i=(e=n.isByteBuffer(e)?e:n.wrap(e)).littleEndian;try{return s=r.decode(e.LE()),e.LE(i),s}catch(t){throw e.LE(i),t}},c.decodeDelimited=function(e,t){var i,s,o;if("string"==typeof e&&(e=n.wrap(e,t||"base64")),(e=n.isByteBuffer(e)?e:n.wrap(e)).remaining()<1)return null;if(i=e.offset,s=e.readVarint32(),e.remaining()<s)return e.offset=i,null;try{return o=r.decode(e.slice(e.offset,e.offset+s).LE()),e.offset+=s,o}catch(t){throw e.offset+=s,t}},c.decode64=function(e){return c.decode(e,"base64")},c.decodeHex=function(e){return c.decode(e,"hex")},c.decodeJSON=function(e){return new c(JSON.parse(e))},l.toString=function(){return r.toString()},Object.defineProperty&&(Object.defineProperty(c,"$options",{value:r.buildOpt()}),Object.defineProperty(l,"$options",{value:c.$options}),Object.defineProperty(c,"$type",{value:r}),Object.defineProperty(l,"$type",{value:r})),c}(t,this),this._fields=[],this._fieldsById={},this._fieldsByName={},o=0,a=this.children.length;a>o;o++)if((s=this.children[o])instanceof p||s instanceof c||s instanceof m){if(i.hasOwnProperty(s.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+s.toString(!0)+" cannot override static property '"+s.name+"'");i[s.name]=s.build()}else if(s instanceof c.Field)s.build(),this._fields.push(s),this._fieldsById[s.id]=s,this._fieldsByName[s.name]=s;else if(!(s instanceof c.OneOf||s instanceof y))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[o].toString(!0));return this.clazz=i},l.encode=function(e,t,n){var r,i,s,o,a,u=null;for(s=0,o=this._fields.length;o>s;++s)i=e[(r=this._fields[s]).name],r.required&&null===i?null===u&&(u=r):r.encode(n?i:r.verifyValue(i),t,e);if(null!==u)throw(a=Error("Missing at least one required field for "+this.toString(!0)+": "+u)).encoded=t,a;return t},l.calculate=function(e){for(var t,n,r=0,i=0,s=this._fields.length;s>i;++i){if(n=e[(t=this._fields[i]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},l.decode=function(e,n,r){var s,o,a,u,c,l,h,f,g,d,p,v;for(n="number"==typeof n?n:-1,c=e.offset,l=new this.clazz;e.offset<c+n||-1===n&&e.remaining()>0;){if(a=(s=e.readVarint32())>>>3,(o=7&s)===t.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(u=this._fieldsById[a])u.repeated&&!u.options.packed?l[u.name].push(u.decode(o,e)):u.map?(f=u.decode(o,e),l[u.name].set(f[0],f[1])):(l[u.name]=u.decode(o,e),u.oneof&&(null!==(g=l[u.oneof.name])&&g!==u.name&&(l[g]=null),l[u.oneof.name]=u.name));else switch(o){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:h=e.readVarint32(),e.offset+=h;break;case t.WIRE_TYPES.STARTGROUP:for(;i(a,e););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+o)}}for(d=0,p=this._fields.length;p>d;++d)if(null===l[(u=this._fields[d]).name])if("proto3"===this.syntax)l[u.name]=u.defaultValue;else{if(u.required)throw(v=Error("Missing at least one required field for "+this.toString(!0)+": "+u.name)).decoded=l,v;t.populateDefaults&&null!==u.defaultValue&&(l[u.name]=u.defaultValue)}return l},T.Message=c,(f=(h=function(e,n,r,i,s,o,a,u,l,h){R.call(this,e,n,o),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=i||null,this.type=s,this.resolvedType=null,this.id=a,this.options=u||{},this.defaultValue=null,this.oneof=l||null,this.syntax=h||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof c.ExtensionField||(this.name=t.Util.toCamelCase(this.name))}).prototype=Object.create(R.prototype)).build=function(){this.element=new a(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new a(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=a.defaultFieldValue(this.type)},f.verifyValue=function(e,n){var r,i,s;if(n=n||!1,r=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this),null===e)return this.required&&r(_t(e),"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&r(_t(e),"proto3 field without field presence cannot be null"),null;if(this.repeated&&!n){for(Array.isArray(e)||(e=[e]),s=[],i=0;i<e.length;i++)s.push(this.element.verifyValue(e[i]));return s}return this.map&&!n?e instanceof t.Map?e:(e instanceof Object||r(_t(e),"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&r(_t(e),"no array expected"),this.element.verifyValue(e))},f.hasWirePresence=function(e,n){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES.float:case t.TYPES.double:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES.enum:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},f.encode=function(e,r,i){var s,o,a,u,c;if(null===this.type||"object"!==_t(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return r;try{if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.ensureCapacity(r.offset+=1),o=r.offset,s=0;s<e.length;s++)this.element.encodeValue(this.id,e[s],r);a=r.offset-o,(u=n.calculateVarint32(a))>1&&(c=r.slice(o,r.offset),o+=u-1,r.offset=o,r.append(c)),r.writeVarint32(a,o-u)}else for(s=0;s<e.length;s++)r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e[s],r);else this.map?e.forEach((function(e,i){var s=n.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,i)+n.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.writeVarint32(s),r.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,i,r),r.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,e,r)}),this):this.hasWirePresence(e,i)&&(r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e,r))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+e+" ("+t+")")}return r},f.calculate=function(e,r){var i,s,o;if(e=this.verifyValue(e),null===this.type||"object"!==_t(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return 0;i=0;try{if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(i+=n.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),o=0,s=0;s<e.length;s++)o+=this.element.calculateLength(this.id,e[s]);i+=n.calculateVarint32(o),i+=o}else for(s=0;s<e.length;s++)i+=n.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,e[s]);else this.map?e.forEach((function(e,r){var s=n.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+n.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);i+=n.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i+=n.calculateVarint32(s),i+=s}),this):this.hasWirePresence(e,r)&&(i+=n.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,e))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+e+" ("+t+")")}return i},f.decode=function(e,n,r){var i,s,o,u,c,l,h;if(!(!this.map&&e==this.type.wireType||!r&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){for(s=n.readVarint32(),s=n.offset+s,o=[];n.offset<s;)o.push(this.decode(this.type.wireType,n,!0));return o}if(this.map){if(u=a.defaultFieldValue(this.keyType),i=a.defaultFieldValue(this.type),s=n.readVarint32(),n.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+n.remaining());for((c=n.clone()).limit=c.offset+s,n.offset+=s;c.remaining()>0;)if(e=7&(l=c.readVarint32()),1==(h=l>>>3))u=this.keyElement.decode(c,e,h);else{if(2!==h)throw Error("Unexpected tag in map field key/value submessage");i=this.element.decode(c,e,h)}return[u,i]}return this.element.decode(n,e,this.id)},T.Message.Field=h,(g=function(e,t,n,r,i,s,o){h.call(this,e,t,n,null,r,i,s,o),this.extension}).prototype=Object.create(h.prototype),T.Message.ExtensionField=g,d=function(e,t,n){R.call(this,e,t,n),this.fields=[]},T.Message.OneOf=d,(p=function(e,t,n,r,i){s.call(this,e,t,n,r,i),this.className="Enum",this.object=null}).getName=function(e,t){var n,r,i=Object.keys(e);for(r=0;r<i.length;++r)if(e[n=i[r]]===t)return n;return null},(p.prototype=Object.create(s.prototype)).build=function(e){var n,r,i,s;if(this.object&&!e)return this.object;for(n=new t.Builder.Enum,i=0,s=(r=this.getChildren(p.Value)).length;s>i;++i)n[r[i].name]=r[i].id;return Object.defineProperty&&Object.defineProperty(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},T.Enum=p,(v=function(e,t,n,r){R.call(this,e,t,n),this.className="Enum.Value",this.id=r}).prototype=Object.create(R.prototype),T.Enum.Value=v,(y=function(e,t,n,r){R.call(this,e,t,n),this.field=r}).prototype=Object.create(R.prototype),T.Extension=y,((m=function(e,t,n,r){s.call(this,e,t,n,r),this.className="Service",this.clazz=null}).prototype=Object.create(s.prototype)).build=function(e){return this.clazz&&!e?this.clazz:this.clazz=function(e,t){var r,i=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},s=i.prototype=Object.create(e.Builder.Service.prototype),o=t.getChildren(e.Reflect.Service.RPCMethod);for(r=0;r<o.length;r++)!function(e){s[e.name]=function(r,i){try{try{r=e.resolvedRequestType.clazz.decode(n.wrap(r))}catch(e){if(!(e instanceof TypeError))throw e}if(null===r||"object"!==_t(r))throw Error("Illegal arguments");r instanceof e.resolvedRequestType.clazz||(r=new e.resolvedRequestType.clazz(r)),this.rpcImpl(e.fqn(),r,(function(n,r){if(!n){try{r=e.resolvedResponseType.clazz.decode(r)}catch(e){}return r&&r instanceof e.resolvedResponseType.clazz?void i(null,r):void i(Error("Illegal response type received in service method "+t.name+"#"+e.name))}i(n)}))}catch(e){setTimeout(i.bind(this,e),0)}},i[e.name]=function(t,n,r){new i(t)[e.name](n,r)},Object.defineProperty&&(Object.defineProperty(i[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(s[e.name],"$options",{value:i[e.name].$options}))}(o[r]);return Object.defineProperty&&(Object.defineProperty(i,"$options",{value:t.buildOpt()}),Object.defineProperty(s,"$options",{value:i.$options}),Object.defineProperty(i,"$type",{value:t}),Object.defineProperty(s,"$type",{value:t})),i}(t,this)},T.Service=m,((_=function(e,t,n,r){R.call(this,e,t,n),this.className="Service.Method",this.options=r||{}}).prototype=Object.create(R.prototype)).buildOpt=o.buildOpt,T.Service.Method=_,(E=function(e,t,n,r,i,s,o,a){_.call(this,e,t,n,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=s,this.responseStream=o,this.resolvedRequestType=null,this.resolvedResponseType=null}).prototype=Object.create(_.prototype),T.Service.RPCMethod=E,T}(i),i.Builder=function(e,t,n){function r(e){e.messages&&e.messages.forEach((function(t){t.syntax=e.syntax,r(t)})),e.enums&&e.enums.forEach((function(t){t.syntax=e.syntax}))}var i=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},s=i.prototype;return i.isMessage=function(e){return"string"==typeof e.name&&void 0===e.values&&void 0===e.rpc},i.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},i.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},i.isService=function(e){return!("string"!=typeof e.name||"object"!==_t(e.rpc)||!e.rpc)},i.isExtend=function(e){return"string"==typeof e.ref},s.reset=function(){return this.ptr=this.ns,this},s.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},s.create=function(t){var r,s,o,a,u;if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){if(s=t.shift(),i.isMessage(s)){if(o=new n.Message(this,this.ptr,s.name,s.options,s.isGroup,s.syntax),a={},s.oneofs&&Object.keys(s.oneofs).forEach((function(e){o.addChild(a[e]=new n.Message.OneOf(this,o,e))}),this),s.fields&&s.fields.forEach((function(e){if(null!==o.getChild(0|e.id))throw Error("duplicate or invalid field id in "+o.name+": "+e.id);if(e.options&&"object"!==_t(e.options))throw Error("illegal field options in "+o.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+o.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,o,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,s.syntax),t&&t.fields.push(e),o.addChild(e)}),this),u=[],s.enums&&s.enums.forEach((function(e){u.push(e)})),s.messages&&s.messages.forEach((function(e){u.push(e)})),s.services&&s.services.forEach((function(e){u.push(e)})),s.extensions&&(o.extensions="number"==typeof s.extensions[0]?[s.extensions]:s.extensions),this.ptr.addChild(o),u.length>0){r.push(t),t=u,u=null,this.ptr=o,o=null;continue}u=null}else if(i.isEnum(s))o=new n.Enum(this,this.ptr,s.name,s.options,s.syntax),s.values.forEach((function(e){o.addChild(new n.Enum.Value(this,o,e.name,e.id))}),this),this.ptr.addChild(o);else if(i.isService(s))o=new n.Service(this,this.ptr,s.name,s.options),Object.keys(s.rpc).forEach((function(e){var t=s.rpc[e];o.addChild(new n.Service.RPCMethod(this,o,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(o);else{if(!i.isExtend(s))throw Error("not a valid definition: "+JSON.stringify(s));if(o=this.ptr.resolve(s.ref,!0))s.fields.forEach((function(t){var r,i,s,a;if(null!==o.getChild(0|t.id))throw Error("duplicate extended field id in "+o.name+": "+t.id);if(o.extensions&&(r=!1,o.extensions.forEach((function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)})),!r))throw Error("illegal extended field id in "+o.name+": "+t.id+" (not within valid ranges)");i=t.name,this.options.convertFieldsToCamelCase&&(i=e.Util.toCamelCase(i)),s=new n.Message.ExtensionField(this,o,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),a=new n.Extension(this,this.ptr,t.name,s),s.extension=a,this.ptr.addChild(a),o.addChild(s)}),this);else if(!/\.?google\.protobuf\./.test(s.ref))throw Error("extended message "+s.ref+" is not defined")}s=null,o=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},s.import=function(t,n){var i,s,o,a,u,c,l,h,f="/";if("string"==typeof n){if(e.Util.IS_NODE,!0===this.files[n])return this.reset();this.files[n]=!0}else if("object"===_t(n)){if(i=n.root,e.Util.IS_NODE,(i.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(f="\\"),s=i+f+n.file,!0===this.files[s])return this.reset();this.files[s]=!0}if(t.imports&&t.imports.length>0){for(a=!1,"object"===_t(n)?(this.importRoot=n.root,a=!0,o=this.importRoot,n=n.file,(o.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(f="\\")):"string"==typeof n?this.importRoot?o=this.importRoot:n.indexOf("/")>=0?""===(o=n.replace(/\/[^\/]*$/,""))&&(o="/"):n.indexOf("\\")>=0?(o=n.replace(/\\[^\\]*$/,""),f="\\"):o=".":o=null,u=0;u<t.imports.length;u++)if("string"==typeof t.imports[u]){if(!o)throw Error("cannot determine import root");if("google/protobuf/descriptor.proto"===(c=t.imports[u]))continue;if(c=o+f+c,!0===this.files[c])continue;if(/\.proto$/i.test(c)&&!e.DotProto&&(c=c.replace(/\.proto$/,".json")),null===(l=e.Util.fetch(c)))throw Error("failed to import '"+c+"' in '"+n+"': file not found");/\.json$/i.test(c)?this.import(JSON.parse(l+""),c):this.import(e.DotProto.Parser.parse(l),c)}else n?/\.(\w+)$/.test(n)?this.import(t.imports[u],n.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+u+"."+n}))):this.import(t.imports[u],n+"_import"+u):this.import(t.imports[u]);a&&(this.importRoot=null)}return t.package&&this.define(t.package),t.syntax&&r(t),h=this.ptr,t.options&&Object.keys(t.options).forEach((function(e){h.options[e]=t.options[e]})),t.messages&&(this.create(t.messages),this.ptr=h),t.enums&&(this.create(t.enums),this.ptr=h),t.services&&(this.create(t.services),this.ptr=h),t.extends&&this.create(t.extends),this.reset()},s.resolveAll=function(){var r;if(null==this.ptr||"object"===_t(this.ptr.type))return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(r=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof n.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((r=this.ptr.parent.resolve(this.ptr.requestName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,!((r=this.ptr.parent.resolve(this.ptr.responseName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+_t(this.ptr)+": "+this.ptr);return this.reset()},s.build=function(e){var t,n,r;if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},s.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},s.toString=function(){return"Builder"},i.Message=function(){},i.Enum=function(){},i.Service=function(){},i}(i,i.Lang,i.Reflect),i.Map=function(e,t){function n(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var r=function(e,n){var r,i,s,o;if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),n)for(r=Object.keys(n),i=0;i<r.length;i++)s=this.keyElem.valueFromString(r[i]),o=this.valueElem.verifyValue(n[r[i]]),this.map[this.keyElem.valueToString(s)]={key:s,value:o}},i=r.prototype;return i.clear=function(){this.map={}},i.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},i.entries=function(){var e,t,r=[],i=Object.keys(this.map);for(t=0;t<i.length;t++)r.push([(e=this.map[i[t]]).key,e.value]);return n(r)},i.keys=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].key);return n(t)},i.values=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].value);return n(t)},i.forEach=function(e,t){var n,r,i=Object.keys(this.map);for(r=0;r<i.length;r++)e.call(t,(n=this.map[i[r]]).value,n.key,this)},i.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},i.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map?this.map[t].value:void 0},i.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},r}(0,i.Reflect),i.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),i.loadJson(i.DotProto.Parser.parse(e),t,n)},i.protoFromString=i.loadProto,i.loadProtoFile=function(e,t,n){if(t&&"object"===_t(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,i.loadProto(r,n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=i.Util.fetch("object"===_t(e)?e.root+"/"+e.file:e);return null===r?null:i.loadProto(r,n,e)},i.protoFromFile=i.loadProtoFile,i.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"===_t(t)||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},i.loadJsonFile=function(e,t,n){if(t&&"object"===_t(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,i.loadJson(JSON.parse(r),n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=i.Util.fetch("object"===_t(e)?e.root+"/"+e.file:e);return null===r?null:i.loadJson(JSON.parse(r),n,e)},r=ef,i.loadProto(r,void 0,"").build("Modules").probuf}(function(e){function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function n(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+a.apply(String,e):(e.length+arguments.length>1024&&(t.push(a.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}function r(e,t,n,r,i){var s,o,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,g=e[t+h];for(h+=f,s=g&(1<<-l)-1,g>>=-l,l+=a;l>0;s=256*s+e[t+h],h+=f,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=r;l>0;o=256*o+e[t+h],h+=f,l-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(g?-1:1);o+=Math.pow(2,r),s-=c}return(g?-1:1)*o*Math.pow(2,s-r)}function i(e,t,n,r,i,s){var o,a,u,c=8*s-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:s-1,d=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(a=0,o=l):o+h>=1?(a=(t*u-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+g]=255&a,g+=d,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[n+g]=255&o,g+=d,o/=256,c-=8);e[n+g-d]|=128*p}var s,o,a,u,c,l=function e(t,n,r){if(void 0===t&&(t=e.DEFAULT_CAPACITY),void 0===n&&(n=e.DEFAULT_ENDIAN),void 0===r&&(r=e.DEFAULT_NOASSERT),!r){if((t|=0)<0)throw RangeError("Illegal capacity");n=!!n,r=!!r}this.buffer=0===t?o:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=n,this.noAssert=r};return l.VERSION="5.0.1",l.LITTLE_ENDIAN=!0,l.BIG_ENDIAN=!1,l.DEFAULT_CAPACITY=16,l.DEFAULT_ENDIAN=l.BIG_ENDIAN,l.DEFAULT_NOASSERT=!1,l.Long=e||null,(s=l.prototype).__isByteBuffer__,Object.defineProperty(s,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1}),o=new ArrayBuffer(0),a=String.fromCharCode,l.accessor=function(){return Uint8Array},l.allocate=function(e,t,n){return new l(e,t,n)},l.concat=function(e,t,n,r){var i,s,o,a,u,c;for(("boolean"==typeof t||"string"!=typeof t)&&(r=n,n=t,t=void 0),i=0,o=0,a=e.length;a>o;++o)l.isByteBuffer(e[o])||(e[o]=l.wrap(e[o],t)),(s=e[o].limit-e[o].offset)>0&&(i+=s);if(0===i)return new l(0,n,r);for(c=new l(i,n,r),o=0;a>o;)(s=(u=e[o++]).limit-u.offset)<=0||(c.view.set(u.view.subarray(u.offset,u.limit),c.offset),c.offset+=s);return c.limit=c.offset,c.offset=0,c},l.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},l.type=function(){return ArrayBuffer},l.wrap=function(e,t,n,r){var i,o;if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return l.fromBase64(e,n);case"hex":return l.fromHex(e,n);case"binary":return l.fromBinary(e,n);case"utf8":return l.fromUTF8(e,n);case"debug":return l.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!==_t(e))throw TypeError("Illegal buffer");if(l.isByteBuffer(e))return(i=s.clone.call(e)).markedOffset=-1,i;if(e instanceof Uint8Array)i=new l(0,n,r),e.length>0&&(i.buffer=e.buffer,i.offset=e.byteOffset,i.limit=e.byteOffset+e.byteLength,i.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)i=new l(0,n,r),e.byteLength>0&&(i.buffer=e,i.offset=0,i.limit=e.byteLength,i.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");for((i=new l(e.length,n,r)).limit=e.length,o=0;o<e.length;++o)i.view[o]=e[o]}return i},s.writeBitSet=function(e,t){var n,r,i,s,o,a,u=void 0===t;if(u&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for(r=t,s=(i=e.length)>>3,o=0,t+=this.writeVarint32(i,t);s--;)n=1&!!e[o++]|(1&!!e[o++])<<1|(1&!!e[o++])<<2|(1&!!e[o++])<<3|(1&!!e[o++])<<4|(1&!!e[o++])<<5|(1&!!e[o++])<<6|(1&!!e[o++])<<7,this.writeByte(n,t++);if(i>o){for(a=0,n=0;i>o;)n|=(1&!!e[o++])<<a++;this.writeByte(n,t++)}return u?(this.offset=t,this):t-r},s.readBitSet=function(e){var t,n,r,i,s,o,a,u=void 0===e;for(u&&(e=this.offset),i=(r=(n=this.readVarint32(e)).value)>>3,s=0,o=[],e+=n.length;i--;)t=this.readByte(e++),o[s++]=!!(1&t),o[s++]=!!(2&t),o[s++]=!!(4&t),o[s++]=!!(8&t),o[s++]=!!(16&t),o[s++]=!!(32&t),o[s++]=!!(64&t),o[s++]=!!(128&t);if(r>s)for(a=0,t=this.readByte(e++);r>s;)o[s++]=!!(1&t>>a++);return u&&(this.offset=e),o},s.readBytes=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}return n=this.slice(t,t+e),r&&(this.offset+=e),n},s.writeBytes=s.append,s.writeInt8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},s.writeByte=s.writeInt8,s.readInt8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return 128==(128&(t=this.view[e]))&&(t=-(255-t+1)),n&&(this.offset+=1),t},s.readByte=s.readInt8,s.writeUint8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},s.writeUInt8=s.writeUint8,s.readUint8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=this.view[e],n&&(this.offset+=1),t},s.readUInt8=s.readUint8,s.writeInt16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},s.writeShort=s.writeInt16,s.readInt16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),32768==(32768&t)&&(t=-(65535-t+1)),n&&(this.offset+=2),t},s.readShort=s.readInt16,s.writeUint16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},s.writeUInt16=s.writeUint16,s.readUint16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),n&&(this.offset+=2),t},s.readUInt16=s.readUint16,s.writeInt32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},s.writeInt=s.writeInt32,s.readInt32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),t|=0,n&&(this.offset+=4),t},s.readInt=s.readInt32,s.writeUint32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},s.writeUInt32=s.writeUint32,s.readUint32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),n&&(this.offset+=4),t},s.readUInt32=s.readUint32,e&&(s.writeInt64=function(t,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,s=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&s>>>24,this.view[n+2]=255&s>>>16,this.view[n+1]=255&s>>>8,this.view[n]=255&s):(this.view[n]=255&s>>>24,this.view[n+1]=255&s>>>16,this.view[n+2]=255&s>>>8,this.view[n+3]=255&s,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),o&&(this.offset+=8),this},s.writeLong=s.writeInt64,s.readInt64=function(t){var n,r,i,s=void 0===t;if(s&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!1),s&&(this.offset+=8),i},s.readLong=s.readInt64,s.writeUint64=function(t,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,s=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&s>>>24,this.view[n+2]=255&s>>>16,this.view[n+1]=255&s>>>8,this.view[n]=255&s):(this.view[n]=255&s>>>24,this.view[n+1]=255&s>>>16,this.view[n+2]=255&s>>>8,this.view[n+3]=255&s,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),o&&(this.offset+=8),this},s.writeUInt64=s.writeUint64,s.readUint64=function(t){var n,r,i,s=void 0===t;if(s&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!0),s&&(this.offset+=8),i},s.readUInt64=s.readUint64),s.writeFloat32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,i(this.view,e,t,this.littleEndian,23,4),r&&(this.offset+=4),this},s.writeFloat=s.writeFloat32,s.readFloat32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,23,4),n&&(this.offset+=4),t},s.readFloat=s.readFloat32,s.writeFloat64=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=8)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=8,i(this.view,e,t,this.littleEndian,52,8),r&&(this.offset+=8),this},s.writeDouble=s.writeFloat64,s.readFloat64=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,52,8),n&&(this.offset+=8),t},s.readDouble=s.readFloat64,l.MAX_VARINT32_BYTES=5,l.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:1<<21>e?3:1<<28>e?4:5},l.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},l.zigZagDecode32=function(e){return 0|e>>>1^-(1&e)},s.writeVarint32=function(e,t){var n,r,i,s=void 0===t;if(s&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for((t+=r=l.calculateVarint32(e))>(i=this.buffer.byteLength)&&this.resize((i*=2)>t?i:t),t-=r,e>>>=0;e>=128;)n=128|127&e,this.view[t++]=n,e>>>=7;return this.view[t++]=e,s?(this.offset=t,this):r},s.writeVarint32ZigZag=function(e,t){return this.writeVarint32(l.zigZagEncode32(e),t)},s.readVarint32=function(e){var t,n,r,i,s=void 0===e;if(s&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}n=0,r=0;do{if(!this.noAssert&&e>this.limit)throw(i=Error("Truncated")).truncated=!0,i;t=this.view[e++],n<5&&(r|=(127&t)<<7*n),++n}while(0!=(128&t));return r|=0,s?(this.offset=e,r):{value:r,length:n}},s.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"===_t(t)?t.value=l.zigZagDecode32(t.value):t=l.zigZagDecode32(t),t},e&&(l.MAX_VARINT64_BYTES=10,l.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?n<16384?n<128?1:2:1<<21>n?3:4:r<16384?r<128?5:6:1<<21>r?7:8:i<128?9:10},l.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},l.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},s.writeVarint64=function(t,n){var r,i,s,o,a,u=void 0===n;if(u&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}switch("number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),r=l.calculateVarint64(t),i=t.toInt()>>>0,s=t.shiftRightUnsigned(28).toInt()>>>0,o=t.shiftRightUnsigned(56).toInt()>>>0,(n+=r)>(a=this.buffer.byteLength)&&this.resize((a*=2)>n?a:n),n-=r,r){case 10:this.view[n+9]=1&o>>>7;case 9:this.view[n+8]=9!==r?128|o:127&o;case 8:this.view[n+7]=8!==r?128|s>>>21:127&s>>>21;case 7:this.view[n+6]=7!==r?128|s>>>14:127&s>>>14;case 6:this.view[n+5]=6!==r?128|s>>>7:127&s>>>7;case 5:this.view[n+4]=5!==r?128|s:127&s;case 4:this.view[n+3]=4!==r?128|i>>>21:127&i>>>21;case 3:this.view[n+2]=3!==r?128|i>>>14:127&i>>>14;case 2:this.view[n+1]=2!==r?128|i>>>7:127&i>>>7;case 1:this.view[n]=1!==r?128|i:127&i}return u?(this.offset+=r,this):r},s.writeVarint64ZigZag=function(e,t){return this.writeVarint64(l.zigZagEncode64(e),t)},s.readVarint64=function(t){var n,r,i,s,o,a,u=void 0===t;if(u&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}if(n=t,r=0,i=0,s=0,o=0,r=127&(o=this.view[t++]),128&o&&(r|=(127&(o=this.view[t++]))<<7,(128&o||this.noAssert&&void 0===o)&&(r|=(127&(o=this.view[t++]))<<14,(128&o||this.noAssert&&void 0===o)&&(r|=(127&(o=this.view[t++]))<<21,(128&o||this.noAssert&&void 0===o)&&(i=127&(o=this.view[t++]),(128&o||this.noAssert&&void 0===o)&&(i|=(127&(o=this.view[t++]))<<7,(128&o||this.noAssert&&void 0===o)&&(i|=(127&(o=this.view[t++]))<<14,(128&o||this.noAssert&&void 0===o)&&(i|=(127&(o=this.view[t++]))<<21,(128&o||this.noAssert&&void 0===o)&&(s=127&(o=this.view[t++]),(128&o||this.noAssert&&void 0===o)&&(s|=(127&(o=this.view[t++]))<<7,128&o||this.noAssert&&void 0===o))))))))))throw Error("Buffer overrun");return a=e.fromBits(r|i<<28,i>>>4|s<<24,!1),u?(this.offset=t,a):{value:a,length:t-n}},s.readVarint64ZigZag=function(t){var n=this.readVarint64(t);return n&&n.value instanceof e?n.value=l.zigZagDecode64(n.value):n=l.zigZagDecode64(n),n}),s.writeCString=function(e,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),i=e.length,!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;i>r;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=c.calculateUTF16asUTF8(t(e))[1],n+=i+1,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=i+1,c.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),this.view[n++]=0,o?(this.offset=n,this):i},s.readCString=function(e){var t,r,i,s=void 0===e;if(s&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,i=-1,c.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view[e++])?null:i}.bind(this),r=n(),!0),s?(this.offset=e,r()):{string:r(),length:e-t}},s.writeIString=function(e,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(i=n,r=c.calculateUTF16asUTF8(t(e),this.noAssert)[1],n+=4+r,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=4+r,this.littleEndian?(this.view[n+3]=255&r>>>24,this.view[n+2]=255&r>>>16,this.view[n+1]=255&r>>>8,this.view[n]=255&r):(this.view[n]=255&r>>>24,this.view[n+1]=255&r>>>16,this.view[n+2]=255&r>>>8,this.view[n+3]=255&r),n+=4,c.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==i+4+r)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+4+r));return o?(this.offset=n,this):n-i},s.readIString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=e,n=this.readUint32(e),r=this.readUTF8String(n,l.METRICS_BYTES,e+=4),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},l.METRICS_CHARS="c",l.METRICS_BYTES="b",s.writeUTF8String=function(e,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=n,r=c.calculateUTF16asUTF8(t(e))[1],n+=r,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=r,c.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),o?(this.offset=n,this):n-i},s.writeString=s.writeUTF8String,l.calculateUTF8Chars=function(e){return c.calculateUTF16asUTF8(t(e))[0]},l.calculateString=l.calculateUTF8Bytes=function(e){return c.calculateUTF16asUTF8(t(e))[1]},s.readUTF8String=function(e,t,r){var i,s,o,a,u;if("number"==typeof t&&(r=t,t=void 0),(i=void 0===r)&&(r=this.offset),void 0===t&&(t=l.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}if(o=0,a=r,t===l.METRICS_CHARS){if(s=n(),c.decodeUTF8(function(){return e>o&&r<this.limit?this.view[r++]:null}.bind(this),(function(e){++o,c.UTF8toUTF16(e,s)})),o!==e)throw RangeError("Illegal range: Truncated data, "+o+" == "+e);return i?(this.offset=r,s()):{string:s(),length:r-a}}if(t===l.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}if(u=r+e,c.decodeUTF8toUTF16(function(){return u>r?this.view[r++]:null}.bind(this),s=n(),this.noAssert),r!==u)throw RangeError("Illegal range: Truncated data, "+r+" == "+u);return i?(this.offset=r,s()):{string:s(),length:r-a}}throw TypeError("Unsupported metrics: "+t)},s.readString=s.readUTF8String,s.writeVString=function(e,n){var r,i,s,o,a=void 0===n;if(a&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(s=n,r=c.calculateUTF16asUTF8(t(e),this.noAssert)[1],i=l.calculateVarint32(r),n+=i+r,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=i+r,n+=this.writeVarint32(r,n),c.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==s+r+i)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+r+i));return a?(this.offset=n,this):n-s},s.readVString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,n=this.readVarint32(e),r=this.readUTF8String(n.value,l.METRICS_BYTES,e+=n.length),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},s.append=function(e,t,n){var r,i,s;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof l||(e=l.wrap(e,t)),(i=e.limit-e.offset)<=0||((n+=i)>(s=this.buffer.byteLength)&&this.resize((s*=2)>n?s:n),n-=i,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=i,r&&(this.offset+=i)),this},s.appendTo=function(e,t){return e.append(this,t),this},s.assert=function(e){return this.noAssert=!e,this},s.capacity=function(){return this.buffer.byteLength},s.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},s.clone=function(e){var t=new l(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},s.compact=function(e,t){var n,r,i;if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return 0===e&&t===this.buffer.byteLength?this:0==(n=t-e)?(this.buffer=o,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this):(r=new ArrayBuffer(n),(i=new Uint8Array(r)).set(this.view.subarray(e,t)),this.buffer=r,this.view=i,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this)},s.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new l(0,this.littleEndian,this.noAssert);var n=t-e,r=new l(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,r.markedOffset>=0&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},s.copyTo=function(e,t,n,r){var i,s,o;if(!this.noAssert&&!l.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(s=void 0===t)?e.offset:0|t,n=(i=void 0===n)?this.offset:0|n,r=void 0===r?this.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);return 0==(o=r-n)?e:(e.ensureCapacity(t+o),e.view.set(this.view.subarray(n,r),t),i&&(this.offset+=o),s&&(e.offset+=o),this)},s.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},s.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;n>t;)this.view[t++]=e;return r&&(this.offset=t),this},s.flip=function(){return this.limit=this.offset,this.offset=0,this},s.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},s.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},s.LE=function(e){return this.littleEndian=void 0===e||!!e,this},s.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},s.prepend=function(e,t,n){var r,i,s,o,a;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof l||(e=l.wrap(e,t)),(i=e.limit-e.offset)<=0||((s=i-n)>0?(o=new ArrayBuffer(this.buffer.byteLength+s),(a=new Uint8Array(o)).set(this.view.subarray(n,this.buffer.byteLength),i),this.buffer=o,this.view=a,this.offset+=s,this.markedOffset>=0&&(this.markedOffset+=s),this.limit+=s,n+=s):new Uint8Array(this.buffer),this.view.set(e.view.subarray(e.offset,e.limit),n-i),e.offset=e.limit,r&&(this.offset-=i)),this},s.prependTo=function(e,t){return e.prepend(this,t),this},s.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},s.remaining=function(){return this.limit-this.offset},s.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},s.resize=function(e){var t,n;if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}return this.buffer.byteLength<e&&(t=new ArrayBuffer(e),(n=new Uint8Array(t)).set(this.view),this.buffer=t,this.view=n),this},s.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},s.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},s.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},s.toBuffer=function(e){var t,n=this.offset,r=this.limit;if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: Not an integer");if(n>>>=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal limit: Not an integer");if(r>>>=0,n<0||n>r||r>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+n+" <= "+r+" <= "+this.buffer.byteLength)}return e||0!==n||r!==this.buffer.byteLength?n===r?o:(t=new ArrayBuffer(r-n),new Uint8Array(t).set(new Uint8Array(this.buffer).subarray(n,r),0),t):this.buffer},s.toArrayBuffer=s.toBuffer,s.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}},u=function(){var e,t,n={},r=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[];for(e=0,t=r.length;t>e;++e)i[r[e]]=e;return n.encode=function(e,t){for(var n,i;null!==(n=e());)t(r[63&n>>2]),i=(3&n)<<4,null!==(n=e())?(t(r[63&((i|=15&n>>4)|15&n>>4)]),i=(15&n)<<2,null!==(n=e())?(t(r[63&(i|3&n>>6)]),t(r[63&n])):(t(r[63&i]),t(61))):(t(r[63&i]),t(61),t(61))},n.decode=function(e,t){function n(e){throw Error("Illegal character code: "+e)}for(var r,s,o;null!==(r=e());)if(void 0===(s=i[r])&&n(r),null!==(r=e())&&(void 0===(o=i[r])&&n(r),t(s<<2>>>0|(48&o)>>4),null!==(r=e()))){if(void 0===(s=i[r])){if(61===r)break;n(r)}if(t((15&o)<<4>>>0|(60&s)>>2),null!==(r=e())){if(void 0===(o=i[r])){if(61===r)break;n(r)}t((3&s)<<6>>>0|o)}}},n.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},n}(),s.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||e>t)throw RangeError("begin, end");var r;return u.encode(function(){return t>e?this.view[e++]:null}.bind(this),r=n()),r()},l.fromBase64=function(e,n){if("string"!=typeof e)throw TypeError("str");var r=new l(e.length/4*3,n),i=0;return u.decode(t(e),(function(e){r.view[i++]=e})),r.limit=i,r},l.btoa=function(e){return l.fromBinary(e).toBase64()},l.atob=function(e){return l.fromBase64(e).toBinary()},s.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];t>e;)n.push(this.view[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},l.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,i=e.length,s=new l(i,t);i>r;){if((n=e.charCodeAt(r))>255)throw RangeError("illegal char code: "+n);s.view[r++]=n}return s.limit=i,s},s.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",s="",o="";r>n;){if(-1!==n&&(i+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(s+=t>32&&t<127?String.fromCharCode(t):".")),++n,e&&n>0&&n%16==0&&n!==r){for(;i.length<51;)i+=" ";o+=i+s+"\n",i=s=""}i+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";o+=i+s+"\n"}return e?o:i},l.fromDebug=function(e,t,n){for(var r,i,s=e.length,o=new l(0|(s+1)/3,t,n),a=0,u=0,c=!1,h=!1,f=!1,g=!1,d=!1;s>a;){switch(r=e.charAt(a++)){case"!":if(!n){if(h||f||g){d=!0;break}h=f=g=!0}o.offset=o.markedOffset=o.limit=u,c=!1;break;case"|":if(!n){if(h||g){d=!0;break}h=g=!0}o.offset=o.limit=u,c=!1;break;case"[":if(!n){if(h||f){d=!0;break}h=f=!0}o.offset=o.markedOffset=u,c=!1;break;case"<":if(!n){if(h){d=!0;break}h=!0}o.offset=u,c=!1;break;case"]":if(!n){if(g||f){d=!0;break}g=f=!0}o.limit=o.markedOffset=u,c=!1;break;case">":if(!n){if(g){d=!0;break}g=!0}o.limit=u,c=!1;break;case"'":if(!n){if(f){d=!0;break}f=!0}o.markedOffset=u,c=!1;break;case" ":c=!1;break;default:if(!n&&c){d=!0;break}if(i=parseInt(r+e.charAt(a++),16),!n&&(isNaN(i)||i<0||i>255))throw TypeError("Illegal str: Not a debug encoded string");o.view[u++]=i,c=!0}if(d)throw TypeError("Illegal str: Invalid symbol at "+a)}if(!n){if(!h||!g)throw TypeError("Illegal str: Missing offset or limit");if(u<o.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+s)}return o},s.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);t>e;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},l.fromHex=function(e,t,n){var r,i,s,o,a;if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(i=e.length,s=new l(0|i/2,t),o=0,a=0;i>o;o+=2){if(r=parseInt(e.substring(o,o+2),16),!n&&(!isFinite(r)||r<0||r>255))throw TypeError("Illegal str: Contains non-hex characters");s.view[a++]=r}return s.limit=a,s},c=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(192|31&n>>6),t(128|63&n)):n<65536?(t(224|15&n>>12),t(128|63&n>>6),t(128|63&n)):(t(240|7&n>>18),t(128|63&n>>12),t(128|63&n>>6),t(128|63&n)),n=null},decodeUTF8:function(e,t){for(var n,r,i,s,o=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&o([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))(null===(r=e())||null===(i=e()))&&o([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(s=e()))&&o([n,r,i,s]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&s)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(t,n){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,n)}))},decodeUTF8toUTF16:function(t,n){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,n)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(t){var n=0,r=0;return e.UTF16toUTF8(t,(function(e){++n,r+=e<128?1:e<2048?2:e<65536?3:4})),[n,r]}};return e}(),s.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{c.decodeUTF8toUTF16(function(){return t>e?this.view[e++]:null}.bind(this),r=n())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},l.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var i=new l(c.calculateUTF16asUTF8(t(e),!0)[1],n,r),s=0;return c.encodeUTF16toUTF8(t(e),(function(e){i.view[s++]=e})),i.limit=s,i},l}(tf=function(){function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return!0===(e&&e.__isLong__)}function n(e,t){var n,r,s;return t?(s=(e>>>=0)>=0&&e<256)&&(r=u[e])?r:(n=i(e,(0|e)<0?-1:0,!0),s&&(u[e]=n),n):(s=(e|=0)>=-128&&e<128)&&(r=a[e])?r:(n=i(e,e<0?-1:0,!1),s&&(a[e]=n),n)}function r(e,t){if(isNaN(e)||!isFinite(e))return t?p:d;if(t){if(e<0)return p;if(e>=h)return E}else{if(-f>=e)return T;if(e+1>=f)return _}return e<0?r(-e,t).neg():i(0|e%l,0|e/l,t)}function i(t,n,r){return new e(t,n,r)}function s(e,t,n){var i,o,a,u,l,h,f;if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return d;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||n>36)throw RangeError("radix");if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return s(e.substring(1),t,n).neg();for(o=r(c(n,8)),a=d,u=0;u<e.length;u+=8)l=Math.min(8,e.length-u),h=parseInt(e.substring(u,u+l),n),l<8?(f=r(c(n,l)),a=a.mul(f).add(r(h))):a=(a=a.mul(o)).add(r(h));return a.unsigned=t,a}function o(t){return t instanceof e?t:"number"==typeof t?r(t):"string"==typeof t?s(t):i(t.low,t.high,t.unsigned)}var a,u,c,l,h,f,g,d,p,v,y,m,_,E,T,R;return e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t,a={},u={},e.fromInt=n,e.fromNumber=r,e.fromBits=i,c=Math.pow,e.fromString=s,e.fromValue=o,f=(h=(l=4294967296)*l)/2,g=n(16777216),d=n(0),e.ZERO=d,p=n(0,!0),e.UZERO=p,v=n(1),e.ONE=v,y=n(1,!0),e.UONE=y,m=n(-1),e.NEG_ONE=m,_=i(-1,2147483647,!1),e.MAX_VALUE=_,E=i(-1,-1,!0),e.MAX_UNSIGNED_VALUE=E,T=i(0,-2147483648,!1),e.MIN_VALUE=T,(R=e.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},R.toString=function(e){var t,n,i,s,o,a,u,l;if((e=e||10)<2||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())return this.eq(T)?(t=r(e),i=(n=this.div(t)).mul(t).sub(this),n.toString(e)+i.toInt().toString(e)):"-"+this.neg().toString(e);for(s=r(c(e,6),this.unsigned),o=this,a="";;){if(u=o.div(s),l=(o.sub(u.mul(s)).toInt()>>>0).toString(e),(o=u).isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){var e,t;if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},R.isZero=function(){return 0===this.high&&0===this.low},R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||this.high>=0},R.isOdd=function(){return 1==(1&this.low)},R.isEven=function(){return 0==(1&this.low)},R.equals=function(e){return t(e)||(e=o(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},R.eq=R.equals,R.notEquals=function(e){return!this.eq(e)},R.neq=R.notEquals,R.lessThan=function(e){return this.comp(e)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(e){return this.comp(e)<=0},R.lte=R.lessThanOrEqual,R.greaterThan=function(e){return this.comp(e)>0},R.gt=R.greaterThan,R.greaterThanOrEqual=function(e){return this.comp(e)>=0},R.gte=R.greaterThanOrEqual,R.compare=function(e){if(t(e)||(e=o(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(v)},R.neg=R.negate,R.add=function(e){var n,r,s,a,u,c,l,h,f,g,d;return t(e)||(e=o(e)),n=this.high>>>16,r=65535&this.high,s=this.low>>>16,a=65535&this.low,u=e.high>>>16,c=65535&e.high,l=e.low>>>16,h=0,f=0,g=0,d=0,g+=(d+=a+(65535&e.low))>>>16,f+=(g+=s+l)>>>16,h+=(f+=r+c)>>>16,h+=n+u,i((g&=65535)<<16|(d&=65535),(h&=65535)<<16|(f&=65535),this.unsigned)},R.subtract=function(e){return t(e)||(e=o(e)),this.add(e.neg())},R.sub=R.subtract,R.multiply=function(e){var n,s,a,u,c,l,h,f,p,v,y,m;return this.isZero()?d:(t(e)||(e=o(e)),e.isZero()?d:this.eq(T)?e.isOdd()?T:d:e.eq(T)?this.isOdd()?T:d:this.isNegative()?e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg():e.isNegative()?this.mul(e.neg()).neg():this.lt(g)&&e.lt(g)?r(this.toNumber()*e.toNumber(),this.unsigned):(n=this.high>>>16,s=65535&this.high,a=this.low>>>16,u=65535&this.low,c=e.high>>>16,l=65535&e.high,h=e.low>>>16,p=0,v=0,y=0,m=0,y+=(m+=u*(f=65535&e.low))>>>16,v+=(y+=a*f)>>>16,y&=65535,v+=(y+=u*h)>>>16,p+=(v+=s*f)>>>16,v&=65535,p+=(v+=a*h)>>>16,v&=65535,p+=(v+=u*l)>>>16,p+=n*f+s*h+a*l+u*c,i((y&=65535)<<16|(m&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)))},R.mul=R.multiply,R.divide=function(e){var n,i,s,a,u,l,h;if(t(e)||(e=o(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?p:d;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return p;if(e.gt(this.shru(1)))return y;s=p}else{if(this.eq(T))return e.eq(v)||e.eq(m)?T:e.eq(T)?v:(n=this.shr(1).div(e).shl(1)).eq(d)?e.isNegative()?v:m:(i=this.sub(e.mul(n)),s=n.add(i.div(e)));if(e.eq(T))return this.unsigned?p:d;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=d}for(i=this;i.gte(e);){for(n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())),u=(a=Math.ceil(Math.log(n)/Math.LN2))<=48?1:c(2,a-48),h=(l=r(n)).mul(e);h.isNegative()||h.gt(i);)h=(l=r(n-=u,this.unsigned)).mul(e);l.isZero()&&(l=v),s=s.add(l),i=i.sub(h)}return s},R.div=R.divide,R.modulo=function(e){return t(e)||(e=o(e)),this.sub(this.div(e).mul(e))},R.mod=R.modulo,R.not=function(){return i(~this.low,~this.high,this.unsigned)},R.and=function(e){return t(e)||(e=o(e)),i(this.low&e.low,this.high&e.high,this.unsigned)},R.or=function(e){return t(e)||(e=o(e)),i(this.low|e.low,this.high|e.high,this.unsigned)},R.xor=function(e){return t(e)||(e=o(e)),i(this.low^e.low,this.high^e.high,this.unsigned)},R.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):i(0,this.low<<e-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):i(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(e){var n;return t(e)&&(e=e.toInt()),0==(e&=63)?this:(n=this.high,e<32?i(this.low>>>e|n<<32-e,n>>>e,this.unsigned):i(32===e?n:n>>>e-32,0,this.unsigned))},R.shru=R.shiftRightUnsigned,R.toSigned=function(){return this.unsigned?i(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:i(this.low,this.high,!0)},R.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,255&t>>>8,255&t>>>16,255&t>>>24,255&e,255&e>>>8,255&e>>>16,255&e>>>24]},R.toBytesBE=function(){var e=this.high,t=this.low;return[255&e>>>24,255&e>>>16,255&e>>>8,255&e,255&t>>>24,255&t>>>16,255&t>>>8,255&t]},e}()),tf));rf.getModule=function(e){var t=new rf[e];return t.getArrayData=function(){var e=t.toArrayBuffer();return e=Ls(e)?[].slice.call(new Int8Array(e)):e},t},function(e){e[e.ALL=1]="ALL",e[e.SINGAL=2]="SINGAL"}(nf||(nf={}));var sf,of=nf;!function(e){e.TextMessage="RC:TxtMsg",e.VOICE="RC:VcMsg",e.HQ_VOICE="RC:HQVCMsg",e.IMAGE="RC:ImgMsg",e.GIF="RC:GIFMsg",e.RICH_CONTENT="RC:ImgTextMsg",e.LOCATION="RC:LBSMsg",e.FILE="RC:FileMsg",e.SIGHT="RC:SightMsg",e.COMBINE="RC:CombineMsg",e.CHRM_KV_NOTIFY="RC:chrmKVNotiMsg",e.LOG_COMMAND="RC:LogCmdMsg",e.EXPANSION_NOTIFY="RC:MsgExMsg",e.REFERENCE="RC:ReferenceMsg",e.RECALL="RC:RcCmd",e.READ_RECEIPT="RC:ReadNtf",e.READ_RECEIPT_REQUEST="RC:RRReqMsg",e.READ_RECEIPT_RESPONSE="RC:RRRspMsg",e.SYNC_READ_STATUS="RC:SRSMsg",e.GROUP_READ_RECEIPT_REQUEST="RC:RRMsg"}(sf||(sf={}));var af,uf=sf;!function(e){e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE"}(af||(af={}));var cf,lf,hf,ff,gf=af,df="pgMsgP",pf="chatMsg",vf="pcMsgP",yf={PRIVATE:"ppMsgS",GROUP:"pgMsgS",CHATROOM:"chatMsgS"},mf="delMsg",_f="joinChrm",Ef="joinChrmR",Tf="exitChrm",Rf="setKV",If="delKV",Cf="qryRelationR",Sf="delRelation",bf="setSeAtt",wf={PRIVATE:"cleanPMsg",GROUP:"cleanGMsg",CUSTOMER_SERVICE:"cleanCMsg",SYSTEM:"cleanSMsg"},Of="qryPMsg",Nf="qryGMsg",kf="qryCHMsg",Af="qryCMsg",Mf="qrySMsg",xf=(St(cf={},"ppMsgP",ws.PRIVATE),St(cf,df,ws.GROUP),St(cf,pf,ws.CHATROOM),St(cf,vf,ws.CUSTOMER_SERVICE),cf),Lf=(St(lf={},ws.PRIVATE,Of),St(lf,ws.GROUP,Nf),St(lf,ws.CHATROOM,kf),St(lf,ws.CUSTOMER_SERVICE,Af),St(lf,ws.SYSTEM,Mf),lf),Uf=(St(hf={},ws.PRIVATE,wf.PRIVATE),St(hf,ws.GROUP,wf.GROUP),St(hf,ws.CUSTOMER_SERVICE,wf.CUSTOMER_SERVICE),St(hf,ws.SYSTEM,wf.SYSTEM),hf),Pf="1",Df="0",Vf=1,Bf=2,Ff=3;!function(e){e[e.SEND=1]="SEND",e[e.RECEIVE=2]="RECEIVE"}(ff||(ff={}));var Yf=ff,jf=function(){function e(t){Rt(this,e),this._codec="websocket"===t?rf:Kh,this._connectType=t}return Ct(e,[{key:"decodeByPBName",value:function(e,t,n){var r,i=this,s=e,o=(St(r={},xl,i._formatSyncMessages),St(r,Ml,i._formatReceivedMessage),St(r,kl,i._formatSentMessage),St(r,Fl,i._formatHistoryMessages),St(r,jl,i._formatConversationList),St(r,$l,i._formatChatRoomInfos),St(r,eh,i._formatRTCUserList),St(r,uh,i._formatRTCData),St(r,Rh,i._formatChatRoomKVList),St(r,wh,i._formatUserSetting),St(r,kh,i._formatConversationStatus),St(r,Dh,i._formatGrpReadReceiptQryResp),St(r,Sh,i._formatSetUserSettingOutput),St(r,Oh,i._formatUserSettingNotification),r)[t];try{s=e.length>0&&i._codec[t].decode(e),Ps(s)&&(s=function(e){for(var t in e)Ps(e[t])&&(e[t]=bo(e[t]));return e}(s)),Ds(o)&&(s=o.call(this,s,n))}catch(n){Hs.error("PB parse error\n",n,e,t)}return s}},{key:"_readBytes",value:function(e){var t=e.offset,n=e.buffer,r=e.limit;if(t)try{var i=Ls(n)?new Uint8Array(n):n;return wl.readUTF(i.subarray(t,r))}catch(e){Hs.info("readBytes error\n",e)}return e}},{key:"_formatBytes",value:function(e){var t=this._readBytes(e);try{t=JSON.parse(t)}catch(e){Hs.info("formatBytes error\n",e)}return t||e}},{key:"_formatSyncMessages",value:function(e,t){t=t||{};var n=this,r=e.list,i=e.syncTime,s=e.finished;return(Vs(s)||null===s)&&(e.finished=!0),e.syncTime=bo(i),e.list=xo(r,(function(e){return n._formatReceivedMessage(e,t)})),e}},{key:"_formatReceivedMessage",value:function(e,t){var r=t=t||{},i=r.currentUserId,s=r.connectedTime,o=e.content,a=e.fromUserId,u=e.type,c=e.groupId,l=e.status,h=e.dataTime,f=e.classname,g=e.msgId,d=e.extraContent,p=e.pushContent,v=e.pushExt,y=e.configFlag,m=(e.direction||Yf.RECEIVE)===Yf.SEND,_=function(e){var t=n.READ;return{isPersited:!!(16&e),isCounted:!!(32&e),isMentioned:!!(64&e),disableNotification:!!(512&e),receivedStatus:t=2&e?n.RETRIEVED:t,canIncludeExpansion:!!(1024&e)}}(l),E=_.isPersited,T=_.isCounted,R=_.isMentioned,I=_.disableNotification,C=_.receivedStatus,S=_.canIncludeExpansion,b=[ws.GROUP,ws.CHATROOM,ws.RTC_ROOM].indexOf(u)>-1?c:a,w=m?i:a,O=bo(h),N=O<s,k=u===ws.CHATROOM,A=this._formatBytes(o),M={};v&&(M=No(v.pushConfigs,v.pushId));var x,L=wt(wt({},M),{},{pushTitle:null==v?void 0:v.title,pushContent:p,pushData:p,disablePushTitle:!!y&&Boolean(4&y),forceShowDetailContent:!!y&&Boolean(8&y),templateId:null==v?void 0:v.templateId}),U=m?Yf.SEND:Yf.RECEIVE;return k&&a===i&&(U=Yf.SEND),d&&(x={},x=qo(d)),{conversationType:u,targetId:b,senderUserId:w,messageType:f,messageUId:g,isPersited:E,isCounted:T,isMentioned:R,sentTime:O,isOffLineMessage:N,messageDirection:U,receivedTime:Go.getTime(),disableNotification:I,receivedStatus:C,canIncludeExpansion:S,content:A,expansion:x,configFlag:y,pushConfig:L}}},{key:"_formatSentMessage",value:function(e,t){var n,r=e.content,i=e.classname,s=e.sessionId,o=e.msgId,a=e.extraContent,u=e.pushExt,c=e.pushContent,l=e.configFlag,h=t.signal,f=t.currentUserId,g=h.date,d=h.topic,p=h.targetId,v=function(e){return{isPersited:!!(1&e),isCounted:!!(2&e),disableNotification:!!(32&e),canIncludeExpansion:!!(64&e)}}(s),y=v.isPersited,m=v.isCounted,_=v.disableNotification,E=v.canIncludeExpansion,T=xf[d]||ws.PRIVATE,R=Uo(yf,d);a&&(n={},n=qo(a));var I={};u&&(I=No(u.pushConfigs,u.pushId));var C=wt(wt({},I),{},{pushTitle:null==u?void 0:u.title,pushContent:c,pushData:c,disablePushTitle:!!l&&Boolean(4&l),forceShowDetailContent:!!l&&Boolean(8&l),templateId:null==u?void 0:u.templateId});return{conversationType:T,targetId:p,messageType:i,messageUId:o,isPersited:y,isCounted:m,isStatusMessage:R,senderUserId:f,content:this._formatBytes(r),sentTime:1e3*g,receivedTime:Go.getTime(),messageDirection:Yf.SEND,isOffLineMessage:!1,disableNotification:_,canIncludeExpansion:E,expansion:n,pushConfig:C}}},{key:"_formatHistoryMessages",value:function(e,t){var n=this,r=t.conversation||{},i=e.list,s=e.hasMsg,o=r.targetId,a=bo(e.syncTime),u=[];return Mo(i,(function(e){var r=n._formatReceivedMessage(e,t);r.targetId=o,u.push(r)}),{isReverse:!0}),{syncTime:a,list:u,hasMore:!!s}}},{key:"_formatConversationList",value:function(e,t){var n=this,r=e.info,i=t.afterDecode||function(){};return(r=xo(r,(function(e){var r=e.msg,s=e.userId,o=e.type,a=e.unreadCount,u=e.channelId,c=n._formatReceivedMessage(r,t);c.targetId=s;var l={targetId:s,conversationType:o,unreadMessageCount:a,latestMessage:c,channelId:u||""};return i(l)||l})))||[]}},{key:"_formatSetUserSettingOutput",value:function(e){return e}},{key:"_formatChatRoomInfos",value:function(e){var t=e.userTotalNums,n=e.userInfos;return{userCount:t,userInfos:xo(n,(function(e){var t=e.id,n=e.time;return{id:t,time:bo(n)}}))}}},{key:"_formatChatRoomKVList",value:function(e){var t=e.entries,n=e.bFullUpdate,r=e.syncTime;return{kvEntries:t=xo(t=t||[],(function(e){var t=e.key,n=e.value,r=e.status,i=e.timestamp,s=e.uid,o=function(e){return{isAutoDelete:!!(1&e),isOverwrite:!!(2&e),type:4&e?jo.DELETE:jo.UPDATE}}(r);return{key:t,value:n,isAutoDelete:o.isAutoDelete,isOverwrite:o.isOverwrite,type:o.type,userId:s,timestamp:bo(i)}})),isFullUpdate:n,syncTime:r}}},{key:"_formatUserSetting",value:function(e){var t=this,n=e.items,r=e.version,i={};return Mo(n||[],(function(e){var n=e.key,r=e.version,s=e.value;e.version=bo(r),e.value=t._readBytes(s),"Tag"===n&&e.tags.forEach((function(e){e.createdTime=bo(e.createdTime),e.tagName=e.name})),i[n]=e})),{settings:i,version:r}}},{key:"_formatConversationStatus",value:function(e){var t=e.state,n=[];return Mo(t,(function(e){var t=e.type,r=e.channelId,i=e.time,s=e.stateItem,o=gf.CLOSE,a=!1,u=[];Mo(s,(function(e){var t=e.sessionStateType,n=e.value,r=e.tags;switch(t){case Vf:o=n===Pf?gf.OPEN:gf.CLOSE;break;case Bf:a=n===Pf;break;case Ff:u=r}})),n.push({type:t,targetId:r,notificationStatus:o,isTop:a,updatedTime:bo(i),tags:u})})),n}},{key:"_formatRTCUserList",value:function(e){var t=e.list,n=e.token,r=e.sessionId,i={};return Mo(t,(function(e){var t=e.userId,n=e.userData,r={};Mo(n,(function(e){var t=e.key,n=e.value;r[t]=n})),i[t]=r})),{users:i,token:n,sessionId:r}}},{key:"_formatRTCData",value:function(e){var t=e.outInfo,n={};return Mo(t,(function(e){n[e.key]=e.value})),n}},{key:"_formatRTCRoomInfo",value:function(e){var t=e.roomId,n=e.userCount,r=e.roomData,i={id:t,total:n};return Mo(r,(function(e){i[e.key]=e.value})),i}},{key:"_formatGrpReadReceiptQryResp",value:function(e){var t=e.totalMemberNum,n=e.list;return n.forEach((function(e){e.readTime=bo(e.readTime)})),{totalMemberCount:t,list:n}}},{key:"_formatUserSettingNotification",value:function(e){return e}},{key:"encodeServerConfParams",value:function(){var e=this._codec.getModule(Ll);return e.setNothing(1),e.getArrayData()}},{key:"_getUpMsgModule",value:function(e,t){var n="comet"===this._connectType,r=e.type,i=t.messageType,s=t.isMentioned,o=t.mentionedType,a=t.mentionedUserIdList,u=t.content,c=t.pushContent,l=t.directionalUserIdList,h=t.isFilerWhiteBlacklist,f=t.isVoipPush,g=t.canIncludeExpansion,d=t.expansion,p=t.pushConfig,v=r===ws.GROUP,y=this._codec.getModule(kl),m=function(e){var t=e.isStatusMessage,n=e.isPersited,r=e.isCounted;t&&(n=r=!1);var i=0;return n&&(i|=1),r&&(i|=2),e.isMentioned&&(i|=4),e.disableNotification&&(i|=32),e.canIncludeExpansion&&(i|=64),i}(t),_=p||{},E=_.pushTitle,T=_.pushData,R=_.iOSConfig,I=_.androidConfig,C=_.templateId,S=_.disablePushTitle,b=_.forceShowDetailContent,w=0;if(y.setSessionId(m),v&&s&&u&&(u.mentionedInfo={userIdList:a,type:o||of.ALL}),c&&y.setPushText(c),T&&y.setAppData(T),l&&y.setUserId(l),w|=f?1:0,w|=h?2:0,w|=S?4:0,w|=b?8:0,y.setConfigFlag(w),y.setClassname(i),y.setContent(JSON.stringify(u)),g&&d){var O={};Mo(d,(function(e,t){O[t]={v:e}})),y.setExtraContent(JSON.stringify(O))}if(p){var N=this._codec.getModule(Al);if(E&&N.setTitle(E),R&&I){var k=Oo(R,I);N.setPushConfigs(k)}(null==I?void 0:I.notificationId)&&N.setPushId(null==I?void 0:I.notificationId),N.setTemplateId(C||""),y.setPushExt(n?N.getArrayData():N)}return y}},{key:"encodeUpMsg",value:function(e,t){return this._getUpMsgModule(e,t).getArrayData()}},{key:"encodeSyncMsg",value:function(e){var t=e.sendboxTime,n=e.inboxTime,r=this._codec.getModule(Pl);return r.setIspolling(!1),r.setIsPullSend(!0),r.setSendBoxSyncTime(t),r.setSyncTime(n),r.getArrayData()}},{key:"encodeChrmSyncMsg",value:function(e,t){e=e||0,t=t||0;var n=this._codec.getModule(Dl);return n.setCount(t),n.setSyncTime(e),n.getArrayData()}},{key:"encodeGetHistoryMsg",value:function(e,t){var n=t.count,r=t.order,i=t.timestamp,s=this._codec.getModule(Bl);return s.setTargetId(e),s.setTime(i),s.setCount(n),s.setOrder(r),s.getArrayData()}},{key:"encodeGetConversationList",value:function(e){var t=e=e||{},n=t.count,r=t.startTime,i=this._codec.getModule(Yl);return i.setType(1),i.setCount(n),i.setStartTime(r),i.getArrayData()}},{key:"encodeOldConversationList",value:function(e){var t=e=e||{},n=t.count,r=t.type,i=t.startTime,s=t.order;n=n||0,i=i||0,s=s||0;var o=this._codec.getModule(Yl);return o.setType(r),o.setCount(n),o.setStartTime(i),o.setOrder(s),o.getArrayData()}},{key:"encodeRemoveConversationList",value:function(e){var t=this,n=this._codec.getModule(ql),r=[];return Mo(e,(function(e){var n=e.type,i=e.targetId,s=t._codec.getModule(Gl);s.setType(n),s.setChannelId(i),r.push(s)})),n.setSessions(r),n.getArrayData()}},{key:"encodeDeleteMessages",value:function(e,t,n){var r=this._codec.getModule(Wl),i=[];return Mo(n,(function(e){i.push({msgId:e.messageUId,msgDataTime:e.sentTime,direct:e.messageDirection})})),r.setType(e),r.setConversationId(t),r.setMsgs(i),r.getArrayData()}},{key:"encodeClearMessages",value:function(e,t){var n=this._codec.getModule(Ql);return t=t||(new Date).getTime(),n.setDataTime(t),n.setTargetId(e),n.getArrayData()}},{key:"encodeClearUnreadCount",value:function(e,t){var n=e.type,r=e.targetId,i=t.timestamp,s=this._codec.getModule(zl);return i=i||+new Date,s.setType(n),s.setChannelId(r),s.setMsgTime(i),s.getArrayData()}},{key:"encodeJoinOrQuitChatRoom",value:function(){var e=this._codec.getModule(Jl);return e.setNothing(1),e.getArrayData()}},{key:"encodeGetChatRoomInfo",value:function(e,t){var n=this._codec.getModule(Zl);return n.setCount(e),n.setOrder(t),n.getArrayData()}},{key:"encodeGetFileToken",value:function(e,t,n,r){var i=this._codec.getModule(ph);return i.setType(e),i.setKey(t),i.setHttpMethod(n),i.setQueryString(r),i.getArrayData()}},{key:"encodeGetFileUrl",value:function(e,t,n,r){var i=this._codec.getModule(e);return i.setType(t),i.setKey(n),r&&i.setFileName(r),i.getArrayData()}},{key:"encodeModifyChatRoomKV",value:function(e,t,n){var r="comet"===this._connectType,i=this._codec.getModule(Th),s=t.key,o=t.value,a=t.notificationExtra,u=t.isSendNotification,c=t.type||jo.UPDATE,l=function(e,t){var n=0;return e.isAutoDelete&&(n|=1),e.isOverwrite&&(n|=2),2===t&&(n|=4),n}(t,c),h={key:s,value:o||"",uid:n};if(Vs(l)||(h.status=l),i.setEntry(h),u){var f={type:ws.CHATROOM,targetId:e},g={key:s,value:o,extra:a,type:c},d=this._getUpMsgModule(f,{messageType:uf.CHRM_KV_NOTIFY,content:g,isPersited:!1,isCounted:!1});r?i.setNotification(d.getArrayData()):i.setNotification(d),i.setBNotify(!0),i.setType(ws.CHATROOM)}return i.getArrayData()}},{key:"encodePullChatRoomKV",value:function(e){var t=this._codec.getModule(Ih);return t.setTimestamp(e),t.getArrayData()}},{key:"encodePullUserSetting",value:function(e){var t=this._codec.getModule(bh);return t.setVersion(e),t.getArrayData()}},{key:"encodeGetConversationStatus",value:function(e){var t=this._codec.getModule(Nh);return t.setTime(e),t.getArrayData()}},{key:"encodeSetConversationStatus",value:function(e){var t=this,n="comet"===this._connectType,r=this._codec.getModule(xh),i=Go.getTime(),s=[];return Mo(e,(function(e){var r=t._codec.getModule(Ah),o=e.conversationType,a=e.targetId,u=e.notificationStatus,c=e.isTop,l=[];r.setType(o),r.setChannelId(a),r.setTime(i);var h=u===gf.OPEN,f={};Vs(u)||(f[Vf]=h),Vs(c)||(f[Bf]=c),Mo(f,(function(e,r){if(!Vs(e)){var i=t._codec.getModule(Mh);e=e?Pf:Df,i.setSessionStateType(Number(r)),i.setValue(e);var s=n?i.getArrayData():i;l.push(s)}})),r.setStateItem(l);var g=n?r.getArrayData():r;s.push(g)})),r.setVersion(i),r.setState(s),r.getArrayData()}},{key:"encodeReadReceipt",value:function(e,t){var n=this._codec.getModule(Uh);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()}},{key:"encodeCreateTag",value:function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(Bh),s=[];return e.forEach((function(e){var t=n._codec.getModule(Fh);t.setTagId(e.tagId),t.setName(e.tagName),s.push(r?t.getArrayData():t)})),i.setTags(s),i.setVersion(t),i.getArrayData()}},{key:"encodeMessageReader",value:function(e,t){var n=this._codec.getModule(Uh);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()}},{key:"encodeRemoveTag",value:function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(Yh),s=[];return e.forEach((function(e){var t=n._codec.getModule(Fh);t.setTagId(e),s.push(r?t.getArrayData():t)})),i.setTags(s),i.setVersion(t),i.getArrayData()}},{key:"encodeDisConversationTag",value:function(e){var t=this._codec.getModule(jh);return t.setTagId(e),t.getArrayData()}},{key:"encodeUpdateConversationTag",value:function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(xh),s=[];return t.forEach((function(t){var i=n._codec.getModule(Ah),o=n._codec.getModule(Mh),a=[];e.forEach((function(e){var t=n._codec.getModule(Fh);t.setTagId(e.tagId),Vs(e.isTop)||t.setIsTop(e.isTop),a.push(r?t.getArrayData():t)})),o.setSessionStateType(Ff),o.setValue(JSON.stringify(a)),o.setTags(a),i.setType(t.type),i.setChannelId(t.targetId),i.setTime(Date.now()),i.setStateItem([r?o.getArrayData():o]),s.push(r?i.getArrayData():i)})),i.setState(s),i.setVersion(Go.getTime()),i.getArrayData()}},{key:"encodeReportSDKInfo",value:function(e){var t=this._codec.getModule(qh);return t.setSdkInfo(e),t.getArrayData()}},{key:"encodeJoinRTCRoom",value:function(e,t){var n=this._codec.getModule(Xl);return e=e||0,n.setRoomType(e),Vs(t)||n.setBroadcastType(t),n.getArrayData()}},{key:"encodeQuitRTCRoom",value:function(){return this._codec.getModule(th).getArrayData()}},{key:"encodeSetRTCData",value:function(e,t,n,r,i){var s=this._codec.getModule(nh);if(s.setInterior(n),s.setTarget(r),s.setKey(e),s.setValue(t),i){i.name&&s.setObjectName(i.name);var o=i.content;o&&(Ps(o)&&(o=JSON.stringify(o)),s.setContent(o))}return s.getArrayData()}},{key:"encodeUserSetRTCData",value:function(e,t,n){var r=this._codec.getModule(rh);r.setObjectName(n);var i=this._codec.getModule(gh);return i.setKey(e.name),i.setValue(e.content),r.setContent(i),(i=this._codec.getModule(gh)).setKey("uris"),i.setValue(t),r.setValueInfo(i),r.getArrayData()}},{key:"encodeGetRTCData",value:function(e,t,n){var r=this._codec.getModule(ih);return r.setInterior(t),r.setTarget(n),r.setKey(e),r.getArrayData()}},{key:"encodeRemoveRTCData",value:function(e,t,n,r){var i=this._codec.getModule(ih);i.setInterior(t),i.setTarget(n),i.setKey(e);var s=r=r||{},o=s.name,a=s.content;return!Vs(o)&&i.setObjectName(o),Vs(a)||(Ps(a)&&(a=JSON.stringify(a)),i.setContent(a)),i.getArrayData()}},{key:"encodeSetRTCOutData",value:function(e,t,n){var r=this._codec.getModule(sh);r.setTarget(t),xs(e)||(e=[e]),Mo(e,(function(t,n){t.key=t.key?t.key.toString():t.key,t.value=t.value?t.value.toString():t.value,e[n]=t})),r.setValueInfo(e);var i=n=n||{},s=i.name,o=i.content;return!Vs(s)&&r.setObjectName(s),Vs(o)||(Ps(o)&&(o=JSON.stringify(o)),r.setContent(o)),r.getArrayData()}},{key:"ecnodeGetRTCOutData",value:function(e){var t=this._codec.getModule(ch);return t.setUserId(e),t.getArrayData()}},{key:"encodeSetRTCState",value:function(e){var t=this._codec.getModule(oh);return t.setId(e),t.getArrayData()}},{key:"encodeGetRTCRoomInfo",value:function(){var e=this._codec.getModule(hh);return e.setOrder(2),e.getArrayData()}},{key:"encodeSetRTCUserInfo",value:function(e,t){var n=this._codec.getModule(gh);return n.setKey(e),n.setValue(t),n.getArrayData()}},{key:"encodeRemoveRTCUserInfo",value:function(e){var t=this._codec.getModule(dh);return t.setKey(e),t.getArrayData()}}]),e}(),qf=function e(t,n){Rt(this,e),this._watcher=n,this.codec=new jf(t)},Gf=function(e,t){return e&&t?t+"_"+e:e||Date.now()},Hf=function(){function e(t){Rt(this,e),this.header=t,this._name=null,this.lengthSize=0,this.messageId=0,this.timestamp=0,this.syncMsg=!1,this.identifier=""}return Ct(e,[{key:"getIdentifier",value:function(){var e=this.messageId,t=this.identifier;return Gf(e,t)}},{key:"read",value:function(e,t){this.readMessage(e,t)}},{key:"readMessage",value:function(e,t){return{stream:e,length:t}}}]),e}(),Kf=function(){function e(t){Rt(this,e),this.lengthSize=0,this.messageId=0,this.topic="",this.targetId="",this.identifier="",this._header=new bl(t,!1,rl.AT_MOST_ONCE,!1)}return Ct(e,[{key:"getIdentifier",value:function(){var e=this.messageId,t=this.identifier;return Gf(e,t)}},{key:"write",value:function(e){var t=this.getHeaderFlag();e.write(t),this.writeMessage(e)}},{key:"setHeaderQos",value:function(e){this._header.qos=e}},{key:"getHeaderFlag",value:function(){return this._header.encode()}},{key:"getLengthSize",value:function(){return this.lengthSize}},{key:"getBufferData",value:function(){var e=new Nl;this.write(e);var t=e.getBytesArray();return new Int8Array(t)}},{key:"getCometData",value:function(){var e=this.data||{};return JSON.stringify(e)}}]),e}(),Wf=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.apply(this,arguments))._name=sl.CONN_ACK,e.status=null,e.userId=null,e.timestamp=0,e}return Ct(n,[{key:"readMessage",value:function(e,t){if(e.readByte(),this.status=+e.readByte(),t>n.MESSAGE_LENGTH){this.userId=e.readUTF();var r=e.readUTF();Hs.debug("server sessionId -> "+r),this.timestamp=e.readLong()}return{stream:e,length:t}}}]),n}(Hf);Wf.MESSAGE_LENGTH=2;var Qf=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.apply(this,arguments))._name=sl.DISCONNECT,e.status=0,e}return Ct(n,[{key:"readMessage",value:function(e,t){return e.readByte(),this.status=+e.readByte(),{stream:e,length:t}}}]),n}(Hf);Qf.MESSAGE_LENGTH=2;var zf,Jf=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.call(this,il.PING_REQ))._name=sl.PING_REQ,e}return Ct(n,[{key:"writeMessage",value:function(e){}}]),n}(Kf),Zf=function(e){Ot(n,e);var t=Pt(n);function n(e){var r;return Rt(this,n),(r=t.call(this,e))._name=sl.PING_RESP,r}return n}(Hf),$f=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.apply(this,arguments)).messageId=0,e}return Ct(n,[{key:"readMessage",value:function(e,t){var n=256*e.readByte()+e.readByte();return this.messageId=parseInt(n.toString(),10),{stream:e,length:t}}}]),n}(Hf),Xf=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.apply(this,arguments)).messageId=0,e}return Ct(n,[{key:"writeMessage",value:function(e){var t=this.messageId,n=255&t,r=(65280&t)>>8;e.write(r),e.write(n)}}]),n}(Kf),eg=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.apply(this,arguments))._name=sl.PUBLISH,e.topic="",e.targetId="",e.syncMsg=!1,e.identifier=ol.PUB,e}return Ct(n,[{key:"readMessage",value:function(e,t){return this.date=e.readInt(),this.topic=e.readUTF(),this.targetId=e.readUTF(),Dt(Nt(n.prototype),"readMessage",this).call(this,e,t),this.data=e.readAll(),{stream:e,length:t}}}]),n}($f),tg=function(e){Ot(n,e);var t=Pt(n);function n(e,r,i){var s;return Rt(this,n),(s=t.call(this,il.PUBLISH))._name=sl.PUBLISH,s.syncMsg=!1,s.identifier=ol.PUB,s.topic=e,s.data=ks(r)?wl.writeUTF(r):r,s.targetId=i,s}return Ct(n,[{key:"writeMessage",value:function(e){e.writeUTF(this.topic),e.writeUTF(this.targetId),Dt(Nt(n.prototype),"writeMessage",this).call(this,e),e.write(this.data)}}]),n}(Xf),ng=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.apply(this,arguments))._name=sl.PUB_ACK,e.status=0,e.date=0,e.millisecond=0,e.messageUId="",e.timestamp=0,e.identifier=ol.PUB,e.topic="",e.targetId="",e}return Ct(n,[{key:"readMessage",value:function(e,t){return Dt(Nt(n.prototype),"readMessage",this).call(this,e,t),this.date=e.readInt(),this.status=256*e.readByte()+e.readByte(),this.millisecond=256*e.readByte()+e.readByte(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=e.readUTF(),{stream:e,length:t}}}]),n}($f),rg=function(e){Ot(n,e);var t=Pt(n);function n(e){var r;return Rt(this,n),(r=t.call(this,il.PUB_ACK))._name=sl.PUB_ACK,r.status=0,r.date=0,r.millisecond=0,r.messageUId="",r.timestamp=0,r.messageId=e,r}return Ct(n,[{key:"writeMessage",value:function(e){Dt(Nt(n.prototype),"writeMessage",this).call(this,e)}}]),n}(Xf),ig=function(e){Ot(n,e);var t=Pt(n);function n(e,r,i){var s;return Rt(this,n),(s=t.call(this,il.QUERY)).name=sl.QUERY,s.identifier=ol.QUERY,s.topic=e,s.data=ks(r)?wl.writeUTF(r):r,s.targetId=i,s}return Ct(n,[{key:"writeMessage",value:function(e){e.writeUTF(this.topic),e.writeUTF(this.targetId),Dt(Nt(n.prototype),"writeMessage",this).call(this,e),e.write(this.data)}}]),n}(Xf),sg=function(e){Ot(n,e);var t=Pt(n);function n(e){var r;return Rt(this,n),(r=t.call(this,il.QUERY_CONFIRM))._name=sl.QUERY_CON,r.messageId=e,r}return n}(Xf),og=function(e){Ot(n,e);var t=Pt(n);function n(){var e;return Rt(this,n),(e=t.apply(this,arguments))._name=sl.QUERY_ACK,e.status=0,e.identifier=ol.QUERY,e.topic="",e.targetId="",e}return Ct(n,[{key:"readMessage",value:function(e,t){return Dt(Nt(n.prototype),"readMessage",this).call(this,e,t),this.date=e.readInt(),this.status=256*e.readByte()+e.readByte(),this.data=e.readAll(),{stream:e,length:t}}}]),n}($f),ag=function(e){var t,n=e.type;switch(n){case il.CONN_ACK:t=new Wf(e);break;case il.PUBLISH:(t=new eg(e)).syncMsg=e.syncMsg;break;case il.PUB_ACK:t=new ng(e);break;case il.QUERY_ACK:t=new og(e);break;case il.SUB_ACK:case il.UNSUB_ACK:case il.PING_RESP:t=new Zf(e);break;case il.DISCONNECT:t=new Qf(e);break;default:t=new Hf(e),Hs.error("No support for deserializing "+n+" messages")}return t},ug=function(e){var t=new Uint8Array(e),n=new Ol(t),r=n.readByte(),i=new bl(r),s=ag(i);return s.read(n,t.length-1),s},cg=function(e){var t=e.headerCode,n=new bl(t),r=ag(n);for(var i in e)r[i]=e[i];return r},lg={ACCEPTED:0,UNACCEPTABLE_PROTOCOL_VERSION:1,IDENTIFIER_REJECTED:2,SERVER_UNAVAILABLE:3,TOKEN_INCORRECT:4,NOT_AUTHORIZED:5,REDIRECT:6,PACKAGE_ERROR:7,APP_BLOCK_OR_DELETE:8,BLOCK:9,TOKEN_EXPIRE:10,DEVICE_ERROR:11,HOSTNAME_ERROR:12,HASOHTERSAMECLIENTONLINE:13};!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.NETWORK_UNAVAILABLE=3]="NETWORK_UNAVAILABLE",e[e.CONNECTION_CLOSED=4]="CONNECTION_CLOSED",e[e.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",e[e.WEBSOCKET_UNAVAILABLE=7]="WEBSOCKET_UNAVAILABLE",e[e.WEBSOCKET_ERROR=8]="WEBSOCKET_ERROR",e[e.BLOCKED=9]="BLOCKED",e[e.DOMAIN_INCORRECT=12]="DOMAIN_INCORRECT",e[e.DISCONNECT_BY_SERVER=13]="DISCONNECT_BY_SERVER",e[e.REDIRECT=14]="REDIRECT",e[e.APPKEY_IS_FAKE=20]="APPKEY_IS_FAKE",e[e.ULTRALIMIT=1101]="ULTRALIMIT",e[e.REQUEST_NAVI=201]="REQUEST_NAVI",e[e.RESPONSE_NAVI=202]="RESPONSE_NAVI",e[e.RESPONSE_NAVI_ERROR=203]="RESPONSE_NAVI_ERROR",e[e.RESPONSE_NAVI_TIMEOUT=204]="RESPONSE_NAVI_TIMEOUT"}(zf||(zf={}));var hg,fg=zf;!function(e){e[e.ppMsgP=1]="ppMsgP",e[e.ppMsgN=2]="ppMsgN",e[e.ppMsgS=3]="ppMsgS",e[e.pgMsgP=4]="pgMsgP",e[e.chatMsg=5]="chatMsg",e[e.pcMsgP=6]="pcMsgP",e[e.qryPMsg=7]="qryPMsg",e[e.qryGMsg=8]="qryGMsg",e[e.qryCHMsg=9]="qryCHMsg",e[e.qryCMsg=10]="qryCMsg",e[e.qrySMsg=11]="qrySMsg",e[e.recallMsg=12]="recallMsg",e[e.prMsgS=13]="prMsgS",e[e.rrMsg=14]="rrMsg",e[e.rrList=15]="rrList",e[e.s_ntf=16]="s_ntf",e[e.s_msg=17]="s_msg",e[e.s_stat=18]="s_stat",e[e.s_cmd=19]="s_cmd",e[e.s_us=20]="s_us",e[e.pullUS=21]="pullUS",e[e.pgMsgS=22]="pgMsgS",e[e.chatMsgS=23]="chatMsgS",e[e.qrySessionsAtt=24]="qrySessionsAtt",e[e.pullMsg=25]="pullMsg",e[e.qrySessions=26]="qrySessions",e[e.delSessions=27]="delSessions",e[e.delMsg=28]="delMsg",e[e.updRRTime=29]="updRRTime",e[e.chrmPull=30]="chrmPull",e[e.joinChrm=31]="joinChrm",e[e.joinChrmR=32]="joinChrmR",e[e.exitChrm=33]="exitChrm",e[e.queryChrmI=34]="queryChrmI",e[e.setKV=35]="setKV",e[e.delKV=36]="delKV",e[e.pullKV=37]="pullKV",e[e.qryRelation=38]="qryRelation",e[e.delRelation=39]="delRelation",e[e.pullSeAtts=40]="pullSeAtts",e[e.setSeAtt=41]="setSeAtt",e[e.qnTkn=42]="qnTkn",e[e.qnUrl=43]="qnUrl",e[e.aliUrl=44]="aliUrl",e[e.s3Url=45]="s3Url",e[e.stcUrl=46]="stcUrl",e[e.cleanPMsg=47]="cleanPMsg",e[e.cleanGMsg=48]="cleanGMsg",e[e.cleanCMsg=49]="cleanCMsg",e[e.cleanSMsg=50]="cleanSMsg",e[e.rtcRJoin_data=51]="rtcRJoin_data",e[e.rtcRExit=52]="rtcRExit",e[e.rtcPing=53]="rtcPing",e[e.rtcSetData=54]="rtcSetData",e[e.userSetData=55]="userSetData",e[e.rtcQryData=56]="rtcQryData",e[e.rtcDelData=57]="rtcDelData",e[e.rtcSetOutData=58]="rtcSetOutData",e[e.rtcQryUserOutData=59]="rtcQryUserOutData",e[e.rtcToken=60]="rtcToken",e[e.rtcUserState=61]="rtcUserState",e[e.rtcRInfo=62]="rtcRInfo",e[e.rtcUData=63]="rtcUData",e[e.rtcUPut=64]="rtcUPut",e[e.rtcUDel=65]="rtcUDel",e[e.rtcUList=66]="rtcUList",e[e.addSeTag=67]="addSeTag",e[e.delSeTag=68]="delSeTag",e[e.addTag=69]="addTag",e[e.delTag=70]="delTag",e[e.disTag=71]="disTag",e[e.reportsdk=72]="reportsdk"}(hg||(hg={}));var gg,dg,pg=hg,vg=(gg=Tt(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=Tt(regeneratorRuntime.mark((function e(t){var i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Date.now(),s="".concat(n,"://").concat(t,"/ping?r=").concat(Is(1e3,9999)),e.next=4,r.httpReq({url:s,timeout:5e3});case 4:return o=e.sent,e.abrupt("return",{status:o.status,host:t,cost:Date.now()-i});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return(i=(i=e.sent).filter((function(e){return 200===e.status}))).length>1&&(i=i.sort((function(e,t){return e.cost-t.cost}))),e.abrupt("return",i.map((function(e){return e.host})));case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return gg.apply(this,arguments)}),yg=function(e,t,n,r,i,s,o){return"".concat(e,"://").concat(t,"/websocket?appId=").concat(n,"&token=").concat(encodeURIComponent(r),"&sdkVer=").concat(s,"&pid=").concat(o,"&apiVer=").concat(i.isFromUniapp?"uniapp":"normal").concat(i.connectPlatform?"&platform="+i.connectPlatform:"")},mg=function(e){return[pg.ppMsgS,pg.pgMsgS,pg.chatMsgS].map((function(e){return pg[e]})).indexOf(e)>=0};!function(e){e[e.REDIRECT=0]="REDIRECT",e[e.OTHER_DEVICE_LOGIN=1]="OTHER_DEVICE_LOGIN",e[e.BLOCK=2]="BLOCK",e[e.REMOTE_CLOSE=3]="REMOTE_CLOSE",e[e.LOGOUT=4]="LOGOUT",e[e.BLOCK_NEW=5]="BLOCK_NEW",e[e.REDIRECT_NEW=6]="REDIRECT_NEW"}(dg||(dg={}));var _g,Eg=function(e,t){Hs.debug("websocket send -> messageId: ".concat(e.messageId));var n=e.getBufferData();t.send(n.buffer)},Tg=function(e){Ot(o,e);var t,n,r,i,s=Pt(o);function o(e,t){var n;return Rt(this,o),(n=s.call(this,"websocket",t))._runtime=e,n._socket=null,n._messageIds={},n._syncMessageIds={},n._failedCount=0,n.ALLOW_FAILED_TIMES=2,n._timer=null,n._idCount=0,n._generateMessageId=function(){return n._idCount>=65535&&(n._idCount=0),++n._idCount},n}return Ct(o,[{key:"connect",value:(i=Tt(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c,l,h,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=qn(s),this._watcher.status(fg.CONNECTING),Hs.debug("ping -> protocol: ".concat(i,", hosts: ").concat(JSON.stringify(r))),e.next=5,vg(r,i,this._runtime);case 5:if(o=e.sent,Hs.debug("valid hosts -> ".concat(o.join(","))),0!==o.length){e.next=10;break}return Hs.error("No valid websocket server hosts!"),e.abrupt("return",So.RC_SOCKET_NOT_CREATED);case 10:a=i.replace("http","ws"),u=regeneratorRuntime.mark((function e(r,i){var u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=yg(a,o[r],t,n,f._runtime,s),Hs.debug("conenct start -> ".concat(u)),c=f._runtime.createWebSocket(u),l=function(e){f._timer&&(clearTimeout(f._timer),f._timer=null),f._socket===c&&(f._socket=null,f._watcher.status(e))},e.next=6,new Promise((function(e){c.onMessage((function(t){if("[object ArrayBuffer]"===Object.prototype.toString.call(t)){var n=ug(t);if(n instanceof Zf&&f._pingResolve)return f._pingResolve(So.SUCCESS),void(f._pingResolve=void 0);if(n instanceof Wf)return Hs.debug("recv connect ack -> ".concat(n.status)),n.status!==lg.ACCEPTED?(Hs.warn("connect failed: ".concat(n.status)),void e(n.status)):(Hs.info("connect success -> ".concat(u)),f.connectedTime=n.timestamp,f.userId=n.userId||"",void e(So.SUCCESS));if(n instanceof Qf){var r=n.status;switch(Hs.warn("recv disconnect signal -> status: ".concat(r)),r){case dg.BLOCK:f._watcher.status(fg.BLOCKED);break;case dg.OTHER_DEVICE_LOGIN:f._watcher.status(fg.KICKED_OFFLINE_BY_OTHER_CLIENT);break;case dg.REDIRECT_NEW:case dg.REDIRECT:f._watcher.status(fg.REDIRECT);break;default:f._watcher.status(fg.DISCONNECT_BY_SERVER)}}else f._onReceiveSignal(n)}else Hs.error("Socket received invalid data:",t)})),c.onClose((function(t,n){Hs.warn("websocket closed! code:",t,"reason:",n),l(fg.CONNECTION_CLOSED),e(t)})),c.onError((function(t){Hs.error("websocket error!",null==t?void 0:t.stack),l(fg.WEBSOCKET_ERROR),e(So.NETWORK_ERROR)})),c.onOpen((function(){return Hs.debug("websocket open =>",u)})),setTimeout((function(){e(So.TIMEOUT)}),rn)}));case 6:if((h=e.sent)!==lg.REDIRECT){e.next=9;break}return e.abrupt("return",{v:h});case 9:if(h!==So.SUCCESS){e.next=15;break}return f._socket=c,f._checkAlive(),e.abrupt("return",{v:h});case 15:Hs.warn("connect result -> code: ".concat(h,", url: ").concat(u));case 16:c.close();case 17:case"end":return e.stop()}}),e)})),c=0,l=o.length;case 13:if(!(c<l)){e.next=21;break}return e.delegateYield(u(c,l),"t0",15);case 15:if("object"!==_t(h=e.t0)){e.next=18;break}return e.abrupt("return",h.v);case 18:c+=1,e.next=13;break;case 21:return e.abrupt("return",So.RC_NET_UNAVAILABLE);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,s){return i.apply(this,arguments)})},{key:"_checkAlive",value:(r=Tt(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._socket){e.next=2;break}return e.abrupt("return");case 2:return Hs.debug("send ping ->"),this.sendOnly(new Jf),e.next=6,new Promise((function(e){r._pingResolve=e,r._timer&&clearTimeout(r._timer),r._timer=setTimeout((function(){r._pingResolve=void 0,e(So.TIMEOUT)}),15e3)}));case 6:if((t=e.sent)===So.SUCCESS){e.next=12;break}return this._failedCount+=1,Hs.warn("ping failed count: ".concat(this._failedCount,", code: ").concat(t)),this._failedCount>=this.ALLOW_FAILED_TIMES?(this._failedCount=0,Hs.warn("ping timeout, close current websocket to reconnect!"),null===(n=this._socket)||void 0===n||n.close()):this._checkAlive(),e.abrupt("return");case 12:Hs.debug("recv pong <-"),this._failedCount=0,setTimeout((function(){return r._checkAlive()}),15e3);case 15:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_onReceiveSignal",value:(n=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.messageId,t.header&&t.header.qos!==rl.AT_MOST_ONCE&&(t instanceof eg&&!t.syncMsg&&(Hs.debug("send pubAck -> ".concat(n)),this.sendOnly(new rg(n))),t instanceof og&&(Hs.debug("send queryCon -> ".concat(n)),this.sendOnly(new sg(n)))),n>0&&(Hs.debug("recv ack -> messageId: ".concat(n)),(r=this._messageIds[n])&&(r(t),delete this._messageIds[n]),(i=this._syncMessageIds[n])&&(delete this._syncMessageIds[n],i(t))),!(t instanceof eg)){e.next=16;break}if(s=t.syncMsg,(o=t.topic)!==pg[pg.userSetData]){e.next=8;break}return e.abrupt("return");case 8:if(s&&!mg(o)){e.next=11;break}return this._watcher.signal(t),e.abrupt("return");case 11:return e.next=13,new Promise((function(e){u._syncMessageIds[n]=e}));case 13:a=e.sent,delete this._syncMessageIds[n],this._watcher.signal(t,a);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"sendOnly",value:function(e){this._socket&&Eg(e,this._socket)}},{key:"send",value:(t=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u=this,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>3&&void 0!==c[3]?c[3]:on,!this._socket){e.next=16;break}return s=this._generateMessageId(),t.messageId=s,Eg(t,this._socket),e.next=7,new Promise((function(e){u._messageIds[s]=e,setTimeout((function(){u._messageIds[s]&&delete u._messageIds[s],e()}),i)}));case 7:if(o=e.sent){e.next=11;break}return Hs.warn("send timeout -> message: ".concat(s,", respPBName: ").concat(n,", timeout: ").concat(i)),e.abrupt("return",{code:So.TIMEOUT});case 11:if(0===o.status){e.next=14;break}return Hs.warn("send failed -> message: ".concat(s,", respPBName: ").concat(n,", status: ").concat(o.status)),e.abrupt("return",{code:o.status});case 14:return a=n?this.codec.decodeByPBName(o.data,n,r):o,e.abrupt("return",{code:So.SUCCESS,data:a});case 16:return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 17:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"close",value:function(){this._socket&&(this._socket.close(),this._socket=null,this._watcher.status(fg.DISCONNECTED))}}]),o}(qf);e.HttpMethod=void 0,(_g=e.HttpMethod||(e.HttpMethod={})).GET="GET",_g.POST="POST";var Rg=function(e){if(Ps(e))return!0;var t=!1;try{var n=JSON.parse(e);t=JSON.stringify(n)===e}catch(e){t=!1}return t},Ig=function(t){Ot(a,t);var n,r,i,s,o=Pt(a);function a(e,t){var n;return Rt(this,a),(n=o.call(this,"comet",t))._runtime=e,n._messageIds={},n._syncMessageIds={},n._idCount=0,n._generateMessageId=function(){return++n._idCount},n._pid=encodeURIComponent((new Date).getTime()+Math.random()+""),n}return Ct(a,[{key:"handleCometRes",value:function(e){var t=this;if(200!==e.status&&202!==e.status)return!1;var n=ks(e.data)?JSON.parse(e.data):e.data;return n?!xs(n)||(Mo(n,function(){var e=Tt(regeneratorRuntime.mark((function e(n){var r,i,s,o,a,u,c,l,h,f,g,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.sessionid)&&(t._sessionid=r),i=cg(n),s=i.messageId,o=i._header,a=i.status,i.identifier,u=o&&o.qos!==rl.AT_MOST_ONCE,s&&i.getIdentifier&&((c=t._messageIds[s])&&c(i),t._syncMessageIds[s]&&t._syncMessageIds[s](i)),u&&(i instanceof eg&&!i.syncMsg&&(l=new rg(s),t.sendOnly(l)),i instanceof og&&(h=new sg(s),t.sendOnly(h))),!(i instanceof Qf)){e.next=20;break}e.t0=a,e.next=e.t0===dg.OTHER_DEVICE_LOGIN?11:e.t0===dg.BLOCK?13:e.t0===dg.REDIRECT_NEW||e.t0===dg.REDIRECT?15:17;break;case 11:return t._watcher.status(fg.KICKED_OFFLINE_BY_OTHER_CLIENT),e.abrupt("break",19);case 13:return t._watcher.status(fg.BLOCKED),e.abrupt("break",19);case 15:return t._watcher.status(fg.REDIRECT),e.abrupt("break",19);case 17:return t._watcher.status(fg.DISCONNECT_BY_SERVER),e.abrupt("break",19);case 19:return e.abrupt("return");case 20:if(!(i instanceof eg)){e.next=30;break}if(f=i.syncMsg,g=i.topic,f&&!mg(g)){e.next=25;break}return t._watcher.signal(i),e.abrupt("return",!1);case 25:return e.next=27,new Promise((function(e){t._syncMessageIds[s]=e}));case 27:d=e.sent,delete t._syncMessageIds[s],t._watcher.signal(i,d);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),!0):(Hs.error("received data is not a validJson",n),!1)}},{key:"_startPullSignal",value:(s=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).getTime(),r="".concat(t,"://").concat(this._domain,"/pullmsg.js?sessionid=").concat(this._sessionid,"&timestrap=").concat(n,"&pid=").concat(this._pid),e.next=4,this._runtime.httpReq({url:r,body:{pid:this._pid},timeout:45e3});case 4:i=e.sent,s=this.handleCometRes(i),this._isDisconnected||(s?this._startPullSignal(t):(this._watcher.status(fg.NETWORK_UNAVAILABLE),this.close()));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"connect",value:(i=Tt(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c,l,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=qn(s),this._protocol=i,this._isDisconnected=!1,this._watcher.status(fg.CONNECTING),e.next=6,vg(r,i,this._runtime);case 6:if(0!==(o=e.sent).length){e.next=10;break}return Hs.error("No valid comet server hosts!"),e.abrupt("return",So.RC_SOCKET_NOT_CREATED);case 10:a=function(e){return(200===e.status||202===e.status)&&!!e.data&&(Rg(e.data)?Ps(e.data)?e.data:JSON.parse(e.data):(Hs.error("received data is not a validJson",e.data),!1))},u=0,c=o.length;case 12:if(!(u<c)){e.next=31;break}return l=yg(i,o[u],t,n,this._runtime,s,this._pid),e.next=16,this._runtime.httpReq({url:l,body:{pid:this._pid},timeout:rn});case 16:if(h=e.sent,f=a(h),this._domain=o[u],!f||f.status!==lg.REDIRECT){e.next=21;break}return e.abrupt("return",f.status);case 21:if(!f||0!==f.status){e.next=28;break}return this._watcher.status(fg.CONNECTED),this._sessionid=f.sessionid,this._startPullSignal(i),this.userId=f.userId,this.connectedTime=f.timestamp,e.abrupt("return",f.status);case 28:u+=1,e.next=12;break;case 31:return e.abrupt("return",So.RC_NET_UNAVAILABLE);case 32:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,s){return i.apply(this,arguments)})},{key:"sendCometData",value:(r=Tt(regeneratorRuntime.mark((function t(n){var r,i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this._domain,i=this._sessionid,s=this._pid,o=n.messageId,a=n.topic,u=n.targetId,n.identifier,c=n.getHeaderFlag(),l=a?"".concat(this._protocol,"://").concat(r,"/websocket?messageid=").concat(o,"&header=").concat(c,"&sessionid=").concat(i,"&topic=").concat(a,"&targetid=").concat(u,"&pid=").concat(s):"".concat(this._protocol,"://").concat(r,"/websocket?messageid=").concat(o,"&header=").concat(c,"&sessionid=").concat(i,"&pid=").concat(s),t.next=7,this._runtime.httpReq({url:l,method:e.HttpMethod.POST,body:n.getCometData()});case 7:h=t.sent,this.handleCometRes(h);case 9:case"end":return t.stop()}}),t,this)}))),function(e){return r.apply(this,arguments)})},{key:"sendOnly",value:function(e){this.sendCometData(e)}},{key:"send",value:(n=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u=this,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>3&&void 0!==c[3]?c[3]:on,s=this._generateMessageId(),t.messageId=s,this.sendCometData(t),e.next=6,new Promise((function(e){u._messageIds[s]=e,setTimeout((function(){delete u._messageIds[s],e()}),i)}));case 6:if(o=e.sent){e.next=9;break}return e.abrupt("return",{code:So.TIMEOUT});case 9:if(0===o.status){e.next=11;break}return e.abrupt("return",{code:o.status});case 11:return a=n?this.codec.decodeByPBName(o.data,n,r):o,e.abrupt("return",{code:So.SUCCESS,data:a});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"close",value:function(){this._isDisconnected=!0,this._watcher.status(fg.DISCONNECTED)}}]),a}(qf),Cg=function e(t,n,r){Rt(this,e),this.runtime=t,this._watcher=n,this._options=r,this.currentUserId="",this._appkey=this._options.appkey,this._apiVer=this._options.apiVersion,this.navi=this._createNavi()},Sg=kn.find,bg="find",wg=!0;bg in[]&&Array(1).find((function(){wg=!1})),Pe({target:"Array",proto:!0,forced:wg},{find:function(e){return Sg(this,e,arguments.length>1?arguments[1]:void 0)}}),sr(bg);var Og=function(e){return["navi",e].join("_")},Ng=function(e,t,n){var r,i,s=Og(e);try{var o=n.getItem(s);i=o?JSON.parse(o):[]}catch(e){i=[]}var a=Date.now();return i.length>0&&(i=i.filter((function(e){return a-e.timestamp<nn}))),0===i.length?n.removeItem(s):n.setItem(s,JSON.stringify(i)),(null===(r=i.find((function(e){return e.token===t})))||void 0===r?void 0:r.naviInfo)||null},kg=function(){function e(t,n){Rt(this,e),this._runtime=t,this._options=n,this._naviInfo=null,this._appkey=this._options.appkey,this._apiVersion=qn(this._options.apiVersion)}var t;return Ct(e,[{key:"getInfo",value:(t=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&this._clear(t),!(i=Ng(this._appkey,t,this._runtime.localStorage))){e.next=5;break}return this._naviInfo=i,e.abrupt("return",i);case 5:return s=this._options.navigators.slice(),n.length&&n.forEach((function(e){s.indexOf(e)<0&&s.unshift(e)})),e.next=9,this._reqNavi(s,this._appkey,t);case 9:if(!(i=e.sent)){e.next=14;break}return this._naviInfo=i,this.setNaviInfo2Cache(t,i),e.abrupt("return",i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"setNaviInfo2Cache",value:function(e,t){this._naviInfo=t,function(e,t,n,r){var i,s=Og(e);try{var o=r.getItem(s);i=o?JSON.parse(o):[]}catch(e){i=[]}var a=Date.now();i.length>0&&(i=i.filter((function(e){return a-e.timestamp<nn&&t!==e.token}))),i.push({timestamp:a,naviInfo:n,token:t}),r.setItem(s,JSON.stringify(i))}(this._appkey,e,t,this._runtime.localStorage)}},{key:"getInfoFromCache",value:function(e){return this._naviInfo}},{key:"_clear",value:function(e){!function(e,t,n){var r,i=Og(e);try{var s=n.getItem(i);r=s?JSON.parse(s):[]}catch(e){r=[]}var o=Date.now();r.length>0&&(r=r.filter((function(e){return o-e.timestamp<nn&&t!==e.token}))),0===r.length?n.removeItem(i):n.setItem(i,JSON.stringify(r))}(this._appkey,e,this._runtime.localStorage)}}]),e}(),Ag=Object.assign,Mg=Object.defineProperty,xg=!Ag||a((function(){if(u&&1!==Ag({b:1},Ag(Mg({},"a",{enumerable:!0,get:function(){Mg(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=Ag({},e)[n]||Un(Ag({},t)).join("")!=r}))?function(e,t){for(var n=R(e),r=arguments.length,i=1,s=Se.f,o=h.f;r>i;)for(var a,c=y(arguments[i++]),l=s?Un(c).concat(s(c)):Un(c),f=l.length,g=0;f>g;)a=l[g++],u&&!o.call(c,a)||(n[a]=c[a]);return n}:Ag;Pe({target:"Object",stat:!0,forced:Object.assign!==xg},{assign:xg});var Lg=kn.findIndex,Ug="findIndex",Pg=!0;Ug in[]&&Array(1).findIndex((function(){Pg=!1})),Pe({target:"Array",proto:!0,forced:Pg},{findIndex:function(e){return Lg(this,e,arguments.length>1?arguments[1]:void 0)}}),sr(Ug);var Dg=function(e){if(ys(e))throw TypeError("The method doesn't accept regular expressions");return e},Vg=ot("match");Pe({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Vg]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~String(m(this)).indexOf(Dg(e),arguments.length>1?arguments[1]:void 0)}});var Bg="outbox",Fg="inbox",Yg=function(e,t,n){return[e,t,n].join("_")},jg=function(){function e(t,n){Rt(this,e),this._runtime=t,this._appkey=n,this._inboxTime=0,this._outboxTime=0}return Ct(e,[{key:"setInboxTime",value:function(e,t){if(!(this._inboxTime>e)){this._inboxTime=e;var n=Yg(Fg,this._appkey,t);this._runtime.localStorage.setItem(n,e.toString())}}},{key:"getInboxTime",value:function(e){if(0===this._inboxTime){var t=Yg(Fg,this._appkey,e);this._inboxTime=parseInt(this._runtime.localStorage.getItem(t))||0}return this._inboxTime}},{key:"setOutboxTime",value:function(e,t){if(!(this._outboxTime>=e)){this._outboxTime=e;var n=Yg(Bg,this._appkey,t);this._runtime.localStorage.setItem(n,e.toString())}}},{key:"getOutboxTime",value:function(e){if(0===this._outboxTime){var t=Yg(Bg,this._appkey,e);this._outboxTime=parseInt(this._runtime.localStorage.getItem(t))||0}return this._outboxTime}}]),e}(),qg={_caches:{},set:function(e,t){this._caches[e]=t},get:function(e){return this._caches[e]||0},clear:function(e){this._caches[e]=0}},Gg=function(){function e(t,n){Rt(this,e),this._kvCaches={},this._chatroomId=t,this._currentUserId=n}return Ct(e,[{key:"_add",value:function(e){var t=e.key;e.isDeleted=!1,this._kvCaches[t]=e}},{key:"_remove",value:function(e){var t=e.key,n=this._kvCaches[t];n.isDeleted=!0,this._kvCaches[t]=n}},{key:"_setEntry",value:function(e,t){var n=e.key,r=e.type,i=e.isOverwrite,s=e.userId,o=this._getSetUserId(n),a=r===jo.DELETE,u=o===s,c=!this._isExisted(n),l=a?this._remove:this._add;(t||i||u||c)&&l.call(this,e)}},{key:"getValue",value:function(e){var t=this._kvCaches[e]||{};return t.isDeleted?null:t.value}},{key:"getAllValue",value:function(){var e={};for(var t in this._kvCaches)this._kvCaches[t].isDeleted||(e[t]=this._kvCaches[t].value);return e}},{key:"_getSetUserId",value:function(e){return(this._kvCaches[e]||{}).userId}},{key:"_isExisted",value:function(e){var t=this._kvCaches[e]||{},n=t.value,r=t.isDeleted;return n&&!r}},{key:"setEntries",value:function(e){var t=this,n=e.kvEntries,r=e.isFullUpdate;n=n||[],(r=r||!1)&&this.clear(),n.forEach((function(e){t._setEntry(e,r)}))}},{key:"clear",value:function(){this._kvCaches={}}}]),e}(),Hg=function(){function e(t){Rt(this,e),this._pullQueue=[],this._isPulling=!1,this._storeCaches={},this._engine=t}var t;return Ct(e,[{key:"_startPull",value:(t=Tt(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isPulling&&0!==this._pullQueue.length){e.next=2;break}return e.abrupt("return");case 2:if(this._isPulling=!0,t=this._pullQueue.splice(0,1)[0],n=t.chrmId,r=t.timestamp,!((i=qg.get(n))>r)){e.next=9;break}return this._isPulling=!1,this._startPull(),e.abrupt("return");case 9:return e.next=11,this._engine.pullChatroomEntry(n,i);case 11:s=e.sent,o=s.code,a=s.data,o===So.SUCCESS?(this._isPulling=!1,qg.set(n,a.syncTime||0),this._startPull()):this._startPull();case 15:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"reset",value:function(e){qg.clear(e);var t=this._storeCaches[e];t&&t.clear()}},{key:"pullEntry",value:function(e,t){this._pullQueue.push({chrmId:e,timestamp:t}),this._startPull()}},{key:"setLocal",value:function(e,t,n){var r=this._storeCaches[e];Fs(r)||(r=new Gg(e,n)),r.setEntries(t),this._storeCaches[e]=r}},{key:"getValue",value:function(e,t){var n=this._storeCaches[e];return n?n.getValue(t):null}},{key:"getAll",value:function(e){var t=this._storeCaches[e],n={};return t&&(n=t.getAllValue()),n}}]),e}(),Kg=function(){function e(t,n,r,i){Rt(this,e),this._runtime=t,this._appkey=n,this._userId=r,this._canJoinMulipleChrm=i,this._sessionKey="",this._joinedChrmsInfo={},this._sessionKey="sync-chrm-".concat(this._appkey,"-").concat(this._userId)}return Ct(e,[{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!this._canJoinMulipleChrm&&(this._joinedChrmsInfo={}),this._joinedChrmsInfo[e]=t,this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo))}},{key:"get",value:function(){var e,t;try{t=this._runtime.sessionStorage.getItem(this._sessionKey),e=JSON.parse(t||"{}")}catch(n){Hs.error("parse rejoined chrm infos error -> ".concat(t)),e={}}return e}},{key:"remove",value:function(e){delete this._joinedChrmsInfo[e],Fs(this._joinedChrmsInfo)?this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo)):this.clear()}},{key:"clear",value:function(){this._joinedChrmsInfo={},this._runtime.sessionStorage.removeItem(this._sessionKey)}}]),e}(),Wg="converStatusChanged",Qg=function(){function e(t,n,r){Rt(this,e),this._eventEmitter=new Xs,this._pullQueue=[],this._isPulling=!1,this._storage=hn(t.runtime),this._appkey=n,this._currentUserId=r,this._engine=t,this._storagePullTimeKey="con-s-".concat(n,"-").concat(r)}var t;return Ct(e,[{key:"_set",value:function(e){var t=this;if(!Vs(e)){var n=this._storage.get(this._storagePullTimeKey)||0,r=e.length;e.forEach((function(e,i){var s=e.updatedTime||0;n=s>n?s:n,e.conversationType=e.type,t._eventEmitter.emit(Wg,{statusItem:e,isLastPull:i===r-1})})),this._storage.set(this._storagePullTimeKey,n)}}},{key:"_startPull",value:(t=Tt(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isPulling&&0!==this._pullQueue.length){e.next=2;break}return e.abrupt("return");case 2:return this._isPulling=!0,t=this._pullQueue.splice(0,1)[0],e.next=6,this._engine.pullConversationStatus(t);case 6:n=e.sent,r=n.code,i=n.data,r===So.SUCCESS?(this._isPulling=!1,this._set(i),this._startPull()):this._startPull();case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pull",value:function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())}},{key:"watch",value:function(e){this._eventEmitter.on(Wg,(function(t){e(t)}))}},{key:"unwatch",value:function(){this._eventEmitter.off(Wg,(function(e){}))}}]),e}(),zg={c:{keyName:"unreadMessageCount",defaultVal:0},hm:{keyName:"hasMentioned",defaultVal:!1},m:{keyName:"mentionedInfo",defaultVal:null},t:{keyName:"lastUnreadTime",defaultVal:0},nc:{keyName:"notificationStatus",defaultVal:2},to:{keyName:"isTop",defaultVal:!1},tg:{keyName:"tags",defaultVal:{}}},Jg={};for(var Zg in zg){var $g=zg[Zg].keyName;Jg[$g]=Zg}var Xg,ed=function(){function e(t,n,r){Rt(this,e),this._appkey=n,this._currentUserId=r;var i="con-".concat(n,"-").concat(r);this.storage=new gn(t,i)}return Ct(e,[{key:"_getStoreKey",value:function(e,t){return"".concat(e,"_").concat(t)}},{key:"_getConOptionByKey",value:function(e){var t=(e=e||"").split("_");return t.length>=2?{conversationType:t[0],targetId:e.match(/_.*/g)[0].substring(1)}:{conversationType:ws.PRIVATE,targetId:""}}},{key:"updateMentionedData",value:function(e){var t,n=this,r=e.conversationType,i=e.targetId,s=e.messageType,o=e.isMentioned,a=e.content,u=e.senderUserId,c=this._getStoreKey(r,i),l=this.storage.get(c)||{},h=Jg.mentionedInfo,f=Jg.hasMentioned,g=l[h]||{},d=g.userIdList||[],p=a.mentionedInfo;o&&r===ws.GROUP&&((p.userIdList||[]).forEach((function(e){e===n._currentUserId&&d.indexOf(u)<0&&d.push(u)})),p.type===of.ALL&&d.indexOf(u)<0&&d.push(u));if(s===uf.RECALL&&r===ws.GROUP){var v=d.indexOf(u);v>=0&&d.splice(v,1)}p={userIdList:d,type:(null===(t=p)||void 0===t?void 0:t.type)||g.type},0!==d.length?(l[h]=p,l[f]=!0):(delete l[h],delete l[f]),Fs(l)?this.storage.set(c,l):this.storage.remove(c)}},{key:"set",value:function(e,t,n){var r=this._getStoreKey(e,t),i=this.storage.get(r)||{};for(var s in n){var o=Jg[s],a=n[s];if(!Vs(o)&&!Vs(a)&&"hasMentioned"!==s&&"MentionedInfo"!==s){if(a===zg[o].defaultVal||"tags"===s&&!Fs(a))delete i[o];else if("tags"===s){var u=a;for(var c in u)u[c].isTop||delete u[c].isTop;i[o]=a}else i[o]=a;i.c||(delete i.t,delete i.hm,delete i.m)}}Fs(i)?this.storage.set(r,i):this.storage.remove(r)}},{key:"get",value:function(e,t){var n=this._getStoreKey(e,t),r=this.storage.get(n)||{},i={};for(var s in zg){var o=zg[s],a=o.keyName,u=o.defaultVal;i[a]=r[s]||Po(u)}return i}},{key:"getValue",value:function(e){var t=this.storage.getValues()||{},n=[];for(var r in t){var i=this._getConOptionByKey(r),s={conversationType:i.conversationType,targetId:i.targetId},o=t[r];for(var a in o){var u=zg[a],c=u.keyName,l=u.defaultVal;s[c]=o[a]||Po(l)}s=e?e(s):s,n.push(s)}return n}},{key:"getValueForTag",value:function(){var e=this.storage.getValues()||{},t={};for(var n in e){var r=this._getConOptionByKey(n),i=r.conversationType,s=r.targetId,o={},a=e[n];for(var u in a){var c=zg[u],l=c.keyName,h=c.defaultVal;o[l]=a[u]||Po(h)}for(var f in o.tags){Vs(t[f])&&(t[f]=[]);var g=Object.assign({},o,{conversationType:i,targetId:s});delete g.tags,t[f].push(g)}}return t}}]),e}(),td=[ws.PRIVATE,ws.GROUP,ws.SYSTEM],nd="conversationChanged",rd=function(){function e(t,n,r,i){var s=this;Rt(this,e),this._updatedConversations={},this._eventEmitter=new Xs,this._draftMap={},this._appkey=n,this._loginUserId=r,this._store=new ed(t.runtime,n,r),this._statusManager=new Qg(t,n,r),this._statusManager.watch((function(e){var t=e.statusItem,n=e.isLastPull;s.addStatus(t,n)})),this._eventEmitter.on(nd,(function(e){i(e)}))}return Ct(e,[{key:"_calcUnreadCount",value:function(e,t){var n=e.content,r=e.messageType,i=e.sentTime,s=e.isCounted,o=e.messageDirection,a=e.senderUserId,u=o===Yf.SEND&&a===this._loginUserId,c=r===uf.RECALL,l=Ps(n),h=!1,f=t.lastUnreadTime||0,g=t.unreadMessageCount||0;if(f>i||u)return{hasChanged:h,localConversation:t};(s&&(t.unreadMessageCount=g+1,t.lastUnreadTime=i,h=!0),c&&l)&&(f>=n.sentTime&&g&&(t.unreadMessageCount=g-1,h=!0));return{hasChanged:h,localConversation:t}}},{key:"_calcMentionedInfo",value:function(e,t){var n=e.content,r=(e.messageDirection,e.isMentioned);Yf.SEND;var i=Ps(n),s=!1;return r&&i&&n.mentionedInfo&&(t.hasMentioned=!0,s=!0),{hasChanged:s,localConversation:t}}},{key:"_setUpdatedConversation",value:function(e){if(Ps(e)){var t=e.conversationType,n=e.targetId,r="".concat(t,"_").concat(n),i=this._store.get(t,n)||{};this._updatedConversations[r]=Object.assign(i,e)}}},{key:"addStatus",value:function(e,t){var n=e.conversationType,r=e.targetId,i=e.updatedTime,s=e.notificationStatus,o=e.isTop,a=e.tags,u={},c={};Vs(s)||(c.notificationStatus={time:i,val:s}),Vs(o)||(c.isTop={time:i,val:o}),Vs(a)||(c.tags={time:i,val:a},null==a||a.forEach((function(e){u[e.tagId]={isTop:e.isTop}}))),this._store.set(n,r,{notificationStatus:s,isTop:o,tags:u}),this._setUpdatedConversation({conversationType:n,targetId:r,updatedItems:c}),t&&this._notifyConversationChanged()}},{key:"_notifyConversationChanged",value:function(){var e=[];for(var t in this._updatedConversations)e.push(this._updatedConversations[t]);this._eventEmitter.emit(nd,e),this._updatedConversations={}}},{key:"setConversationCacheByMessage",value:function(e,t){var n=this,r=e.conversationType,i=e.isPersited,s=e.targetId;if(td.indexOf(r)>=0){var o=!1,a=this._store.get(r,s);if([this._calcUnreadCount,this._calcMentionedInfo].forEach((function(t){var r=t.call(n,e,a),i=r.hasChanged,s=r.localConversation;o=o||i,a=Po(s)})),o&&this._store.set(r,s,a),this._store.updateMentionedData(e),i){var u=this._store.get(r,s);u.updatedItems={latestMessage:{time:e.sentTime,val:e}},u.latestMessage=e;var c=Object.assign(u,{conversationType:r,targetId:s});this._setUpdatedConversation(c)}t&&this._notifyConversationChanged()}}},{key:"get",value:function(e,t){return this._store.get(e,t)}},{key:"getAllUnreadCount",value:function(e,t,n){var r=this._store.getValue(),i=0;return r.forEach((function(e){var t=e.unreadMessageCount;t=t||0,i+=Number(t)})),i}},{key:"getUnreadCountByTag",value:function(e,t){var n=this._store.getValueForTag()[e]||[],r=0;return n.forEach((function(e){var n=e.unreadMessageCount,i=e.notificationStatus;(t||1!==i)&&(n=n||0,r+=Number(n))})),r}},{key:"getUnreadCount",value:function(e,t){return this._store.get(e,t).unreadMessageCount||0}},{key:"clearUnreadCount",value:function(e,t){var n=this._store.get(e,t),r=n.unreadMessageCount,i=n.hasMentioned;(r||i)&&(n.unreadMessageCount=0,n.hasMentioned=!1),this._store.set(e,t,n);var s=Object.assign(n,{conversationType:e,targetId:t});this._setUpdatedConversation(s),this._notifyConversationChanged()}},{key:"startPullConversationStatus",value:function(e){this._statusManager.pull(e)}},{key:"setDraft",value:function(e,t,n){var r="".concat(e,"_").concat(t);this._draftMap[r]=n}},{key:"getDraft",value:function(e,t){var n="".concat(e,"_").concat(t);return this._draftMap[n]}},{key:"clearDraft",value:function(e,t){var n="".concat(e,"_").concat(t);delete this._draftMap[n]}},{key:"addTagStatus",value:function(e,t,n){var r=this._store.get(e,t).tags;r=Object.assign(r,n),this._store.set(e,t,{tags:r})}},{key:"deleteTagStatus",value:function(e,t,n){var r=this._store.get(e,t).tags;n.forEach((function(e){delete r[e]})),this._store.set(e,t,{tags:r})}},{key:"getConversationListForTag",value:function(){return this._store.getValueForTag()}}]),e}();!function(e){e[e.QINIU=1]="QINIU",e[e.ALI=2]="ALI",e[e.AWS=3]="AWS",e[e.STC=4]="STC"}(Xg||(Xg={}));var id,sd,od,ad=Xg;e.RTCMode=void 0,(id=e.RTCMode||(e.RTCMode={}))[id.RTC=0]="RTC",id[id.LIVE=2]="LIVE",e.LiveType=void 0,(sd=e.LiveType||(e.LiveType={}))[sd.AUDIO_AND_VIDEO=0]="AUDIO_AND_VIDEO",sd[sd.AUDIO=1]="AUDIO",e.LiveRole=void 0,(od=e.LiveRole||(e.LiveRole={}))[od.ANCHOR=1]="ANCHOR",od[od.AUDIENCE=2]="AUDIENCE";var ud,cd={"RC:VCAccept":"RC:VCAccept","RC:VCRinging":"RC:VCRinging","RC:VCSummary":"RC:VCSummary","RC:VCHangup":"RC:VCHangup","RC:VCInvite":"RC:VCInvite","RC:VCModifyMedia":"RC:VCModifyMedia","RC:VCModifyMem":"RC:VCModifyMem"};e.RTCApiType=void 0,(ud=e.RTCApiType||(e.RTCApiType={}))[ud.ROOM=1]="ROOM",ud[ud.PERSON=2]="PERSON";var ld=function(){function e(t,n,r,i){Rt(this,e),this._pullQueue=[],this._isPulling=!1,this._storageTagKey="tag-".concat(n,"-").concat(r),this._storagePullTimeKey="us-s-".concat(n,"-").concat(r),this._storage=hn(t.runtime),this._engine=t,this._tagWatcherFunc=i}var t;return Ct(e,[{key:"_updateTag",value:function(e){var t=e.tags,n={};t.forEach((function(e){n[e.tagId]={tagName:e.tagName,createdTime:e.createdTime}})),this._storage.set(this._storageTagKey,n),this._tagWatcherFunc()}},{key:"addTag",value:function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){var t,r=(null===(t=n[e.tagId])||void 0===t?void 0:t.createdTime)||e.createdTime||0;n[e.tagId]={tagName:e.tagName,createdTime:r}})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)}},{key:"deleteTag",value:function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){delete n[e]})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)}},{key:"getTagsInfo",value:function(){return this._storage.get(this._storageTagKey)||{}}},{key:"getTags",value:function(){var e=this._storage.get(this._storageTagKey)||{},t=[];for(var n in e)t.push({tagId:n,tagName:e[n].tagName,createdTime:e[n].createdTime,conversationCount:0});return t.sort((function(e,t){return(e.createdTime||0)-(t.createdTime||0)}))}},{key:"getTagById",value:function(e){var t=this._storage.get(this._storageTagKey)||{};return t[e]?{tagId:e,tagName:t[e].tagName,createdTime:t[e].createdTime,conversationCount:0}:null}},{key:"_startPull",value:(t=Tt(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isPulling&&0!==this._pullQueue.length){e.next=2;break}return e.abrupt("return");case 2:return this._isPulling=!0,t=this._pullQueue.splice(0,1)[0],e.next=6,this._engine.pullUserSettings(t);case 6:n=e.sent,r=n.code,i=n.data,r!==So.SUCCESS||Vs(i)?(this._isPulling=!1,this._startPull()):(s=i.settings,o=i.version,a=s.Tag,Vs(a)||this._updateTag(a),this._storage.set(this._storagePullTimeKey,o),this._isPulling=!1,this._startPull());case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pullUserSettings",value:function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())}},{key:"getVersion",value:function(){return this._storage.get(this._storagePullTimeKey)||0}}]),e}(),hd=function(e){Ot(i,e);var t,n,r=Pt(i);function i(e,t){var n;return Rt(this,i),(n=r.call(this,e,t))._connectType=t.connectionType,n}return Ct(i,[{key:"_formatJSONPUrl",value:function(e,t,n,r){var i=this._runtime.isSupportSocket()&&"websocket"===this._connectType?"navi":"cometnavi";return"".concat(e,"/").concat(i,".js?appId=").concat(n,"&token=").concat(encodeURIComponent(t),"&callBack=").concat(r,"&v=").concat(this._apiVersion,"&r=").concat(Date.now())}},{key:"getInfo",value:(n=Tt(regeneratorRuntime.mark((function e(t,n,r){var s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._runtime.useNavi){e.next=5;break}return o={code:200,protocol:"https",server:"",voipCallInfo:"",kvStorage:0,openHttpDNS:!1,historyMsg:!1,chatroomMsg:!1,uploadServer:"https://upload.qiniup.com",bosAddr:"https://gz.bcebos.com",location:"",monitor:0,joinMChrm:!1,openMp:0,openUS:0,grpMsgLimit:0,isFormatted:0,gifSize:2048,logSwitch:0,logPolicy:"",compDays:0,msgAck:"",activeServer:"",qnAddr:"",extkitSwitch:0,alone:!1,voipServer:"",offlinelogserver:"",backupServer:null!==(s=this._options.miniCMPProxy)&&void 0!==s&&s.length?this._options.miniCMPProxy.join(","):void 0},this.setNaviInfo2Cache(t,o),e.abrupt("return",o);case 5:return e.abrupt("return",Dt(Nt(i.prototype),"getInfo",this).call(this,t,n,r));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_reqNavi",value:(t=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="getServerEndpoint",s=0,o=t.length;case 2:if(!(s<o)){e.next=24;break}return a=this._formatJSONPUrl(t[s],r,n,i),Hs.debug("req navi => ".concat(a)),e.next=7,this._runtime.httpReq({url:a,timeout:1e4});case 7:if(200===(u=e.sent).status){e.next=10;break}return e.abrupt("continue",21);case 10:return e.prev=10,c=u.data.replace("".concat(i,"("),"").replace(/\);?$/,""),l=JSON.parse(c),h=/^https/.test(a)?"https":"http",l.protocol=h,e.abrupt("return",l);case 18:e.prev=18,e.t0=e.catch(10),Hs.error("parse navi err =>",e.t0);case 21:s+=1,e.next=2;break;case 24:return e.abrupt("return",null);case 25:case"end":return e.stop()}}),e,this,[[10,18]])}))),function(e,n,r){return t.apply(this,arguments)})}]),i}(kg),fd=function(e){var t;return(t={},St(t,ws.PRIVATE,pg.ppMsgP),St(t,ws.GROUP,pg.pgMsgP),St(t,ws.CHATROOM,pg.chatMsg),St(t,ws.CUSTOMER_SERVICE,pg.pcMsgP),St(t,ws.RTC_ROOM,pg.prMsgS),t)[e]},gd=function(e,t,r,i,s,o){return{conversationType:e,targetId:t,senderUserId:o,messageDirection:Yf.SEND,isCounted:!!r.isCounted,isMentioned:!!r.isMentioned,content:r.content,messageType:r.messageType,isOffLineMessage:!1,isPersited:!!r.isPersited,messageUId:i,sentTime:s,receivedTime:0,disableNotification:!!r.disableNotification,isStatusMessage:!!r.isStatusMessage,canIncludeExpansion:!!r.canIncludeExpansion,expansion:r.canIncludeExpansion?r.expansion:null,receivedStatus:n.UNREAD,pushConfig:r.pushConfig}},dd=function(e,t){return"RC:SRSMsg"===e.messageType&&Object.assign(e,{directionalUserIdList:[t]}),e},pd=function(e){Ot(ie,e);var t,n,r,i,s,o,a,u,c,l,h,f,g,d,p,v,y,m,_,E,T,R,I,C,S,b,w,O,N,k,A,M,x,L,U,P,D,V,B,F,Y,j,q,G,H,K,W,Q,z,J,Z,$,X,ee,te,ne,re=Pt(ie);function ie(e,t,n){var r;return Rt(this,ie),(r=re.call(this,e,t,n))._customMessageType={},r._connectedTime=0,r._localConnectedTime=0,r._pullingMsg=!1,r._pullQueue=[],r._chrmsQueue={},r._latestSyncTimestamp=0,r._intervalTimer=-1,r._sentMessageMap={},r._letterbox=new jg(e,n.appkey),r._chrmEntryHandler=new Hg(Lt(r)),r}return Ct(ie,[{key:"_createNavi",value:function(){return new hd(this.runtime,this._options)}},{key:"getConnectedTime",value:function(){return this._connectedTime}},{key:"connect",value:(ne=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],this._naviInfo=n,n.server?r.push(n.server):Hs.warn("navi.server is invalid"),(i=n.backupServer)&&i.split(",").forEach((function(e){r.indexOf(e)<0&&r.push(e)})),0!==r.length){e.next=8;break}return Hs.error("navi invaild.",r),e.abrupt("return",So.UNKNOWN);case 8:return s=this.runtime.createDataChannel({status:function(e){a._connectionStatusHandler(e,t,r,n.protocol)},signal:this._signalHandler.bind(this)},this._options.connectionType),e.next=11,s.connect(this._appkey,t,r,n.protocol,this._apiVer);case 11:return(o=e.sent)===So.SUCCESS?(this._channel=s,this.currentUserId=s.userId,this._connectedTime=s.connectedTime,this._localConnectedTime=Date.now(),this._watcher.status(fg.CONNECTED),this._conversationManager=new rd(this,this._appkey,this.currentUserId,this._watcher.conversation),this._conversationManager.startPullConversationStatus(0),this._userSettingManager=new ld(this,this._appkey,this.currentUserId,this._watcher.tag),this._userSettingManager.pullUserSettings(0),this._joinedChrmManager=new Kg(this.runtime,this._appkey,this.currentUserId,n.joinMChrm),this._startSyncInterval()):s.close(),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return ne.apply(this,arguments)})},{key:"_connectionStatusHandler",value:function(e,t,n,r){if(Hs.warn("connection status changed:",e),e!==fg.CONNECTING&&e!==fg.CONNECTED){if(this._channel&&e!==fg.DISCONNECTED)return e===fg.BLOCKED||e===fg.KICKED_OFFLINE_BY_OTHER_CLIENT||e===fg.DISCONNECT_BY_SERVER?(this.disconnect(),void this._watcher.status(e)):void(e!==fg.REDIRECT?this._try2Reconnect(t,n,r):this._watcher.status(e));this._watcher.status(e)}else this._watcher.status(e)}},{key:"_try2Reconnect",value:(te=Tt(regeneratorRuntime.mark((function e(t,n,r){var i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._channel.connect(this._appkey,t,n,r,this._apiVer);case 4:if(e.sent!==So.SUCCESS){e.next=11;break}return this._watcher.status(fg.CONNECTED),this._startSyncInterval(),this._rejoinChrm(),Hs.__insertLogIntoDatabase(),e.abrupt("return");case 11:this._watcher.status(fg.WEBSOCKET_UNAVAILABLE),setTimeout((function(){i._try2Reconnect(t,n,r)}),5e3);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return te.apply(this,arguments)})},{key:"_signalHandler",value:function(e,t){var n=e.syncMsg,r=e.topic;if(n)this._receiveSyncMsg(e,t);else{var i=pg[r];if(i)switch(i){case pg.s_ntf:Hs.debug("recv s_ntf -> signal.messageId: ".concat(e.messageId)),this._pullMsg(e);break;case pg.s_msg:this._receiveMsg(e);break;case pg.s_cmd:this._receiveStateNotify(e);break;case pg.s_us:this._receiveSettingNotify(e)}else Hs.error("unknown topic:",r)}}},{key:"_receiveStateNotify",value:function(e){var t,n=null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,Vl),r=n.time,i=n.type,s=n.chrmId;switch(i){case 2:this._chrmEntryHandler.pullEntry(s,r);break;case 3:this._conversationManager.startPullConversationStatus(r)}}},{key:"_receiveSettingNotify",value:function(e){var t,n=(null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,Oh)).version;this._userSettingManager.pullUserSettings(n)}},{key:"_receiveMessageExpansion",value:function(e){var t=e.content,n=t.put,r=t.del,i=t.mid;n&&this._watcher.expansion({updatedExpansion:{messageUId:i,expansion:n}}),r&&this._watcher.expansion({deletedExpansion:{messageUId:i,deletedKeys:r}})}},{key:"_receiveSyncMsg",value:function(e,t){var n,r=null===(n=this._channel)||void 0===n?void 0:n.codec.decodeByPBName(e.data,kl,{currentUserId:this.currentUserId,signal:e});(r=this._handleMsgProperties(r)).sentTime=t.timestamp,r.messageUId=t.messageUId,this._pullingMsg?this._pullQueue.push(t.timestamp):(this._sentMessageMap[t.messageUId]=t.timestamp,r.messageType!==uf.EXPANSION_NOTIFY?(this._watcher.message(r),this._conversationManager.setConversationCacheByMessage(r,!0)):this._receiveMessageExpansion(r))}},{key:"_pullMsg",value:function(e){if(this._channel){var t=this._channel.codec.decodeByPBName(e.data,Vl),n=t.type,r=t.chrmId,i=t.time;if(Hs.debug("s_ntf -> type: ".concat(n,", chrmId: ").concat(r,", time: ").concat(i)),2===n){var s=this._chrmsQueue[r];if(!s)return;s.queue.push(i),this._pullChrmMsg(r)}else this._pullQueue.push(i),this._syncMsg()}}},{key:"_startSyncInterval",value:function(){var e=this;this._stopSyncInterval();this._intervalTimer=setInterval((function(){Date.now()-e._latestSyncTimestamp>=18e4&&e._syncMsg()}),3e4),this._latestSyncTimestamp=Date.now(),this._syncMsg()}},{key:"_stopSyncInterval",value:function(){-1!==this._intervalTimer&&(clearInterval(this._intervalTimer),this._intervalTimer=-1)}},{key:"_syncMsg",value:(ee=Tt(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a,u,c,l,h,f,g,d=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._pullingMsg){e.next=2;break}return e.abrupt("return");case 2:if(this._channel){e.next=5;break}return this._pullingMsg=!1,e.abrupt("return");case 5:return this._pullingMsg=!0,n=this._letterbox.getOutboxTime(this.currentUserId),r=this._letterbox.getInboxTime(this.currentUserId),Hs.debug("pullMsg -> sendboxTime: ".concat(n,", inboxTime: ").concat(r)),i=this._channel.codec.encodeSyncMsg({sendboxTime:n,inboxTime:r}),s=new ig(pg[pg.pullMsg],i,this.currentUserId),e.next=13,this._channel.send(s,xl,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId});case 13:if(o=e.sent,a=o.code,u=o.data,this._latestSyncTimestamp=Date.now(),a===So.SUCCESS&&u){e.next=21;break}return Hs.warn("pullMsg failed -> code:",a,", data: ",u),this._pullingMsg=!1,e.abrupt("return");case 21:c=u.list,l=u.finished,h=u.syncTime,Hs.debug("pullMsg success -> syncTime: ".concat(h,", finished: ").concat(l)),f=0,c.forEach((function(e){if(e.messageDirection===Yf.SEND&&(f=Math.max(e.sentTime,f),d._sentMessageMap[e.messageUId]))delete d._sentMessageMap[e.messageUId];else if(e.messageType!==uf.EXPANSION_NOTIFY){var t=d._handleMsgProperties(e);d._conversationManager.setConversationCacheByMessage(t,!0),d._watcher.message(t)}else d._receiveMessageExpansion(e)})),this._letterbox.setInboxTime(h,this.currentUserId),this._letterbox.setOutboxTime(f,this.currentUserId),this._pullingMsg=!1,g=this._pullQueue.filter((function(e){return e>h})),this._pullQueue.length=0,(t=this._pullQueue).push.apply(t,Bt(g)),(!l||g.length>0)&&this._syncMsg();case 32:case"end":return e.stop()}}),e,this)}))),function(){return ee.apply(this,arguments)})},{key:"_receiveMsg",value:function(e){if(this._channel&&!this._pullingMsg){var t=this._channel.codec.decodeByPBName(e.data,Ml,{currentUserId:this.currentUserId,connectedTime:this._channel.connectedTime});(t=this._handleMsgProperties(t)).isStatusMessage||this._letterbox.setInboxTime(t.sentTime,this.currentUserId),t.messageType!==uf.EXPANSION_NOTIFY?(this._watcher.message(t),this._conversationManager.setConversationCacheByMessage(t,!0)):this._receiveMessageExpansion(t)}}},{key:"_handleMsgProperties",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.messageType,i=e.isCounted,s=e.isPersited,o=e.isStatusMessage,a=r in cn,u=r in this._customMessageType;return t=a?cn[r]:u?this._customMessageType[r]:{isCounted:!Bs(i)&&i,isPersited:!Bs(s)&&s},Object.assign(e,{isCounted:t.isCounted,isPersited:t.isPersited,isStatusMessage:ln.includes(r)}),n&&(e.isStatusMessage=o),e}},{key:"getHistoryMessage",value:(X=Tt(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c,l,h,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.currentUserId,a=this._channel,u=Lf[t]||Of,c=1===i&&0===r,!a){e.next=14;break}return l=a.codec.encodeGetHistoryMsg(n,{timestamp:r,count:c?2:i,order:s}),e.next=7,a.send(new ig(u,l,o),Fl,{currentUserId:o,connectedTime:a.connectedTime,conversation:{targetId:n}});case 7:if(h=e.sent,(f=h.code)===So.SUCCESS){e.next=11;break}return e.abrupt("return",{code:f});case 11:return g=h.data,c&&2===g.list.length&&(g.hasMore=!0,0===s?g.list.shift():g.list.pop()),e.abrupt("return",{code:f,data:{list:g.list,hasMore:g.hasMore}});case 14:return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return X.apply(this,arguments)})},{key:"reportSDKInfo",value:function(e){var t=this.currentUserId,n=this._channel;if(n){Hs.debug("reportSDKInfo ->",e);var r=n.codec.encodeReportSDKInfo(JSON.stringify(e)),i=new ig(pg[pg.reportsdk],r,t);n.send(i).then((function(e){var t=e.code;t!==So.SUCCESS&&Hs.warn("reportSDKInfo failed -> code: ".concat(t))}))}}},{key:"deleteRemoteMessage",value:($=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.currentUserId,!(s=this._channel)){e.next=11;break}return o=s.codec.encodeDeleteMessages(t,n,r),a=new ig(mf,o,i),e.next=6,s.send(a);case 6:if(u=e.sent,(c=u.code)===So.SUCCESS){e.next=10;break}return e.abrupt("return",c);case 10:return e.abrupt("return",c);case 11:return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return $.apply(this,arguments)})},{key:"deleteRemoteMessageByTimestamp",value:(Z=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.currentUserId,!(s=this._channel)){e.next=12;break}return o=s.codec.encodeClearMessages(n,r),a=new ig(Uf[t],o,i),e.next=7,s.send(a);case 7:if(u=e.sent,(c=u.code)===So.SUCCESS){e.next=11;break}return e.abrupt("return",c);case 11:return e.abrupt("return",c);case 12:return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return Z.apply(this,arguments)})},{key:"getConversationList",value:(J=Tt(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a,u,c,l,h,f=this,g=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g.length>0&&void 0!==g[0]?g[0]:300,n=g.length>1?g[1]:void 0,r=g.length>2?g[2]:void 0,i=g.length>3?g[3]:void 0,s=this.currentUserId,o=this._channel,n=n||ws.PRIVATE,!o){e.next=17;break}return a=o.codec.encodeOldConversationList({count:t,type:n,startTime:r,order:i}),u=new ig(Cf,a,s),e.next=12,o.send(u,jl,{currentUserId:s,connectedTime:o.connectedTime,afterDecode:function(e){var t=e.conversationType,n=e.targetId,r=f._conversationManager.get(t,n);return Object.assign(e,r),e}});case 12:if(c=e.sent,l=c.code,h=c.data,l===So.SUCCESS){e.next=16;break}return e.abrupt("return",{code:l});case 16:return e.abrupt("return",{code:l,data:h});case 17:return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 18:case"end":return e.stop()}}),e,this)}))),function(){return J.apply(this,arguments)})},{key:"removeConversation",value:(z=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this._channel)){e.next=12;break}return i=r.codec.encodeOldConversationList({type:t}),s=new ig(Sf,i,n),e.next=6,r.send(s);case 6:if(o=e.sent,Hs.info("RemoveConversation =>",o),(a=o.code)===So.SUCCESS){e.next=11;break}return e.abrupt("return",a);case 11:return e.abrupt("return",a);case 12:return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return z.apply(this,arguments)})},{key:"getConversation",value:(Q=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._conversationManager.get(t,n)){e.next=3;break}return e.abrupt("return",{code:So.CONVER_GET_ERROR});case 3:return e.next=5,this.getHistoryMessage(t,n,0,1,0);case 5:if(s=e.sent,o=s.code,a=s.data,o===So.SUCCESS){e.next=10;break}return e.abrupt("return",{code:So.CONVER_GET_ERROR});case 10:return u=(null==a?void 0:a.list[0])||null,c={conversationType:t,targetId:n,channelId:r,unreadMessageCount:i.unreadMessageCount||0,latestMessage:u,notificationStatus:i.notificationStatus||gf.CLOSE,isTop:i.isTop||!1,lastUnreadTime:i.lastUnreadTime||0},e.abrupt("return",{code:So.SUCCESS,data:c});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return Q.apply(this,arguments)})},{key:"getAllConversationUnreadCount",value:function(e,t,n){var r=this._conversationManager.getAllUnreadCount(e,t,n);return Promise.resolve({code:So.SUCCESS,data:r})}},{key:"getConversationUnreadCount",value:function(e,t){var n=this._conversationManager.getUnreadCount(e,t);return Promise.resolve({code:So.SUCCESS,data:n})}},{key:"clearConversationUnreadCount",value:function(e,t){return this._conversationManager.clearUnreadCount(e,t),Promise.resolve(So.SUCCESS)}},{key:"saveConversationMessageDraft",value:function(e,t,n){return this._conversationManager.setDraft(e,t,n),Promise.resolve(So.SUCCESS)}},{key:"getConversationMessageDraft",value:function(e,t){var n=this._conversationManager.getDraft(e,t);return Promise.resolve({code:So.SUCCESS,data:n})}},{key:"clearConversationMessageDraft",value:function(e,t){return this._conversationManager.clearDraft(e,t),Promise.resolve(So.SUCCESS)}},{key:"pullConversationStatus",value:(W=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._channel,r=this.currentUserId,!n){e.next=11;break}return i=n.codec.encodeGetConversationStatus(t),s=new ig(pg[pg.pullSeAtts],i,r),e.next=6,n.send(s,kh);case 6:if(o=e.sent,a=o.code,u=o.data,a===So.SUCCESS){e.next=10;break}return e.abrupt("return",{code:a});case 10:return e.abrupt("return",{code:a,data:u});case 11:return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 12:case"end":return e.stop()}}),e,this)}))),function(e){return W.apply(this,arguments)})},{key:"batchSetConversationStatus",value:(K=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.currentUserId,!(r=this._channel)){e.next=13;break}return i=r.codec.encodeSetConversationStatus(t),s=new ig(bf,i,n),e.next=6,r.send(s,Lh);case 6:if(o=e.sent,a=o.code,u=o.data,a!==So.SUCCESS){e.next=12;break}return c=u,t.forEach((function(e){l._conversationManager.addStatus(wt(wt({},e),{},{updatedTime:c.version}),!0)})),e.abrupt("return",a);case 12:return e.abrupt("return",a);case 13:return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return K.apply(this,arguments)})},{key:"_joinChrm",value:(H=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._channel){e.next=3;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 3:return s=i.codec.encodeJoinOrQuitChatRoom(),o=new ig(r?Ef:_f,s,t),e.next=8,i.send(o);case 8:return a=e.sent,u=a.code,a.data,u===So.SUCCESS&&(this._chrmsQueue[t]||(this._chrmsQueue[t]={pulling:!1,queue:[],timestamp:0}),this._pullChrmMsg(t,n),this._naviInfo.kvStorage&&this._chrmEntryHandler.pullEntry(t,0),this._joinedChrmManager.set(t,n)),e.abrupt("return",u);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return H.apply(this,arguments)})},{key:"_rejoinChrm",value:(G=Tt(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._joinedChrmManager.get(),e.t0=regeneratorRuntime.keys(t);case 2:if((e.t1=e.t0()).done){e.next=10;break}return n=e.t1.value,e.next=6,this._joinChrm(n,t[n]||10,!0);case 6:(r=e.sent)===So.SUCCESS?this._watcher.chatroom({rejoinedRoom:{chatroomId:n,count:t[n]}}):this._watcher.chatroom({rejoinedRoom:{chatroomId:n,errorCode:r}}),e.next=2;break;case 10:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"_pullChrmMsg",value:(q=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l,h,f,g,d=this,p=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.length>1&&void 0!==p[1]?p[1]:10,this._channel){e.next=3;break}return e.abrupt("return");case 3:if(r=this._chrmsQueue[t],i=r.pulling,s=r.timestamp,!i){e.next=7;break}return e.abrupt("return");case 7:return r.pulling=!0,o=this._channel.codec.encodeChrmSyncMsg(s,n),a=new ig(pg[pg.chrmPull],o,t),e.next=12,this._channel.send(a,xl,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId});case 12:if(u=e.sent,c=u.code,l=u.data,r.pulling=!1,c===So.SUCCESS&&l){e.next=19;break}return Hs.warn("pull chatroom msg failed, code:",c,", data:",l),e.abrupt("return");case 19:h=l.list,f=l.syncTime,g=l.finished,r.timestamp=f,r.queue=r.queue.filter((function(e){return e>f})),h.forEach((function(e){e.sentTime<s||d._watcher.message(e)})),(!g||r.queue.length>0)&&this._pullChrmMsg(t);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return q.apply(this,arguments)})},{key:"joinChatroom",value:(j=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._joinChrm(t,n,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"joinExistChatroom",value:(Y=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._joinChrm(t,n,!0));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return Y.apply(this,arguments)})},{key:"quitChatroom",value:(F=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._channel){e.next=3;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 3:return r=n.codec.encodeJoinOrQuitChatRoom(),i=new ig(Tf,r,t),e.next=7,n.send(i);case 7:return s=e.sent,(o=s.code)===So.SUCCESS&&(delete this._chrmsQueue[t],this._chrmEntryHandler.reset(t),this._joinedChrmManager.remove(t)),e.abrupt("return",o);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"getChatroomInfo",value:(B=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._channel){e.next=3;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 3:return s=i.codec.encodeGetChatRoomInfo(n,r),o=new ig(pg[pg.queryChrmI],s,t),e.next=7,i.send(o,$l);case 7:if(a=e.sent,u=a.code,c=a.data,u===So.SUCCESS){e.next=11;break}return e.abrupt("return",{code:u});case 11:return e.abrupt("return",{code:u,data:c});case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return B.apply(this,arguments)})},{key:"getChatroomHistoryMessages",value:(V=Tt(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this._channel){e.next=3;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 3:return o=s.codec.encodeGetHistoryMsg(t,{timestamp:n,count:r,order:i}),a=new ig(kf,o,t),e.next=7,s.send(a,Fl,{conversation:{targetId:t}});case 7:if(u=e.sent,c=u.code,l=u.data,c===So.SUCCESS){e.next=12;break}return e.abrupt("return",{code:c});case 12:return e.abrupt("return",{code:c,data:{list:l.list,hasMore:l.hasMore}});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return V.apply(this,arguments)})},{key:"_modifyChatroomKV",value:(D=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._channel,i=this.currentUserId,r){e.next=3;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 3:return s=r.codec.encodeModifyChatRoomKV(t,n,i),o=n.type===jo.UPDATE?Rf:If,a=new ig(o,s,t),e.next=8,r.send(a);case 8:if(u=e.sent,(c=u.code)!==So.SUCCESS){e.next=13;break}return this._chrmEntryHandler.setLocal(t,{kvEntries:[n],syncTime:(new Date).getTime()},i),e.abrupt("return",c);case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)})},{key:"setChatroomEntry",value:(P=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=jo.UPDATE,e.abrupt("return",this._modifyChatroomKV(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return P.apply(this,arguments)})},{key:"forceSetChatroomEntry",value:(U=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=jo.UPDATE,n.isOverwrite=!0,e.abrupt("return",this._modifyChatroomKV(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return U.apply(this,arguments)})},{key:"removeChatroomEntry",value:(L=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=jo.DELETE,e.abrupt("return",this._modifyChatroomKV(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return L.apply(this,arguments)})},{key:"forceRemoveChatroomEntry",value:(x=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=jo.DELETE,n.isOverwrite=!0,e.abrupt("return",this._modifyChatroomKV(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"getChatroomEntry",value:function(e,t){var n=this._chrmEntryHandler.getValue(e,t);return n?Promise.resolve({code:So.SUCCESS,data:n}):Promise.resolve({code:So.CHATROOM_KEY_NOT_EXIST})}},{key:"getAllChatroomEntry",value:function(e){var t=this._chrmEntryHandler.getAll(e);return Promise.resolve({code:So.SUCCESS,data:t})}},{key:"pullChatroomEntry",value:(M=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._channel,i=this.currentUserId,r){e.next=3;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 3:return s=r.codec.encodePullChatRoomKV(n),o=new ig(pg[pg.pullKV],s,t),e.next=7,r.send(o,Rh);case 7:if(a=e.sent,u=a.code,c=a.data,u!==So.SUCCESS){e.next=15;break}return this._chrmEntryHandler.setLocal(t,c,i),l=c.kvEntries,h=[],l.length>0&&(l.forEach((function(e){var n=e.key,r=e.value,i=e.type,s=e.timestamp;h.push({key:n,value:r,type:i,timestamp:s,chatroomId:t})})),this._watcher.chatroom({updatedEntries:h})),e.abrupt("return",{code:u,data:c});case 15:return e.abrupt("return",{code:u});case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"sendMessage",value:(A=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c,l,h,f,g,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:if(r=dd(r,this.currentUserId),r=this._handleMsgProperties(r,!0),s=!![ws.PRIVATE,ws.GROUP].includes(t)&&r.isStatusMessage,o=s?(p=t,v=void 0,(v={},St(v,ws.PRIVATE,pg.ppMsgS),St(v,ws.GROUP,pg.pgMsgS),v)[p]):fd(t)||pg.ppMsgP,s&&(r.isPersited=!1,r.isCounted=!1),r.pushContent=(null===(i=r.pushConfig)||void 0===i?void 0:i.pushContent)||r.pushContent||"",a=this._channel.codec.encodeUpMsg({type:t,targetId:n},r),(u=new tg(pg[o],a,n)).setHeaderQos(rl.AT_LEAST_ONCE),!s){e.next=14;break}return this._channel.sendOnly(u),e.abrupt("return",{code:So.SUCCESS,data:gd(t,n,wt({},r),"",0,this.currentUserId)});case 14:return c=Date.now()-this._localConnectedTime+this._connectedTime,l=gd(t,n,wt({},r),"",c,this.currentUserId),e.next=18,this._channel.send(u);case 18:if(h=e.sent,f=h.code,g=h.data,f===So.SUCCESS){e.next=23;break}return e.abrupt("return",{code:f,data:l});case 23:return d=g,this._sentMessageMap[d.messageUId]=d.timestamp,l.sentTime=d.timestamp,l.messageUId=d.messageUId,this._conversationManager.setConversationCacheByMessage(l,!0),e.abrupt("return",{code:So.SUCCESS,data:l});case 29:case"end":return e.stop()}var p,v}),e,this)}))),function(e,t,n){return A.apply(this,arguments)})},{key:"recallMsg",value:(k=Tt(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c,l,h,f,g,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return a=s.user,u={content:{conversationType:t,targetId:n,messageUId:r,sentTime:i,user:a},messageType:"RC:RcCmd",disableNotification:null==s?void 0:s.disableNotification,pushConfig:null==s?void 0:s.pushConfig,pushContent:(null===(o=s.pushConfig)||void 0===o?void 0:o.pushContent)||s.pushContent||""},c=pg[pg.recallMsg],l=this._channel.codec.encodeUpMsg({type:t,targetId:n},u),(h=new tg(c,l,this.currentUserId)).setHeaderQos(rl.AT_LEAST_ONCE),e.next=10,this._channel.send(h);case 10:if(f=e.sent,g=f.code,d=f.data,g===So.SUCCESS){e.next=15;break}return e.abrupt("return",{code:g});case 15:return p=d,e.abrupt("return",{code:So.SUCCESS,data:gd(t,n,wt({},u),p.messageUId,p.timestamp,this.currentUserId)});case 17:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return k.apply(this,arguments)})},{key:"sendReadReceiptMessage",value:(N=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeReadReceipt(n,r),s=new ig(pg[pg.rrMsg],i,t),e.next=6,this._channel.send(s);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return N.apply(this,arguments)})},{key:"getMessageReader",value:(O=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeMessageReader(n,r),s=new ig(pg[pg.rrList],i,t),e.next=6,this._channel.send(s,Dh);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return O.apply(this,arguments)})},{key:"pullUserSettings",value:(w=Tt(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return n=this._channel.codec.encodePullUserSetting(t),r=new ig(pg[pg.pullUS],n,this.currentUserId),e.abrupt("return",this._channel.send(r,wh));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"getFileToken",value:(b=Tt(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return s=i&&"uploads"!==i?n||"":wo(t,n),o=this._channel.codec.encodeGetFileToken(t,s,r||"",i||""),a=new ig(pg[pg.qnTkn],o,this.currentUserId),e.next=7,this._channel.send(a,vh);case 7:if(u=e.sent,c=u.code,l=u.data,l=Object.assign(l,{fileName:s}),c!==So.SUCCESS){e.next=13;break}return e.abrupt("return",{code:c,data:l});case 13:return e.abrupt("return",{code:c});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return b.apply(this,arguments)})},{key:"getFileUrl",value:(S=Tt(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l,h,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return s="",o="",a="",n===ad.QINIU?(o=yh,a=_h):(o=mh,a=Eh),s=n===ad.QINIU?pg[pg.qnUrl]:n===ad.AWS?pg[pg.s3Url]:n===ad.STC?pg[pg.stcUrl]:pg[pg.aliUrl],u=this._channel.codec.encodeGetFileUrl(o,t,r,i),c=new ig(s,u,this.currentUserId),e.next=11,this._channel.send(c,a);case 11:if(l=e.sent,h=l.code,f=l.data,g=f,h!==So.SUCCESS){e.next=17;break}return e.abrupt("return",{code:h,data:g});case 17:return e.abrupt("return",{code:h});case 18:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return S.apply(this,arguments)})},{key:"disconnect",value:function(){this._channel&&(this._channel.close(),this._channel=void 0),this._stopSyncInterval()}},{key:"destroy",value:function(){throw new Error("JSEngine's method not implemented.")}},{key:"registerMessageType",value:function(e,t,n,r){this._customMessageType[e]={isPersited:t,isCounted:n}}},{key:"createTag",value:(C=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return n=this._userSettingManager.getVersion(),r=this._channel.codec.encodeCreateTag([t],n),i=new ig(pg[pg.addSeTag],r,this.currentUserId),e.next=7,this._channel.send(i,Sh);case 7:if(s=e.sent,o=s.code,a=s.data,o===So.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return u=a.version,this._userSettingManager.addTag([wt(wt({},t),{},{createdTime:u})],u),e.abrupt("return",{code:So.SUCCESS,data:a});case 15:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"removeTag",value:(I=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return n=this._userSettingManager.getVersion(),r=this._channel.codec.encodeRemoveTag([t],n),i=new ig(pg[pg.delSeTag],r,this.currentUserId),e.next=7,this._channel.send(i,Sh);case 7:if(s=e.sent,o=s.code,a=s.data,o===So.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return u=a.version,this._userSettingManager.deleteTag([t],u),e.abrupt("return",{code:So.SUCCESS});case 15:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"updateTag",value:(R=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return n=this._userSettingManager.getVersion(),r=this._channel.codec.encodeCreateTag([t],n),i=new ig(pg[pg.addSeTag],r,this.currentUserId),e.next=7,this._channel.send(i,Sh);case 7:if(s=e.sent,o=s.code,a=s.data,o===So.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return u=a.version,this._userSettingManager.addTag([t],u),e.abrupt("return",{code:So.SUCCESS,data:a});case 15:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"getTagList",value:(T=Tt(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._userSettingManager.getTags(),n=this._conversationManager.getConversationListForTag(),t.forEach((function(e){e.conversationCount=n[e.tagId]?n[e.tagId].length:0})),e.abrupt("return",{code:So.SUCCESS,data:t});case 4:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"addTagForConversations",value:(E=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:if(this._userSettingManager.getTagById(t)){e.next=4;break}return e.abrupt("return",{code:So.TAG_NOT_EXIST});case 4:return r=this._channel.codec.encodeUpdateConversationTag([{tagId:t}],n),i=new ig(pg[pg.addTag],r,this.currentUserId),e.next=8,this._channel.send(i);case 8:if(s=e.sent,(o=s.code)===So.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return(a={})[t]={},n.forEach((function(e){u._conversationManager.addTagStatus(e.type,e.targetId,a)})),e.abrupt("return",{code:So.SUCCESS});case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return E.apply(this,arguments)})},{key:"removeTagForConversations",value:(_=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return r=this._channel.codec.encodeUpdateConversationTag([{tagId:t}],n),i=new ig(pg[pg.delTag],r,this.currentUserId),e.next=6,this._channel.send(i);case 6:if(s=e.sent,(o=s.code)===So.SUCCESS){e.next=10;break}return e.abrupt("return",{code:o});case 10:return n.forEach((function(e){a._conversationManager.deleteTagStatus(e.type,e.targetId,[t])})),e.abrupt("return",{code:So.SUCCESS});case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return _.apply(this,arguments)})},{key:"removeTagsForConversation",value:(m=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return r=t.type,i=t.targetId,s=n.map((function(e){return{tagId:e}})),o=this._channel.codec.encodeUpdateConversationTag(s,[t]),a=new ig(pg[pg.delTag],o,this.currentUserId),e.next=8,this._channel.send(a);case 8:if(u=e.sent,(c=u.code)===So.SUCCESS){e.next=12;break}return e.abrupt("return",{code:c});case 12:return this._conversationManager.deleteTagStatus(r,i,n),e.abrupt("return",{code:So.SUCCESS});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"getConversationListByTag",value:(y=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.currentUserId,s=this._channel){e.next=3;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 3:return o=s.codec.encodeOldConversationList({count:r,type:ws.PRIVATE,startTime:n}),a=new ig(Cf,o,i),e.next=7,s.send(a,jl,{currentUserId:i,connectedTime:s.connectedTime});case 7:if(u=e.sent,c=u.code,l=u.data,h=this._conversationHasTagFilter(t,l),Hs.info("GetConversationListByTag",h),c===So.SUCCESS){e.next=13;break}return e.abrupt("return",{code:c});case 13:return e.abrupt("return",{code:c,data:h});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return y.apply(this,arguments)})},{key:"_conversationHasTagFilter",value:function(e,t){var n=this,r=[],i=[];function s(e,t){return e.latestMessage&&t.latestMessage?e.latestMessage.sentTime-t.latestMessage.sentTime:0}return t.forEach((function(t){var s=t.conversationType,o=t.targetId,a=n._conversationManager.get(s,o),u=a.hasMentioned,c=a.mentionedInfo,l=a.lastUnreadTime,h=a.notificationStatus,f=a.isTop,g=a.tags,d=a.unreadMessageCount,p=g&&g[e];if(p){var v=wt(wt({},t),{},{hasMentioned:u,mentionedInfo:c,lastUnreadTime:l,notificationStatus:h,isTop:f,unreadMessageCount:d});p.isTop?r.push(wt(wt({},v),{},{isTopInTag:!0})):i.push(wt(wt({},v),{},{isTopInTag:!1}))}})),[].concat(Bt(r.sort(s)),Bt(i.sort(s)))}},{key:"getUnreadCountByTag",value:(v=Tt(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return r=this._conversationManager.getUnreadCountByTag(t,n),e.abrupt("return",{code:So.SUCCESS,data:r});case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"setConversationStatusInTag",value:(p=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c,l,h,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:if(i=n.targetId,s=n.type,o=r.isTop,a=[{tagId:t,isTop:o}],(u=this._conversationManager.get(s,i)).tags&&Object.hasOwnProperty.call(u.tags,t)){e.next=8;break}return e.abrupt("return",{code:So.NO_TAG_IN_CONVER});case 8:return c=this._channel.codec.encodeUpdateConversationTag(a,[n]),l=new ig(pg[pg.addTag],c,this.currentUserId),e.next=12,this._channel.send(l);case 12:if(h=e.sent,(f=h.code)===So.SUCCESS){e.next=16;break}return e.abrupt("return",{code:f});case 16:return(g={})[t]={},o&&(g[t].isTop=!0),this._conversationManager.addTagStatus(s,i,g),e.abrupt("return",{code:So.SUCCESS});case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"getTagsForConversation",value:(d=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:if(n=this._conversationManager.get(t.type,t.targetId),r=this._userSettingManager.getTagsInfo(),i=[],n.tags)for(s in n.tags)i.push({tagId:s,tagName:null===(o=r[s])||void 0===o?void 0:o.tagName});return e.abrupt("return",{code:So.SUCCESS,data:i});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"joinRTCRoom",value:(g=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeJoinRTCRoom(n,r),s=new ig(pg[pg.rtcRJoin_data],i,t),e.abrupt("return",this._channel.send(s,eh));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"quitRTCRoom",value:(f=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return n=this._channel.codec.encodeQuitRTCRoom(),r=new ig(pg[pg.rtcRExit],n,t),e.next=6,this._channel.send(r);case 6:return i=e.sent,s=i.code,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"rtcPing",value:(h=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return i=this._channel.codec.encodeJoinRTCRoom(n,r),s=new ig(pg[pg.rtcPing],i,t),e.next=6,this._channel.send(s);case 6:return o=e.sent,a=o.code,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"getRTCRoomInfo",value:(l=Tt(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return n=this._channel.codec.encodeGetRTCRoomInfo(),r=new ig(pg[pg.rtcRInfo],n,t),e.abrupt("return",this._channel.send(r,fh));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getRTCUserInfoList",value:(c=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return n=this._channel.codec.encodeGetRTCRoomInfo(),r=new ig(pg[pg.rtcUData],n,t),e.next=6,this._channel.send(r,eh);case 6:return i=e.sent,s=i.code,o=i.data,e.abrupt("return",{code:s,data:o?{users:o.users}:o});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setRTCUserInfo",value:(u=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return i=this._channel.codec.encodeSetRTCUserInfo(n,r),s=new ig(pg[pg.rtcUPut],i,t),e.next=6,this._channel.send(s);case 6:return o=e.sent,a=o.code,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"removeRTCUserInfo",value:(a=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return r=this._channel.codec.encodeRemoveRTCUserInfo(n),i=new tg(pg[pg.rtcUDel],r,t),e.next=6,this._channel.send(i);case 6:return s=e.sent,o=s.code,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"setRTCData",value:(o=Tt(regeneratorRuntime.mark((function e(t,n,r,i,s,o){var a,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return a=this._channel.codec.encodeSetRTCData(n,r,i,s,o),u=new tg(pg[pg.rtcSetData],a,t),e.next=6,this._channel.send(u);case 6:return c=e.sent,l=c.code,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i,s){return o.apply(this,arguments)})},{key:"setRTCTotalRes",value:(s=Tt(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return s=this._channel.codec.encodeUserSetRTCData(n,r,i),o=new ig(pg[pg.userSetData],s,t),e.next=6,this._channel.send(o);case 6:return a=e.sent,u=a.code,e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return s.apply(this,arguments)})},{key:"getRTCData",value:function(e,t,n,r){if(!this._channel)return Promise.resolve({code:So.RC_NET_CHANNEL_INVALID});var i=this._channel.codec.encodeGetRTCData(t,n,r),s=new ig(pg[pg.rtcQryData],i,e);return this._channel.send(s,uh)}},{key:"removeRTCData",value:(i=Tt(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return o=this._channel.codec.encodeRemoveRTCData(n,r,i,s),a=new tg(pg[pg.rtcDelData],o,t),e.next=6,this._channel.send(a);case 6:return u=e.sent,c=u.code,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,s){return i.apply(this,arguments)})},{key:"setRTCOutData",value:function(e,t,n,r){throw new Error("JSEngine's method not implemented.")}},{key:"getRTCOutData",value:function(e,t){throw new Error("JSEngine's method not implemented.")}},{key:"getRTCToken",value:(r=Tt(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:So.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeJoinRTCRoom(n,r),s=new ig(pg[pg.rtcToken],i,t),e.abrupt("return",this._channel.send(s,ah));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"setRTCState",value:(n=Tt(regeneratorRuntime.mark((function e(t,n){var r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",So.RC_NET_CHANNEL_INVALID);case 2:return r=this._channel.codec.encodeSetRTCState(n),i=new ig(pg[pg.rtcUserState],r,t),e.next=6,this._channel.send(i);case 6:return s=e.sent,o=s.code,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getRTCUserInfo",value:(t=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"getRTCUserList",value:function(e){if(!this._channel)return Promise.resolve({code:So.RC_NET_CHANNEL_INVALID});var t=this._channel.codec.encodeGetRTCRoomInfo(),n=new ig(pg[pg.rtcUList],t,e);return this._channel.send(n,eh)}},{key:"callExtra",value:function(e){return Promise.resolve({code:So.EXTRA_METHOD_UNDEFINED})}},{key:"clearConversations",value:function(){throw new Error("Method not implemented.")}},{key:"setUserStatusListener",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setUserStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"subscribeUserStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"getUserStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"addToBlacklist",value:function(e){throw new Error("Method not implemented.")}},{key:"removeFromBlacklist",value:function(e){throw new Error("Method not implemented.")}},{key:"getBlacklist",value:function(){throw new Error("Method not implemented.")}},{key:"getBlacklistStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"insertMessage",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"deleteMessages",value:function(e){throw new Error("Method not implemented.")}},{key:"deleteMessagesByTimestamp",value:function(e,t,n,r,i){throw new Error("Method not implemented.")}},{key:"clearMessages",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"getMessage",value:function(e){throw new Error("Method not implemented.")}},{key:"setMessageContent",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"setMessageSearchField",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"searchConversationByContent",value:function(e,t,n,r){throw new Error("Method not implemented.")}},{key:"searchMessageByContent",value:function(e,t,n,r,i,s){throw new Error("Method not implemented.")}},{key:"getUnreadMentionedMessages",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setMessageSentStatus",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setMessageReceivedStatus",value:function(e,t){throw new Error("Method not implemented.")}},{key:"clearUnreadCountByTimestamp",value:function(e,t,n,r){throw new Error("Method not implemented.")}},{key:"getConversationNotificationStatus",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"getRemoteHistoryMessages",value:function(e,t,n,r,i,s){throw new Error("Method not implemented.")}}]),ie}(Cg),vd=function(){function e(t){Rt(this,e),this._context=t}return Ct(e,[{key:"getCoreVersion",value:function(){return this._context.coreVersion}},{key:"getAPIVersion",value:function(){return this._context.apiVersion}},{key:"getAppkey",value:function(){return this._context.appkey}},{key:"getCurrentId",value:function(){return this._context.getCurrentUserId()}},{key:"getConnectionStatus",value:function(){return this._context.getConnectionStatus()}},{key:"sendMessage",value:function(e,t,n){return this._context.sendMessage(e,t,n)}},{key:"registerMessageType",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this._context.registerMessageType(e,t,n,r)}}]),e}(),yd=function(e){Ot(n,e);var t=Pt(n);function n(){return Rt(this,n),t.apply(this,arguments)}return Ct(n,[{key:"getNaviInfo",value:function(){return this._context.getInfoFromCache()}},{key:"joinRTCRoom",value:function(e,t,n){return this._context.joinRTCRoom(e,t,n)}},{key:"quitRTCRoom",value:function(e){return this._context.quitRTCRoom(e)}},{key:"rtcPing",value:function(e,t,n){return this._context.rtcPing(e,t,n)}},{key:"getRTCRoomInfo",value:function(e){return this._context.getRTCRoomInfo(e)}},{key:"getRTCUserInfoList",value:function(e){return this._context.getRTCUserInfoList(e)}},{key:"getRTCUserInfo",value:function(e){return this._context.getRTCUserInfo(e)}},{key:"setRTCUserInfo",value:function(e,t,n){return this._context.setRTCUserInfo(e,t,n)}},{key:"removeRTCUserInfo",value:function(e,t){return this._context.removeRTCUserInfo(e,t)}},{key:"setRTCData",value:function(e,t,n,r,i,s){return this._context.setRTCData(e,t,n,r,i,s)}},{key:"setRTCTotalRes",value:function(e,t,n,r){return this._context.setRTCTotalRes(e,t,n,r)}},{key:"getRTCData",value:function(e,t,n,r){return this._context.getRTCData(e,t,n,r)}},{key:"removeRTCData",value:function(e,t,n,r,i){return this._context.removeRTCData(e,t,n,r,i)}},{key:"setRTCOutData",value:function(e,t,n,r){return this._context.setRTCOutData(e,t,n,r)}},{key:"getRTCOutData",value:function(e,t){return this._context.getRTCOutData(e,t)}},{key:"getRTCToken",value:function(e,t,n){return this._context.getRTCToken(e,t,n)}},{key:"setRTCState",value:function(e,t){return this._context.setRTCState(e,t)}},{key:"getRTCUserList",value:function(e){return this._context.getRTCUserList(e)}}]),n}(vd),md=function(){function e(){Rt(this,e)}return Ct(e,null,[{key:"compress",value:function(e){for(var t=this,n={},r=0;r<e.length-1;r++){var i=e.charAt(r)+e.charAt(r+1);n.hasOwnProperty(i)?n[i].push(r):n[i]=[r]}for(var s=[],o=[],a=function(){if(o.length>0){var e=o.join("");if(o=[],e.length>26){var n=t.numberEncode(e.length),r=String.fromCharCode(t.dataType.NormalExt|n.length);s.push(r+n)}else{var i=String.fromCharCode(t.dataType.Normal|e.length);s.push(i)}s.push(e)}},u=0;u<e.length;){var c=t.indexOf(n,e,u);if(c.length<2)o.push(e.charAt(u++));else if(c.length<4)o.push(e.substr(u,c.length)),u+=c.length;else{var l=t.numberEncode(u-c.offset),h=t.numberEncode(c.length);if(l.length+h.length>=c.length)o.push(e.substr(u,c.length)),u+=c.length;else{a();var f=String.fromCharCode(t.dataType.Compressed|l.length<<2|h.length);s.push(f+l+h),u+=c.length}}}a();var g=t.numberEncode(e.length),d=String.fromCharCode(t.dataType.Tail|g.length);return s.push(d+g),s.join("")}},{key:"uncompress",value:function(e){var t=this,n=0,r="";e:do{var i=e.charCodeAt(n++),s=i&t.dataType.Mark,o=15&i,a=void 0;switch(s){case t.dataType.Compressed:var u=o>>2,c=3&o;if(0===u||0===c)throw new Error("Data parsing error,at "+n);var l=t.numberDecode(e.substr(n,u)),h=t.numberDecode(e.substr(n+=u,c));if((l=r.length-l)+h>r.length)throw new Error("Data parsing error,at "+n);n+=c,r+=r.substr(l,h);break;case t.dataType.Tail:if((a=t.numberDecode(e.substr(n,o)))!==r.length)throw console.log(r.length),console.log(a),new Error("Data parsing error,at "+n);n+=o;break e;case t.dataType.NormalExt:a=t.numberDecode(e.substr(n,o)),r+=e.substr(n+=o,a),n+=a;break;case t.dataType.Normal:r+=e.substr(n,o),n+=o;break;case t.dataType.Mark:if(o>10)throw new Error("Data parsing error,at "+n);r+=e.substr(n,16+o),n+=16+o;break;default:throw new Error("Data parsing error,at "+n+" header:"+s)}}while(n<e.length);return r}},{key:"indexOf",value:function(e,t,n){var r={length:0,offset:-1};if(t.length,n>=t.length-1)return r;var i=e[t.charAt(n)+t.charAt(n+1)];if(i[0]===n)return r;for(var s=t.length-n,o=0,a=i.length;o<a;o++){var u=i[o],c=n-u;if(!(c>this.max)){var l=Math.min(s,c);if(l<=r.length)break;if(!(r.length>2&&t.charAt(u+r.length-1)!==t.charAt(n+r.length-1))){for(var h=2,f=h;f<l&&t.charAt(u+f)===t.charAt(n+f);f++)h++;h>=r.length&&(r.length=h,r.offset=u)}}}return r}},{key:"numberEncode",value:function(e){var t=this,n=[],r=0;do{r=e%t.scale,n.push(t.chars.charAt(r)),e=(e-r)/t.scale}while(e>0);return n.join("")}},{key:"numberDecode",value:function(e){for(var t=0,n=0,r=e.length-1;r>=0;r--){if(-1===(n=this.chars.indexOf(e.charAt(r))))throw new Error('decode number error, data is "'+e+'"');t=t*this.scale+n}return t}}]),e}();md.dataType={Tail:48,Compressed:64,NormalExt:80,Normal:96,Mark:112},md.chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",md.scale=md.chars.length,md.max=238327;var _d=1,Ed=!1,Td="undefined"!=typeof location&&"https://"===location.protocol?"https://":"http://",Rd=function(){function e(t){Rt(this,e),this.info=t,this.logUrl="logcollection.ronghub.com",this.level=1,this.itv=30,this.times=5,this.deviceId="",this.deviceInfo="",this.logSwitch=0,this.logUrl=t.logPolicy.url||this.logUrl,this.level=t.logPolicy.level||this.level,this.itv=t.logPolicy.itv||this.itv,this.times=t.logPolicy.times||this.times,this.deviceId=function(e){var t="RCDeviceId",n=hn(e),r="",i=n.get(t);return i?r=i:(r=Ss(),n.set(t,r)),r}(t.runtime),this.logSwitch=t.logSwitch;var n=Vo(t.runtime);this.deviceInfo="".concat(n.type,"|").concat(n.version,"|").concat(Gs.sessionId),this.startReport()}var t;return Ct(e,[{key:"startReport",value:function(){var e=this;if(this.logSwitch&&Ed){var t=this.itv*Math.pow(2,_d-1);_d<this.times&&_d++,setTimeout((function(){e.reportRealtimeLog()}),1e3*t)}}},{key:"reportRealtimeLog",value:function(){var e=this,t=Gs.realTimeLogList.filter((function(t){return t.level<=e.level}));if(0!==t.length){var n=md.compress(t.map((function(e){return e.content})).join("")),r="".concat(Td).concat(this.logUrl,"?version=").concat(this.info.version,"&appkey=").concat(this.info.appkey,"&userId=").concat(this.info.userId,"&deviceId=").concat(this.deviceId,"&deviceInfo=").concat(this.deviceInfo,"&platform=Web");this.info.runtime.httpReq({method:"POST",url:r,body:n}).then((function(t){Hs.__clearRealTimeLog(),Hs.debug("report real-time log success");var n=t.data;n&&(n=JSON.parse(n),e.itv=n.nextTime,e.level=n.level,e.logSwitch=n.logSwitch,_d=1),e.startReport()})).catch((function(t){Hs.debug("report real-time log error -> "+t),e.startReport()}))}else this.startReport()}},{key:"reportFullLog",value:(t=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.startTime,r=t.endTime,i=t.platform,s=t.logId,o=t.uri,a=ps.getInstance(),"web"===i.toLowerCase()&&a){e.next=4;break}return e.abrupt("return");case 4:if(!(n>r)){e.next=7;break}return Hs.warn("report error: The start time(".concat(n,") cannot be greater than the end time(").concat(n,")")),e.abrupt("return");case 7:return e.next=9,Hs.__insertLogIntoDatabase();case 9:return e.next=11,a.getRangeData(gs,"time",n,r);case 11:u=(u=e.sent).filter((function(e){return!e.userId||e.userId===h.info.userId})),c=md.compress(u.map((function(e){return e.content})).join("")||"no data"),l=1,function e(){if(!(l>3)&&Ed){var t=o||h.logUrl,n="".concat(Td).concat(t,"?version=").concat(h.info.version,"&appkey=").concat(h.info.appkey,"&userId=").concat(h.info.userId,"&logId=").concat(s,"&deviceId=").concat(h.deviceId,"&deviceInfo=").concat(h.deviceInfo,"&platform=Web"),r=5e3*(l-1);l++,setTimeout((function(){Ed&&h.info.runtime.httpReq({url:n,method:"POST",body:c}).then((function(){Hs.debug("report full log success!")})).catch((function(t){e(),Hs.warn("report full log error -> "+t)}))}),r)}}();case 18:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"distroy",value:function(){_d=1,Ed=!1}}],[{key:"init",value:function(t){return Ed=!0,e._instance||(e._instance=new e(t)),e._instance}},{key:"getInstance",value:function(){return e._instance}}]),e}();function Id(e){return Object.assign({},e)}var Cd,Sd=function(){function e(t,n){Rt(this,e),this._runtime=t,this._token="",this._pluginContextQueue=[],this._pluginInstanseMap={},this.coreVersion="4.4.0-enterprise.1",this._versionInfo={},this._typingInfo={},this._connectionStatus=fg.DISCONNECTED,this._canRedirectConnect=!1,this._watcher={message:void 0,conversationState:void 0,chatroomState:void 0,connectionState:void 0,rtcInnerWatcher:void 0,expansion:void 0,tag:void 0,conversationTagChanged:void 0,typingState:void 0},this._typingInternalTimer=-1,this._typingExpireTime=2e3,this._typingChangedList=[],this._options=Object.assign({},n),this.appkey=this._options.appkey,this.apiVersion=this._options.apiVersion,this._options.typingExpireTime&&(this._options.typingExpireTime<2e3?this._typingExpireTime=2e3:this._options.typingExpireTime>6e3?this._typingExpireTime=6e3:this._typingExpireTime=this._options.typingExpireTime),this._options.navigators=this._options.navigators.filter((function(e){return/^https?:\/\//.test(e)})),this._options.navigators=this._options.navigators.map((function(e){return e.replace(/\/$/g,"")})),this._options.navigators.length;var r={status:this._connectionStatusListener.bind(this),message:this._messageReceiver.bind(this),chatroom:this._chatroomInfoListener.bind(this),conversation:this._conversationInfoListener.bind(this),expansion:this._expansionInfoListener.bind(this),tag:this._tagListener.bind(this),conversationTag:this._conversationTagListener.bind(this)};this._engine=Do()?new RCCppEngine(t,r,this._options):new pd(t,r,this._options)}var t,n,r,i,s,o,a,u,c,l,h,f,g,d,p,v,y,m,_,E,T,R,I,C,S,b,w,O,N,k,A,M,x,L,U,P,D,V,B;return Ct(e,[{key:"install",value:function(e,t){if(this._pluginInstanseMap[e.tag])return Hs.warn("Repeat install plugin: ".concat(e.tag)),this._pluginInstanseMap[e.tag];var n="RCRTC"===e.tag?new yd(this):new vd(this),r=null;try{if(!e.verify(this._runtime))return null;r=e.setup(n,this._runtime,t)}catch(e){Hs.error("install plugin error!\n",e)}return["RCRTC","RCCall"].includes(e.tag)&&e.version&&e.name&&(this._versionInfo[e.name]=e.version),r&&this._pluginContextQueue.push(n),r&&(this._pluginInstanseMap[e.tag]=r),r}},{key:"_handleRedirect",value:(B=Tt(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Hs.debug("_handleRedirct",this._token),e.next=3,this.connect(this._token,!0);case 3:e.sent.code!==So.SUCCESS&&this._canRedirectConnect&&setTimeout((function(){t._handleRedirect()}),5e3);case 6:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"_connectionStatusListener",value:(V=Tt(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t===fg.REDIRECT&&(this._canRedirectConnect=!0,this._handleRedirect()),t!==fg.BLOCKED&&t!==fg.KICKED_OFFLINE_BY_OTHER_CLIENT&&t!==fg.DISCONNECT_BY_SERVER||(this._canRedirectConnect=!1),this._connectionStatus=t,(null===(n=this._watcher.rtcInnerWatcher)||void 0===n?void 0:n.status)&&this._watcher.rtcInnerWatcher.status(t),this._pluginContextQueue.forEach((function(e){e.onconnectionstatechange&&e.onconnectionstatechange(t)})),this._watcher.connectionState&&this._watcher.connectionState(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)})},{key:"_messageReceiver",value:function(e,t,n){if((e.conversationType===ws.RTC_ROOM||Object.prototype.hasOwnProperty.call(cd,e.messageType))&&this._watcher.rtcInnerWatcher&&this._watcher.rtcInnerWatcher.message)this._watcher.rtcInnerWatcher.message(Id(e));else if("RC:TypSts"!==e.messageType||(this._addTypingInfo(Id(e)),!this._watcher.typingState))if(e.messageType!==uf.LOG_COMMAND||"rongcloudsystem"!==e.senderUserId)this._pluginContextQueue.some((function(t){if(!t.onmessage)return!1;try{return t.onmessage(Id(e))}catch(e){return Hs.error("plugin error =>",e),!1}}))||this._watcher.message&&this._watcher.message(Id(e),t,n);else{var r,i=e.content,s=i.startTime,o=i.endTime,a=i.platform,u=i.logId,c=i.uri,l=i.packageName,h={startTime:parseInt(s),endTime:parseInt(o),platform:a,logId:u,uri:c,packageName:l};null===(r=Rd.getInstance())||void 0===r||r.reportFullLog(h)}}},{key:"_chatroomInfoListener",value:function(e){this._watcher.chatroomState&&this._watcher.chatroomState(e)}},{key:"_conversationInfoListener",value:function(e){this._watcher.conversationState&&this._watcher.conversationState(e)}},{key:"_expansionInfoListener",value:function(e){this._watcher.expansion&&this._watcher.expansion(e)}},{key:"_tagListener",value:function(){this._watcher.tag&&this._watcher.tag()}},{key:"_conversationTagListener",value:function(){this._watcher.conversationTagChanged&&this._watcher.conversationTagChanged()}},{key:"_typingStatusListener",value:function(e){this._watcher.typingState&&this._watcher.typingState(e)}},{key:"assignWatcher",value:function(e){var t=this;Object.keys(this._watcher).forEach((function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t._watcher[n]=Ds(r)||Ps(r)?r:void 0}}))}},{key:"_addTypingInfo",value:function(e){var t=e.senderUserId,n=e.conversationType,r=e.targetId,i=e.content,s=e.channelId,o=i.typingContentType,a=s||"",u="".concat(n,"#").concat(r,"#").concat(a);this._typingInfo[u]||(this._typingInfo[u]=[]);var c=this._typingInfo[u].findIndex((function(e){return e.userId===t}));c>=0&&this._typingInfo[u][c].messageType===o?this._typingInfo[u][c].timestamp=Date.now():(c>=0&&this._typingInfo[u].splice(c,1),this._typingInfo[u].push({userId:t,messageType:o,timestamp:Date.now()}),this._typingChangedList.includes(u)||this._typingChangedList.push(u),this._startCheckTypingInfo())}},{key:"_startCheckTypingInfo",value:function(){var e=this;-1===this._typingInternalTimer&&0!==Object.keys(this._typingInfo).length&&(this._typingInternalTimer=setInterval((function(){for(var t in e._typingInfo){var n=e._typingInfo[t].length;e._typingInfo[t]=e._typingInfo[t].filter((function(t){return Date.now()-t.timestamp<e._typingExpireTime})),e._typingInfo[t].length===n||e._typingChangedList.includes(t)||e._typingChangedList.push(t),0===e._typingInfo[t].length&&delete e._typingInfo[t]}if(e._typingChangedList.length>0){var r=e._typingChangedList.map((function(t){return{conversationType:Number(t.split("#")[0]),targetId:t.split("#")[1],channelId:t.split("#")[2],list:e._typingInfo[t]||[]}}));e._typingStatusListener(r),e._typingChangedList=[]}0===Object.keys(e._typingInfo).length&&(clearInterval(e._typingInternalTimer),e._typingInternalTimer=-1)}),500))}},{key:"getConnectedTime",value:function(){return this._engine.getConnectedTime()}},{key:"getCurrentUserId",value:function(){return this._engine.currentUserId}},{key:"getConnectionStatus",value:function(){return this._connectionStatus}},{key:"connect",value:(D=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]&&l[1],this._connectionStatus!==fg.CONNECTED){e.next=3;break}return e.abrupt("return",{code:So.SUCCESS,userId:this._engine.currentUserId});case 3:if(this._connectionStatus!==fg.CONNECTING){e.next=5;break}return e.abrupt("return",{code:So.BIZ_ERROR_CONNECTING});case 5:if("string"==typeof t&&0!==t.length){e.next=7;break}return e.abrupt("return",{code:So.RC_CONN_USER_OR_PASSWD_ERROR});case 7:return this._token=t,r=t.split("@"),i=Vt(r,2),s=i[1],o=s?s.split(";").map((function(e){return/^https?:/.test(e)?e:"https://".concat(e)})):[],e.next=12,this._engine.navi.getInfo(this._getTokenWithoutNavi(),o,n);case 12:if(a=e.sent){e.next=15;break}return e.abrupt("return",{code:So.RC_NAVI_RESOURCE_ERROR});case 15:e.next=17;break;case 17:return u=wt({engine:this.coreVersion,imlib:this.apiVersion},this._versionInfo),e.next=20,this._engine.connect(this._getTokenWithoutNavi(),a);case 20:if(c=e.sent,Hs.__insertLogIntoDatabase(),c!==lg.REDIRECT){e.next=27;break}return this._connectionStatus=fg.REDIRECT,e.next=26,this.connect(t,!0);case 26:return e.abrupt("return",e.sent);case 27:return c===So.SUCCESS&&(Hs.info("connect success, userId: ".concat(this._engine.currentUserId)),this._engine.reportSDKInfo&&this._engine.reportSDKInfo(u),Rd.init({runtime:this._runtime,logSwitch:(null==a?void 0:a.logSwitch)||0,logPolicy:JSON.parse((null==a?void 0:a.logPolicy)||"{}"),appkey:this.appkey,version:this.apiVersion,userId:this._engine.currentUserId}),Gs.init(this._engine.currentUserId)),c!==So.SUCCESS||Do()||1===a.openUS&&this._pullUserSettings(),c!==So.SUCCESS&&(this._connectionStatus=fg.CONNECTION_CLOSED),e.abrupt("return",{code:c,userId:this._engine.currentUserId});case 31:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"_pullUserSettings",value:(P=Tt(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)}))),function(){return P.apply(this,arguments)})},{key:"disconnect",value:function(){var e;return clearInterval(this._typingInternalTimer),this._typingInternalTimer=-1,null===(e=Rd.getInstance())||void 0===e||e.distroy(),Hs.__insertLogIntoDatabase(),Gs.reset(),this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondisconnect)try{e.ondisconnect()}catch(e){Hs.error("plugin error =>",e)}})),Promise.resolve()}},{key:"reconnect",value:function(){return this.connect(this._getTokenWithoutNavi())}},{key:"_getTokenWithoutNavi",value:function(){return this._token.replace(/@.+$/,"@")}},{key:"getInfoFromCache",value:function(){return this._engine.navi.getInfoFromCache(this._getTokenWithoutNavi())}},{key:"registerMessageType",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this._engine.registerMessageType(e,t,n,r)}},{key:"sendMessage",value:function(e,t,n,r){var i=this.getInfoFromCache();if(1===((null==i?void 0:i.grpRRVer)||0)&&n.messageType===uf.READ_RECEIPT_RESPONSE)return Promise.resolve({code:So.READ_RECEIPT_ERROR});if(e===ws.SYSTEM)return Promise.resolve({code:So.BIZ_ERROR_INVALID_PARAMETER});var s=JSON.stringify(n.content);return jn(s)>an?Promise.resolve({code:So.RC_MSG_CONTENT_EXCEED_LIMIT}):this._engine.sendMessage(e,t,n,r)}},{key:"sendExpansionMessage",value:(U=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l,h,f,g,d,p,v,y,m,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.channelId,r=t.conversationType,i=t.targetId,s=t.messageUId,o=t.keys,a=t.expansion,u=t.originExpansion,c=t.removeAll,t.canIncludeExpansion){e.next=3;break}return e.abrupt("return",{code:So.MESSAGE_KV_NOT_SUPPORT});case 3:if(l=!1,h=!1,Ps(a))for(p in u=u||{},f=Object.keys(a).length,g=Object.assign(u,a),d=Object.keys(g).length,l=d>300||f>20,a)v=a[p],l=p.length>32||v.length>64,h=!/^[A-Za-z0-9_=+-]+$/.test(p);if(!l){e.next=8;break}return e.abrupt("return",{code:So.EXPANSION_LIMIT_EXCEET});case 8:if(!h){e.next=10;break}return e.abrupt("return",{code:So.BIZ_ERROR_INVALID_PARAMETER});case 10:return y={mid:s},a&&(y.put=a),o&&(y.del=o),c&&(y.removeAll=1),e.next=16,this._engine.sendMessage(r,i,{content:y,messageType:uf.EXPANSION_NOTIFY,channelId:n});case 16:return m=e.sent,_=m.code,e.abrupt("return",{code:_});case 19:case"end":return e.stop()}}),e,this)}))),function(e){return U.apply(this,arguments)})},{key:"sendReadReceiptMessage",value:(L=Tt(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==((null==(i=this.getInfoFromCache())?void 0:i.grpRRVer)||0)){e.next=4;break}return e.abrupt("return",{code:So.READ_RECEIPT_ERROR,data:"The read receipt switch is not on, please call the sendMessage method!"});case 4:return e.abrupt("return",this._engine.sendReadReceiptMessage(t,n,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return L.apply(this,arguments)})},{key:"getMessageReader",value:(x=Tt(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==((null==(i=this.getInfoFromCache())?void 0:i.grpRRVer)||0)){e.next=4;break}return e.abrupt("return",{code:So.READ_RECEIPT_ERROR});case 4:return e.abrupt("return",this._engine.getMessageReader(t,n,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return x.apply(this,arguments)})},{key:"_destroy",value:function(){var e;this._watcher={},this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondestroy)try{e.ondestroy()}catch(e){Hs.error("plugin error =>",e)}})),this._pluginContextQueue.length=0,this._pluginInstanseMap={},null===(e=Rd.getInstance())||void 0===e||e.distroy(),Gs.reset()}},{key:"getHistoryMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return this._engine.getHistoryMessage(e,t,n,r,i,s,o||"")}},{key:"getConversationList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return this._engine.getConversationList(e,t,n,r,i)}},{key:"getConversation",value:function(e,t,n){return this._engine.getConversation(e,t,n)}},{key:"removeConversation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.removeConversation(e,t,n)}},{key:"clearUnreadCount",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.clearConversationUnreadCount(e,t,n)}},{key:"getUnreadCount",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.getConversationUnreadCount(e,t,n)}},{key:"getTotalUnreadCount",value:function(e,t,n){return this._engine.getAllConversationUnreadCount(e,t&&t.length>0?t:[ws.PRIVATE,ws.GROUP,ws.SYSTEM,ws.PUBLIC_SERVICE],!!n)}},{key:"setConversationStatus",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=[{conversationType:e,targetId:t,isTop:n,notificationStatus:r,channelId:i}];return this._engine.batchSetConversationStatus(s)}},{key:"saveConversationMessageDraft",value:function(e,t,n){return this._engine.saveConversationMessageDraft(e,t,n)}},{key:"getConversationMessageDraft",value:function(e,t){return this._engine.getConversationMessageDraft(e,t)}},{key:"clearConversationMessageDraft",value:function(e,t){return this._engine.clearConversationMessageDraft(e,t)}},{key:"recallMessage",value:function(e,t,n,r,i){return this._engine.recallMsg(e,t,n,r,i)}},{key:"deleteRemoteMessage",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this._engine.deleteRemoteMessage(e,t,n,r)}},{key:"deleteRemoteMessageByTimestamp",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this._engine.deleteRemoteMessageByTimestamp(e,t,n,r)}},{key:"joinChatroom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return this._engine.joinChatroom(e,t)}},{key:"joinExistChatroom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return this._engine.joinExistChatroom(e,t)}},{key:"quitChatroom",value:function(e){return this._engine.quitChatroom(e)}},{key:"getChatroomInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._engine.getChatroomInfo(e,t,n)}},{key:"setChatroomEntry",value:function(e,t){var n=t.key,r=t.value;return ko(n)&&Ao(r)?this._engine.setChatroomEntry(e,t):Promise.resolve(So.BIZ_ERROR_INVALID_PARAMETER)}},{key:"forceSetChatroomEntry",value:function(e,t){var n=t.key,r=t.value;return ko(n)&&Ao(r)?this._engine.forceSetChatroomEntry(e,t):Promise.resolve(So.BIZ_ERROR_INVALID_PARAMETER)}},{key:"removeChatroomEntry",value:function(e,t){var n=t.key;return ko(n)?this._engine.removeChatroomEntry(e,t):Promise.resolve(So.BIZ_ERROR_INVALID_PARAMETER)}},{key:"forceRemoveChatroomEntry",value:function(e,t){var n=t.key;return ko(n)?this._engine.forceRemoveChatroomEntry(e,t):Promise.resolve(So.BIZ_ERROR_INVALID_PARAMETER)}},{key:"getChatroomEntry",value:function(e,t){return this._engine.getChatroomEntry(e,t)}},{key:"getAllChatroomEntries",value:function(e){return this._engine.getAllChatroomEntry(e)}},{key:"getChatRoomHistoryMessages",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this._engine.getChatroomHistoryMessages(e,r,t,n)}},{key:"getFileToken",value:(M=Tt(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.getInfoFromCache(),o=(null==s?void 0:s.bosAddr)||"",a=(null==s?void 0:s.uploadServer)||"",u=(null==s?void 0:s.ossConfig)||"",e.next=6,this._engine.getFileToken(t,n,r,i);case 6:if(c=e.sent,l=c.code,h=c.data,l!==So.SUCCESS){e.next=11;break}return e.abrupt("return",Promise.resolve(Object.assign(h,{bos:o,qiniu:a,ossConfig:u})));case 11:return e.abrupt("return",Promise.reject(l));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return M.apply(this,arguments)})},{key:"getFileUrl",value:(A=Tt(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=c.length>4&&void 0!==c[4]?c[4]:ad.QINIU,null==i||!i.isBosRes){e.next=3;break}return e.abrupt("return",Promise.resolve(i));case 3:return e.next=5,this._engine.getFileUrl(t,s,n,r);case 5:if(o=e.sent,a=o.code,u=o.data,a!==So.SUCCESS){e.next=10;break}return e.abrupt("return",Promise.resolve(u));case 10:return e.abrupt("return",Promise.reject(a));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return A.apply(this,arguments)})},{key:"createTag",value:(k=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.createTag(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"removeTag",value:(N=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeTag(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"updateTag",value:(O=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.updateTag(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return O.apply(this,arguments)})},{key:"getTagList",value:(w=Tt(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getTagList());case 1:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"addTagForConversations",value:(b=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>1e3)){e.next=2;break}return e.abrupt("return",Promise.reject(So.CONVER_OUT_LIMIT_ERROR));case 2:return e.abrupt("return",this._engine.addTagForConversations(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"removeTagForConversations",value:(S=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeTagForConversations(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"removeTagsForConversation",value:(C=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeTagsForConversation(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return C.apply(this,arguments)})},{key:"getConversationListByTag",value:(I=Tt(regeneratorRuntime.mark((function e(t,n,r,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getConversationListByTag(t,n,r,i));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return I.apply(this,arguments)})},{key:"getUnreadCountByTag",value:(R=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getUnreadCountByTag(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return R.apply(this,arguments)})},{key:"setConversationStatusInTag",value:(T=Tt(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setConversationStatusInTag(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return T.apply(this,arguments)})},{key:"getTagsForConversation",value:(E=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getTagsForConversation(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"callExtra",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this._engine).callExtra.apply(t,[e].concat(r))}},{key:"clearConversations",value:(_=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._engine.clearConversations(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return _.apply(this,arguments)})},{key:"setUserStatusListener",value:function(e,t){return this._engine.setUserStatusListener(e,(function(e){try{t(e)}catch(e){Hs.error(e)}}))}},{key:"addToBlacklist",value:(m=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.addToBlacklist(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"removeFromBlacklist",value:(y=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeFromBlacklist(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"getBlacklist",value:(v=Tt(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getBlacklist());case 1:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"getBlacklistStatus",value:(p=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getBlacklistStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"insertMessage",value:(d=Tt(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.insertMessage(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"deleteMessages",value:(g=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.deleteMessages(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"deleteMessagesByTimestamp",value:(f=Tt(regeneratorRuntime.mark((function e(t,n,r,i){var s,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=o.length>4&&void 0!==o[4]?o[4]:"",e.abrupt("return",this._engine.deleteMessagesByTimestamp(t,n,r,i,s));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return f.apply(this,arguments)})},{key:"clearMessages",value:(h=Tt(regeneratorRuntime.mark((function e(t,n){var r,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:"",e.abrupt("return",this._engine.clearMessages(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"getMessage",value:(l=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getMessage(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"setMessageContent",value:(c=Tt(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageContent(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"setMessageSearchField",value:(u=Tt(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageSearchField(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"setMessageSentStatus",value:(a=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageSentStatus(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"setMessageReceivedStatus",value:(o=Tt(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageReceivedStatus(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"setUserStatus",value:(s=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setUserStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"subscribeUserStatus",value:(i=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.subscribeUserStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getUserStatus",value:(r=Tt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getUserStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"searchConversationByContent",value:(n=Tt(regeneratorRuntime.mark((function e(t){var n,r,i,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:[],r=s.length>2&&void 0!==s[2]?s[2]:"",i=s.length>3?s[3]:void 0,e.abrupt("return",this._engine.searchConversationByContent(t,n,r,i));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"searchMessageByContent",value:(t=Tt(regeneratorRuntime.mark((function e(t,n,r,i,s,o){var a,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>6&&void 0!==u[6]?u[6]:"",e.abrupt("return",this._engine.searchMessageByContent(t,n,r,i,s,o,a));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n,r,i,s,o){return t.apply(this,arguments)})},{key:"getUnreadMentionedMessages",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.getUnreadMentionedMessages(e,t,n)}},{key:"clearUnreadCountByTimestamp",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this._engine.clearUnreadCountByTimestamp(e,t,n,r)}},{key:"getConversationNotificationStatus",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.getConversationNotificationStatus(e,t,n)}},{key:"getRemoteHistoryMessages",value:function(e,t,n,r,i,s){return this._engine.getRemoteHistoryMessages(e,t,n,r,i,s)}},{key:"joinRTCRoom",value:function(e,t,n){return this._engine.joinRTCRoom(e,t,n)}},{key:"quitRTCRoom",value:function(e){return this._engine.quitRTCRoom(e)}},{key:"rtcPing",value:function(e,t,n){return this._engine.rtcPing(e,t,n)}},{key:"getRTCRoomInfo",value:function(e){return this._engine.getRTCRoomInfo(e)}},{key:"getRTCUserInfoList",value:function(e){return this._engine.getRTCUserInfoList(e)}},{key:"getRTCUserInfo",value:function(e){return this._engine.getRTCUserInfo(e)}},{key:"setRTCUserInfo",value:function(e,t,n){return this._engine.setRTCUserInfo(e,t,n)}},{key:"removeRTCUserInfo",value:function(e,t){return this._engine.removeRTCUserInfo(e,t)}},{key:"setRTCData",value:function(e,t,n,r,i,s){return this._engine.setRTCData(e,t,n,r,i,s)}},{key:"setRTCTotalRes",value:function(e,t,n,r){return this._engine.setRTCTotalRes(e,t,n,r)}},{key:"getRTCData",value:function(e,t,n,r){return this._engine.getRTCData(e,t,n,r)}},{key:"removeRTCData",value:function(e,t,n,r,i){return this._engine.removeRTCData(e,t,n,r,i)}},{key:"setRTCOutData",value:function(e,t,n,r){return this._engine.setRTCOutData(e,t,n,r)}},{key:"getRTCOutData",value:function(e,t){return this._engine.getRTCOutData(e,t)}},{key:"getRTCToken",value:function(e,t,n){return this._engine.getRTCToken(e,t,n)}},{key:"setRTCState",value:function(e,t){return this._engine.setRTCState(e,t)}},{key:"getRTCUserList",value:function(e){return this._engine.getRTCUserList(e)}}],[{key:"init",value:function(t,n){return Hs.setLogLevel(n.logLevel),Hs.setLogStdout(n.logStdout),n.indexDBSwitch&&ps.init(),Hs.debug("APIContext.init =>",n.appkey,n.navigators),this._context?(Hs.error("Repeat initialize!"),this._context):(Hs.warn("RCEngine Commit:","f865daea10d633176e22719b268eefec30cf4ffc"),this._context=new e(t,n),Hs.__insertLogIntoDatabase(),this._context)}},{key:"destroy",value:function(){this._context&&(this._context._destroy(),this._context=void 0)}}]),e}();e.TagChangeType=void 0,(Cd=e.TagChangeType||(e.TagChangeType={}))[Cd.add=1]="add",Cd[Cd.update=2]="update",Cd[Cd.delete=3]="delete";e.AEngine=Cg,e.ANavi=kg,e.APIContext=Sd,e.AppStorage=gn,e.CPP_PROTOCAL_MSGTYPE_OPTION={"RC:DizNtf":{isCounted:!1,isPersited:!1}},e.CallLibMsgType=cd,e.ChatroomEntryType=jo,e.CometChannel=Ig,e.ConnectResultCode=lg,e.ConnectionStatus=fg,e.ConversationType=ws,e.DelayTimer=Go,e.ErrorCode=So,e.EventEmitter=Xs,e.FileType=Ns,e.IM_COMET_PULLMSG_TIMEOUT=45e3,e.IM_PING_INTERVAL_TIME=15e3,e.IM_PING_MIN_TIMEOUT=2e3,e.IM_PING_TIMEOUT=15e3,e.IM_SIGNAL_TIMEOUT=on,e.Logger=Gs,e.MAX_MESSAGE_CONTENT_BYTES=an,e.MINI_COMET_CONNECT_URIS=["cometproxy-cn.ronghub.com","mini-cn.ronghub.com"],e.MINI_SOCKET_CONNECT_URIS=["wsproxy.cn.ronghub.com","wsap-cn.ronghub.com"],e.MentionedType=of,e.MessageDirection=Yf,e.MessageType=uf,e.NAVI_CACHE_DURATION=nn,e.NAVI_REQ_TIMEOUT=1e4,e.NotificationStatus=gf,e.PING_REQ_TIMEOUT=5e3,e.PUBLIC_CLOUD_NAVI_URIS=sn,e.PluginContext=vd,e.RCAssertError=to,e.RTCPluginContext=yd,e.ReceivedStatus=n,e.SEND_MESSAGE_TYPE_OPTION=cn,e.STATUS_MESSAGE=ln,e.STORAGE_ROOT_KEY=un,e.UploadMethod=ad,e.WEB_SOCKET_TIMEOUT=rn,e.WebSocketChannel=Tg,e.appendUrl=function(e,t){if(e=e.replace(/\?$/,""),!t)return e;var n=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).filter((function(e){return!!e}));return n.length?[e,n.join("&")].join("?"):e},e.assert=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!no(e,t,n,r))throw new to("'".concat(e,"' is invalid: ").concat(JSON.stringify(t)))},e.cloneByJSON=Po,e.forEach=Mo,e.getBrowser=Vo,e.getMimeKey=function(e){var t="application/octet-stream";switch(e){case Ns.IMAGE:t="image/jpeg";break;case Ns.AUDIO:t="audio/amr";break;case Ns.VIDEO:t="video/3gpp";break;case Ns.SIGHT:t="video/mpeg4";break;case Ns.COMBINE_HTML:t="text/html"}return t},e.getUploadFileName=wo,e.indexOf=Lo,e.isArray=xs,e.isArrayBuffer=Ls,e.isBoolean=As,e.isFunction=Ds,e.isHttpUrl=function(e){return ks(e)&&/https?:\/\//.test(e)},e.isInObject=Uo,e.isInclude=function(e,t){return-1!==Lo(e,t)},e.isNull=Bs,e.isNumber=Ms,e.isObject=Ps,e.isString=ks,e.isUndefined=Vs,e.isValidChrmEntryKey=ko,e.isValidChrmEntryValue=Ao,e.isValidConversationType=function(e){return Ms(e)&&Object.prototype.hasOwnProperty.call(ws,e)},e.isValidFileType=function(e){return Ms(e)&&Object.prototype.hasOwnProperty.call(Ns,e)},e.map=xo,e.notEmptyArray=function(e){return xs(e)&&e.length>0},e.notEmptyObject=Fs,e.notEmptyString=Us,e.pushConfigsToJSON=Oo,e.pushJSONToConfigs=No,e.todo=function(e){return new dn(e)},e.usingCppEngine=Do,e.validate=no,e.version="4.4.0-enterprise.1",Object.defineProperty(e,"__esModule",{value:!0})}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@rongcloud/engine")):"function"==typeof define&&define.amd?define(["exports","@rongcloud/engine"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).RongIMLib={},e.RCEngine)}(this,(function(e,t){"use strict";var n;!function(e){e[e.SENDING=10]="SENDING",e[e.FAILED=20]="FAILED",e[e.SENT=30]="SENT",e[e.RECEIVED=40]="RECEIVED",e[e.READ=50]="READ",e[e.DESTROYED=60]="DESTROYED"}(n||(n={}));var s,r=n;!function(e){e[e.NONE=0]="NONE",e[e.SQQUENCE=1]="SQQUENCE",e[e.REVERSE=2]="REVERSE"}(s||(s={}));var o=s;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n,s,r,o,a){try{var i=e[o](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(s,r)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(s,r){var o=e.apply(t,n);function a(e){i(o,s,r,a,c,"next",e)}function c(e){i(o,s,r,a,c,"throw",e)}a(void 0)}))}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function d(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function v(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function R(e){var t={exports:{}};return e(t,t.exports),t.exports}R((function(e){var t=function(e){var t,n=Object.prototype,s=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,s){var r=t&&t.prototype instanceof v?t:v,o=Object.create(r.prototype),a=new b(s||[]);return o._invoke=function(e,t,n){var s=d;return function(r,o){if(s===g)throw new Error("Generator is already running");if(s===h){if("throw"===r)throw o;return U()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var i=E(a,n);if(i){if(i===C)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===d)throw s=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=g;var c=l(e,t,n);if("normal"===c.type){if(s=n.done?h:f,c.arg===C)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(s=h,n.method="throw",n.arg=c.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",g="executing",h="completed",C={};function v(){}function p(){}function R(){}var m={};m[o]=function(){return this};var y=Object.getPrototypeOf,S=y&&y(y(w([])));S&&S!==n&&s.call(S,o)&&(m=S);var I=R.prototype=v.prototype=Object.create(m);function M(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(r,o,a,i){var c=l(e[r],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&s.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,i)}))}i(c.arg)}var r;this._invoke=function(e,s){function o(){return new t((function(t,r){n(e,s,t,r)}))}return r=r?r.then(o,o):o()}}function E(e,n){var s=e.iterator[n.method];if(s===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return C;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var r=l(s,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,C;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,C):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,C)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function w(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(s.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:U}}function U(){return{value:t,done:!0}}return p.prototype=I.constructor=R,R.constructor=p,p.displayName=c(R,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,R):(e.__proto__=R,c(e,i,"GeneratorFunction")),e.prototype=Object.create(I),e},e.awrap=function(e){return{__await:e}},M(T.prototype),T.prototype[a]=function(){return this},e.AsyncIterator=T,e.async=function(t,n,s,r,o){void 0===o&&(o=Promise);var a=new T(u(t,n,s,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},M(I),c(I,i,"Generator"),I[o]=function(){return this},I.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var s=t.pop();if(s in e)return n.value=s,n.done=!1,n}return n.done=!0,n}},e.values=w,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(s,r){return i.type="throw",i.arg=e,n.next=s,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=s.call(a,"catchLoc"),u=s.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,C):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),C},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),C}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var s=n.completion;if("throw"===s.type){var r=s.arg;k(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,s){return this.delegate={iterator:w(e),resultName:n,nextLoc:s},"next"===this.method&&(this.arg=t),C}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var m=function(e){return e&&e.Math==Math&&e},y=m("object"==typeof globalThis&&globalThis)||m("object"==typeof window&&window)||m("object"==typeof self&&self)||m("object"==typeof p&&p)||function(){return this}()||Function("return this")(),S=function(e){try{return!!e()}catch(e){return!0}},I=!S((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),M={}.propertyIsEnumerable,T=Object.getOwnPropertyDescriptor,E={f:T&&!M.call({1:2},1)?function(e){var t=T(this,e);return!!t&&t.enumerable}:M},A=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},k={}.toString,b=function(e){return k.call(e).slice(8,-1)},w="".split,U=S((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==b(e)?w.call(e,""):Object(e)}:Object,N=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},L=function(e){return U(N(e))},x=function(e){return"object"==typeof e?null!==e:"function"==typeof e},_=function(e,t){if(!x(e))return e;var n,s;if(t&&"function"==typeof(n=e.toString)&&!x(s=n.call(e)))return s;if("function"==typeof(n=e.valueOf)&&!x(s=n.call(e)))return s;if(!t&&"function"==typeof(n=e.toString)&&!x(s=n.call(e)))return s;throw TypeError("Can't convert object to primitive value")},O={}.hasOwnProperty,P=function(e,t){return O.call(e,t)},B=y.document,j=x(B)&&x(B.createElement),D=function(e){return j?B.createElement(e):{}},G=!I&&!S((function(){return 7!=Object.defineProperty(D("div"),"a",{get:function(){return 7}}).a})),F=Object.getOwnPropertyDescriptor,K={f:I?F:function(e,t){if(e=L(e),t=_(t,!0),G)try{return F(e,t)}catch(e){}if(P(e,t))return A(!E.f.call(e,t),e[t])}},H=function(e){if(!x(e))throw TypeError(String(e)+" is not an object");return e},V=Object.defineProperty,q={f:I?V:function(e,t,n){if(H(e),t=_(t,!0),H(n),G)try{return V(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},W=I?function(e,t,n){return q.f(e,t,A(1,n))}:function(e,t,n){return e[t]=n,e},Y=function(e,t){try{W(y,e,t)}catch(n){y[e]=t}return t},J="__core-js_shared__",Q=y[J]||Y(J,{}),X=Function.toString;"function"!=typeof Q.inspectSource&&(Q.inspectSource=function(e){return X.call(e)});var z,$,Z,ee=Q.inspectSource,te=y.WeakMap,ne="function"==typeof te&&/native code/.test(ee(te)),se=R((function(e){(e.exports=function(e,t){return Q[e]||(Q[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.9.1",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})})),re=0,oe=Math.random(),ae=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++re+oe).toString(36)},ie=se("keys"),ce=function(e){return ie[e]||(ie[e]=ae(e))},ue={},le=y.WeakMap;if(ne){var de=Q.state||(Q.state=new le),fe=de.get,ge=de.has,he=de.set;z=function(e,t){return t.facade=e,he.call(de,e,t),t},$=function(e){return fe.call(de,e)||{}},Z=function(e){return ge.call(de,e)}}else{var Ce=ce("state");ue[Ce]=!0,z=function(e,t){return t.facade=e,W(e,Ce,t),t},$=function(e){return P(e,Ce)?e[Ce]:{}},Z=function(e){return P(e,Ce)}}var ve,pe,Re={set:z,get:$,has:Z,enforce:function(e){return Z(e)?$(e):z(e,{})},getterFor:function(e){return function(t){var n;if(!x(t)||(n=$(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},me=R((function(e){var t=Re.get,n=Re.enforce,s=String(String).split("String");(e.exports=function(e,t,r,o){var a,i=!!o&&!!o.unsafe,c=!!o&&!!o.enumerable,u=!!o&&!!o.noTargetGet;"function"==typeof r&&("string"!=typeof t||P(r,"name")||W(r,"name",t),(a=n(r)).source||(a.source=s.join("string"==typeof t?t:""))),e!==y?(i?!u&&e[t]&&(c=!0):delete e[t],c?e[t]=r:W(e,t,r)):c?e[t]=r:Y(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||ee(this)}))})),ye=y,Se=function(e){return"function"==typeof e?e:void 0},Ie=function(e,t){return arguments.length<2?Se(ye[e])||Se(y[e]):ye[e]&&ye[e][t]||y[e]&&y[e][t]},Me=Math.ceil,Te=Math.floor,Ee=function(e){return isNaN(e=+e)?0:(e>0?Te:Me)(e)},Ae=Math.min,ke=function(e){return e>0?Ae(Ee(e),9007199254740991):0},be=Math.max,we=Math.min,Ue=function(e,t){var n=Ee(e);return n<0?be(n+t,0):we(n,t)},Ne=function(e){return function(t,n,s){var r,o=L(t),a=ke(o.length),i=Ue(s,a);if(e&&n!=n){for(;a>i;)if((r=o[i++])!=r)return!0}else for(;a>i;i++)if((e||i in o)&&o[i]===n)return e||i||0;return!e&&-1}},Le={includes:Ne(!0),indexOf:Ne(!1)},xe=Le.indexOf,_e=function(e,t){var n,s=L(e),r=0,o=[];for(n in s)!P(ue,n)&&P(s,n)&&o.push(n);for(;t.length>r;)P(s,n=t[r++])&&(~xe(o,n)||o.push(n));return o},Oe=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Pe=Oe.concat("length","prototype"),Be={f:Object.getOwnPropertyNames||function(e){return _e(e,Pe)}},je={f:Object.getOwnPropertySymbols},De=Ie("Reflect","ownKeys")||function(e){var t=Be.f(H(e)),n=je.f;return n?t.concat(n(e)):t},Ge=function(e,t){for(var n=De(t),s=q.f,r=K.f,o=0;o<n.length;o++){var a=n[o];P(e,a)||s(e,a,r(t,a))}},Fe=/#|\.prototype\./,Ke=function(e,t){var n=Ve[He(e)];return n==We||n!=qe&&("function"==typeof t?S(t):!!t)},He=Ke.normalize=function(e){return String(e).replace(Fe,".").toLowerCase()},Ve=Ke.data={},qe=Ke.NATIVE="N",We=Ke.POLYFILL="P",Ye=Ke,Je=K.f,Qe=function(e,t){var n,s,r,o,a,i=e.target,c=e.global,u=e.stat;if(n=c?y:u?y[i]||Y(i,{}):(y[i]||{}).prototype)for(s in t){if(o=t[s],r=e.noTargetGet?(a=Je(n,s))&&a.value:n[s],!Ye(c?s:i+(u?".":"#")+s,e.forced)&&void 0!==r){if(typeof o==typeof r)continue;Ge(o,r)}(e.sham||r&&r.sham)&&W(o,"sham",!0),me(n,s,o,e)}},Xe=Array.isArray||function(e){return"Array"==b(e)},ze=function(e){return Object(N(e))},$e=function(e,t,n){var s=_(t);s in e?q.f(e,s,A(0,n)):e[s]=n},Ze="process"==b(y.process),et=Ie("navigator","userAgent")||"",nt=y.process,st=nt&&nt.versions,rt=st&&st.v8;rt?pe=(ve=rt.split("."))[0]+ve[1]:et&&(!(ve=et.match(/Edge\/(\d+)/))||ve[1]>=74)&&(ve=et.match(/Chrome\/(\d+)/))&&(pe=ve[1]);var ot=pe&&+pe,at=!!Object.getOwnPropertySymbols&&!S((function(){return!Symbol.sham&&(Ze?38===ot:ot>37&&ot<41)})),it=at&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ct=se("wks"),ut=y.Symbol,lt=it?ut:ut&&ut.withoutSetter||ae,dt=function(e){return P(ct,e)&&(at||"string"==typeof ct[e])||(at&&P(ut,e)?ct[e]=ut[e]:ct[e]=lt("Symbol."+e)),ct[e]},ft=dt("species"),gt=function(e,t){var n;return Xe(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!Xe(n.prototype)?x(n)&&null===(n=n[ft])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},ht=dt("species"),Ct=function(e){return ot>=51||!S((function(){var t=[];return(t.constructor={})[ht]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},vt=dt("isConcatSpreadable"),pt=9007199254740991,Rt="Maximum allowed index exceeded",mt=ot>=51||!S((function(){var e=[];return e[vt]=!1,e.concat()[0]!==e})),yt=Ct("concat"),St=function(e){if(!x(e))return!1;var t=e[vt];return void 0!==t?!!t:Xe(e)};Qe({target:"Array",proto:!0,forced:!mt||!yt},{concat:function(e){var t,n,s,r,o,a=ze(this),i=gt(a,0),c=0;for(t=-1,s=arguments.length;t<s;t++)if(St(o=-1===t?a:arguments[t])){if(c+(r=ke(o.length))>pt)throw TypeError(Rt);for(n=0;n<r;n++,c++)n in o&&$e(i,c,o[n])}else{if(c>=pt)throw TypeError(Rt);$e(i,c++,o)}return i.length=c,i}});var It={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Mt=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Tt=function(e,t,n){if(Mt(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,s){return e.call(t,n,s)};case 3:return function(n,s,r){return e.call(t,n,s,r)}}return function(){return e.apply(t,arguments)}},Et=[].push,At=function(e){var t=1==e,n=2==e,s=3==e,r=4==e,o=6==e,a=7==e,i=5==e||o;return function(c,u,l,d){for(var f,g,h=ze(c),C=U(h),v=Tt(u,l,3),p=ke(C.length),R=0,m=d||gt,y=t?m(c,p):n||a?m(c,0):void 0;p>R;R++)if((i||R in C)&&(g=v(f=C[R],R,h),e))if(t)y[R]=g;else if(g)switch(e){case 3:return!0;case 5:return f;case 6:return R;case 2:Et.call(y,f)}else switch(e){case 4:return!1;case 7:Et.call(y,f)}return o?-1:s||r?r:y}},kt={forEach:At(0),map:At(1),filter:At(2),some:At(3),every:At(4),find:At(5),findIndex:At(6),filterOut:At(7)},bt=kt.forEach,wt=function(e,t){var n=[][e];return!!n&&S((function(){n.call(null,t||function(){throw 1},1)}))}("forEach")?[].forEach:function(e){return bt(this,e,arguments.length>1?arguments[1]:void 0)};for(var Ut in It){var Nt=y[Ut],Lt=Nt&&Nt.prototype;if(Lt&&Lt.forEach!==wt)try{W(Lt,"forEach",wt)}catch(e){Lt.forEach=wt}}var xt,_t=Object.keys||function(e){return _e(e,Oe)},Ot=I?Object.defineProperties:function(e,t){H(e);for(var n,s=_t(t),r=s.length,o=0;r>o;)q.f(e,n=s[o++],t[n]);return e},Pt=Ie("document","documentElement"),Bt=ce("IE_PROTO"),jt=function(){},Dt=function(e){return"<script>"+e+"</"+"script>"},Gt=function(){try{xt=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;Gt=xt?function(e){e.write(Dt("")),e.close();var t=e.parentWindow.Object;return e=null,t}(xt):((t=D("iframe")).style.display="none",Pt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Dt("document.F=Object")),e.close(),e.F);for(var n=Oe.length;n--;)delete Gt.prototype[Oe[n]];return Gt()};ue[Bt]=!0;var Ft=Object.create||function(e,t){var n;return null!==e?(jt.prototype=H(e),n=new jt,jt.prototype=null,n[Bt]=e):n=Gt(),void 0===t?n:Ot(n,t)},Kt=dt("unscopables"),Ht=Array.prototype;null==Ht[Kt]&&q.f(Ht,Kt,{configurable:!0,value:Ft(null)});var Vt=function(e){Ht[Kt][e]=!0},qt=kt.find,Wt="find",Yt=!0;Wt in[]&&Array(1).find((function(){Yt=!1})),Qe({target:"Array",proto:!0,forced:Yt},{find:function(e){return qt(this,e,arguments.length>1?arguments[1]:void 0)}}),Vt(Wt);var Jt=S((function(){_t(1)}));Qe({target:"Object",stat:!0,forced:Jt},{keys:function(e){return _t(ze(e))}});var Qt=Le.includes;Qe({target:"Array",proto:!0},{includes:function(e){return Qt(this,e,arguments.length>1?arguments[1]:void 0)}}),Vt("includes");var Xt=y.Promise,zt=q.f,$t=dt("toStringTag"),Zt=function(e,t,n){e&&!P(e=n?e:e.prototype,$t)&&zt(e,$t,{configurable:!0,value:t})},en=dt("species"),tn={},nn=dt("iterator"),sn=Array.prototype,rn={};rn[dt("toStringTag")]="z";var on="[object z]"===String(rn),an=dt("toStringTag"),cn="Arguments"==b(function(){return arguments}()),un=on?b:function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),an))?n:cn?b(t):"Object"==(s=b(t))&&"function"==typeof t.callee?"Arguments":s},ln=dt("iterator"),dn=function(e){var t=e.return;if(void 0!==t)return H(t.call(e)).value},fn=function(e,t){this.stopped=e,this.result=t},gn=function(e,t,n){var s,r,o,a,i,c,u,l,d=n&&n.that,f=!(!n||!n.AS_ENTRIES),g=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),C=Tt(t,d,1+f+h),v=function(e){return s&&dn(s),new fn(!0,e)},p=function(e){return f?(H(e),h?C(e[0],e[1],v):C(e[0],e[1])):h?C(e,v):C(e)};if(g)s=e;else{if("function"!=typeof(r=function(e){if(null!=e)return e[ln]||e["@@iterator"]||tn[un(e)]}(e)))throw TypeError("Target is not iterable");if(void 0!==(l=r)&&(tn.Array===l||sn[nn]===l)){for(o=0,a=ke(e.length);a>o;o++)if((i=p(e[o]))&&i instanceof fn)return i;return new fn(!1)}s=r.call(e)}for(c=s.next;!(u=c.call(s)).done;){try{i=p(u.value)}catch(e){throw dn(s),e}if("object"==typeof i&&i&&i instanceof fn)return i}return new fn(!1)},hn=dt("iterator"),Cn=!1;try{var vn=0,pn={next:function(){return{done:!!vn++}},return:function(){Cn=!0}};pn[hn]=function(){return this},Array.from(pn,(function(){throw 2}))}catch(e){}var Rn,mn,yn,Sn=dt("species"),In=/(iphone|ipod|ipad).*applewebkit/i.test(et),Mn=y.location,Tn=y.setImmediate,En=y.clearImmediate,An=y.process,kn=y.MessageChannel,bn=y.Dispatch,wn=0,Un={},Nn="onreadystatechange",Ln=function(e){if(Un.hasOwnProperty(e)){var t=Un[e];delete Un[e],t()}},xn=function(e){return function(){Ln(e)}},_n=function(e){Ln(e.data)},On=function(e){y.postMessage(e+"",Mn.protocol+"//"+Mn.host)};Tn&&En||(Tn=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Un[++wn]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Rn(wn),wn},En=function(e){delete Un[e]},Ze?Rn=function(e){An.nextTick(xn(e))}:bn&&bn.now?Rn=function(e){bn.now(xn(e))}:kn&&!In?(yn=(mn=new kn).port2,mn.port1.onmessage=_n,Rn=Tt(yn.postMessage,yn,1)):y.addEventListener&&"function"==typeof postMessage&&!y.importScripts&&Mn&&"file:"!==Mn.protocol&&!S(On)?(Rn=On,y.addEventListener("message",_n,!1)):Rn=Nn in D("script")?function(e){Pt.appendChild(D("script")).onreadystatechange=function(){Pt.removeChild(this),Ln(e)}}:function(e){setTimeout(xn(e),0)});var Pn,Bn,jn,Dn,Gn,Fn,Kn,Hn,Vn={set:Tn,clear:En},qn=/web0s(?!.*chrome)/i.test(et),Wn=K.f,Yn=Vn.set,Jn=y.MutationObserver||y.WebKitMutationObserver,Qn=y.document,Xn=y.process,zn=y.Promise,$n=Wn(y,"queueMicrotask"),Zn=$n&&$n.value;Zn||(Pn=function(){var e,t;for(Ze&&(e=Xn.domain)&&e.exit();Bn;){t=Bn.fn,Bn=Bn.next;try{t()}catch(e){throw Bn?Dn():jn=void 0,e}}jn=void 0,e&&e.enter()},In||Ze||qn||!Jn||!Qn?zn&&zn.resolve?(Kn=zn.resolve(void 0),Hn=Kn.then,Dn=function(){Hn.call(Kn,Pn)}):Dn=Ze?function(){Xn.nextTick(Pn)}:function(){Yn.call(y,Pn)}:(Gn=!0,Fn=Qn.createTextNode(""),new Jn(Pn).observe(Fn,{characterData:!0}),Dn=function(){Fn.data=Gn=!Gn}));var es,ts,ns,ss,rs=Zn||function(e){var t={fn:e,next:void 0};jn&&(jn.next=t),Bn||(Bn=t,Dn()),jn=t},os=function(e){var t,n;this.promise=new e((function(e,s){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=s})),this.resolve=Mt(t),this.reject=Mt(n)},as={f:function(e){return new os(e)}},is=function(e,t){if(H(e),x(t)&&t.constructor===e)return t;var n=as.f(e);return(0,n.resolve)(t),n.promise},cs=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},us=Vn.set,ls=dt("species"),ds="Promise",fs=Re.get,gs=Re.set,hs=Re.getterFor(ds),Cs=Xt,vs=y.TypeError,ps=y.document,Rs=y.process,ms=Ie("fetch"),ys=as.f,Ss=ys,Is=!!(ps&&ps.createEvent&&y.dispatchEvent),Ms="function"==typeof PromiseRejectionEvent,Ts="unhandledrejection",Es=Ye(ds,(function(){if(!(ee(Cs)!==String(Cs))){if(66===ot)return!0;if(!Ze&&!Ms)return!0}if(ot>=51&&/native code/.test(Cs))return!1;var e=Cs.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[ls]=t,!(e.then((function(){}))instanceof t)})),As=Es||!function(e,t){if(!t&&!Cn)return!1;var n=!1;try{var s={};s[hn]=function(){return{next:function(){return{done:n=!0}}}},e(s)}catch(e){}return n}((function(e){Cs.all(e).catch((function(){}))})),ks=function(e){var t;return!(!x(e)||"function"!=typeof(t=e.then))&&t},bs=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;rs((function(){for(var s=e.value,r=1==e.state,o=0;n.length>o;){var a,i,c,u=n[o++],l=r?u.ok:u.fail,d=u.resolve,f=u.reject,g=u.domain;try{l?(r||(2===e.rejection&&Ls(e),e.rejection=1),!0===l?a=s:(g&&g.enter(),a=l(s),g&&(g.exit(),c=!0)),a===u.promise?f(vs("Promise-chain cycle")):(i=ks(a))?i.call(a,d,f):d(a)):f(s)}catch(e){g&&!c&&g.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Us(e)}))}},ws=function(e,t,n){var s,r;Is?((s=ps.createEvent("Event")).promise=t,s.reason=n,s.initEvent(e,!1,!0),y.dispatchEvent(s)):s={promise:t,reason:n},!Ms&&(r=y["on"+e])?r(s):e===Ts&&function(e,t){var n=y.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Us=function(e){us.call(y,(function(){var t,n=e.facade,s=e.value;if(Ns(e)&&(t=cs((function(){Ze?Rs.emit("unhandledRejection",s,n):ws(Ts,n,s)})),e.rejection=Ze||Ns(e)?2:1,t.error))throw t.value}))},Ns=function(e){return 1!==e.rejection&&!e.parent},Ls=function(e){us.call(y,(function(){var t=e.facade;Ze?Rs.emit("rejectionHandled",t):ws("rejectionhandled",t,e.value)}))},xs=function(e,t,n){return function(s){e(t,s,n)}},_s=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,bs(e,!0))},Os=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw vs("Promise can't be resolved itself");var s=ks(t);s?rs((function(){var n={done:!1};try{s.call(t,xs(Os,n,e),xs(_s,n,e))}catch(t){_s(n,t,e)}})):(e.value=t,e.state=1,bs(e,!1))}catch(t){_s({done:!1},t,e)}}};Es&&(Cs=function(e){!function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation")}(this,Cs,ds),Mt(e),es.call(this);var t=fs(this);try{e(xs(Os,t),xs(_s,t))}catch(e){_s(t,e)}},(es=function(e){gs(this,{type:ds,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(e,t,n){for(var s in t)me(e,s,t[s],n);return e}(Cs.prototype,{then:function(e,t){var n,s,r,o=hs(this),a=ys((n=Cs,void 0===(r=H(this).constructor)||null==(s=H(r)[Sn])?n:Mt(s)));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=Ze?Rs.domain:void 0,o.parent=!0,o.reactions.push(a),0!=o.state&&bs(o,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),ts=function(){var e=new es,t=fs(e);this.promise=e,this.resolve=xs(Os,t),this.reject=xs(_s,t)},as.f=ys=function(e){return e===Cs||e===ns?new ts(e):Ss(e)},"function"==typeof Xt&&(ss=Xt.prototype.then,me(Xt.prototype,"then",(function(e,t){var n=this;return new Cs((function(e,t){ss.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof ms&&Qe({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return is(Cs,ms.apply(y,arguments))}}))),Qe({global:!0,wrap:!0,forced:Es},{Promise:Cs}),Zt(Cs,ds,!1),function(e){var t=Ie(e),n=q.f;I&&t&&!t[en]&&n(t,en,{configurable:!0,get:function(){return this}})}(ds),ns=Ie(ds),Qe({target:ds,stat:!0,forced:Es},{reject:function(e){var t=ys(this);return t.reject.call(void 0,e),t.promise}}),Qe({target:ds,stat:!0,forced:Es},{resolve:function(e){return is(this,e)}}),Qe({target:ds,stat:!0,forced:As},{all:function(e){var t=this,n=ys(t),s=n.resolve,r=n.reject,o=cs((function(){var n=Mt(t.resolve),o=[],a=0,i=1;gn(e,(function(e){var c=a++,u=!1;o.push(void 0),i++,n.call(t,e).then((function(e){u||(u=!0,o[c]=e,--i||s(o))}),r)})),--i||s(o)}));return o.error&&r(o.value),n.promise},race:function(e){var t=this,n=ys(t),s=n.reject,r=cs((function(){var r=Mt(t.resolve);gn(e,(function(e){r.call(t,e).then(n.resolve,s)}))}));return r.error&&s(r.value),n.promise}});var Ps=on?{}.toString:function(){return"[object "+un(this)+"]"};on||me(Object.prototype,"toString",Ps,{unsafe:!0});var Bs=[].slice,js=/MSIE .\./.test(et),Ds=function(e){return function(t,n){var s=arguments.length>2,r=s?Bs.call(arguments,2):void 0;return e(s?function(){("function"==typeof t?t:Function(t)).apply(this,r)}:t,n)}};Qe({global:!0,bind:!0,forced:js},{setTimeout:Ds(y.setTimeout),setInterval:Ds(y.setInterval)});var Gs,Fs,Ks=new t.Logger("RCIM"),Hs=function(){return!("undefined"==typeof uni||!function(e){for(var t=["canIUse","getSystemInfo"],n=0,s=t.length;n<s;n++)if(!e[t[n]])return!1;return!0}(uni))},Vs=Hs();var qs={tag:"browser",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,i=e.body,c=t.appendUrl(e.url,o);return new Promise((function(e){var t,o=(t="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,"undefined"!=typeof XMLHttpRequest&&t?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")),u="[object XDomainRequest]"===Object.prototype.toString.call(o);if(o.open(n,c),r&&o.setRequestHeader)for(var l in r)o.setRequestHeader(l,r[l]);if(u){o.timeout=s,o.onload=function(){e({data:o.responseText,status:o.status||200})},o.onerror=function(){e({status:o.status||0})},o.ontimeout=function(){e({status:o.status||0})};var d="object"===a(i)?JSON.stringify(i):i;o.send(d)}else o.onreadystatechange=function(){4===o.readyState&&e({data:o.responseText,status:o.status})},o.onerror=function(){e({status:o.status||0})},setTimeout((function(){return e({status:o.status||0})}),s),o.send(i)}))},localStorage:null===(Gs=window)||void 0===Gs?void 0:Gs.localStorage,sessionStorage:null===(Fs=window)||void 0===Fs?void 0:Fs.sessionStorage,isSupportSocket:function(){var e="undefined"!=typeof WebSocket;return e||Ks.warn("websocket not support"),e},useNavi:!0,connectPlatform:"",isFromUniapp:Vs,createWebSocket:function(e,t){var n=new WebSocket(e,t);return n.binaryType="arraybuffer",{onClose:function(e){n.onclose=function(t){var n=t.code,s=t.reason;e(n,s)}},onError:function(e){n.onerror=e},onMessage:function(e){n.onmessage=function(t){e(t.data)}},onOpen:function(e){n.onopen=e},send:function(e){n.send(e)},close:function(e,t){n.close(e,t)}}},createDataChannel:function(e,n){return this.isSupportSocket()&&"websocket"===n?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},Ws=Hs(),Ys=function(e){return function(){try{var t;return(t=wx)[e].apply(t,arguments)}catch(e){Ks.error(e)}}},Js={setItem:Ys("setStorageSync"),getItem:Ys("getStorageSync"),removeItem:Ys("removeStorageSync"),clear:Ys("clearStorageSync")},Qs={tag:"wechat",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,a=e.body,i=t.appendUrl(e.url,o);return new Promise((function(e){wx.request({url:i,method:n,headers:r,timeout:s,data:a,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:Js,sessionStorage:Js,isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:Ws,createWebSocket:function(e,t){var n=wx.connectSocket({url:e,protocols:t});return{onClose:function(e){n.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){e(t.data)}))},onOpen:function(e){n.onOpen(e)},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,n){return"websocket"===n?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},Xs=Hs(),zs=function(e){return function(){try{var t;return(t=my)[e].apply(t,arguments)}catch(e){Ks.error(e)}}},$s={setItem:zs("setStorageSync"),getItem:zs("getStorageSync"),removeItem:zs("removeStorageSync"),clear:zs("clearStorageSync")},Zs={tag:"alipay",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,a=e.body,i=t.appendUrl(e.url,o);return new Promise((function(e){my.request({url:i,method:n,headers:r,timeout:s,data:a,success:function(t){e({data:t.data,status:t.status})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:$s,sessionStorage:$s,isSupportSocket:function(){return!1},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:Xs,createDataChannel:function(e,n){return"websocket"===n?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},er=Hs(),tr=function(e){return function(){try{var t;return(t=swan)[e].apply(t,arguments)}catch(e){Ks.error(e)}}},nr={setItem:tr("setStorageSync"),getItem:tr("getStorageSync"),removeItem:tr("removeStorageSync"),clear:tr("clearStorageSync")},sr={tag:"baidu",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:er,localStorage:nr,sessionStorage:nr,httpReq:function(e){return new Promise((function(t,n){swan.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("è°ç¨æå",e.data);var n=(null==e?void 0:e.data)||{},s={data:JSON.stringify(n),status:e.statusCode};t(s)},fail:function(e){console.log("è°ç¨å¤±è´¥",e.errorCode),n({data:e.errorCode})}})}))},createWebSocket:function(e,t){var n=swan.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,n){return"websocket"===n?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},rr=Hs(),or=function(e){return function(){try{var t;return console.log("tt",tt),(t=tt)[e].apply(t,arguments)}catch(e){Ks.error(e)}}},ar={setItem:or("setStorageSync"),getItem:or("getStorageSync"),removeItem:or("removeStorageSync"),clear:or("clearStorageSync")},ir={tag:"toutiao",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:rr,localStorage:ar,sessionStorage:ar,httpReq:function(e){return new Promise((function(t,n){tt.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("è°ç¨æå",e.data);var n=(null==e?void 0:e.data)||{},s={data:JSON.stringify(n),status:e.statusCode};t(s)},fail:function(e){console.log("è°ç¨å¤±è´¥",e.errMsg),n({data:e.errMsg})}})}))},createWebSocket:function(e,t){var n=tt.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,n){return"websocket"===n?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},cr=function(e){return function(){try{var t;return(t=uni)[e].apply(t,arguments)}catch(e){Ks.error(e)}}},ur={setItem:cr("setStorageSync"),getItem:cr("getStorageSync"),removeItem:cr("removeStorageSync"),clear:cr("clearStorageSync")},lr={tag:"uniapp",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,a=e.body,i=t.appendUrl(e.url,o);return new Promise((function(e){uni.request({url:i,method:n,headers:r,timeout:s,data:a,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:ur,sessionStorage:ur,isSupportSocket:function(){return!0},useNavi:!0,connectPlatform:"",isFromUniapp:!0,createWebSocket:function(e,t){var n={complete:function(){},url:e,protocols:t},s=uni.connectSocket(n);return{onClose:function(e){s.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){s.onError((function(t){e(t.errMsg)}))},onMessage:function(e){s.onMessage((function(t){e(t.data)}))},onOpen:function(e){s.onOpen(e)},send:function(e){s.send({data:e})},close:function(e,t){s.close({code:e,reason:t})}}},createDataChannel:function(e,n){return"websocket"===n?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},dr=function(e){return e&&e.canIUse&&e.getSystemInfo},fr="undefined"!=typeof uni&&dr(uni)?function(){switch(process.env.VUE_APP_PLATFORM){case"app-plus":return lr;case"mp-baidu":return sr;case"mp-toutiao":return ir;case"mp-alipay":return Zs;case"mp-weixin":return Qs;case"h5":default:return qs}}():"undefined"!=typeof wx&&dr(wx)?Qs:"undefined"!=typeof my&&dr(my)?Zs:"undefined"!=typeof tt&&dr(tt)?ir:"undefined"!=typeof swan&&dr(swan)?sr:qs,gr=kt.map,hr=Ct("map");Qe({target:"Array",proto:!0,forced:!hr},{map:function(e){return gr(this,e,arguments.length>1?arguments[1]:void 0)}});var Cr,vr,pr,Rr=!S((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),mr=ce("IE_PROTO"),yr=Object.prototype,Sr=Rr?Object.getPrototypeOf:function(e){return e=ze(e),P(e,mr)?e[mr]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?yr:null},Ir=dt("iterator"),Mr=!1;[].keys&&("next"in(pr=[].keys())?(vr=Sr(Sr(pr)))!==Object.prototype&&(Cr=vr):Mr=!0),(null==Cr||S((function(){var e={};return Cr[Ir].call(e)!==e})))&&(Cr={}),P(Cr,Ir)||W(Cr,Ir,(function(){return this}));var Tr={IteratorPrototype:Cr,BUGGY_SAFARI_ITERATORS:Mr},Er=Tr.IteratorPrototype,Ar=function(){return this},kr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,s){return H(n),function(e){if(!x(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(s),t?e.call(n,s):n.__proto__=s,n}}():void 0),br=Tr.IteratorPrototype,wr=Tr.BUGGY_SAFARI_ITERATORS,Ur=dt("iterator"),Nr="keys",Lr="values",xr="entries",_r=function(){return this},Or="Array Iterator",Pr=Re.set,Br=Re.getterFor(Or),jr=function(e,t,n,s,r,o,a){!function(e,t,n){var s=t+" Iterator";e.prototype=Ft(Er,{next:A(1,n)}),Zt(e,s,!1),tn[s]=Ar}(n,t,s);var i,c,u,l=function(e){if(e===r&&C)return C;if(!wr&&e in g)return g[e];switch(e){case Nr:case Lr:case xr:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",f=!1,g=e.prototype,h=g[Ur]||g["@@iterator"]||r&&g[r],C=!wr&&h||l(r),v="Array"==t&&g.entries||h;if(v&&(i=Sr(v.call(new e)),br!==Object.prototype&&i.next&&(Sr(i)!==br&&(kr?kr(i,br):"function"!=typeof i[Ur]&&W(i,Ur,_r)),Zt(i,d,!0))),r==Lr&&h&&h.name!==Lr&&(f=!0,C=function(){return h.call(this)}),g[Ur]!==C&&W(g,Ur,C),tn[t]=C,r)if(c={values:l(Lr),keys:o?C:l(Nr),entries:l(xr)},a)for(u in c)(wr||f||!(u in g))&&me(g,u,c[u]);else Qe({target:t,proto:!0,forced:wr||f},c);return c}(Array,"Array",(function(e,t){Pr(this,{type:Or,target:L(e),index:0,kind:t})}),(function(){var e=Br(this),t=e.target,n=e.kind,s=e.index++;return!t||s>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:s,done:!1}:"values"==n?{value:t[s],done:!1}:{value:[s,t[s]],done:!1}}),"values");tn.Arguments=tn.Array,Vt("keys"),Vt("values"),Vt("entries");var Dr=dt("iterator"),Gr=dt("toStringTag"),Fr=jr.values;for(var Kr in It){var Hr=y[Kr],Vr=Hr&&Hr.prototype;if(Vr){if(Vr[Dr]!==Fr)try{W(Vr,Dr,Fr)}catch(e){Vr[Dr]=Fr}if(Vr[Gr]||W(Vr,Gr,Kr),It[Kr])for(var qr in jr)if(Vr[qr]!==jr[qr])try{W(Vr,qr,jr[qr])}catch(e){Vr[qr]=jr[qr]}}}var Wr=function(){var e=H(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Yr="toString",Jr=RegExp.prototype,Qr=Jr.toString,Xr=S((function(){return"/a/b"!=Qr.call({source:"a",flags:"b"})})),zr=Qr.name!=Yr;function $r(e,t,n){return e+"_"+t+"_"+n}(Xr||zr)&&me(RegExp.prototype,Yr,(function(){var e=H(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in Jr)?Wr.call(e):n)}),{unsafe:!0});var Zr=function(){function e(){u(this,e)}return d(e,null,[{key:"set",value:function(n){if(t.SEND_MESSAGE_TYPE_OPTION[n.messageType]&&t.SEND_MESSAGE_TYPE_OPTION[n.messageType].isPersited){var s=e.get(n.conversationType,n.targetId,n.channelId||"");if(!s||s.sentTime<n.sentTime){var r=$r(n.conversationType,n.targetId,n.channelId||"");e.map[r]=n}}}},{key:"get",value:function(t,n,s){var r=$r(t,n,s);return e.map[r]||null}},{key:"remove",value:function(t,n,s){var r=$r(t,n,s);delete e.map[r]}}]),e}();Zr.map={};var eo={"RC:TxtMsg":"TextMessage","RC:ImgMsg":"ImageMessage","RC:VcMsg":"VoiceMessage","RC:ImgTextMsg":"RichContentMessage","RC:ReferenceMsg":"ReferenceMessage","RC:FileMsg":"FileMessage","RC:HQVCMsg":"HQVoiceMessage","RC:GIFMsg":"GIFMessage","RC:SightMsg":"SightMessage","RC:LBSMsg":"LocationMessage","RC:InfoNtf":"InformationNotificationMessage","RC:ContactNtf":"ContactNotificationMessage","RC:ProfileNtf":"ProfileNotificationMessage","RC:CmdNtf":"CommandNotificationMessage","RC:DizNtf":"DiscussionNotificationMessage","RC:CmdMsg":"CommandMessage","RC:TypSts":"TypingStatusMessage","RC:CsChaR":"ChangeModeResponseMessage","RC:CsHsR":"HandShakeResponseMessage","RC:CsEnd":"TerminateMessage","RC:CsSp":"SuspendMessage","RC:CsUpdate":"CustomerStatusUpdateMessage","RC:ReadNtf":"ReadReceiptMessage","RC:VCAccept":"AcceptMessage","RC:VCRinging":"RingingMessage","RC:VCSummary":"SummaryMessage","RC:VCHangup":"HungupMessage","RC:VCInvite":"InviteMessage","RC:VCModifyMedia":"MediaModifyMessage","RC:VCModifyMem":"MemberModifyMessage","RC:CsContact":"CustomerContact","RC:PSImgTxtMsg":"PublicServiceRichContentMessage","RC:PSMultiImgTxtMsg":"PublicServiceMultiRichContentMessage","RC:GrpNtf":"GroupNotificationMessage","RC:PSCmd":"PublicServiceCommandMessage","RC:RcCmd":"RecallCommandMessage","RC:SRSMsg":"SyncReadStatusMessage","RC:RRReqMsg":"ReadReceiptRequestMessage","RC:RRRspMsg":"ReadReceiptResponseMessage","RCJrmf:RpMsg":"JrmfRedPacketMessage","RCJrmf:RpOpendMsg":"JrmfRedPacketOpenedMessage","RC:CombineMsg":"RCCombineMessage","RC:chrmKVNotiMsg":"ChrmKVNotificationMessage","RC:LogCmdMsg":"LogCommandMessage","RC:MsgExMsg":"ExpansionCommandMessage","RC:RRMsg":"GroupReadReceiptResponseMessage"},to={},no=new t.AppStorage(fr,"API-V2");function so(e){var n=e.channelId,s=e.conversationType,r=e.targetId,o=e.unreadMessageCount,a=e.latestMessage,i=e.isTop,c=e.notificationStatus,u=e.matchCount;if(!t.usingCppEngine()){var l=Zr.get(s,r,n||"");a?l&&a.sentTime<l.sentTime&&(a=l):a=l}var d=a?ro(a):null;return{channelId:n||"",conversationType:s,targetId:r,unreadMessageCount:o,latestMessage:d,latestMessageId:null==d?void 0:d.messageId,objectName:null==d?void 0:d.messageType,sentTime:null==d?void 0:d.sentTime,isTop:i,notificationStatus:c,receivedStatus:null==d?void 0:d.receivedStatus,matchCount:u}}function ro(e){var n=e.conversationType,s=e.targetId,o=e.senderUserId,a=e.content,i=e.messageType,c=e.messageUId,u=e.messageDirection,l=e.isOffLineMessage,d=e.sentTime,f=e.receivedStatus,g=e.receivedTime,h=e.canIncludeExpansion,C=e.disableNotification,v=e.expansion,p=e.messageId,R=e.sentStatus,m=e.channelId,y=e.readReceiptInfo,S=e.pushConfig,I="";return i in eo?I=eo[i]:i in to?I=to[i]:(a={message:{content:a,objectName:i},messageName:"UnknownMessage"},I="UnknownMessage"),f||(f=t.ReceivedStatus.UNREAD),void 0===p&&(p=~~(16777215*Math.random())),{channelId:m||"",conversationType:n,targetId:s,senderUserId:o,content:a,messageType:I,messageUId:c,messageDirection:u,offLineMessage:l,sentTime:d,receivedStatus:f,receivedTime:g,objectName:i,messageId:p,sentStatus:R||r.SENT,disableNotification:C,canIncludeExpansion:h,expansion:v,readReceiptInfo:y,pushConfig:S}}function oo(e,n){var s=new Date,r=s.getMonth()+1,o=s.getFullYear()+"/"+(1===r.toString().length?"0"+r:r)+"/"+s.getDate(),a=new Date(o).getTime()-e.sentTime<0,i=e.messageType,c=e.messageDirection;if("ReadReceiptRequestMessage"===i&&a&&c===t.MessageDirection.SEND){var u="".concat(n).concat(e.content.messageUId,"SENT");no.set(u,{count:0,dealtime:e.sentTime,userIds:{}})}else if("ReadReceiptRequestMessage"===i&&a){var l="".concat(n).concat(e.conversationType).concat(e.targetId,"RECEIVED"),d=no.get(l);if(d)if(e.senderUserId in d)d[e.senderUserId].uIds&&-1===d[e.senderUserId].uIds.indexOf(e.content.messageUId)&&(d[e.senderUserId].uIds.push(e.content.messageUId),d[e.senderUserId].dealtime=e.sentTime,d[e.senderUserId].isResponse=!1,no.set(l,d));else{var f={uIds:[e.content.messageUId],dealtime:e.sentTime,isResponse:!1};d[e.senderUserId]=f,no.set(l,d)}else{var g={};g[e.senderUserId]={uIds:[e.content.messageUId],dealtime:e.sentTime,isResponse:!1},no.set(l,g)}}}function ao(e,t,n){try{e(t,n)}catch(e){Ks.error(e)}}function io(e,t,n){try{e(t,n)}catch(e){Ks.error(e)}}var co=Object.assign,uo=Object.defineProperty,lo=!co||S((function(){if(I&&1!==co({b:1},co(uo({},"a",{enumerable:!0,get:function(){uo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),s="abcdefghijklmnopqrst";return e[n]=7,s.split("").forEach((function(e){t[e]=e})),7!=co({},e)[n]||_t(co({},t)).join("")!=s}))?function(e,t){for(var n=ze(e),s=arguments.length,r=1,o=je.f,a=E.f;s>r;)for(var i,c=U(arguments[r++]),u=o?_t(c).concat(o(c)):_t(c),l=u.length,d=0;l>d;)i=u[d++],I&&!a.call(c,i)||(n[i]=c[i]);return n}:co;Qe({target:"Object",stat:!0,forced:Object.assign!==lo},{assign:lo});var fo=Ct("splice"),go=Math.max,ho=Math.min,Co=9007199254740991,vo="Maximum allowed length exceeded";Qe({target:"Array",proto:!0,forced:!fo},{splice:function(e,t){var n,s,r,o,a,i,c=ze(this),u=ke(c.length),l=Ue(e,u),d=arguments.length;if(0===d?n=s=0:1===d?(n=0,s=u-l):(n=d-2,s=ho(go(Ee(t),0),u-l)),u+n-s>Co)throw TypeError(vo);for(r=gt(c,s),o=0;o<s;o++)(a=l+o)in c&&$e(r,o,c[a]);if(r.length=s,n<s){for(o=l;o<u-s;o++)i=o+n,(a=o+s)in c?c[i]=c[a]:delete c[i];for(o=u;o>u-s+n;o--)delete c[o-1]}else if(n>s)for(o=u-s;o>l;o--)i=o+n-1,(a=o+s-1)in c?c[i]=c[a]:delete c[i];for(o=0;o<n;o++)c[o+l]=arguments[o+2];return c.length=u-s+n,r}});var po=function e(t,n,s){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];u(this,e),this.messageType=t,this.objectName=n,this.content=s,this.isPersited=r,this.isCounted=o};function Ro(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=function(r){return new po(e,t,r,n,s)};return r.MessageType=e,r.ObjectName=t,r}var mo,yo,So,Io=Ro("ReadReceiptResponseMessage","RC:RRRspMsg"),Mo=function(){function e(t,n,s){u(this,e),this._context=t,this.channelId=n,this._isCPPMode=s,this._storage=no,this._draftMap={}}return d(e,[{key:"getConversationList",value:function(e,n,s){t.assert("callback",e,t.AssertRules.CALLBACK),t.assert("conversationTypes",n,t.AssertRules.ARRAY),t.assert("count",s,t.AssertRules.NUMBER),Ks.info("getConversationList ->channelId:"+this.channelId),this._context.getConversationList(s,void 0,0,0,this.channelId).then((function(s){var r=s.code,o=s.data,a=[];o=o||[],r===t.ErrorCode.SUCCESS?(n?o.forEach((function(e){n.indexOf(e.conversationType)>-1&&a.push(so(e))})):o.forEach((function(e){a.push(so(e))})),ao(e.onSuccess,a)):(Ks.warn("getConversationList ->code:"+r),io(e.onError,r))}))}},{key:"getConversation",value:function(e,n,s){var r=this;t.assert("callback",s,t.AssertRules.CALLBACK),t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),Ks.info("getConversation ->targetId:"+n+",conversationType:"+e),c(regeneratorRuntime.mark((function o(){var a,i,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r._context.getConversation(e,n,r.channelId);case 2:if(a=o.sent,i=a.code,c=a.data,i===t.ErrorCode.SUCCESS){o.next=9;break}return Ks.warn("getConversation ->code:"+i+",targetId:"+n),s.onError(i),o.abrupt("return");case 9:s.onSuccess(c?so(c):null);case 10:case"end":return o.stop()}}),o)})))()}},{key:"removeConversation",value:function(e,n,s){var r=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("removeConversation ->targetId:"+n+",conversationType:"+e),this._context.removeConversation(e,n,this.channelId).then((function(o){o===t.ErrorCode.SUCCESS?(r._isCPPMode||Zr.remove(e,n,r.channelId),ao(s.onSuccess)):(Ks.warn("removeConversation ->code:"+o+",targetId:"+n),io(s.onError,o))}))}},{key:"saveTextMessageDraft",value:function(e,n,s){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("draftText",s,t.AssertRules.STRING,!0),Ks.info("saveTextMessageDraft ->targetId:"+n+",conversationType:"+e);var r=this._context.getCurrentUserId();return!!r&&((this._draftMap[r]=this._draftMap[r]||{})["".concat(e,"_").concat(n,"_").concat(this.channelId)]=s,!0)}},{key:"getTextMessageDraft",value:function(e,n){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),Ks.info("getTextMessageDraft ->targetId:"+n+",conversationType:"+e);var s=this._context.getCurrentUserId();if(s)return(this._draftMap[s]||{})["".concat(e,"_").concat(n,"_").concat(this.channelId)]}},{key:"clearTextMessageDraft",value:function(e,n){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),Ks.info("clearTextMessageDraft ->targetId:"+n+",conversationType:"+e);var s=this._context.getCurrentUserId();return!!s&&delete(this._draftMap[s]||{})["".concat(e,"_").concat(n,"_").concat(this.channelId)]}},{key:"getTotalUnreadCount",value:function(e,n,s){t.assert("callback",e,t.AssertRules.CALLBACK),Ks.info("getTotalUnreadCount ->conversationTypes:"+n),this._context.getTotalUnreadCount(this.channelId,n,s).then((function(n){var s=n.code,r=n.data;s===t.ErrorCode.SUCCESS?ao(e.onSuccess,r):(Ks.warn("getTotalUnreadCount ->code:"+s),io(e.onError,s))}))}},{key:"getUnreadCount",value:function(e,n,s){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("getUnreadCount ->targetId:"+n+",conversationType:"+e),this._context.getUnreadCount(e,n,this.channelId).then((function(e){var r=e.code,o=e.data;r===t.ErrorCode.SUCCESS?ao(s.onSuccess,o):(Ks.warn("getUnreadCount ->code:"+r+",targetId:"+n),io(s.onError,r))}))}},{key:"clearConversations",value:function(e,n){Ks.info("clearConversations -> conversationTypes:"+n),this._isCPPMode?this._context.clearConversations(n,this.channelId).then((function(n){n===t.ErrorCode.SUCCESS?ao(e.onSuccess,!0):(Ks.warn("clearConversations ->code:"+n),io(e.onError,n))})):Ks.error("Method is only available in cppProtocol mode")}},{key:"clearUnreadCount",value:function(e,n,s){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("clearUnreadCount ->targetId:"+n+",conversationType:"+e),this._context.clearUnreadCount(e,n,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?ao(s.onSuccess,!0):(Ks.warn("clearUnreadCount ->code:"+e+",targetId:"+n),io(s.onError,e))}))}},{key:"setConversationStatus",value:function(e,n,s,r){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",r,t.AssertRules.CALLBACK),t.assert("status",s,t.AssertRules.OBJECT,!0),Ks.info("setConversationStatus ->targetId:"+n+",status:"+s);var o=s.isTop,a=s.notificationStatus;this._context.setConversationStatus(e,n,o,a,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?ao(r.onSuccess):(Ks.warn("setConversationStatus ->code:"+e+",targetId:"+n),io(r.onError,e))}))}},{key:"sendMessage",value:function(e,n,s,o,a,i,c,u){var l=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("msg",s,t.AssertRules.OBJECT,!0),t.assert("callback",o,t.AssertRules.CALLBACK),t.assert("isMentioned",a,t.AssertRules.BOOLEAN),t.assert("pushContent",i,t.AssertRules.ONLY_STRING),t.assert("pushData",c,t.AssertRules.ONLY_STRING),t.assert("options.userIds",null==u?void 0:u.userIds,t.AssertRules.ARRAY),t.assert("options.isVoipPush",null==u?void 0:u.isVoipPush,t.AssertRules.BOOLEAN),t.assert("options.disableNotification",null==u?void 0:u.disableNotification,t.AssertRules.BOOLEAN),t.assert("options.canIncludeExpansion",null==u?void 0:u.canIncludeExpansion,t.AssertRules.BOOLEAN),t.assert("options.expansion",null==u?void 0:u.expansion,t.AssertRules.OBJECT),t.assert("options.pushConfig",null==u?void 0:u.pushConfig,t.AssertRules.OBJECT),Ks.info("sendMessage ->targetId:"+n+",conversationType:"+e);var d=!!(null!=u&&u.isStatusMessage||null!=u&&u.isStatus),f=function(e,t,n){var s,r=e||{},o=r.userIds,a=r.isVoipPush,i=r.disableNotification,c=r.isFilerWhiteBlacklist,u=r.expansion,l=r.canIncludeExpansion,d=r.pushConfig,f=[];if(t){var g=(n||{}).content.mentionedInfo;f=g.userIdList,s=g.type}return{mentionedType:s,mentionedUserIdList:f,directionalUserIdList:o,isVoipPush:a,disableNotification:i,isFilerWhiteBlacklist:c,expansion:u,canIncludeExpansion:l,pushConfig:d}}(u,a,s),g=Object.assign(s,h(h({isMentioned:a,pushContent:i,pushData:c},f),{},{messageType:s.objectName,channelId:this.channelId,isStatusMessage:d})),C=this._context.getCurrentUserId();this._context.sendMessage(e,n,g,o.onBefore).then((function(a){var i=a.code,c=a.data;if(i===t.ErrorCode.SUCCESS){l._isCPPMode||Zr.set(c);var f=ro(c);oo(f,C),ao(o.onSuccess,f)}else Ks.warn("sendMessage ->code:"+i+",targetId:"+n),io(o.onError,i,ro({isMentioned:!!g.isMentioned,content:s.content,messageType:s.messageType,isPersited:s.isPersited,isCounted:s.isCounted,disableNotification:!(null==u||!u.disableNotification),canIncludeExpansion:!(null==u||!u.canIncludeExpansion),expansion:(null==u?void 0:u.expansion)||null,conversationType:e,targetId:n,senderUserId:C,messageUId:"",messageDirection:t.MessageDirection.SEND,isOffLineMessage:!1,sentTime:(null==c?void 0:c.sentTime)||0,receivedTime:0,isStatusMessage:d,receivedStatus:t.ReceivedStatus.UNREAD,messageId:null==c?void 0:c.messageId,sentStatus:r.FAILED}))}))}},{key:"sendRecallMessage",value:function(e,n,s){t.assert("message.conversationType",e.conversationType,t.AssertRules.NUMBER,!0),t.assert("message.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("message.messageUId",e.messageUId,t.AssertRules.STRING,!0),t.assert("message.sentTime",e.sentTime,t.AssertRules.NUMBER,!0),t.assert("callback",n,t.AssertRules.CALLBACK),t.assert("options.disableNotification",null==s?void 0:s.disableNotification,t.AssertRules.BOOLEAN),t.assert("options.pushConfig",null==s?void 0:s.pushConfig,t.AssertRules.OBJECT);var r=e.conversationType,o=e.targetId,a=e.messageUId,i=e.sentTime,c=e.content;Ks.info("sendRecallMessage ->targetId:"+o+",conversationType:"+r+",messageUId:"+a);var u=h({channelId:this.channelId,oriContent:c},s);this._context.recallMessage(r,o,a,i,u).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?ao(n.onSuccess,ro(r)):(Ks.warn("sendRecallMessage ->code:"+s+",targetId:"+o+",messageUId:"+a),io(n.onError,s))}))}},{key:"sendTypingStatusMessage",value:function(e,n,s,r){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("typingContentType",s,t.AssertRules.STRING,!0),t.assert("callback",r,t.AssertRules.CALLBACK),Ks.info("sendTypingStatusMessage ->targetId:"+n+",conversationType:"+e);var o={messageType:"RC:TypSts",content:{typingContentType:s},isStatusMessage:!0,channelId:this.channelId};this._context.sendMessage(e,n,o).then((function(e){var s=e.code,o=e.data;s===t.ErrorCode.SUCCESS?ao(r.onSuccess,ro(o)):(Ks.warn("sendTypingStatusMessage ->code:"+s+",targetId:"+n),io(r.onError,s))}))}},{key:"sendReceiptResponse",value:function(e,t,n){var s=this;Ks.info("sendReceiptResponse ->targetId:"+t+",conversationType:"+e);var r=this._context.getCurrentUserId(),o="".concat(r).concat(e).concat(t,"RECEIVED"),a=this._storage.get(o);if(a){var i=[];for(var c in a){var u={};u[c]=a[c].uIds,a[c].isResponse||i.push(u)}if(0===i.length)return void n.onSuccess(null);var l=setInterval((function(){1===i.length&&clearInterval(l);var r=i.splice(0,1)[0],c=new Io({receiptMessageDic:r});s.sendMessage(e,t,c,{onSuccess:function(e){var t=Object.keys(r)[0];a[t].isResponse=!0,s._storage.set(o,a),ao(n.onSuccess,e)},onError:function(e){Ks.warn("sendReceiptResponse ->code:"+e+",targetId:"+t),io(n.onError,e)}})}),200)}else n.onSuccess(null)}},{key:"sendReadReceiptMessage",value:function(e,n,s){t.assert("messageUIds",e,t.AssertRules.ARRAY,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),Ks.info("sendReadReceiptMessage ->targetId:"+n+",messageUIds:"+e);var r,o=v(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;t.assert("messageUId",a,t.AssertRules.STRING)}}catch(e){o.e(e)}finally{o.f()}this._context.sendReadReceiptMessage(n,e,this.channelId).then((function(r){var o=r.code;o===t.ErrorCode.SUCCESS?s.onSuccess():(Ks.warn("sendReadReceiptMessage ->code:"+o+",targetId:"+n+",messageUIds:"+e),s.onError(o))})).catch((function(t){Ks.warn("sendReadReceiptMessage ->code:"+t+",targetId:"+n+",messageUIds:"+e),s.onError(t)}))}},{key:"getMessageReader",value:function(e,n,s){t.assert("messageUId",e,t.AssertRules.STRING,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),Ks.info("getMessageReader ->targetId:"+n+",messageUId:"+e),this._context.getMessageReader(n,e,this.channelId).then((function(r){var o=r.code,a=r.data;o===t.ErrorCode.SUCCESS?s.onSuccess(a):(Ks.warn("getMessageReader ->code:"+o+",targetId:"+n+",messageUId:"+e),s.onError(o))})).catch((function(t){Ks.warn("getMessageReader ->code:"+t+",targetId:"+n+",messageUId:"+e),s.onError(t)}))}},{key:"updateMessageExpansion",value:function(e,n,s){t.assert("expansion",e,t.AssertRules.OBJECT,!0),t.assert("message",n,t.AssertRules.OBJECT,!0);var r=n.conversationType,o=n.targetId,a=n.messageUId,i=n.canIncludeExpansion,c=n.expansion;Ks.info("updateMessageExpansion ->targetId:"+o+",messageUId:"+a+",conversationType:"+r),this._context.sendExpansionMessage({conversationType:r,targetId:o,messageUId:a,canIncludeExpansion:i,originExpansion:c,expansion:e,channelId:this.channelId}).then((function(e){var n=e.code;n===t.ErrorCode.SUCCESS?ao(s.onSuccess):(Ks.warn("updateMessageExpansion ->code:"+n+",targetId:"+o+",messageUId:"+a),io(s.onError,n))}))}},{key:"removeMessageExpansionForKey",value:function(e,n,s){t.assert("keys",e,t.AssertRules.ARRAY,!0),t.assert("message",n,t.AssertRules.OBJECT,!0);var r=n.conversationType,o=n.targetId,a=n.messageUId,i=n.canIncludeExpansion;Ks.info("removeMessageExpansionForKey ->targetId:"+o+",messageUId:"+a+",conversationType:"+r),this._context.sendExpansionMessage({conversationType:r,targetId:o,messageUId:a,canIncludeExpansion:i,keys:e,channelId:this.channelId}).then((function(e){var n=e.code;n===t.ErrorCode.SUCCESS?ao(s.onSuccess):(Ks.warn("removeMessageExpansionForKey ->code:"+n+",targetId:"+o+",messageUId:"+a),io(s.onError,n))}))}},{key:"getHistoryMessages",value:function(e,n,s,r,o,a,i){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),t.assert("count",r,t.AssertRules.NUMBER,!0),t.assert("callback",o,t.AssertRules.CALLBACK,!0),t.assert("order",i,t.AssertRules.NUMBER),Ks.info("getHistoryMessages ->targetId:"+n+",conversationType:"+e+",timestamp:"+s),this._context.getHistoryMessage(e,n,s,r,i,this.channelId,a).then((function(e){var s=e.code,r=e.data;if(s===t.ErrorCode.SUCCESS)if(r){var a=r.list,i=r.hasMore,c=a.map((function(e){return ro(e)}));ao(o.onSuccess,c,i)}else ao(o.onSuccess,[],!1);else Ks.warn("getHistoryMessages ->code:"+s+",targetId:"+n),io(o.onError,s)}))}},{key:"deleteRemoteMessages",value:function(e,n,s,r){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("messages",s,t.AssertRules.ARRAY,!0),t.assert("callback",r,t.AssertRules.CALLBACK),Ks.info("deleteRemoteMessages ->targetId:"+n+",conversationType:"+e),this._context.deleteRemoteMessage(e,n,s,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?ao(r.onSuccess):(Ks.warn("deleteRemoteMessages ->code:"+e+",targetId:"+n),io(r.onError,e))}))}},{key:"clearRemoteHistoryMessages",value:function(e,n){t.assert("param.conversationType",e.conversationType,t.AssertRules.NUMBER,!0),t.assert("param.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("param.timestamp",e.timestamp,t.AssertRules.NUMBER,!0),t.assert("callback",n,t.AssertRules.CALLBACK);var s=e.conversationType,r=e.targetId,o=e.timestamp;Ks.info("clearRemoteHistoryMessages ->targetId:"+r+",conversationType:"+s),this._context.deleteRemoteMessageByTimestamp(s,r,o,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?ao(n.onSuccess):(Ks.warn("clearRemoteHistoryMessages ->code:"+e),io(n.onError,e))}))}},{key:"insertMessage",value:function(e,n,s,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=s.senderUserId,i=s.objectName,c=s.content,u=s.messageDirection,l=s.messageUId,d=s.canIncludeExpansion,f=s.expansion,g=s.disableNotification,h=s.sentTime,C=s.sentStatus;Ks.info("insertMessage ->targetId:"+n+",conversationType:"+e);var v=o.isUnread,p=o.searchContent,R={senderUserId:a,messageType:i,content:c,messageDirection:u,sentTime:h,sentStatus:C,searchContent:p,isUnread:v,messageUId:l,disableNotification:g,canIncludeExpansion:d,expansionMsg:JSON.stringify(f),channelId:this.channelId};this._context.insertMessage(e,n,R).then((function(e){var s=e.code,o=e.data;s===t.ErrorCode.SUCCESS?ao(r.onSuccess,ro(o)):(Ks.warn("insertMessage ->code:"+s+",targetId:"+n),io(r.onError,s))}))}},{key:"deleteLocalMessagesByTimestamp",value:function(e,n,s,r,o){Ks.info("deleteLocalMessagesByTimestamp ->targetId:"+n+",conversationType:"+e+",timestamp:"+s),this._context.deleteMessagesByTimestamp(e,n,s,r,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?ao(o.onSuccess,!0):(Ks.warn("deleteLocalMessagesByTimestamp ->code:"+e+",targetId:"+n),io(o.onError,e))}))}},{key:"getRemoteHistoryMessages",value:function(e,n,s,r,o,a){Ks.info("getRemoteHistoryMessages ->targetId:"+n+",conversationType:"+e);var i=a.order||0;this._context.getRemoteHistoryMessages(e,n,s,r,i,this.channelId).then((function(e){var s=e.code,r=e.data;if(s===t.ErrorCode.SUCCESS)if(r){var a=r.list,i=r.hasMore,c=a.map((function(e){return ro(e)}));ao(o.onSuccess,c,i)}else ao(o.onSuccess,[],!1);else Ks.warn("getRemoteHistoryMessages ->code:"+s+",targetId:"+n),io(o.onError,s)}))}},{key:"clearMessages",value:function(e,n,s){var r=this;Ks.info("clearMessages ->targetId:"+n+",conversationType:"+e),this._context.clearMessages(e,n,this.channelId).then((function(o){o===t.ErrorCode.SUCCESS?(r._isCPPMode||Zr.remove(e,n,r.channelId),ao(s.onSuccess,!0)):(Ks.warn("clearMessages ->code:"+o+",targetId:"+n),io(s.onError,o))}))}},{key:"searchConversationByContent",value:function(e,n,s,r){Ks.info("searchConversationByContent ->keyword:"+e),this._context.searchConversationByContent(e,r,this.channelId,s).then((function(s){var r=s.code,o=s.data,a=[];o=o||[],r===t.ErrorCode.SUCCESS?(o.forEach((function(e){a.push(so(e))})),ao(n.onSuccess,a)):(Ks.warn("searchConversationByContent ->code:"+r+",keyword:"+e),io(n.onError,r))}))}},{key:"searchMessageByContent",value:function(e,n,s,r,o,a,i){Ks.info("setConversationStatus ->targetId:"+n+",conversationType:"+e+",keyword:"+s),this._context.searchMessageByContent(e,n,s,r,o,a,this.channelId).then((function(e){var s=e.code,r=e.data,o=[];if(s===t.ErrorCode.SUCCESS){var a=r=r||{},c=a.messages,u=a.count;c.forEach((function(e){o.push(ro(e))})),ao(i.onSuccess,o,u)}else Ks.warn("searchMessageByContent ->code:"+s+",targetId:"+n),io(i.onError,s)}))}},{key:"getUnreadMentionedMessages",value:function(e,t){return Ks.info("getUnreadMentionedMessages ->targetId:"+t+",conversationType:"+e),this._context.getUnreadMentionedMessages(e,t,this.channelId).map((function(e){return ro(e)}))}},{key:"clearUnreadCountByTimestamp",value:function(e,n,s,r){Ks.info("clearUnreadCountByTimestamp ->targetId:"+n+",conversationType:"+e),this._context.clearUnreadCountByTimestamp(e,n,s,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?ao(r.onSuccess,!0):(Ks.warn("clearUnreadCountByTimestamp ->code:"+e+",targetId:"+n),io(r.onError,e))}))}},{key:"getConversationNotificationStatus",value:function(e,n,s){Ks.info("getConversationNotificationStatus ->targetId:"+n+",conversationType:"+e),this._context.getConversationNotificationStatus(e,n,this.channelId).then((function(e){var r=e.code,o=e.data;r===t.ErrorCode.SUCCESS?ao(s.onSuccess,o):(Ks.warn("getConversationNotificationStatus ->code:"+r+",targetId:"+n),io(s.onError,r))}))}}]),e}(),To=function(){function e(n){u(this,e),this._context=n,this._channelClient={},this._isCPPMode=t.usingCppEngine(),this._defaultChannelClient=new Mo(n,"",this._isCPPMode)}var n;return d(e,[{key:"assertCPPMode",value:function(e,n,s){if(!this._isCPPMode)return s&&s.onError(t.ErrorCode.NOT_SUPPORT),void Ks.error("'".concat(n,"' is unusable!"));e()}},{key:"install",value:function(e,t){return this._context.install(e,t)}},{key:"getChannel",value:function(e){return Ks.info("getChannel ->channelId:"+e),this._isCPPMode?(t.assert("channelId",e,t.AssertRules.STRING,!0),e.length>20?(Ks.error("The channelId cannot exceed 20 characters"),null):e in this._channelClient?this._channelClient[e]:Object.keys(this._channelClient).length>1e3?(Ks.error("Only 1000 channels can be obtained"),null):(this._channelClient[e]=new Mo(this._context,e,this._isCPPMode),this._channelClient[e])):(Ks.error("getChannel method is only available in protocol stack mode"),null)}},{key:"deleteChannels",value:function(e){var n=this;t.assert("channelIds",e,t.AssertRules.ARRAY,!0),Ks.info("deleteChannels ->channelIds:"+e),this.assertCPPMode((function(){e.forEach((function(e){delete n._channelClient[e]}))}),"deleteChannels")}},{key:"getNavi",value:function(){return this._context.getInfoFromCache()||{}}},{key:"getSDKInfo",value:function(){return{version:this._context.apiVersion}}},{key:"getAppInfo",value:function(){return{appKey:this._context.appkey}}},{key:"getCurrentUserId",value:function(){return this._context.getCurrentUserId()}},{key:"disconnect",value:(n=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.disconnect();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"logout",value:function(){return this.disconnect()}},{key:"clearCache",value:function(){}},{key:"getConversationList",value:function(e,t,n){this._defaultChannelClient.getConversationList(e,t,n)}},{key:"getConversation",value:function(e,t,n){return this._defaultChannelClient.getConversation(e,t,n)}},{key:"removeConversation",value:function(e,t,n){return this._defaultChannelClient.removeConversation(e,t,n)}},{key:"saveTextMessageDraft",value:function(e,t,n){return this._defaultChannelClient.saveTextMessageDraft(e,t,n)}},{key:"getTextMessageDraft",value:function(e,t){return this._defaultChannelClient.getTextMessageDraft(e,t)}},{key:"clearTextMessageDraft",value:function(e,t){return this._defaultChannelClient.clearTextMessageDraft(e,t)}},{key:"getTotalUnreadCount",value:function(e,t,n){return this._defaultChannelClient.getTotalUnreadCount(e,t,n)}},{key:"getUnreadCount",value:function(e,t,n){return this._defaultChannelClient.getUnreadCount(e,t,n)}},{key:"getConversationUnreadCount",value:function(e,t){Ks.error("Method is deprecated")}},{key:"clearConversations",value:function(e,t){return this._defaultChannelClient.clearConversations(e,t)}},{key:"clearUnreadCount",value:function(e,t,n){this._defaultChannelClient.clearUnreadCount(e,t,n)}},{key:"setConversationStatus",value:function(e,t,n,s){return this._defaultChannelClient.setConversationStatus(e,t,n,s)}},{key:"sendMessage",value:function(e,t,n,s,r,o,a,i,c){return this._defaultChannelClient.sendMessage(e,t,n,s,r,o,a,c)}},{key:"sendRecallMessage",value:function(e,t,n){return this._defaultChannelClient.sendRecallMessage(e,t,n)}},{key:"sendTypingStatusMessage",value:function(e,t,n,s){return this._defaultChannelClient.sendTypingStatusMessage(e,t,n,s)}},{key:"sendReceiptResponse",value:function(e,t,n){return this._defaultChannelClient.sendReceiptResponse(e,t,n)}},{key:"sendReadReceiptMessage",value:function(e,t,n){return this._defaultChannelClient.sendReadReceiptMessage(e,t,n)}},{key:"getMessageReader",value:function(e,t,n){this._defaultChannelClient.getMessageReader(e,t,n)}},{key:"updateMessageExpansion",value:function(e,t,n){this._defaultChannelClient.updateMessageExpansion(e,t,n)}},{key:"removeMessageExpansionForKey",value:function(e,t,n){this._defaultChannelClient.removeMessageExpansionForKey(e,t,n)}},{key:"getHistoryMessages",value:function(e,t,n,s,r,o,a){return this._defaultChannelClient.getHistoryMessages(e,t,n,s,r,o,a)}},{key:"joinChatRoom",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("joinChatRoom ->chatRoomId:"+e),this._context.joinChatroom(e,n).then((function(n){n===t.ErrorCode.SUCCESS?ao(s.onSuccess):(Ks.warn("joinChatRoom ->code:"+n+",chatRoomId:"+e),io(s.onError,n))}))}},{key:"quitChatRoom",value:function(e,n){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("quitChatRoom ->chatRoomId:"+e),this._context.quitChatroom(e).then((function(s){s===t.ErrorCode.SUCCESS?ao(n.onSuccess):(Ks.warn("quitChatRoom ->code:"+s+",chatRoomId:"+e),io(n.onError,s))}))}},{key:"getChatRoomInfo",value:function(e,n,s,r){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("order",s,t.AssertRules.NUMBER,!0),t.assert("callback",r,t.AssertRules.CALLBACK),Ks.info("getChatRoomInfo ->chatRoomId:"+e),this._context.getChatroomInfo(e,n,s).then((function(n){var s=n.code,o=n.data;s===t.ErrorCode.SUCCESS?ao(r.onSuccess,{userInfos:(null==o?void 0:o.userInfos)||[],userTotalNums:(null==o?void 0:o.userCount)||0}):(Ks.warn("getChatRoomInfo ->code:"+s+",chatRoomId:"+e),io(r.onError,s))}))}},{key:"setChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("setChatroomEntry ->chatRoomId:"+e),this._context.setChatroomEntry(e,n).then((function(n){n===t.ErrorCode.SUCCESS?ao(s.onSuccess):(Ks.warn("setChatroomEntry ->code:"+n+",chatRoomId:"+e),io(s.onError,n))}))}},{key:"forceSetChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("forceSetChatroomEntry ->chatRoomId:"+e),this._context.forceSetChatroomEntry(e,n).then((function(n){n===t.ErrorCode.SUCCESS?ao(s.onSuccess):(Ks.warn("forceSetChatroomEntry ->code:"+n+",chatRoomId:"+e),io(s.onError,n))}))}},{key:"removeChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("removeChatroomEntry ->chatRoomId:"+e),this._context.removeChatroomEntry(e,n).then((function(n){n===t.ErrorCode.SUCCESS?ao(s.onSuccess):(Ks.warn("removeChatroomEntry ->code:"+n+",chatRoomId:"+e),io(s.onError,n))}))}},{key:"forceRemoveChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("forceRemoveChatroomEntry ->chatRoomId:"+e),this._context.forceRemoveChatroomEntry(e,n).then((function(n){n===t.ErrorCode.SUCCESS?ao(s.onSuccess):(Ks.warn("forceRemoveChatroomEntry ->code:"+n+",chatRoomId:"+e),io(s.onError,n))}))}},{key:"getChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("key",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("getChatroomEntry ->chatRoomId:"+e+",key:"+n),this._context.getChatroomEntry(e,n).then((function(n){var r=n.code,o=n.data;r===t.ErrorCode.SUCCESS?ao(s.onSuccess,o||""):(Ks.warn("getChatroomEntry ->code:"+r+",chatRoomId:"+e),io(s.onError,r))}))}},{key:"getAllChatroomEntries",value:function(e,n){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("getAllChatroomEntries ->chatRoomId:"+e),this._context.getAllChatroomEntries(e).then((function(s){var r=s.code,o=s.data;r===t.ErrorCode.SUCCESS?ao(n.onSuccess,o):(Ks.warn("getAllChatroomEntries ->code:"+r+",chatRoomId:"+e),io(n.onError,r))}))}},{key:"getChatRoomHistoryMessages",value:function(e,n,s,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("order",s,t.AssertRules.NUMBER,!0),t.assert("callback",r,t.AssertRules.CALLBACK),t.assert("timestamp",o,t.AssertRules.NUMBER),Ks.info("getChatRoomHistoryMessages ->chatRoomId:"+e),this._context.getChatRoomHistoryMessages(e,n,s,o).then((function(n){var s=n.code,o=n.data;if(s===t.ErrorCode.SUCCESS)if(o){var a=o.list,i=o.hasMore,c=a.map((function(e){return ro(e)}));ao(r.onSuccess,c,i)}else ao(r.onSuccess,[],!1);else Ks.warn("getChatRoomHistoryMessages ->code:"+s+",chatRoomId:"+e),io(r.onError,s)}))}},{key:"setDeviceInfo",value:function(e){}},{key:"getCurrentConnectionStatus",value:function(){return this._context.getConnectionStatus()}},{key:"deleteRemoteMessages",value:function(e,t,n,s){return this._defaultChannelClient.deleteRemoteMessages(e,t,n,s)}},{key:"clearRemoteHistoryMessages",value:function(e,t){return this._defaultChannelClient.clearRemoteHistoryMessages(e,t)}},{key:"getFileToken",value:function(e,n,s,r,o){t.assert("fileType",e,t.AssertRules.NUMBER,!0),t.assert("fileName",s,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("getFileToken ->fileType:"+e+",fileName:"+s+",queryString:"+o),this._context.getFileToken(e,s,r,o).then(n.onSuccess).catch(n.onError)}},{key:"getFileUrl",value:function(e,n,s,r,o,a){t.assert("fileType",e,t.AssertRules.NUMBER,!0),t.assert("fileName",n,t.AssertRules.STRING,!0),t.assert("saveName",s,t.AssertRules.STRING),t.assert("callback",r,t.AssertRules.CALLBACK),t.assert("serverType",a,t.AssertRules.NUMBER),t.assert("uploadRes",o,t.AssertRules.OBJECT),Ks.info("getFileUrl ->fileType:"+e+",fileName:"+n),this._context.getFileUrl(e,n,s,o,a).then(r.onSuccess).catch(r.onError)}},{key:"createTag",value:function(e,n){t.assert("tag.tagId",e.tagId,t.AssertRules.STRING,!0),t.assert("tag.tagId",e.tagId,(function(e){return e.length<=10})),t.assert("tag.tagName",e.tagName,(function(e){return e.length<=15})),t.assert("tag.tagName",e.tagName,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("createTag ->tagId:"+e.tagId+",tagName:"+e.tagName),this._context.createTag(e).then((function(s){var r=s.code;r===t.ErrorCode.SUCCESS?n.onSuccess():(Ks.warn("createTag ->code:"+r+",tagId:"+e.tagId),n.onError(r))})).catch((function(t){Ks.warn("createTag ->code:"+t+",tagId:"+e.tagId),n.onError(t)}))}},{key:"removeTag",value:function(e,n){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("removeTag ->tagId:"+e),this._context.removeTag(e).then((function(s){var r=s.code;r===t.ErrorCode.SUCCESS?n.onSuccess():(Ks.warn("removeTag ->code:"+r+",tagId:"+e),n.onError(r))})).catch((function(t){Ks.warn("removeTag ->code:"+t+",tagId:"+e),n.onError(t)}))}},{key:"updateTag",value:function(e,n){t.assert("tag.tagId",e.tagId,t.AssertRules.STRING,!0),t.assert("tag.tagName",e.tagName,t.AssertRules.STRING,!0),t.assert("tag.tagName",e.tagName,(function(e){return e.length<=15})),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("updateTag ->tagId:"+e.tagId+",tagName:"+e.tagName),this._context.updateTag(e).then((function(s){var r=s.code;r===t.ErrorCode.SUCCESS?n.onSuccess():(Ks.warn("updateTag ->code:"+r+",tagId:"+e.tagId),n.onError(r))})).catch((function(t){Ks.warn("updateTag ->reason:"+t+",tagId:"+e.tagId),n.onError(t)}))}},{key:"getTagList",value:function(e){t.assert("callback",e,t.AssertRules.CALLBACK),this._context.getTagList().then((function(n){var s=n.code,r=n.data;s===t.ErrorCode.SUCCESS?e.onSuccess(r||[]):(Ks.warn("getTagList ->code:"+s),e.onError(s))})).catch((function(t){Ks.warn("getTagList ->reason:"+t),e.onError(t)}))}},{key:"getTagsForConversation",value:function(e,n){t.assert("conversationType",e.type,t.AssertRules.NUMBER),t.assert("targetId",e.targetId,t.AssertRules.STRING),t.assert("channelId",e.channelId,t.AssertRules.ONLY_STRING),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("getTagsForConversation ->targetId:"+e.targetId+",conversationType:"+e.type),this._context.getTagsForConversation(e).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?n.onSuccess(r||[]):(Ks.warn("getTagsForConversation ->code:"+s),n.onError(s))})).catch((function(e){Ks.warn("getTagsForConversation ->reason:"+e),n.onError(e)}))}},{key:"addTagForConversations",value:function(e,n,s){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("conversations",n,t.AssertRules.ARRAY,!0),t.assert("callback",s,t.AssertRules.CALLBACK),n.forEach((function(e){t.assert("conversation.type",e.type,t.AssertRules.NUMBER,!0),t.assert("conversation.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("conversation.channelId",e.channelId,t.AssertRules.ONLY_STRING)})),Ks.info("addTagForConversations ->tagId:"+e),this._context.addTagForConversations(e,n).then((function(n){var r=n.code;n.data,r===t.ErrorCode.SUCCESS?s.onSuccess():(Ks.warn("addTagForConversations ->code:"+r+",tagId:"+e),s.onError(r))})).catch((function(t){Ks.warn("addTagForConversations ->reason:"+t+",tagId:"+e),s.onError(t)}))}},{key:"removeTagForConversations",value:function(e,n,s){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("conversations",n,t.AssertRules.ARRAY,!0),t.assert("callback",s,t.AssertRules.CALLBACK),n.forEach((function(e){t.assert("conversation.type",e.type,t.AssertRules.NUMBER,!0),t.assert("conversation.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("conversation.channelId",e.channelId,t.AssertRules.ONLY_STRING)})),Ks.info("removeTagForConversations ->tagId:"+e),this._context.removeTagForConversations(e,n).then((function(n){var r=n.code;n.data,r===t.ErrorCode.SUCCESS?s.onSuccess():(Ks.warn("removeTagForConversations ->code:"+r+",tagId:"+e),s.onError(r))})).catch((function(t){Ks.warn("removeTagForConversations ->reason:"+t+",tagId:"+e),s.onError(t)}))}},{key:"removeTagsForConversation",value:function(e,n,s){t.assert("conversation.type",e.type,t.AssertRules.NUMBER,!0),t.assert("conversation.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("conversation.channelId",e.channelId,t.AssertRules.ONLY_STRING),t.assert("tagIds",n,t.AssertRules.ARRAY,!0),t.assert("callback",s,t.AssertRules.CALLBACK),n.forEach((function(e){t.assert("tagId",e,t.AssertRules.STRING,!0)})),Ks.info("removeTagsForConversation ->tagIds:"+n+",targetId:"+e.targetId+",type:"+e.type),this._context.removeTagsForConversation(e,n).then((function(e){var r=e.code;e.data,r===t.ErrorCode.SUCCESS?s.onSuccess():(Ks.warn("removeTagsForConversation ->code:"+r+",tagIds:"+n),s.onError(r))})).catch((function(e){Ks.warn("removeTagsForConversation ->reason:"+e+",tagIds:"+n),s.onError(e)}))}},{key:"getConversationListByTag",value:function(e,n,s,r){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("startTime",s,t.AssertRules.NUMBER,!0),t.assert("callback",r,t.AssertRules.CALLBACK,!0),Ks.info("getConversationListByTag ->tagId:"+e),this._context.getConversationListByTag(e,s,n).then((function(n){var s=n.code,o=n.data,a=[];s===t.ErrorCode.SUCCESS?((o=o||[]).forEach((function(e){var t,n,s,r,o,i,c,u,l,d,f;a.push((n=(t=e).channelId,s=t.conversationType,r=t.targetId,o=t.unreadMessageCount,i=t.latestMessage,c=t.isTop,u=t.notificationStatus,l=t.isTopInTag,d=i?ro(i):null,(f=d||{}).messageType,f.sentTime,f.receivedStatus,f.messageId,{channelId:n||"",conversationType:s,targetId:r,unreadMessageCount:o,latestMessage:d,isTopInTag:l,latestMessageId:null==d?void 0:d.messageId,objectName:null==d?void 0:d.messageType,sentTime:null==d?void 0:d.sentTime,isTop:c,notificationStatus:u,receivedStatus:null==d?void 0:d.receivedStatus}))})),r.onSuccess(a)):(Ks.warn("getConversationListByTag ->code:"+s+",tagId:"+e),r.onError(s))})).catch((function(t){Ks.warn("getConversationListByTag ->reason:"+t+",tagId:"+e),r.onError(t)}))}},{key:"getUnreadCountByTag",value:function(e,n,s){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("containMuted",n,t.AssertRules.BOOLEAN,!0),t.assert("callback",s,t.AssertRules.CALLBACK),Ks.info("getUnreadCountByTag ->tagId:"+e),this._context.getUnreadCountByTag(e,n).then((function(n){var r=n.code,o=n.data;Ks.info(r,o),r===t.ErrorCode.SUCCESS?s.onSuccess(o||0):(Ks.warn("getUnreadCountByTag ->code:"+r+",tagId:"+e),s.onError(r))})).catch((function(t){Ks.warn("getUnreadCountByTag ->reason:"+t+",tagId:"+e),s.onError(t)}))}},{key:"setConversationStatusInTag",value:function(e,n,s,r){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("conversation.targetId",n.targetId,t.AssertRules.STRING,!0),t.assert("conversation.type",n.type,t.AssertRules.NUMBER,!0),t.assert("conversation.channelId",n.channelId,t.AssertRules.ONLY_STRING),t.assert("status.isTop",null==s?void 0:s.isTop,t.AssertRules.BOOLEAN,!0),t.assert("callback",r,t.AssertRules.CALLBACK),Ks.info("setConversationStatusInTag ->tagId:"+e+",targetId:"+n.targetId+",type"+n.type),this._context.setConversationStatusInTag(e,n,s).then((function(n){var s=n.code;n.data,s===t.ErrorCode.SUCCESS?r.onSuccess():(Ks.warn("setConversationStatusInTag ->code:"+s+",tagId:"+e),r.onError(s))})).catch((function(t){Ks.warn("setConversationStatusInTag ->reason:"+t+",tagId:"+e),r.onError(t)}))}},{key:"callExtra",value:function(e,n){var s;Ks.info("callExtra ->method:"+e);for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];(s=this._context).callExtra.apply(s,[e].concat(o)).then((function(s){var r=s.code,o=s.data;if(r!==t.ErrorCode.SUCCESS)Ks.warn("callExtra ->code:"+r),n.onError&&io(n.onError,r);else{if("getConversationsByPage"===e&&o.forEach((function(e){e.latestMessage=e.latestMessage?ro(e.latestMessage):null})),"getHistoryMessagesByObjectNames"===e){var a=o.list,i=o.hasMore,c=a.map((function(e){return ro(e)}));return void ao(n.onSuccess,c,i)}n.onSuccess&&ao(n.onSuccess,o)}}))}},{key:"hasRemoteUnreadMessages",value:function(e,n){t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("hasRemoteUnreadMessages ->token:"+e),this.assertCPPMode((function(){ao(n.onSuccess,!1)}),"hasRemoteUnreadMessages",n)}},{key:"setUserStatusListener",value:function(e,t){var n=this;Ks.info("setUserStatusListener ->userIds:"+e.userIds),this.assertCPPMode((function(){n._context.setUserStatusListener(e,t)}),"setUserStatusListener")}},{key:"setUserStatus",value:function(e,n){var s=this;t.assert("status",e,t.AssertRules.NUMBER),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("setUserStatus ->status:"+e),this.assertCPPMode((function(){s._context.setUserStatus(e).then((function(e){e===t.ErrorCode.SUCCESS?ao(n.onSuccess,!0):(Ks.warn("setUserStatus ->code:"+e),io(n.onError,e))}))}),"setUserStatus",n)}},{key:"getUserStatus",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("getUserStatus ->userId:"+e),this.assertCPPMode((function(){s._context.getUserStatus(e).then((function(s){var r=s.code,o=s.data;r===t.ErrorCode.SUCCESS?ao(n.onSuccess,o):(Ks.warn("getUserStatus ->code:"+r+",useerId:"+e),io(n.onError,r))}))}),"getUserStatus",n)}},{key:"addToBlacklist",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("addToBlacklist ->userId:"+e),this.assertCPPMode((function(){s._context.addToBlacklist(e).then((function(s){s===t.ErrorCode.SUCCESS?ao(n.onSuccess):(Ks.warn("addToBlacklist ->code:"+s+",useerId:"+e),io(n.onError,s))}))}),"addToBlacklist",n)}},{key:"removeFromBlacklist",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("removeFromBlacklist ->userId:"+e),this.assertCPPMode((function(){s._context.removeFromBlacklist(e).then((function(s){s===t.ErrorCode.SUCCESS?ao(n.onSuccess):(Ks.warn("removeFromBlacklist ->code:"+s+",useerId:"+e),io(n.onError,s))}))}),"removeFromBlacklist",n)}},{key:"getBlacklist",value:function(e){var n=this;t.assert("callback",e,t.AssertRules.CALLBACK),this.assertCPPMode((function(){n._context.getBlacklist().then((function(n){var s=n.code,r=n.data;s===t.ErrorCode.SUCCESS?ao(e.onSuccess,r):(Ks.warn("getBlacklist ->code:"+s),io(e.onError,s))}))}),"getBlacklist",e)}},{key:"getBlacklistStatus",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),Ks.info("getBlacklistStatus ->userId:"+e),this.assertCPPMode((function(){s._context.getBlacklistStatus(e).then((function(s){var r=s.code,o=s.data;r===t.ErrorCode.SUCCESS?ao(n.onSuccess,o):(Ks.warn("getBlacklistStatus ->code:"+r+",userId:"+e),io(n.onError,r))}))}),"getBlacklistStatus",n)}},{key:"insertMessage",value:function(e,n,s,r){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("content.senderUserId",s.senderUserId,t.AssertRules.STRING,!0),t.assert("callback",r,t.AssertRules.CALLBACK),Ks.info("insertMessage ->targetId:"+n+",conversationType:"+e+",senderUserId:"+s.senderUserId),this.assertCPPMode((function(){o._defaultChannelClient.insertMessage(e,n,s,r,a)}),"insertMessage",r)}},{key:"getRemoteHistoryMessages",value:function(e,n,s,r,o){var a=this,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),t.assert("count",r,t.AssertRules.NUMBER,!0),t.assert("callback",o,t.AssertRules.CALLBACK),t.assert("options.order",i.order,t.AssertRules.NUMBER),this.assertCPPMode((function(){a._defaultChannelClient.getRemoteHistoryMessages(e,n,s,r,o,i)}),"getRemoteHistoryMessages",o)}},{key:"deleteLocalMessages",value:function(e,n,s,r){var o=this;t.assert("messageIds",s,t.AssertRules.ARRAY,!0),t.assert("callback",r,t.AssertRules.CALLBACK),Ks.info("deleteLocalMessages ->messageIds:"+s),this.assertCPPMode((function(){o._context.deleteMessages(s).then((function(e){e===t.ErrorCode.SUCCESS?ao(r.onSuccess,!0):(Ks.warn("deleteLocalMessages ->code:"+e+",messageIds:"+s),io(r.onError,e))}))}),"deleteLocalMessages",r)}},{key:"deleteLocalMessagesByTimestamp",value:function(e,n,s,r,o){var a=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),t.assert("cleanSpace",r,t.AssertRules.BOOLEAN),t.assert("callback",o,t.AssertRules.CALLBACK),this.assertCPPMode((function(){a._defaultChannelClient.deleteLocalMessagesByTimestamp(e,n,s,r,o)}),"deleteLocalMessagesByTimestamp",o)}},{key:"clearMessages",value:function(e,n,s){var r=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this.assertCPPMode((function(){r._defaultChannelClient.clearMessages(e,n,s)}),"clearMessages",s)}},{key:"getMessage",value:function(e,n){var s=this;t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){s._context.getMessage(e).then((function(s){var r=s.code,o=s.data;r===t.ErrorCode.SUCCESS?ao(n.onSuccess,ro(o)):(Ks.warn("getMessage ->code:"+r+",messageId:"+e),io(n.onError,r))}))}),"getMessage",n)}},{key:"setMessageSentStatus",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("sentStatus",n,t.AssertRules.NUMBER,!0),Ks.info("setMessageSentStatus ->messageId:"+e+",sentStatus:"+n),this.assertCPPMode((function(){r._context.setMessageSentStatus(e,n).then((function(n){n===t.ErrorCode.SUCCESS?ao(s.onSuccess,!0):(Ks.warn("setMessageSentStatus ->code:"+n+",messageId:"+e),io(s.onError,n))}))}),"setMessageSentStatus",s)}},{key:"setMessageReceivedStatus",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("receivedStatus",n,t.AssertRules.NUMBER,!0),Ks.info("setMessageReceivedStatus ->messageId:"+e+",receivedStatus:"+n),this.assertCPPMode((function(){r._context.setMessageReceivedStatus(e,n).then((function(n){n===t.ErrorCode.SUCCESS?ao(s.onSuccess,!0):(Ks.warn("setMessageReceivedStatus ->code:"+n+",messageId:"+e),io(s.onError,n))}))}),"setMessageReceivedStatus",s)}},{key:"setMessageContent",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("objectName",s,t.AssertRules.ONLY_STRING,!0),Ks.info("setMessageContent ->messageId:"+e+",objectName:"+s),this.assertCPPMode((function(){r._context.setMessageContent(e,n,s)}),"setMessageContent")}},{key:"setMessageSearchField",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("searchFiles",s,t.AssertRules.STRING,!0),Ks.info("setMessageSearchField ->messageId:"+e+",searchFiles:"+s),this.assertCPPMode((function(){r._context.setMessageSearchField(e,n,s)}),"setMessageSearchField")}},{key:"searchConversationByContent",value:function(e,n,s,r){var o=this;t.assert("keyword",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),t.assert("conversationTypes",s,t.AssertRules.ARRAY),t.assert("customMessageType",r,t.AssertRules.ARRAY),this.assertCPPMode((function(){o._defaultChannelClient.searchConversationByContent(e,n,s,r)}),"searchConversationByContent",n)}},{key:"searchMessageByContent",value:function(e,n,s,r,o,a,i){var c=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("keyword",s,t.AssertRules.STRING,!0),t.assert("timestamp",r,t.AssertRules.NUMBER),t.assert("count",o,t.AssertRules.NUMBER),t.assert("total",a,t.AssertRules.NUMBER),t.assert("callback",i,t.AssertRules.CALLBACK),this.assertCPPMode((function(){c._defaultChannelClient.searchMessageByContent(e,n,s,r,o,a,i)}),"searchMessageByContent",i)}},{key:"getUnreadMentionedMessages",value:function(e,n){return this._isCPPMode?(t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),this._defaultChannelClient.getUnreadMentionedMessages(e,n)):(Ks.error("getUnreadMentionedMessages method is not supported in a browser!"),null)}},{key:"clearUnreadCountByTimestamp",value:function(e,n,s,r){var o=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),this.assertCPPMode((function(){o._defaultChannelClient.clearUnreadCountByTimestamp(e,n,s,r)}),"clearUnreadCountByTimestamp",r)}},{key:"getConversationNotificationStatus",value:function(e,n,s){var r=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),this.assertCPPMode((function(){r._defaultChannelClient.getConversationNotificationStatus(e,n,s)}),"getConversationNotificationStatus",s)}},{key:"getRTCUserInfoList",value:function(e,n){Ks.info("getRTCUserInfoList ->roomId:"+e.id),this._context.getRTCUserInfoList(e.id).then((function(s){var r=s.code,o=s.data;if(r!==t.ErrorCode.SUCCESS)Ks.warn("getRTCUserInfoList ->code:"+r+",roomId:"+e.id),n.onError(r);else{var a=null==o?void 0:o.users;n.onSuccess(a)}})).catch((function(t){Ks.warn("getRTCUserInfoList ->error:"+t+",roomId:"+e.id),n.onError(t)}))}},{key:"getRTCUserList",value:function(e,n){Ks.info("getRTCUserList ->roomId:"+e.id),this._context.getRTCUserList(e.id).then((function(s){var r=s.code,o=s.data;r!==t.ErrorCode.SUCCESS?(Ks.warn("getRTCUserList ->code:"+r+",roomId:"+e.id),n.onError(r)):n.onSuccess(o)})).catch((function(t){Ks.warn("getRTCUserList ->error:"+t+",roomId:"+e.id),n.onError(t)}))}},{key:"setRTCUserInfo",value:function(e,n,s){Ks.info("setRTCUserInfo ->roomId:"+e.id+",info:"+JSON.stringify(n||{})),this._context.setRTCUserInfo(e.id,n.key,n.value).then((function(r){r!==t.ErrorCode.SUCCESS?(Ks.warn("setRTCUserInfo ->code:"+r+",roomId:"+e.id+",key:"+n.key+",value:"+n.value),s.onError(r)):s.onSuccess(!0)})).catch((function(t){Ks.warn("setRTCUserInfo ->code:"+t+",roomId:"+e.id+",key:"+n.key+",value:"+n.value),s.onError(t)}))}},{key:"removeRTCUserInfo",value:function(e,n,s){Ks.info("removeRTCUserInfo ->roomId:"+e.id+"keys:"+n.keys),this._context.removeRTCUserInfo(e.id,n.keys).then((function(n){n!==t.ErrorCode.SUCCESS?(Ks.warn("removeRTCUserInfo ->code:"+n+",roomId:"+e.id),s.onError(n)):s.onSuccess(!0)})).catch((function(t){Ks.warn("removeRTCUserInfo ->error:"+t+",roomId:"+e.id),s.onError(t)}))}},{key:"getRTCRoomInfo",value:function(e,n){Ks.info("getRTCRoomInfo ->roomId:"+e.id),this._context.getRTCRoomInfo(e.id).then((function(s){var r=s.code,o=s.data;r!==t.ErrorCode.SUCCESS?(Ks.warn("getRTCRoomInfo ->code:"+r+",roomId:"+e.id),n.onError(r)):n.onSuccess(o)})).catch((function(t){Ks.warn("getRTCRoomInfo ->error:"+t+",roomId:"+e.id),n.onError(t)}))}},{key:"setRTCRoomInfo",value:function(e,n,s){throw t.todo("setRTCRoomInfo")}},{key:"removeRTCRoomInfo",value:function(e,n,s){throw t.todo("removeRTCRoomInfo")}},{key:"joinRTCRoom",value:function(e,n){Ks.info("joinRTCRoom ->roomId:"+e.id);var s=e.mode||0;this._context.joinRTCRoom(e.id,s).then((function(s){var r=s.code,o=s.data;r!==t.ErrorCode.SUCCESS?(Ks.warn("joinRTCRoom ->code:"+r+",roomId:"+e.id),n.onError(r)):n.onSuccess(o)})).catch((function(t){Ks.warn("joinRTCRoom ->error:"+t+",roomId:"+e.id),n.onError(t)}))}},{key:"quitRTCRoom",value:function(e,n){Ks.info("quitRTCRoom ->roomId:"+e.id),this._context.quitRTCRoom(e.id).then((function(s){s!==t.ErrorCode.SUCCESS?(Ks.warn("quitRTCRoom ->code:"+s+",roomId:"+e.id),n.onError(s)):n.onSuccess(!0)})).catch((function(t){Ks.warn("quitRTCRoom ->error:"+t+",roomId:"+e.id),n.onError(t)}))}},{key:"RTCPing",value:function(e,n){Ks.info("RTCPing ->roomId:"+e.id);var s=e.mode||0;this._context.rtcPing(e.id,s).then((function(s){s!==t.ErrorCode.SUCCESS?(Ks.warn("RTCPing ->code:"+s+",roomId:"+e.id),n.onError(s)):n.onSuccess(!0)})).catch((function(t){Ks.warn("RTCPing ->error:"+t+",roomId:"+e.id),n.onError(t)}))}},{key:"setRTCData",value:function(e,n,s,r,o,a,i){Ks.info("setRTCData ->roomId:"+e+",key:"+n),this._context.setRTCData(e,n,s,r,o,i).then((function(n){n!==t.ErrorCode.SUCCESS?(Ks.warn("setRTCData ->code:"+n+",roomId:"+e),a.onError(n)):a.onSuccess(!0)})).catch((function(t){Ks.warn("setRTCData ->error:"+t+",roomId:"+e),a.onError(t)}))}},{key:"getRTCData",value:function(e,n,s,r,o){Ks.info("getRTCData ->roomId:"+e+",keys:"+n),this._context.getRTCData(e,n,s,r).then((function(n){var s=n.code,r=n.data;s!==t.ErrorCode.SUCCESS?(Ks.warn("getRTCData ->code:"+s+",roomId:"+e),o.onError(s)):o.onSuccess(r)})).catch((function(t){Ks.warn("setRTCUserInfo ->error:"+t+",roomId:"+e),o.onError(t)}))}},{key:"removeRTCData",value:function(e,n,s,r,o,a){Ks.info("removeRTCData ->roomId:"+e+",keys:"+n),this._context.removeRTCData(e,n,s,r,a).then((function(n){n!==t.ErrorCode.SUCCESS?(Ks.warn("removeRTCData ->code:"+n+",roomId:"+e),o.onError(n)):o.onSuccess(!0)})).catch((function(t){Ks.warn("removeRTCData ->error:"+t+",roomId:"+e),o.onError(t)}))}},{key:"setRTCUserData",value:function(e,n,s,r,o,a){this.setRTCData(e,n,s,r,t.RTCApiType.PERSON,o,a)}},{key:"setRTCUserTotalRes",value:function(e,n,s,r,o){Ks.info("setRTCUserTotalRes ->roomId:"+e),this._context.setRTCTotalRes(e,n,s,r).then((function(n){n!==t.ErrorCode.SUCCESS?(Ks.warn("setRTCUserTotalRes ->code:"+n+",roomId:"+e),o.onError(n)):o.onSuccess(!0)})).catch((function(t){Ks.warn("setRTCUserTotalRes ->error:"+t+",roomId:"+e),o.onError(t)}))}},{key:"getRTCUserData",value:function(e,n,s,r){this.getRTCData(e,n,s,t.RTCApiType.PERSON,r)}},{key:"removeRTCUserData",value:function(e,n,s,r,o){this.removeRTCData(e,n,s,t.RTCApiType.PERSON,r,o)}},{key:"setRTCRoomData",value:function(e,n,s,r,o,a){this.setRTCData(e,n,s,r,t.RTCApiType.ROOM,o,a)}},{key:"getRTCRoomData",value:function(e,n,s,r){this.getRTCData(e,n,s,t.RTCApiType.ROOM,r)}},{key:"removeRTCRoomData",value:function(e,n,s,r,o){this.removeRTCData(e,n,s,t.RTCApiType.ROOM,r,o)}},{key:"setRTCOutData",value:function(e,n,s,r,o){throw t.todo("setRTCOutData")}},{key:"getRTCOutData",value:function(e,n,s){throw t.todo("getRTCOutData")}},{key:"getRTCToken",value:function(e,n){Ks.info("getRTCToken ->roomId:"+e.id),this._context.getRTCToken(e.id,e.mode,e.broadcastType).then((function(s){var r=s.code,o=s.data;r!==t.ErrorCode.SUCCESS?(Ks.warn("getRTCToken ->code:"+r+",roomId:"+e.id),n.onError(r)):n.onSuccess(o)})).catch((function(t){Ks.warn("getRTCToken ->error:"+t+",roomId:"+e.id),n.onError(t)}))}},{key:"setRTCState",value:function(e,n,s){Ks.info("setRTCState ->roomId:"+e.id),this._context.setRTCState(e.id,n.report).then((function(n){n!==t.ErrorCode.SUCCESS?(Ks.warn("setRTCState ->code:"+n+",roomId:"+e.id),s.onError(n)):s.onSuccess(!0)})).catch((function(t){Ks.warn("setRTCState ->error:"+t+",roomId:"+e.id),s.onError(t)}))}}]),e}(),Eo=[],Ao=[],ko={message:function(e){Eo.forEach((function(t){return t(ro(e))}))},status:function(e){Ao.forEach((function(t){return t(e)}))}},bo={init:function(e,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t.assert("appkey",e,t.AssertRules.STRING,!0),Ks.setLogLevel(s.logLevel),Ks.setLogStdout(s.logStdout),Ks.info("RongIMLib Version: ".concat("2.8.0-enterprise.1",", Commit: ","64ff20f694d97c9eea41383085c04b99d54f0fd8",",appkey:")+e);var r=null==s?void 0:s.connectionType;r?t.CONNECTION_TYPE.WEBSOCKET!==r&&t.CONNECTION_TYPE.COMET!==r&&(Ks.warn("RongIMLib connectionType must be ".concat(t.CONNECTION_TYPE.WEBSOCKET," or ").concat(t.CONNECTION_TYPE.COMET)),r=t.CONNECTION_TYPE.WEBSOCKET):r=t.CONNECTION_TYPE.WEBSOCKET,yo=t.APIContext.init(fr,{appkey:e,apiVersion:"2.8.0-enterprise.1",navigators:s.navi?[s.navi]:[],miniCMPProxy:[],connectionType:r,logLevel:s.logLevel,logStdout:s.logStdout,typingExpireTime:s.typingExpireTime,indexDBSwitch:void 0===s.indexDBSwitch||s.indexDBSwitch}),mo=new To(yo)},getInstance:function(){return mo},setConnectionStatusListener:function(e){yo.assignWatcher({connectionState:e.onChanged})},setOnReceiveMessageListener:function(e){yo.assignWatcher({message:function(n,s,r){try{var o=ro(n),a=yo.getCurrentUserId();oo(o,a),o=function(e,t){var n=new Date,s=n.getMonth()+1,r=n.getFullYear()+"/"+(1===s.toString().length?"0"+s:s)+"/"+n.getDate(),o=new Date(r).getTime()-e.sentTime<0;if("ReadReceiptResponseMessage"!==e.messageType||!o)return e;var a=e.content,i=((a=a||{}).receiptMessageDic||{})[t],c="",u={};if(e.receiptResponse||(e.receiptResponse={}),i){for(var l=[],d=0;d<i.length;d++)c="".concat(t).concat(i[d],"SENT"),(u=no.get(c))&&!(e.senderUserId in u.userIds)&&(l.push(i[d]),u.count+=1,u.userIds[e.senderUserId]=e.sentTime,e.receiptResponse[i[d]]=u.count,no.set(c,u));a.receiptMessageDic[t]=l,e.content=a}return e}(o,a),t.usingCppEngine()||Zr.set(n),e.onReceived(o,void 0,r)}catch(e){Ks.error("setOnReceiveMessageListener ->error:"+e)}}})},setConversationStatusListener:function(e){yo.assignWatcher({conversationState:function(t){try{var n=[];t.forEach((function(e){var t=e.updatedItems,s=e.conversationType,r=e.targetId,o=e.channelId,a=t=t||{},i=a.notificationStatus,c=a.isTop;i&&c&&n.push({notificationStatus:i.val,isTop:c.val,conversationType:s,targetId:r,channelId:o||"",updatedTime:i.time})})),n.length>0&&e.onChanged(n)}catch(e){Ks.error("setConversationStatusListener ->error:"+e)}}})},setMessageExpansionListener:function(e){yo.assignWatcher({expansion:function(t){try{t.updatedExpansion&&e.onUpdated(t.updatedExpansion),t.deletedExpansion&&e.onDeleted(t.deletedExpansion)}catch(e){Ks.error("setMessageExpansionListener ->error:"+e)}}})},setTagListener:function(e){yo.assignWatcher({tag:function(){e.onChanged()}})},setConversationTagListener:function(e){yo.assignWatcher({conversationTagChanged:function(){e.onChanged()}})},setTypingStatusListener:function(e){yo.assignWatcher({typingState:function(t){e.onChanged(t)}})},connect:function(e,n){return c(regeneratorRuntime.mark((function s(){var r;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return Ks.info("connect ->token:"+e),s.next=3,yo.connect(e);case 3:(r=s.sent).code===t.ErrorCode.SUCCESS?n.onSuccess(r.userId):r.code===t.ErrorCode.RC_CONN_USER_OR_PASSWD_ERROR?(Ks.warn("connect ->code:"+r.code+",token:"+e),n.onTokenIncorrect()):(Ks.warn("connect ->code:"+r.code+",token:"+e),n.onError(r.code));case 5:case"end":return s.stop()}}),s)})))()},reconnect:function(e,n){yo.reconnect().then((function(n){n.code===t.ErrorCode.SUCCESS?e.onSuccess(n.userId):(Ks.warn("reconnect ->code:"+n.code),e.onError(n.code))})).catch(e.onError)},RegisterMessage:{},RegisterMessageTypeMapping:to,getMessageObjectName:function(e){var t=h(h({},eo),to);return Object.keys(t).find((function(n){return t[n]===e}))||e},registerMessageType:function(e,t,n,s){this.RegisterMessage[e]=Ro(e,t,n.isPersited,n.isCounted),this.RegisterMessageTypeMapping[t]=e,yo.registerMessageType(t,n.isPersited,n.isCounted,s)},createLogger:function(e,n){return/^(RC)/.test(e)?(Ks.error("Tag error. Tags that start with RC are used internally by the SDK !"),null):["IM","RTC"].includes(n)?new t.Logger(e,n,"A"):(Ks.error("The parameter type must be one of IM, or RTC !"),null)},messageWatch:function(e){var t=this;Eo.push((function(n){Ks.info("messageWatch ->message:"+JSON.stringify(n||{}));try{e(n),t._voipProvider.onReceived&&t._voipProvider.onReceived(n)}catch(e){Ks.error("messageWatch ->error:"+e)}})),yo.assignWatcher({rtcInnerWatcher:ko})},statusWatch:function(e){Ao.push((function(t){Ks.info("statusWatch ->status:"+t);try{e(t)}catch(e){Ks.error("statusWatch ->error:"+e)}}))},MessageType:{TextMessage:"TextMessage",ImageMessage:"ImageMessage",ReferenceMessage:"ReferenceMessage",DiscussionNotificationMessage:"DiscussionNotificationMessage",VoiceMessage:"VoiceMessage",RichContentMessage:"RichContentMessage",HandshakeMessage:"HandshakeMessage",UnknownMessage:"UnknownMessage",LocationMessage:"LocationMessage",InformationNotificationMessage:"InformationNotificationMessage",ContactNotificationMessage:"ContactNotificationMessage",ProfileNotificationMessage:"ProfileNotificationMessage",CommandNotificationMessage:"CommandNotificationMessage",CommandMessage:"CommandMessage",TypingStatusMessage:"TypingStatusMessage",ChangeModeResponseMessage:"ChangeModeResponseMessage",ChangeModeMessage:"ChangeModeMessage",EvaluateMessage:"EvaluateMessage",HandShakeMessage:"HandShakeMessage",HandShakeResponseMessage:"HandShakeResponseMessage",SuspendMessage:"SuspendMessage",TerminateMessage:"TerminateMessage",CustomerContact:"CustomerContact",CustomerStatusUpdateMessage:"CustomerStatusUpdateMessage",SyncReadStatusMessage:"SyncReadStatusMessage",ReadReceiptRequestMessage:"ReadReceiptRequestMessage",ReadReceiptResponseMessage:"ReadReceiptResponseMessage",FileMessage:"FileMessage",HQVoiceMessage:"HQVoiceMessage",GIFMessage:"GIFMessage",SightMessage:"SightMessage",AcceptMessage:"AcceptMessage",RingingMessage:"RingingMessage",SummaryMessage:"SummaryMessage",HungupMessage:"HungupMessage",InviteMessage:"InviteMessage",MediaModifyMessage:"MediaModifyMessage",MemberModifyMessage:"MemberModifyMessage",JrmfRedPacketMessage:"JrmfRedPacketMessage",JrmfRedPacketOpenedMessage:"JrmfRedPacketOpenedMessage",GroupNotificationMessage:"GroupNotificationMessage",PublicServiceRichContentMessage:"PublicServiceRichContentMessage",PublicServiceMultiRichContentMessage:"PublicServiceMultiRichContentMessage",PublicServiceCommandMessage:"PublicServiceCommandMessage",RecallCommandMessage:"RecallCommandMessage",ReadReceiptMessage:"ReadReceiptMessage",RCCombineMessage:"RCCombineMessage",ChrmKVNotificationMessage:"ChrmKVNotificationMessage",LogCommandMessage:"LogCommandMessage"},_voipProvider:{}},wo=Ro("TextMessage","RC:TxtMsg"),Uo=Ro("LocationMessage","RC:LBSMsg"),No=Ro("TypingStatusMessage","RC:TypSts"),Lo=Ro("ImageMessage","RC:ImgMsg"),xo=Ro("RichContentMessage","RC:ImgTextMsg"),_o=Ro("VoiceMessage","RC:VcMsg"),Oo=Ro("HQVoiceMessage","RC:HQVCMsg"),Po=Ro("FileMessage","RC:FileMsg"),Bo=Ro("SightMessage","RC:SightMsg"),jo=Ro("GIFMessage","RC:GIFMsg"),Do=Ro("ReadReceiptMessage","RC:ReadNtf"),Go=Ro("ReadReceiptRequestMessage","RC:RRReqMsg"),Fo=Ro("RCCombineMessage","RC:CombineMsg");e.VoIPMediaType=void 0,(So=e.VoIPMediaType||(e.VoIPMediaType={}))[So.MEDIA_AUDIO=1]="MEDIA_AUDIO",So[So.MEDIA_VEDIO=2]="MEDIA_VEDIO",So[So.MEDIA_VIDEO=2]="MEDIA_VIDEO";var Ko,Ho=Ro("AcceptMessage","RC:VCAccept"),Vo=Ro("RingingMessage","RC:VCRinging"),qo=Ro("SummaryMessage","RC:VCSummary"),Wo=Ro("HungupMessage","RC:VCHangup"),Yo=Ro("InviteMessage","RC:VCInvite"),Jo=Ro("MediaModifyMessage","RC:VCModifyMedia"),Qo=Ro("MemberModifyMessage","RC:VCModifyMem"),Xo=Ro("lastMessageSendTime","RC:SRSMsg"),zo=Ro("ReferenceMessage","RC:ReferenceMsg");!function(e){e[e.ALL=1]="ALL",e[e.PART=2]="PART"}(Ko||(Ko={}));var $o=Ko,Zo=Ro("PublicServiceRichContentMessage","RC:PSImgTxtMsg"),ea=Ro("PublicServiceMultiRichContentMessage","RC:PSMultiImgTxtMsg"),ta=t.ConnectResultCode;window&&(window.RongIMClient=bo),Object.defineProperty(e,"ConnectionStatus",{enumerable:!0,get:function(){return t.ConnectionStatus}}),Object.defineProperty(e,"ConversationType",{enumerable:!0,get:function(){return t.ConversationType}}),Object.defineProperty(e,"ErrorCode",{enumerable:!0,get:function(){return t.ErrorCode}}),Object.defineProperty(e,"FileType",{enumerable:!0,get:function(){return t.FileType}}),Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return t.LogLevel}}),Object.defineProperty(e,"MessageDirection",{enumerable:!0,get:function(){return t.MessageDirection}}),Object.defineProperty(e,"ReceivedStatus",{enumerable:!0,get:function(){return t.ReceivedStatus}}),Object.defineProperty(e,"UploadMethod",{enumerable:!0,get:function(){return t.UploadMethod}}),e.AcceptMessage=Ho,e.ChannelClient=Mo,e.ConnectionState=ta,e.FileMessage=Po,e.GIFMessage=jo,e.GetChatRoomType=o,e.HQVoiceMessage=Oo,e.HungupMessage=Wo,e.IMClient=To,e.ImageMessage=Lo,e.InviteMessage=Yo,e.LocationMessage=Uo,e.MediaModifyMessage=Jo,e.MemberModifyMessage=Qo,e.MentionedInfo=function e(t,n,s){u(this,e),this.type=t,this.userIdList=n,this.mentionedContent=s},e.MentionedType=$o,e.Message=function e(t,n,s,r,o,a,i,c,l,d,f,g,h,C,v,p,R,m){u(this,e),this.conversationType=t,this.targetId=n,this.senderUserId=s,this.content=r,this.objectName=o,this.messageType=a,this.messageId=i,this.messageUId=c,this.messageDirection=l,this.offLineMessage=d,this.sentStatus=f,this.sentTime=g,this.receivedStatus=h,this.receivedTime=C,this.canIncludeExpansion=v,this.expansion=p,this.receiptResponse=R,this.disableNotification=m},e.MessageTag=function e(t,n){u(this,e),this.isCounted=t,this.isPersited=n},e.PublicServiceMultiRichContentMessage=ea,e.PublicServiceRichContentMessage=Zo,e.RCCombineMessage=Fo,e.ReadReceiptMessage=Do,e.ReadReceiptRequestMessage=Go,e.ReadReceiptResponseMessage=Io,e.ReferenceMessage=zo,e.RichContentMessage=xo,e.RingingMessage=Vo,e.RongIMClient=bo,e.SentStatus=r,e.SightMessage=Bo,e.SummaryMessage=qo,e.SyncReadStatusMessage=Xo,e.TextMessage=wo,e.TypingStatusMessage=No,e.VoiceMessage=_o,Object.defineProperty(e,"__esModule",{value:!0})}));
