!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).RCEngine={})}(this,(function(e){"use strict";var t;!function(e){e[e.READ=1]="READ",e[e.LISTENED=2]="LISTENED",e[e.DOWNLOADED=4]="DOWNLOADED",e[e.RETRIEVED=8]="RETRIEVED",e[e.UNREAD=0]="UNREAD"}(t||(t={}));var n=t;function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n,r,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var o=e.apply(t,n);function a(e){i(o,r,s,a,u,"next",e)}function u(e){i(o,r,s,a,u,"throw",e)}a(void 0)}))}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e,t,n){return(y=v()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&p(i,n.prototype),i}).apply(null,arguments)}function m(e){var t="function"==typeof Map?new Map:void 0;return(m=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return y(e,arguments,d(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?E(e):t}function T(e){var t=v();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _(this,n)}}function R(e,t,n){return(R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,s=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return n}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function O(e){var t={exports:{}};return e(t,t.exports),t.exports}var N=function(e){return e&&e.Math==Math&&e},k=N("object"==typeof globalThis&&globalThis)||N("object"==typeof window&&window)||N("object"==typeof self&&self)||N("object"==typeof w&&w)||function(){return this}()||Function("return this")(),A=function(e){try{return!!e()}catch(e){return!0}},M=!A((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),x={}.propertyIsEnumerable,U=Object.getOwnPropertyDescriptor,L={f:U&&!x.call({1:2},1)?function(e){var t=U(this,e);return!!t&&t.enumerable}:x},P=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},D={}.toString,V=function(e){return D.call(e).slice(8,-1)},B="".split,F=A((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==V(e)?B.call(e,""):Object(e)}:Object,Y=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},j=function(e){return F(Y(e))},q=function(e){return"object"==typeof e?null!==e:"function"==typeof e},G=function(e,t){if(!q(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!q(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!q(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!q(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},H={}.hasOwnProperty,K=function(e,t){return H.call(e,t)},W=k.document,Q=q(W)&&q(W.createElement),z=function(e){return Q?W.createElement(e):{}},J=!M&&!A((function(){return 7!=Object.defineProperty(z("div"),"a",{get:function(){return 7}}).a})),Z=Object.getOwnPropertyDescriptor,$={f:M?Z:function(e,t){if(e=j(e),t=G(t,!0),J)try{return Z(e,t)}catch(e){}if(K(e,t))return P(!L.f.call(e,t),e[t])}},X=function(e){if(!q(e))throw TypeError(String(e)+" is not an object");return e},ee=Object.defineProperty,te={f:M?ee:function(e,t,n){if(X(e),t=G(t,!0),X(n),J)try{return ee(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},ne=M?function(e,t,n){return te.f(e,t,P(1,n))}:function(e,t,n){return e[t]=n,e},re=function(e,t){try{ne(k,e,t)}catch(n){k[e]=t}return t},ie="__core-js_shared__",se=k[ie]||re(ie,{}),oe=Function.toString;"function"!=typeof se.inspectSource&&(se.inspectSource=function(e){return oe.call(e)});var ae,ue,ce,le=se.inspectSource,he=k.WeakMap,fe="function"==typeof he&&/native code/.test(le(he)),de=O((function(e){(e.exports=function(e,t){return se[e]||(se[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.9.1",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})})),ge=0,pe=Math.random(),ve=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++ge+pe).toString(36)},ye=de("keys"),me=function(e){return ye[e]||(ye[e]=ve(e))},Ee={},_e=k.WeakMap;if(fe){var Te=se.state||(se.state=new _e),Re=Te.get,Ie=Te.has,Ce=Te.set;ae=function(e,t){return t.facade=e,Ce.call(Te,e,t),t},ue=function(e){return Re.call(Te,e)||{}},ce=function(e){return Ie.call(Te,e)}}else{var Se=me("state");Ee[Se]=!0,ae=function(e,t){return t.facade=e,ne(e,Se,t),t},ue=function(e){return K(e,Se)?e[Se]:{}},ce=function(e){return K(e,Se)}}var be,we,Oe={set:ae,get:ue,has:ce,enforce:function(e){return ce(e)?ue(e):ae(e,{})},getterFor:function(e){return function(t){var n;if(!q(t)||(n=ue(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},Ne=O((function(e){var t=Oe.get,n=Oe.enforce,r=String(String).split("String");(e.exports=function(e,t,i,s){var o,a=!!s&&!!s.unsafe,u=!!s&&!!s.enumerable,c=!!s&&!!s.noTargetGet;"function"==typeof i&&("string"!=typeof t||K(i,"name")||ne(i,"name",t),(o=n(i)).source||(o.source=r.join("string"==typeof t?t:""))),e!==k?(a?!c&&e[t]&&(u=!0):delete e[t],u?e[t]=i:ne(e,t,i)):u?e[t]=i:re(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||le(this)}))})),ke=k,Ae=function(e){return"function"==typeof e?e:void 0},Me=function(e,t){return arguments.length<2?Ae(ke[e])||Ae(k[e]):ke[e]&&ke[e][t]||k[e]&&k[e][t]},xe=Math.ceil,Ue=Math.floor,Le=function(e){return isNaN(e=+e)?0:(e>0?Ue:xe)(e)},Pe=Math.min,De=function(e){return e>0?Pe(Le(e),9007199254740991):0},Ve=Math.max,Be=Math.min,Fe=function(e,t){var n=Le(e);return n<0?Ve(n+t,0):Be(n,t)},Ye=function(e){return function(t,n,r){var i,s=j(t),o=De(s.length),a=Fe(r,o);if(e&&n!=n){for(;o>a;)if((i=s[a++])!=i)return!0}else for(;o>a;a++)if((e||a in s)&&s[a]===n)return e||a||0;return!e&&-1}},je={includes:Ye(!0),indexOf:Ye(!1)},qe=je.indexOf,Ge=function(e,t){var n,r=j(e),i=0,s=[];for(n in r)!K(Ee,n)&&K(r,n)&&s.push(n);for(;t.length>i;)K(r,n=t[i++])&&(~qe(s,n)||s.push(n));return s},He=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ke=He.concat("length","prototype"),We={f:Object.getOwnPropertyNames||function(e){return Ge(e,Ke)}},Qe={f:Object.getOwnPropertySymbols},ze=Me("Reflect","ownKeys")||function(e){var t=We.f(X(e)),n=Qe.f;return n?t.concat(n(e)):t},Je=function(e,t){for(var n=ze(t),r=te.f,i=$.f,s=0;s<n.length;s++){var o=n[s];K(e,o)||r(e,o,i(t,o))}},Ze=/#|\.prototype\./,$e=function(e,t){var n=et[Xe(e)];return n==nt||n!=tt&&("function"==typeof t?A(t):!!t)},Xe=$e.normalize=function(e){return String(e).replace(Ze,".").toLowerCase()},et=$e.data={},tt=$e.NATIVE="N",nt=$e.POLYFILL="P",rt=$e,it=$.f,st=function(e,t){var n,r,i,s,o,a=e.target,u=e.global,c=e.stat;if(n=u?k:c?k[a]||re(a,{}):(k[a]||{}).prototype)for(r in t){if(s=t[r],i=e.noTargetGet?(o=it(n,r))&&o.value:n[r],!rt(u?r:a+(c?".":"#")+r,e.forced)&&void 0!==i){if(typeof s==typeof i)continue;Je(s,i)}(e.sham||i&&i.sham)&&ne(s,"sham",!0),Ne(n,r,s,e)}},ot=Array.isArray||function(e){return"Array"==V(e)},at=function(e){return Object(Y(e))},ut=function(e,t,n){var r=G(t);r in e?te.f(e,r,P(0,n)):e[r]=n},ct="process"==V(k.process),lt=Me("navigator","userAgent")||"",ht=k.process,ft=ht&&ht.versions,dt=ft&&ft.v8;dt?we=(be=dt.split("."))[0]+be[1]:lt&&(!(be=lt.match(/Edge\/(\d+)/))||be[1]>=74)&&(be=lt.match(/Chrome\/(\d+)/))&&(we=be[1]);var gt=we&&+we,pt=!!Object.getOwnPropertySymbols&&!A((function(){return!Symbol.sham&&(ct?38===gt:gt>37&&gt<41)})),vt=pt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,yt=de("wks"),mt=k.Symbol,Et=vt?mt:mt&&mt.withoutSetter||ve,_t=function(e){return K(yt,e)&&(pt||"string"==typeof yt[e])||(pt&&K(mt,e)?yt[e]=mt[e]:yt[e]=Et("Symbol."+e)),yt[e]},Tt=_t("species"),Rt=function(e,t){var n;return ot(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!ot(n.prototype)?q(n)&&null===(n=n[Tt])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},It=_t("species"),Ct=function(e){return gt>=51||!A((function(){var t=[];return(t.constructor={})[It]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},St=_t("isConcatSpreadable"),bt=9007199254740991,wt="Maximum allowed index exceeded",Ot=gt>=51||!A((function(){var e=[];return e[St]=!1,e.concat()[0]!==e})),Nt=Ct("concat"),kt=function(e){if(!q(e))return!1;var t=e[St];return void 0!==t?!!t:ot(e)};st({target:"Array",proto:!0,forced:!Ot||!Nt},{concat:function(e){var t,n,r,i,s,o=at(this),a=Rt(o,0),u=0;for(t=-1,r=arguments.length;t<r;t++)if(kt(s=-1===t?o:arguments[t])){if(u+(i=De(s.length))>bt)throw TypeError(wt);for(n=0;n<i;n++,u++)n in s&&ut(a,u,s[n])}else{if(u>=bt)throw TypeError(wt);ut(a,u++,s)}return a.length=u,a}});var At,Mt=72e5,xt=5e3,Ut=["https://nav.cn.ronghub.com","https://nav2-cn.ronghub.com"],Lt=["wsproxy.cn.ronghub.com","wsap-cn.ronghub.com"],Pt=["cometproxy-cn.ronghub.com","mini-cn.ronghub.com"],Dt=3e4,Vt=131072,Bt="RCV4-",Ft={"RC:TxtMsg":{isCounted:!0,isPersited:!0},"RC:ImgMsg":{isCounted:!0,isPersited:!0},"RC:VcMsg":{isCounted:!0,isPersited:!0},"RC:ImgTextMsg":{isCounted:!0,isPersited:!0},"RC:FileMsg":{isCounted:!0,isPersited:!0},"RC:HQVCMsg":{isCounted:!0,isPersited:!0},"RC:LBSMsg":{isCounted:!0,isPersited:!0},"RC:PSImgTxtMsg":{isCounted:!0,isPersited:!0},"RC:PSMultiImgTxtMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpOpendMsg":{isCounted:!0,isPersited:!0},"RC:CombineMsg":{isCounted:!0,isPersited:!0},"RC:ReferenceMsg":{isCounted:!0,isPersited:!0},"RC:SightMsg":{isCounted:!0,isPersited:!0},"RC:GIFMsg":{isCounted:!0,isPersited:!0},"RC:InfoNtf":{isCounted:!1,isPersited:!0},"RC:ContactNtf":{isCounted:!1,isPersited:!0},"RC:ProfileNtf":{isCounted:!1,isPersited:!0},"RC:CmdNtf":{isCounted:!1,isPersited:!0},"RC:GrpNtf":{isCounted:!1,isPersited:!0},"RC:RcCmd":{isCounted:!1,isPersited:!0},"RC:CmdMsg":{isCounted:!1,isPersited:!1},"RC:TypSts":{isCounted:!1,isPersited:!1},"RC:PSCmd":{isCounted:!1,isPersited:!1},"RC:SRSMsg":{isCounted:!1,isPersited:!1},"RC:RRReqMsg":{isCounted:!1,isPersited:!1},"RC:RRRspMsg":{isCounted:!1,isPersited:!1},"RC:CsChaR":{isCounted:!1,isPersited:!1},"RC:CSCha":{isCounted:!1,isPersited:!1},"RC:CsEva":{isCounted:!1,isPersited:!1},"RC:CsContact":{isCounted:!1,isPersited:!1},"RC:CsHs":{isCounted:!1,isPersited:!1},"RC:CsHsR":{isCounted:!1,isPersited:!1},"RC:CsSp":{isCounted:!1,isPersited:!1},"RC:CsEnd":{isCounted:!1,isPersited:!1},"RC:CsUpdate":{isCounted:!1,isPersited:!1},"RC:ReadNtf":{isCounted:!1,isPersited:!1},"RC:chrmKVNotiMsg":{isCounted:!1,isPersited:!1},"RC:VCAccept":{isCounted:!1,isPersited:!1},"RC:VCRinging":{isCounted:!1,isPersited:!1},"RC:VCSummary":{isCounted:!1,isPersited:!1},"RC:VCHangup":{isCounted:!1,isPersited:!1},"RC:VCInvite":{isCounted:!1,isPersited:!1},"RC:VCModifyMedia":{isCounted:!1,isPersited:!1},"RC:VCModifyMem":{isCounted:!1,isPersited:!1},"RC:MsgExMsg":{isCounted:!1,isPersited:!1},"RC:RRMsg":{isCounted:!1,isPersited:!1}},Yt=["RC:TypSts"],jt=function(e){return At||(At={set:function(t,n){e.localStorage.setItem(t,JSON.stringify(n))},get:function(t){var n;try{n=JSON.parse(e.localStorage.getItem(t))}catch(e){n=null}return n},remove:function(t){return e.localStorage.removeItem(t)},getKeys:function(){var t=[];for(var n in e.localStorage)t.push(n);return t}}),At},qt=function(){function e(t){o(this,e),this._caches={},t&&(this._caches=t)}return u(e,[{key:"set",value:function(e,t){this._caches[e]=t}},{key:"remove",value:function(e){var t=this.get(e);return delete this._caches[e],t}},{key:"get",value:function(e){return this._caches[e]}},{key:"getKeys",value:function(){var e=[];for(var t in this._caches)e.push(t);return e}}]),e}(),Gt=function(){function e(t,n){o(this,e);var r=n?"".concat(Bt).concat(n):Bt;this._rootStorage=jt(t);var i=this._rootStorage.get(r)||{};this._cache=new qt(c({},r,i)),this._storageKey=r}return u(e,[{key:"_get",value:function(){var e=this._storageKey;return this._cache.get(e)||{}}},{key:"_set",value:function(e){var t=this._storageKey;e=e||{},this._cache.set(t,e),this._rootStorage.set(t,e)}},{key:"set",value:function(e,t){var n=this._get();n[e]=t,this._set(n)}},{key:"remove",value:function(e){var t=this._get();delete t[e],this._set(t)}},{key:"clear",value:function(){var e=this._storageKey;this._rootStorage.remove(e),this._cache.remove(e)}},{key:"get",value:function(e){return this._get()[e]}},{key:"getKeys",value:function(){var e=this._get(),t=[];for(var n in e)t.push(n);return t}},{key:"getValues",value:function(){return this._get()||{}}}]),e}(),Ht=function(e){f(n,e);var t=T(n);function n(e){return o(this,n),t.call(this,"TODO => ".concat(e))}return n}(m(Error)),Kt=Ct("slice"),Wt=_t("species"),Qt=[].slice,zt=Math.max;st({target:"Array",proto:!0,forced:!Kt},{slice:function(e,t){var n,r,i,s=j(this),o=De(s.length),a=Fe(e,o),u=Fe(void 0===t?o:t,o);if(ot(s)&&("function"!=typeof(n=s.constructor)||n!==Array&&!ot(n.prototype)?q(n)&&null===(n=n[Wt])&&(n=void 0):n=void 0,n===Array||void 0===n))return Qt.call(s,a,u);for(r=new(void 0===n?Array:n)(zt(u-a,0)),i=0;a<u;a++,i++)a in s&&ut(r,i,s[a]);return r.length=i,r}});var Jt=function(){var e=X(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function Zt(e,t){return RegExp(e,t)}var $t={UNSUPPORTED_Y:A((function(){var e=Zt("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:A((function(){var e=Zt("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},Xt=RegExp.prototype.exec,en=String.prototype.replace,tn=Xt,nn=function(){var e=/a/,t=/b*/g;return Xt.call(e,"a"),Xt.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),rn=$t.UNSUPPORTED_Y||$t.BROKEN_CARET,sn=void 0!==/()??/.exec("")[1];(nn||sn||rn)&&(tn=function(e){var t,n,r,i,s=this,o=rn&&s.sticky,a=Jt.call(s),u=s.source,c=0,l=e;return o&&(-1===(a=a.replace("y","")).indexOf("g")&&(a+="g"),l=String(e).slice(s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\n"!==e[s.lastIndex-1])&&(u="(?: "+u+")",l=" "+l,c++),n=new RegExp("^(?:"+u+")",a)),sn&&(n=new RegExp("^"+u+"$(?!\\s)",a)),nn&&(t=s.lastIndex),r=Xt.call(o?n:s,l),o?r?(r.input=r.input.slice(c),r[0]=r[0].slice(c),r.index=s.lastIndex,s.lastIndex+=r[0].length):s.lastIndex=0:nn&&r&&(s.lastIndex=s.global?r.index+r[0].length:t),sn&&r&&r.length>1&&en.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r});var on=tn;st({target:"RegExp",proto:!0,forced:/./.exec!==on},{exec:on});var an=_t("species"),un=!A((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),cn="$0"==="a".replace(/./,"$0"),ln=_t("replace"),hn=!!/./[ln]&&""===/./[ln]("a","$0"),fn=!A((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),dn=function(e,t,n,r){var i=_t(e),s=!A((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),o=s&&!A((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[an]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!s||!o||"replace"===e&&(!un||!cn||hn)||"split"===e&&!fn){var a=/./[i],u=n(i,""[e],(function(e,t,n,r,i){return t.exec===on?s&&!i?{done:!0,value:a.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:cn,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:hn}),c=u[0],l=u[1];Ne(String.prototype,e,c),Ne(RegExp.prototype,i,2==t?function(e,t){return l.call(e,this,t)}:function(e){return l.call(e,this)})}r&&ne(RegExp.prototype[i],"sham",!0)},gn=function(e){return function(t,n){var r,i,s=String(Y(t)),o=Le(n),a=s.length;return o<0||o>=a?e?"":void 0:(r=s.charCodeAt(o))<55296||r>56319||o+1===a||(i=s.charCodeAt(o+1))<56320||i>57343?e?s.charAt(o):r:e?s.slice(o,o+2):i-56320+(r-55296<<10)+65536}},pn={codeAt:gn(!1),charAt:gn(!0)},vn=pn.charAt,yn=function(e,t,n){return t+(n?vn(e,t).length:1)},mn=Math.floor,En="".replace,_n=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Tn=/\$([$&'`]|\d{1,2})/g,Rn=function(e,t,n,r,i,s){var o=n+e.length,a=r.length,u=Tn;return void 0!==i&&(i=at(i),u=_n),En.call(s,u,(function(s,u){var c;switch(u.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(o);case"<":c=i[u.slice(1,-1)];break;default:var l=+u;if(0===l)return s;if(l>a){var h=mn(l/10);return 0===h?s:h<=a?void 0===r[h-1]?u.charAt(1):r[h-1]+u.charAt(1):s}c=r[l-1]}return void 0===c?"":c}))},In=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==V(e))throw TypeError("RegExp#exec called on incompatible receiver");return on.call(e,t)},Cn=Math.max,Sn=Math.min;dn("replace",2,(function(e,t,n,r){var i=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,s=r.REPLACE_KEEPS_$0,o=i?"$":"$0";return[function(n,r){var i=Y(this),s=null==n?void 0:n[e];return void 0!==s?s.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!i&&s||"string"==typeof r&&-1===r.indexOf(o)){var a=n(t,e,this,r);if(a.done)return a.value}var u=X(e),c=String(this),l="function"==typeof r;l||(r=String(r));var h=u.global;if(h){var f=u.unicode;u.lastIndex=0}for(var d=[];;){var g=In(u,c);if(null===g)break;if(d.push(g),!h)break;""===String(g[0])&&(u.lastIndex=yn(c,De(u.lastIndex),f))}for(var p,v="",y=0,m=0;m<d.length;m++){g=d[m];for(var E=String(g[0]),_=Cn(Sn(Le(g.index),c.length),0),T=[],R=1;R<g.length;R++)T.push(void 0===(p=g[R])?p:String(p));var I=g.groups;if(l){var C=[E].concat(T,_,c);void 0!==I&&C.push(I);var S=String(r.apply(void 0,C))}else S=Rn(E,c,_,T,I,r);_>=y&&(v+=c.slice(y,_)+S,y=_+E.length)}return v+c.slice(y)}]}));var bn=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},wn=function(e,t,n){if(bn(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},On=[].push,Nn=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,o=7==e,a=5==e||s;return function(u,c,l,h){for(var f,d,g=at(u),p=F(g),v=wn(c,l,3),y=De(p.length),m=0,E=h||Rt,_=t?E(u,y):n||o?E(u,0):void 0;y>m;m++)if((a||m in p)&&(d=v(f=p[m],m,g),e))if(t)_[m]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:On.call(_,f)}else switch(e){case 4:return!1;case 7:On.call(_,f)}return s?-1:r||i?i:_}},kn={forEach:Nn(0),map:Nn(1),filter:Nn(2),some:Nn(3),every:Nn(4),find:Nn(5),findIndex:Nn(6),filterOut:Nn(7)},An=kn.filter,Mn=Ct("filter");st({target:"Array",proto:!0,forced:!Mn},{filter:function(e){return An(this,e,arguments.length>1?arguments[1]:void 0)}});var xn=kn.map,Un=Ct("map");st({target:"Array",proto:!0,forced:!Un},{map:function(e){return xn(this,e,arguments.length>1?arguments[1]:void 0)}});var Ln=Object.keys||function(e){return Ge(e,He)},Pn=A((function(){Ln(1)}));st({target:"Object",stat:!0,forced:Pn},{keys:function(e){return Ln(at(e))}});var Dn=function(e,t){var n=[][e];return!!n&&A((function(){n.call(null,t||function(){throw 1},1)}))},Vn=[].join,Bn=F!=Object,Fn=Dn("join",",");st({target:"Array",proto:!0,forced:Bn||!Fn},{join:function(e){return Vn.call(j(this),void 0===e?",":e)}}),dn("match",1,(function(e,t,n){return[function(t){var n=Y(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var i=X(e),s=String(this);if(!i.global)return In(i,s);var o=i.unicode;i.lastIndex=0;for(var a,u=[],c=0;null!==(a=In(i,s));){var l=String(a[0]);u[c]=l,""===l&&(i.lastIndex=yn(s,De(i.lastIndex),o)),c++}return 0===c?null:u}]}));var Yn,jn=function(e,t,n){if(void 0===t||void 0===n)return e.toUpperCase();var r=e.slice(t,n);return e=e.replace(r,(function(e){return e.toUpperCase()}))},qn=function(e){return e.match(/\d+(\.\d+){2}/)[0]},Gn=te.f,Hn=Function.prototype,Kn=Hn.toString,Wn=/^\s*function ([^ (]*)/,Qn="name";M&&!(Qn in Hn)&&Gn(Hn,Qn,{configurable:!0,get:function(){try{return Kn.call(this).match(Wn)[1]}catch(e){return""}}}),e.LogLevel=void 0,(Yn=e.LogLevel||(e.LogLevel={}))[Yn.LOG=0]="LOG",Yn[Yn.DEBUG=0]="DEBUG",Yn[Yn.INFO=1]="INFO",Yn[Yn.WARN=2]="WARN",Yn[Yn.ERROR=3]="ERROR",Yn[Yn.NONE=1e3]="NONE";var zn={};zn[_t("toStringTag")]="z";var Jn,Zn="[object z]"===String(zn),$n=_t("toStringTag"),Xn="Arguments"==V(function(){return arguments}()),er=Zn?V:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),$n))?n:Xn?V(t):"Object"==(r=V(t))&&"function"==typeof t.callee?"Arguments":r},tr=Zn?{}.toString:function(){return"[object "+er(this)+"]"};Zn||Ne(Object.prototype,"toString",tr,{unsafe:!0}),function(e){e[e.NONE=0]="NONE",e[e.PRIVATE=1]="PRIVATE",e[e.DISCUSSION=2]="DISCUSSION",e[e.GROUP=3]="GROUP",e[e.CHATROOM=4]="CHATROOM",e[e.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",e[e.SYSTEM=6]="SYSTEM",e[e.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",e[e.PUBLIC_SERVICE=8]="PUBLIC_SERVICE",e[e.RTC_ROOM=12]="RTC_ROOM"}(Jn||(Jn={}));var nr,rr=Jn;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=4]="FILE",e[e.SIGHT=5]="SIGHT",e[e.COMBINE_HTML=6]="COMBINE_HTML"}(nr||(nr={}));var ir,sr=nr,or=function(e){return"string"==typeof e},ar=function(e){return"boolean"==typeof e},ur=function(e){return"number"==typeof e&&!isNaN(e)},cr=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")},lr=function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)},hr=function(e){return or(e)&&e.length>0},fr=function(e){return"[object Object]"===Object.prototype.toString.call(e)},dr=function(e){return"[object Function]"===Object.prototype.toString.call(e)},gr=function(e){return void 0===e||"[object Undefined]"===Object.prototype.toString.call(e)},pr=function(e){return"[object Null]"===Object.prototype.toString.call(e)},vr=function(e){for(var t in e)return!0;return!1},yr=(c(ir={},e.LogLevel.DEBUG,console.debug.bind(console)),c(ir,e.LogLevel.INFO,console.info.bind(console)),c(ir,e.LogLevel.WARN,console.warn.bind(console)),c(ir,e.LogLevel.ERROR,console.error.bind(console)),ir),mr=function(e){return or(e)||ur(e)||gr(e)||ar(e)?e:e instanceof Error?JSON.stringify({name:e.name,message:e.message,stack:e.stack}):JSON.stringify(e)},Er=function(){function t(n){o(this,t),this.tag=n,this._outLevel=e.LogLevel.WARN,this.debug=this.log.bind(this,e.LogLevel.DEBUG),this.info=this.log.bind(this,e.LogLevel.INFO),this.warn=this.log.bind(this,e.LogLevel.WARN),this.error=this.log.bind(this,e.LogLevel.ERROR)}return u(t,[{key:"_defaultStdout",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];yr[e].apply(yr,["".concat(t,":")].concat(r))}},{key:"setLogLevel",value:function(t){this._outLevel="number"!=typeof t?e.LogLevel.WARN:t}},{key:"setLogStdout",value:function(e){this._logStdout=e}},{key:"log",value:function(t){if(!(t<this._outLevel)){for(var n="".concat((new Date).toISOString(),"[").concat(this.tag,"][").concat(e.LogLevel[t],"]"),r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];var o="".concat(n," - ").concat(i.map(mr).join(" "));this._logStdout?this._logStdout(t,o):this._stdout?this._stdout(t,o):this._defaultStdout.apply(this,[t,n].concat(i))}}},{key:"set",value:function(e,t){this.warn("logger.set has being deprecated!")}},{key:"setStdout",value:function(e){this._stdout=e}}]),t}(),_r=new Er("RCLog"),Tr=Ct("splice"),Rr=Math.max,Ir=Math.min,Cr=9007199254740991,Sr="Maximum allowed length exceeded";st({target:"Array",proto:!0,forced:!Tr},{splice:function(e,t){var n,r,i,s,o,a,u=at(this),c=De(u.length),l=Fe(e,c),h=arguments.length;if(0===h?n=r=0:1===h?(n=0,r=c-l):(n=h-2,r=Ir(Rr(Le(t),0),c-l)),c+n-r>Cr)throw TypeError(Sr);for(i=Rt(u,r),s=0;s<r;s++)(o=l+s)in u&&ut(i,s,u[o]);if(i.length=r,n<r){for(s=l;s<c-r;s++)a=s+n,(o=s+r)in u?u[a]=u[o]:delete u[a];for(s=c;s>c-r+n;s--)delete u[s-1]}else if(n>r)for(s=c-r;s>l;s--)a=s+n-1,(o=s+r-1)in u?u[a]=u[o]:delete u[a];for(s=0;s<n;s++)u[s+l]=arguments[s+2];return u.length=c-r+n,i}});var br={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},wr=kn.forEach,Or=Dn("forEach")?[].forEach:function(e){return wr(this,e,arguments.length>1?arguments[1]:void 0)};for(var Nr in br){var kr=k[Nr],Ar=kr&&kr.prototype;if(Ar&&Ar.forEach!==Or)try{ne(Ar,"forEach",Or)}catch(e){Ar.forEach=Or}}var Mr,xr,Ur=function(){function e(){o(this,e),this._map={}}return u(e,[{key:"on",value:function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n})}},{key:"once",value:function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n,once:!0})}},{key:"off",value:function(e,t,n){var r=this._map[e];r&&((r=r.filter((function(e){return e.listener!==t||e.target!==n}))).length?this._map[e]=r:delete this._map[e])}},{key:"emit",value:function(e){var t=this._map[e];if(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var s=t.length-1;s>=0;s-=1){var o=t[s],a=o.target,u=o.once,c=o.listener;u&&t.splice(s,1);try{c.call.apply(c,[a].concat(r))}catch(e){_r.error(e)}}}}},{key:"removeAll",value:function(e){delete this._map[e]}},{key:"clear",value:function(){Object.keys(this._map).forEach(this.removeAll,this)}}]),e}();e.AssertRules=void 0,(xr=e.AssertRules||(e.AssertRules={}))[xr.STRING=0]="STRING",xr[xr.ONLY_STRING=1]="ONLY_STRING",xr[xr.NUMBER=2]="NUMBER",xr[xr.BOOLEAN=3]="BOOLEAN",xr[xr.OBJECT=4]="OBJECT",xr[xr.ARRAY=5]="ARRAY",xr[xr.CALLBACK=6]="CALLBACK";var Lr=(c(Mr={},e.AssertRules.STRING,hr),c(Mr,e.AssertRules.ONLY_STRING,or),c(Mr,e.AssertRules.NUMBER,ur),c(Mr,e.AssertRules.BOOLEAN,(function(e){return"boolean"==typeof e})),c(Mr,e.AssertRules.OBJECT,fr),c(Mr,e.AssertRules.ARRAY,cr),c(Mr,e.AssertRules.CALLBACK,(function(e){var t=!0;return fr(e)||(t=!1),(e=e||{}).onSuccess&&!dr(e.onSuccess)&&(t=!1),e.onError&&!dr(e.onError)&&(t=!1),t})),Mr),Pr=function(e){f(n,e);var t=T(n);function n(e){var r;return o(this,n),(r=t.call(this,e)).name="RCAssertError",r}return n}(m(Error)),Dr=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n=Lr[n]||n;var i=r&&!n(t)||!r&&!(gr(t)||null===t||n(t));return i&&_r.error("'".concat(e,"' is invalid: ").concat(JSON.stringify(t))),!i},Vr=_t("match"),Br=function(e){var t;return q(e)&&(void 0!==(t=e[Vr])?!!t:"RegExp"==V(e))},Fr=_t("species"),Yr=function(e,t){var n,r=X(e).constructor;return void 0===r||null==(n=X(r)[Fr])?t:bn(n)},jr=[].push,qr=Math.min,Gr=4294967295,Hr=!A((function(){return!RegExp(Gr,"y")}));dn("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(Y(this)),i=void 0===n?Gr:n>>>0;if(0===i)return[];if(void 0===e)return[r];if(!Br(e))return t.call(r,e,i);for(var s,o,a,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,h=new RegExp(e.source,c+"g");(s=on.call(h,r))&&!((o=h.lastIndex)>l&&(u.push(r.slice(l,s.index)),s.length>1&&s.index<r.length&&jr.apply(u,s.slice(1)),a=s[0].length,l=o,u.length>=i));)h.lastIndex===s.index&&h.lastIndex++;return l===r.length?!a&&h.test("")||u.push(""):u.push(r.slice(l)),u.length>i?u.slice(0,i):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=Y(this),s=null==t?void 0:t[e];return void 0!==s?s.call(t,i,n):r.call(String(i),t,n)},function(e,i){var s=n(r,e,this,i,r!==t);if(s.done)return s.value;var o=X(e),a=String(this),u=Yr(o,RegExp),c=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(Hr?"y":"g"),h=new u(Hr?o:"^(?:"+o.source+")",l),f=void 0===i?Gr:i>>>0;if(0===f)return[];if(0===a.length)return null===In(h,a)?[a]:[];for(var d=0,g=0,p=[];g<a.length;){h.lastIndex=Hr?g:0;var v,y=In(h,Hr?a:a.slice(g));if(null===y||(v=qr(De(h.lastIndex+(Hr?0:g)),a.length))===d)g=yn(a,g,c);else{if(p.push(a.slice(d,g)),p.length===f)return p;for(var m=1;m<=y.length-1;m++)if(p.push(y[m]),p.length===f)return p;g=d=v}}return p.push(a.slice(d)),p}]}),!Hr);var Kr="toString",Wr=RegExp.prototype,Qr=Wr.toString,zr=A((function(){return"/a/b"!=Qr.call({source:"a",flags:"b"})})),Jr=Qr.name!=Kr;(zr||Jr)&&Ne(RegExp.prototype,Kr,(function(){var e=X(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in Wr)?Jt.call(e):n)}),{unsafe:!0});var Zr=function(e,t){return e+Math.floor(Math.random()*(t-e))},$r=k.Promise,Xr=function(e,t,n){for(var r in t)Ne(e,r,t[r],n);return e},ei=te.f,ti=_t("toStringTag"),ni=function(e,t,n){e&&!K(e=n?e:e.prototype,ti)&&ei(e,ti,{configurable:!0,value:t})},ri=_t("species"),ii=function(e){var t=Me(e),n=te.f;M&&t&&!t[ri]&&n(t,ri,{configurable:!0,get:function(){return this}})},si=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},oi={},ai=_t("iterator"),ui=Array.prototype,ci=function(e){return void 0!==e&&(oi.Array===e||ui[ai]===e)},li=_t("iterator"),hi=function(e){if(null!=e)return e[li]||e["@@iterator"]||oi[er(e)]},fi=function(e){var t=e.return;if(void 0!==t)return X(t.call(e)).value},di=function(e,t){this.stopped=e,this.result=t},gi=function(e,t,n){var r,i,s,o,a,u,c,l=n&&n.that,h=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),g=wn(t,l,1+h+d),p=function(e){return r&&fi(r),new di(!0,e)},v=function(e){return h?(X(e),d?g(e[0],e[1],p):g(e[0],e[1])):d?g(e,p):g(e)};if(f)r=e;else{if("function"!=typeof(i=hi(e)))throw TypeError("Target is not iterable");if(ci(i)){for(s=0,o=De(e.length);o>s;s++)if((a=v(e[s]))&&a instanceof di)return a;return new di(!1)}r=i.call(e)}for(u=r.next;!(c=u.call(r)).done;){try{a=v(c.value)}catch(e){throw fi(r),e}if("object"==typeof a&&a&&a instanceof di)return a}return new di(!1)},pi=_t("iterator"),vi=!1;try{var yi=0,mi={next:function(){return{done:!!yi++}},return:function(){vi=!0}};mi[pi]=function(){return this},Array.from(mi,(function(){throw 2}))}catch(e){}var Ei,_i,Ti,Ri=function(e,t){if(!t&&!vi)return!1;var n=!1;try{var r={};r[pi]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Ii=Me("document","documentElement"),Ci=/(iphone|ipod|ipad).*applewebkit/i.test(lt),Si=k.location,bi=k.setImmediate,wi=k.clearImmediate,Oi=k.process,Ni=k.MessageChannel,ki=k.Dispatch,Ai=0,Mi={},xi="onreadystatechange",Ui=function(e){if(Mi.hasOwnProperty(e)){var t=Mi[e];delete Mi[e],t()}},Li=function(e){return function(){Ui(e)}},Pi=function(e){Ui(e.data)},Di=function(e){k.postMessage(e+"",Si.protocol+"//"+Si.host)};bi&&wi||(bi=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Mi[++Ai]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Ei(Ai),Ai},wi=function(e){delete Mi[e]},ct?Ei=function(e){Oi.nextTick(Li(e))}:ki&&ki.now?Ei=function(e){ki.now(Li(e))}:Ni&&!Ci?(Ti=(_i=new Ni).port2,_i.port1.onmessage=Pi,Ei=wn(Ti.postMessage,Ti,1)):k.addEventListener&&"function"==typeof postMessage&&!k.importScripts&&Si&&"file:"!==Si.protocol&&!A(Di)?(Ei=Di,k.addEventListener("message",Pi,!1)):Ei=xi in z("script")?function(e){Ii.appendChild(z("script")).onreadystatechange=function(){Ii.removeChild(this),Ui(e)}}:function(e){setTimeout(Li(e),0)});var Vi,Bi,Fi,Yi,ji,qi,Gi,Hi,Ki={set:bi,clear:wi},Wi=/web0s(?!.*chrome)/i.test(lt),Qi=$.f,zi=Ki.set,Ji=k.MutationObserver||k.WebKitMutationObserver,Zi=k.document,$i=k.process,Xi=k.Promise,es=Qi(k,"queueMicrotask"),ts=es&&es.value;ts||(Vi=function(){var e,t;for(ct&&(e=$i.domain)&&e.exit();Bi;){t=Bi.fn,Bi=Bi.next;try{t()}catch(e){throw Bi?Yi():Fi=void 0,e}}Fi=void 0,e&&e.enter()},Ci||ct||Wi||!Ji||!Zi?Xi&&Xi.resolve?(Gi=Xi.resolve(void 0),Hi=Gi.then,Yi=function(){Hi.call(Gi,Vi)}):Yi=ct?function(){$i.nextTick(Vi)}:function(){zi.call(k,Vi)}:(ji=!0,qi=Zi.createTextNode(""),new Ji(Vi).observe(qi,{characterData:!0}),Yi=function(){qi.data=ji=!ji}));var ns,rs,is,ss,os=ts||function(e){var t={fn:e,next:void 0};Fi&&(Fi.next=t),Bi||(Bi=t,Yi()),Fi=t},as=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=bn(t),this.reject=bn(n)},us={f:function(e){return new as(e)}},cs=function(e,t){if(X(e),q(t)&&t.constructor===e)return t;var n=us.f(e);return(0,n.resolve)(t),n.promise},ls=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},hs=Ki.set,fs=_t("species"),ds="Promise",gs=Oe.get,ps=Oe.set,vs=Oe.getterFor(ds),ys=$r,ms=k.TypeError,Es=k.document,_s=k.process,Ts=Me("fetch"),Rs=us.f,Is=Rs,Cs=!!(Es&&Es.createEvent&&k.dispatchEvent),Ss="function"==typeof PromiseRejectionEvent,bs="unhandledrejection",ws=rt(ds,(function(){if(!(le(ys)!==String(ys))){if(66===gt)return!0;if(!ct&&!Ss)return!0}if(gt>=51&&/native code/.test(ys))return!1;var e=ys.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[fs]=t,!(e.then((function(){}))instanceof t)})),Os=ws||!Ri((function(e){ys.all(e).catch((function(){}))})),Ns=function(e){var t;return!(!q(e)||"function"!=typeof(t=e.then))&&t},ks=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;os((function(){for(var r=e.value,i=1==e.state,s=0;n.length>s;){var o,a,u,c=n[s++],l=i?c.ok:c.fail,h=c.resolve,f=c.reject,d=c.domain;try{l?(i||(2===e.rejection&&Us(e),e.rejection=1),!0===l?o=r:(d&&d.enter(),o=l(r),d&&(d.exit(),u=!0)),o===c.promise?f(ms("Promise-chain cycle")):(a=Ns(o))?a.call(o,h,f):h(o)):f(r)}catch(e){d&&!u&&d.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Ms(e)}))}},As=function(e,t,n){var r,i;Cs?((r=Es.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),k.dispatchEvent(r)):r={promise:t,reason:n},!Ss&&(i=k["on"+e])?i(r):e===bs&&function(e,t){var n=k.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Ms=function(e){hs.call(k,(function(){var t,n=e.facade,r=e.value;if(xs(e)&&(t=ls((function(){ct?_s.emit("unhandledRejection",r,n):As(bs,n,r)})),e.rejection=ct||xs(e)?2:1,t.error))throw t.value}))},xs=function(e){return 1!==e.rejection&&!e.parent},Us=function(e){hs.call(k,(function(){var t=e.facade;ct?_s.emit("rejectionHandled",t):As("rejectionhandled",t,e.value)}))},Ls=function(e,t,n){return function(r){e(t,r,n)}},Ps=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ks(e,!0))},Ds=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw ms("Promise can't be resolved itself");var r=Ns(t);r?os((function(){var n={done:!1};try{r.call(t,Ls(Ds,n,e),Ls(Ps,n,e))}catch(t){Ps(n,t,e)}})):(e.value=t,e.state=1,ks(e,!1))}catch(t){Ps({done:!1},t,e)}}};ws&&(ys=function(e){si(this,ys,ds),bn(e),ns.call(this);var t=gs(this);try{e(Ls(Ds,t),Ls(Ps,t))}catch(e){Ps(t,e)}},(ns=function(e){ps(this,{type:ds,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Xr(ys.prototype,{then:function(e,t){var n=vs(this),r=Rs(Yr(this,ys));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=ct?_s.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&ks(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),rs=function(){var e=new ns,t=gs(e);this.promise=e,this.resolve=Ls(Ds,t),this.reject=Ls(Ps,t)},us.f=Rs=function(e){return e===ys||e===is?new rs(e):Is(e)},"function"==typeof $r&&(ss=$r.prototype.then,Ne($r.prototype,"then",(function(e,t){var n=this;return new ys((function(e,t){ss.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof Ts&&st({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return cs(ys,Ts.apply(k,arguments))}}))),st({global:!0,wrap:!0,forced:ws},{Promise:ys}),ni(ys,ds,!1),ii(ds),is=Me(ds),st({target:ds,stat:!0,forced:ws},{reject:function(e){var t=Rs(this);return t.reject.call(void 0,e),t.promise}}),st({target:ds,stat:!0,forced:ws},{resolve:function(e){return cs(this,e)}}),st({target:ds,stat:!0,forced:Os},{all:function(e){var t=this,n=Rs(t),r=n.resolve,i=n.reject,s=ls((function(){var n=bn(t.resolve),s=[],o=0,a=1;gi(e,(function(e){var u=o++,c=!1;s.push(void 0),a++,n.call(t,e).then((function(e){c||(c=!0,s[u]=e,--a||r(s))}),i)})),--a||r(s)}));return s.error&&i(s.value),n.promise},race:function(e){var t=this,n=Rs(t),r=n.reject,i=ls((function(){var i=bn(t.resolve);gi(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var Vs=[].slice,Bs=/MSIE .\./.test(lt),Fs=function(e){return function(t,n){var r=arguments.length>2,i=r?Vs.call(arguments,2):void 0;return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};st({global:!0,bind:!0,forced:Bs},{setTimeout:Fs(k.setTimeout),setInterval:Fs(k.setInterval)});var Ys,js=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return X(n),function(e){if(!q(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),qs=function(e,t,n){var r,i;return js&&"function"==typeof(r=t.constructor)&&r!==n&&q(i=r.prototype)&&i!==n.prototype&&js(e,i),e},Gs=te.f,Hs=We.f,Ks=Oe.set,Ws=_t("match"),Qs=k.RegExp,zs=Qs.prototype,Js=/a/g,Zs=/a/g,$s=new Qs(Js)!==Js,Xs=$t.UNSUPPORTED_Y;if(M&&rt("RegExp",!$s||Xs||A((function(){return Zs[Ws]=!1,Qs(Js)!=Js||Qs(Zs)==Zs||"/a/i"!=Qs(Js,"i")})))){for(var eo=function(e,t){var n,r=this instanceof eo,i=Br(e),s=void 0===t;if(!r&&i&&e.constructor===eo&&s)return e;$s?i&&!s&&(e=e.source):e instanceof eo&&(s&&(t=Jt.call(e)),e=e.source),Xs&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var o=qs($s?new Qs(e,t):Qs(e,t),r?this:zs,eo);return Xs&&n&&Ks(o,{sticky:n}),o},to=function(e){e in eo||Gs(eo,e,{configurable:!0,get:function(){return Qs[e]},set:function(t){Qs[e]=t}})},no=Hs(Qs),ro=0;no.length>ro;)to(no[ro++]);zs.constructor=eo,eo.prototype=zs,Ne(k,"RegExp",eo)}ii("RegExp"),function(e){e[e.TIMEOUT=-1]="TIMEOUT",e[e.UNKNOWN=-2]="UNKNOWN",e[e.PARAMETER_ERROR=-3]="PARAMETER_ERROR",e[e.EXTRA_METHOD_UNDEFINED=-4]="EXTRA_METHOD_UNDEFINED",e[e.MAIN_PROCESS_ERROR=-5]="MAIN_PROCESS_ERROR",e[e.SUCCESS=0]="SUCCESS",e[e.RC_MSG_UNAUTHORIZED=20406]="RC_MSG_UNAUTHORIZED",e[e.RC_DISCUSSION_GROUP_ID_INVALID=20407]="RC_DISCUSSION_GROUP_ID_INVALID",e[e.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",e[e.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",e[e.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",e[e.RECALL_MESSAGE=25101]="RECALL_MESSAGE",e[e.NOT_IN_GROUP=22406]="NOT_IN_GROUP",e[e.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",e[e.FORBIDDEN_IN_CHATROOM=23408]="FORBIDDEN_IN_CHATROOM",e[e.RC_CHATROOM_USER_KICKED=23409]="RC_CHATROOM_USER_KICKED",e[e.RC_CHATROOM_NOT_EXIST=23410]="RC_CHATROOM_NOT_EXIST",e[e.RC_CHATROOM_IS_FULL=23411]="RC_CHATROOM_IS_FULL",e[e.RC_CHATROOM_PATAMETER_INVALID=23412]="RC_CHATROOM_PATAMETER_INVALID",e[e.CHATROOM_GET_HISTORYMSG_ERROR=23413]="CHATROOM_GET_HISTORYMSG_ERROR",e[e.CHATROOM_NOT_OPEN_HISTORYMSG_STORE=23414]="CHATROOM_NOT_OPEN_HISTORYMSG_STORE",e[e.CHATROOM_KV_EXCEED=23423]="CHATROOM_KV_EXCEED",e[e.CHATROOM_KV_OVERWRITE_INVALID=23424]="CHATROOM_KV_OVERWRITE_INVALID",e[e.CHATROOM_KV_STORE_NOT_OPEN=23426]="CHATROOM_KV_STORE_NOT_OPEN",e[e.CHATROOM_KEY_NOT_EXIST=23427]="CHATROOM_KEY_NOT_EXIST",e[e.SENSITIVE_SHIELD=21501]="SENSITIVE_SHIELD",e[e.SENSITIVE_REPLACE=21502]="SENSITIVE_REPLACE",e[e.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",e[e.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",e[e.INVITE_DICUSSION=21409]="INVITE_DICUSSION",e[e.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",e[e.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",e[e.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",e[e.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",e[e.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",e[e.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",e[e.RC_HTTP_REQ_TIMEOUT=30005]="RC_HTTP_REQ_TIMEOUT",e[e.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",e[e.RC_NAVI_RESOURCE_ERROR=30007]="RC_NAVI_RESOURCE_ERROR",e[e.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",e[e.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",e[e.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",e[e.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",e[e.RC_PING_SEND_FAIL=30012]="RC_PING_SEND_FAIL",e[e.RC_PONG_RECV_FAIL=30013]="RC_PONG_RECV_FAIL",e[e.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",e[e.RC_MSG_CONTENT_EXCEED_LIMIT=30016]="RC_MSG_CONTENT_EXCEED_LIMIT",e[e.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",e[e.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",e[e.RC_CONN_ID_REJECT=31002]="RC_CONN_ID_REJECT",e[e.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",e[e.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR",e[e.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",e[e.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",e[e.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",e[e.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",e[e.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",e[e.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",e[e.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",e[e.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",e[e.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",e[e.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",e[e.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",e[e.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",e[e.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",e[e.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",e[e.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",e[e.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",e[e.MSG_INSERT_ERROR=33008]="MSG_INSERT_ERROR",e[e.MSG_DEL_ERROR=33009]="MSG_DEL_ERROR",e[e.TAG_NOT_EXIST=33101]="TAG_NOT_EXIST",e[e.NO_TAG_IN_CONVER=33102]="NO_TAG_IN_CONVER",e[e.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",e[e.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",e[e.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",e[e.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",e[e.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",e[e.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",e[e.CONVER_CLEAR_ERROR=34007]="CONVER_CLEAR_ERROR",e[e.EXPANSION_LIMIT_EXCEET=34010]="EXPANSION_LIMIT_EXCEET",e[e.MESSAGE_KV_NOT_SUPPORT=34008]="MESSAGE_KV_NOT_SUPPORT",e[e.CLEAR_HIS_TIME_ERROR=34011]="CLEAR_HIS_TIME_ERROR",e[e.CONVER_OUT_LIMIT_ERROR=34013]="CONVER_OUT_LIMIT_ERROR",e[e.CONVER_GET_ERROR=34009]="CONVER_GET_ERROR",e[e.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",e[e.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",e[e.READ_RECEIPT_ERROR=35003]="READ_RECEIPT_ERROR",e[e.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",e[e.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",e[e.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",e[e.CHATROOM_KV_NOT_FOUND=36004]="CHATROOM_KV_NOT_FOUND",e[e.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",e[e.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",e[e.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",e[e.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",e[e.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",e[e.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",e[e.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",e[e.NOT_SUPPORT=39002]="NOT_SUPPORT",e[e.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",e[e.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",e[e.COOKIE_ENABLE=51001]="COOKIE_ENABLE",e[e.GET_MESSAGE_BY_ID_ERROR=61001]="GET_MESSAGE_BY_ID_ERROR",e[e.HAVNODEVICEID=24001]="HAVNODEVICEID",e[e.DEVICEIDISHAVE=24002]="DEVICEIDISHAVE",e[e.FEILD=24009]="FEILD",e[e.VOIPISNULL=24013]="VOIPISNULL",e[e.NOENGINETYPE=24010]="NOENGINETYPE",e[e.NULLCHANNELNAME=24011]="NULLCHANNELNAME",e[e.VOIPDYANMICERROR=24012]="VOIPDYANMICERROR",e[e.NOVOIP=24014]="NOVOIP",e[e.INTERNALERRROR=24015]="INTERNALERRROR",e[e.VOIPCLOSE=24016]="VOIPCLOSE",e[e.CLOSE_BEFORE_OPEN=51001]="CLOSE_BEFORE_OPEN",e[e.ALREADY_IN_USE=51002]="ALREADY_IN_USE",e[e.INVALID_CHANNEL_NAME=51003]="INVALID_CHANNEL_NAME",e[e.VIDEO_CONTAINER_IS_NULL=51004]="VIDEO_CONTAINER_IS_NULL",e[e.DELETE_MESSAGE_ID_IS_NULL=61001]="DELETE_MESSAGE_ID_IS_NULL",e[e.CANCEL=1]="CANCEL",e[e.REJECT=2]="REJECT",e[e.HANGUP=3]="HANGUP",e[e.BUSYLINE=4]="BUSYLINE",e[e.NO_RESPONSE=5]="NO_RESPONSE",e[e.ENGINE_UN_SUPPORTED=6]="ENGINE_UN_SUPPORTED",e[e.NETWORK_ERROR=7]="NETWORK_ERROR",e[e.REMOTE_CANCEL=11]="REMOTE_CANCEL",e[e.REMOTE_REJECT=12]="REMOTE_REJECT",e[e.REMOTE_HANGUP=13]="REMOTE_HANGUP",e[e.REMOTE_BUSYLINE=14]="REMOTE_BUSYLINE",e[e.REMOTE_NO_RESPONSE=15]="REMOTE_NO_RESPONSE",e[e.REMOTE_ENGINE_UN_SUPPORTED=16]="REMOTE_ENGINE_UN_SUPPORTED",e[e.REMOTE_NETWORK_ERROR=17]="REMOTE_NETWORK_ERROR",e[e.VOIP_NOT_AVALIABLE=18]="VOIP_NOT_AVALIABLE"}(Ys||(Ys={}));var io,so=Ys,oo=function(e){if(!fr(e)||void 0===e.low||void 0===e.high)return e;var t=e.low;return t<0&&(t+=4294967296),t=t.toString(16),parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{"+t.length+"}$"),t),16)},ao=function(e,t){var n=Math.floor(1e3*Math.random()%1e4),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),i=function(e){e=e||"-";var t=new Date,n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate();return"".concat(n).concat(e).concat(r).concat(e).concat(i)}(),s=(new Date).getTime(),o="";if(t){var a=t.split(".");o="."+a[a.length-1]}return"".concat(e,"__RC-").concat(i,"_").concat(n,"_").concat(s).concat(r).concat(o)},uo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.threadId,r=e.apnsCollapseId,i=t.channelIdMi,s=t.channelIdHW,o=t.channelIdOPPO,a=t.typeVivo,u={};u["thread-id"]=n||"",u["apns-collapse-id"]=r||"";var c=[{HW:{channelId:s||""}},{MI:{channelId:i||""}},{OPPO:{channelId:o||""}},{VIVO:{classification:a||""}},{APNS:u}];return JSON.stringify(c)},co=function(e){var t=/^[A-Za-z0-9_=+-]+$/.test(e),n=e.length;return t&&(n<=128&&n>=1)},lo=function(e){var t=e.length;return t<=4096&&t>=1},ho=function(e,t,n){t=t||function(){};var r=(n=n||{}).isReverse;fr(e)&&function(){for(var n in e)t(e[n],n,e)}(),(cr(e)||or(e))&&function(){if(r)for(var n=e.length-1;n>=0;n--)t(e[n],n);else for(var i=0,s=e.length;i<s;i++)t(e[i],i)}()},fo=function(e,t){return ho(e,(function(n,r){e[r]=t(n,r)})),e},go=function(e,t){if(e.indexOf)return e.indexOf(t);var n=-1;return ho(e,(function(e,r){t===e&&(n=r)})),n},po=function(e,t){var n=[];return ho(e,(function(e){n.push(e)})),-1!==go(n,t)},vo=function(e){return JSON.parse(JSON.stringify(e))},yo=function(){return"undefined"!=typeof RCCppEngine};!function(e){e[e.UPDATE=1]="UPDATE",e[e.DELETE=2]="DELETE"}(io||(io={}));var mo=io,Eo=function(e){var t={},n=JSON.parse(e);return ho(n,(function(e,n){t[n]=e.v})),t},_o={_delayTime:0,setTime:function(e){var t=(new Date).getTime();_o._delayTime=t-e},getTime:function(){var e=_o._delayTime;return(new Date).getTime()-e}};O((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,s=Object.create(i.prototype),o=new O(r||[]);return s._invoke=function(e,t,n){var r=h;return function(i,s){if(r===d)throw new Error("Generator is already running");if(r===g){if("throw"===i)throw s;return k()}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?g:f,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=g,n.method="throw",n.arg=u.arg)}}}(e,n,o),s}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",d="executing",g="completed",p={};function v(){}function y(){}function m(){}var E={};E[s]=function(){return this};var _=Object.getPrototypeOf,T=_&&_(_(N([])));T&&T!==n&&r.call(T,s)&&(E=T);var R=m.prototype=v.prototype=Object.create(E);function I(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,s,o,a){var u=l(e[i],e,s);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,a)}),(function(e){n("throw",e,o,a)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,a)}))}a(u.arg)}var i;this._invoke=function(e,r){function s(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(s,s):s()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var s=i.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function N(e){if(e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:k}}function k(){return{value:t,done:!0}}return y.prototype=R.constructor=m,m.constructor=y,y.displayName=u(m,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,a,"GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},I(C.prototype),C.prototype[o]=function(){return this},e.AsyncIterator=C,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new C(c(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},I(R),u(R,a,"Generator"),R[s]=function(){return this},R.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=N,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(w),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var To,Ro,Io,Co=!A((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),So=me("IE_PROTO"),bo=Object.prototype,wo=Co?Object.getPrototypeOf:function(e){return e=at(e),K(e,So)?e[So]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?bo:null},Oo=_t("iterator"),No=!1;[].keys&&("next"in(Io=[].keys())?(Ro=wo(wo(Io)))!==Object.prototype&&(To=Ro):No=!0),(null==To||A((function(){var e={};return To[Oo].call(e)!==e})))&&(To={}),K(To,Oo)||ne(To,Oo,(function(){return this}));var ko,Ao={IteratorPrototype:To,BUGGY_SAFARI_ITERATORS:No},Mo=M?Object.defineProperties:function(e,t){X(e);for(var n,r=Ln(t),i=r.length,s=0;i>s;)te.f(e,n=r[s++],t[n]);return e},xo=me("IE_PROTO"),Uo=function(){},Lo=function(e){return"<script>"+e+"</"+"script>"},Po=function(){try{ko=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;Po=ko?function(e){e.write(Lo("")),e.close();var t=e.parentWindow.Object;return e=null,t}(ko):((t=z("iframe")).style.display="none",Ii.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Lo("document.F=Object")),e.close(),e.F);for(var n=He.length;n--;)delete Po.prototype[He[n]];return Po()};Ee[xo]=!0;var Do=Object.create||function(e,t){var n;return null!==e?(Uo.prototype=X(e),n=new Uo,Uo.prototype=null,n[xo]=e):n=Po(),void 0===t?n:Mo(n,t)},Vo=Ao.IteratorPrototype,Bo=function(){return this},Fo=Ao.IteratorPrototype,Yo=Ao.BUGGY_SAFARI_ITERATORS,jo=_t("iterator"),qo="keys",Go="values",Ho="entries",Ko=function(){return this},Wo=function(e,t,n,r,i,s,o){!function(e,t,n){var r=t+" Iterator";e.prototype=Do(Vo,{next:P(1,n)}),ni(e,r,!1),oi[r]=Bo}(n,t,r);var a,u,c,l=function(e){if(e===i&&p)return p;if(!Yo&&e in d)return d[e];switch(e){case qo:case Go:case Ho:return function(){return new n(this,e)}}return function(){return new n(this)}},h=t+" Iterator",f=!1,d=e.prototype,g=d[jo]||d["@@iterator"]||i&&d[i],p=!Yo&&g||l(i),v="Array"==t&&d.entries||g;if(v&&(a=wo(v.call(new e)),Fo!==Object.prototype&&a.next&&(wo(a)!==Fo&&(js?js(a,Fo):"function"!=typeof a[jo]&&ne(a,jo,Ko)),ni(a,h,!0))),i==Go&&g&&g.name!==Go&&(f=!0,p=function(){return g.call(this)}),d[jo]!==p&&ne(d,jo,p),oi[t]=p,i)if(u={values:l(Go),keys:s?p:l(qo),entries:l(Ho)},o)for(c in u)(Yo||f||!(c in d))&&Ne(d,c,u[c]);else st({target:t,proto:!0,forced:Yo||f},u);return u},Qo=pn.charAt,zo="String Iterator",Jo=Oe.set,Zo=Oe.getterFor(zo);Wo(String,"String",(function(e){Jo(this,{type:zo,string:String(e),index:0})}),(function(){var e,t=Zo(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=Qo(n,r),t.index+=e.length,{value:e,done:!1})}));var $o=_t("unscopables"),Xo=Array.prototype;null==Xo[$o]&&te.f(Xo,$o,{configurable:!0,value:Do(null)});var ea=function(e){Xo[$o][e]=!0},ta="Array Iterator",na=Oe.set,ra=Oe.getterFor(ta),ia=Wo(Array,"Array",(function(e,t){na(this,{type:ta,target:j(e),index:0,kind:t})}),(function(){var e=ra(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");oi.Arguments=oi.Array,ea("keys"),ea("values"),ea("entries");var sa=_t("iterator"),oa=_t("toStringTag"),aa=ia.values;for(var ua in br){var ca=k[ua],la=ca&&ca.prototype;if(la){if(la[sa]!==aa)try{ne(la,sa,aa)}catch(e){la[sa]=aa}if(la[oa]||ne(la,oa,ua),br[ua])for(var ha in ia)if(la[ha]!==ia[ha])try{ne(la,ha,ia[ha])}catch(e){la[ha]=ia[ha]}}}var fa,da="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,ga=te.f,pa=k.Int8Array,va=pa&&pa.prototype,ya=k.Uint8ClampedArray,ma=ya&&ya.prototype,Ea=pa&&wo(pa),_a=va&&wo(va),Ta=Object.prototype,Ra=Ta.isPrototypeOf,Ia=_t("toStringTag"),Ca=ve("TYPED_ARRAY_TAG"),Sa=da&&!!js&&"Opera"!==er(k.opera),ba=!1,wa={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Oa={BigInt64Array:8,BigUint64Array:8},Na=function(e){if(!q(e))return!1;var t=er(e);return K(wa,t)||K(Oa,t)};for(fa in wa)k[fa]||(Sa=!1);if((!Sa||"function"!=typeof Ea||Ea===Function.prototype)&&(Ea=function(){throw TypeError("Incorrect invocation")},Sa))for(fa in wa)k[fa]&&js(k[fa],Ea);if((!Sa||!_a||_a===Ta)&&(_a=Ea.prototype,Sa))for(fa in wa)k[fa]&&js(k[fa].prototype,_a);if(Sa&&wo(ma)!==_a&&js(ma,_a),M&&!K(_a,Ia))for(fa in ba=!0,ga(_a,Ia,{get:function(){return q(this)?this[Ca]:void 0}}),wa)k[fa]&&ne(k[fa],Ca,fa);var ka={NATIVE_ARRAY_BUFFER_VIEWS:Sa,TYPED_ARRAY_TAG:ba&&Ca,aTypedArray:function(e){if(Na(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(js){if(Ra.call(Ea,e))return e}else for(var t in wa)if(K(wa,fa)){var n=k[t];if(n&&(e===n||Ra.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(M){if(n)for(var r in wa){var i=k[r];i&&K(i.prototype,e)&&delete i.prototype[e]}_a[e]&&!n||Ne(_a,e,n?t:Sa&&va[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(M){if(js){if(n)for(r in wa)(i=k[r])&&K(i,e)&&delete i[e];if(Ea[e]&&!n)return;try{return Ne(Ea,e,n?t:Sa&&pa[e]||t)}catch(e){}}for(r in wa)!(i=k[r])||i[e]&&!n||Ne(i,e,t)}},isView:function(e){if(!q(e))return!1;var t=er(e);return"DataView"===t||K(wa,t)||K(Oa,t)},isTypedArray:Na,TypedArray:Ea,TypedArrayPrototype:_a},Aa=ka.NATIVE_ARRAY_BUFFER_VIEWS,Ma=k.ArrayBuffer,xa=k.Int8Array,Ua=!Aa||!A((function(){xa(1)}))||!A((function(){new xa(-1)}))||!Ri((function(e){new xa,new xa(null),new xa(1.5),new xa(e)}),!0)||A((function(){return 1!==new xa(new Ma(2),1,void 0).length})),La=function(e){if(void 0===e)return 0;var t=Le(e),n=De(t);if(t!==n)throw RangeError("Wrong length or index");return n},Pa=Math.abs,Da=Math.pow,Va=Math.floor,Ba=Math.log,Fa=Math.LN2,Ya=function(e,t,n){var r,i,s,o=new Array(n),a=8*n-t-1,u=(1<<a)-1,c=u>>1,l=23===t?Da(2,-24)-Da(2,-77):0,h=e<0||0===e&&1/e<0?1:0,f=0;for((e=Pa(e))!=e||e===1/0?(i=e!=e?1:0,r=u):(r=Va(Ba(e)/Fa),e*(s=Da(2,-r))<1&&(r--,s*=2),(e+=r+c>=1?l/s:l*Da(2,1-c))*s>=2&&(r++,s/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(e*s-1)*Da(2,t),r+=c):(i=e*Da(2,c-1)*Da(2,t),r=0));t>=8;o[f++]=255&i,i/=256,t-=8);for(r=r<<t|i,a+=t;a>0;o[f++]=255&r,r/=256,a-=8);return o[--f]|=128*h,o},ja=function(e,t){var n,r=e.length,i=8*r-t-1,s=(1<<i)-1,o=s>>1,a=i-7,u=r-1,c=e[u--],l=127&c;for(c>>=7;a>0;l=256*l+e[u],u--,a-=8);for(n=l&(1<<-a)-1,l>>=-a,a+=t;a>0;n=256*n+e[u],u--,a-=8);if(0===l)l=1-o;else{if(l===s)return n?NaN:c?-1/0:1/0;n+=Da(2,t),l-=o}return(c?-1:1)*n*Da(2,l-t)},qa=function(e){for(var t=at(this),n=De(t.length),r=arguments.length,i=Fe(r>1?arguments[1]:void 0,n),s=r>2?arguments[2]:void 0,o=void 0===s?n:Fe(s,n);o>i;)t[i++]=e;return t},Ga=We.f,Ha=te.f,Ka=Oe.get,Wa=Oe.set,Qa="ArrayBuffer",za="DataView",Ja="Wrong index",Za=k.ArrayBuffer,$a=Za,Xa=k.DataView,eu=Xa&&Xa.prototype,tu=Object.prototype,nu=k.RangeError,ru=Ya,iu=ja,su=function(e){return[255&e]},ou=function(e){return[255&e,e>>8&255]},au=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},uu=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},cu=function(e){return ru(e,23,4)},lu=function(e){return ru(e,52,8)},hu=function(e,t){Ha(e.prototype,t,{get:function(){return Ka(this)[t]}})},fu=function(e,t,n,r){var i=La(n),s=Ka(e);if(i+t>s.byteLength)throw nu(Ja);var o=Ka(s.buffer).bytes,a=i+s.byteOffset,u=o.slice(a,a+t);return r?u:u.reverse()},du=function(e,t,n,r,i,s){var o=La(n),a=Ka(e);if(o+t>a.byteLength)throw nu(Ja);for(var u=Ka(a.buffer).bytes,c=o+a.byteOffset,l=r(+i),h=0;h<t;h++)u[c+h]=l[s?h:t-h-1]};if(da){if(!A((function(){Za(1)}))||!A((function(){new Za(-1)}))||A((function(){return new Za,new Za(1.5),new Za(NaN),Za.name!=Qa}))){for(var gu,pu=($a=function(e){return si(this,$a),new Za(La(e))}).prototype=Za.prototype,vu=Ga(Za),yu=0;vu.length>yu;)(gu=vu[yu++])in $a||ne($a,gu,Za[gu]);pu.constructor=$a}js&&wo(eu)!==tu&&js(eu,tu);var mu=new Xa(new $a(2)),Eu=eu.setInt8;mu.setInt8(0,2147483648),mu.setInt8(1,2147483649),!mu.getInt8(0)&&mu.getInt8(1)||Xr(eu,{setInt8:function(e,t){Eu.call(this,e,t<<24>>24)},setUint8:function(e,t){Eu.call(this,e,t<<24>>24)}},{unsafe:!0})}else $a=function(e){si(this,$a,Qa);var t=La(e);Wa(this,{bytes:qa.call(new Array(t),0),byteLength:t}),M||(this.byteLength=t)},Xa=function(e,t,n){si(this,Xa,za),si(e,$a,za);var r=Ka(e).byteLength,i=Le(t);if(i<0||i>r)throw nu("Wrong offset");if(i+(n=void 0===n?r-i:De(n))>r)throw nu("Wrong length");Wa(this,{buffer:e,byteLength:n,byteOffset:i}),M||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},M&&(hu($a,"byteLength"),hu(Xa,"buffer"),hu(Xa,"byteLength"),hu(Xa,"byteOffset")),Xr(Xa.prototype,{getInt8:function(e){return fu(this,1,e)[0]<<24>>24},getUint8:function(e){return fu(this,1,e)[0]},getInt16:function(e){var t=fu(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=fu(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return uu(fu(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return uu(fu(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return iu(fu(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return iu(fu(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){du(this,1,e,su,t)},setUint8:function(e,t){du(this,1,e,su,t)},setInt16:function(e,t){du(this,2,e,ou,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){du(this,2,e,ou,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){du(this,4,e,au,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){du(this,4,e,au,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){du(this,4,e,cu,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){du(this,8,e,lu,t,arguments.length>2?arguments[2]:void 0)}});ni($a,Qa),ni(Xa,za);var _u={ArrayBuffer:$a,DataView:Xa},Tu=function(e,t){var n=function(e){var t=Le(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}(e);if(n%t)throw RangeError("Wrong offset");return n},Ru=ka.aTypedArrayConstructor,Iu=function(e){var t,n,r,i,s,o,a=at(e),u=arguments.length,c=u>1?arguments[1]:void 0,l=void 0!==c,h=hi(a);if(null!=h&&!ci(h))for(o=(s=h.call(a)).next,a=[];!(i=o.call(s)).done;)a.push(i.value);for(l&&u>2&&(c=wn(c,arguments[2],2)),n=De(a.length),r=new(Ru(this))(n),t=0;n>t;t++)r[t]=l?c(a[t],t):a[t];return r},Cu=O((function(e){var t=We.f,n=kn.forEach,r=Oe.get,i=Oe.set,s=te.f,o=$.f,a=Math.round,u=k.RangeError,c=_u.ArrayBuffer,l=_u.DataView,h=ka.NATIVE_ARRAY_BUFFER_VIEWS,f=ka.TYPED_ARRAY_TAG,d=ka.TypedArray,g=ka.TypedArrayPrototype,p=ka.aTypedArrayConstructor,v=ka.isTypedArray,y="BYTES_PER_ELEMENT",m="Wrong length",E=function(e,t){for(var n=0,r=t.length,i=new(p(e))(r);r>n;)i[n]=t[n++];return i},_=function(e,t){s(e,t,{get:function(){return r(this)[t]}})},T=function(e){var t;return e instanceof c||"ArrayBuffer"==(t=er(e))||"SharedArrayBuffer"==t},R=function(e,t){return v(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},I=function(e,t){return R(e,t=G(t,!0))?P(2,e[t]):o(e,t)},C=function(e,t,n){return!(R(e,t=G(t,!0))&&q(n)&&K(n,"value"))||K(n,"get")||K(n,"set")||n.configurable||K(n,"writable")&&!n.writable||K(n,"enumerable")&&!n.enumerable?s(e,t,n):(e[t]=n.value,e)};M?(h||($.f=I,te.f=C,_(g,"buffer"),_(g,"byteOffset"),_(g,"byteLength"),_(g,"length")),st({target:"Object",stat:!0,forced:!h},{getOwnPropertyDescriptor:I,defineProperty:C}),e.exports=function(e,o,p){var _=e.match(/\d+$/)[0]/8,R=e+(p?"Clamped":"")+"Array",I="get"+e,C="set"+e,S=k[R],b=S,w=b&&b.prototype,O={},N=function(e,t){s(e,t,{get:function(){return function(e,t){var n=r(e);return n.view[I](t*_+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var i=r(e);p&&(n=(n=a(n))<0?0:n>255?255:255&n),i.view[C](t*_+i.byteOffset,n,!0)}(this,t,e)},enumerable:!0})};h?Ua&&(b=o((function(e,t,n,r){return si(e,b,R),qs(q(t)?T(t)?void 0!==r?new S(t,Tu(n,_),r):void 0!==n?new S(t,Tu(n,_)):new S(t):v(t)?E(b,t):Iu.call(b,t):new S(La(t)),e,b)})),js&&js(b,d),n(t(S),(function(e){e in b||ne(b,e,S[e])})),b.prototype=w):(b=o((function(e,t,n,r){si(e,b,R);var s,o,a,h=0,f=0;if(q(t)){if(!T(t))return v(t)?E(b,t):Iu.call(b,t);s=t,f=Tu(n,_);var d=t.byteLength;if(void 0===r){if(d%_)throw u(m);if((o=d-f)<0)throw u(m)}else if((o=De(r)*_)+f>d)throw u(m);a=o/_}else a=La(t),s=new c(o=a*_);for(i(e,{buffer:s,byteOffset:f,byteLength:o,length:a,view:new l(s)});h<a;)N(e,h++)})),js&&js(b,d),w=b.prototype=Do(g)),w.constructor!==b&&ne(w,"constructor",b),f&&ne(w,f,R),O[R]=b,st({global:!0,forced:b!=S,sham:!h},O),y in b||ne(b,y,_),y in w||ne(w,y,_),ii(R)}):e.exports=function(){}}));Cu("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var Su=Math.min,bu=[].copyWithin||function(e,t){var n=at(this),r=De(n.length),i=Fe(e,r),s=Fe(t,r),o=arguments.length>2?arguments[2]:void 0,a=Su((void 0===o?r:Fe(o,r))-s,r-i),u=1;for(s<i&&i<s+a&&(u=-1,s+=a-1,i+=a-1);a-- >0;)s in n?n[i]=n[s]:delete n[i],i+=u,s+=u;return n},wu=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("copyWithin",(function(e,t){return bu.call(wu(this),e,t,arguments.length>2?arguments[2]:void 0)}));var Ou=kn.every,Nu=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("every",(function(e){return Ou(Nu(this),e,arguments.length>1?arguments[1]:void 0)}));var ku=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("fill",(function(e){return qa.apply(ku(this),arguments)}));var Au=ka.aTypedArrayConstructor,Mu=function(e,t){for(var n=Yr(e,e.constructor),r=0,i=t.length,s=new(Au(n))(i);i>r;)s[r]=t[r++];return s},xu=kn.filter,Uu=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("filter",(function(e){var t=xu(Uu(this),e,arguments.length>1?arguments[1]:void 0);return Mu(this,t)}));var Lu=kn.find,Pu=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("find",(function(e){return Lu(Pu(this),e,arguments.length>1?arguments[1]:void 0)}));var Du=kn.findIndex,Vu=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("findIndex",(function(e){return Du(Vu(this),e,arguments.length>1?arguments[1]:void 0)}));var Bu=kn.forEach,Fu=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("forEach",(function(e){Bu(Fu(this),e,arguments.length>1?arguments[1]:void 0)}));var Yu=je.includes,ju=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("includes",(function(e){return Yu(ju(this),e,arguments.length>1?arguments[1]:void 0)}));var qu=je.indexOf,Gu=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("indexOf",(function(e){return qu(Gu(this),e,arguments.length>1?arguments[1]:void 0)}));var Hu=_t("iterator"),Ku=k.Uint8Array,Wu=ia.values,Qu=ia.keys,zu=ia.entries,Ju=ka.aTypedArray,Zu=ka.exportTypedArrayMethod,$u=Ku&&Ku.prototype[Hu],Xu=!!$u&&("values"==$u.name||null==$u.name),ec=function(){return Wu.call(Ju(this))};Zu("entries",(function(){return zu.call(Ju(this))})),Zu("keys",(function(){return Qu.call(Ju(this))})),Zu("values",ec,!Xu),Zu(Hu,ec,!Xu);var tc=ka.aTypedArray,nc=[].join;(0,ka.exportTypedArrayMethod)("join",(function(e){return nc.apply(tc(this),arguments)}));var rc=Math.min,ic=[].lastIndexOf,sc=!!ic&&1/[1].lastIndexOf(1,-0)<0,oc=Dn("lastIndexOf"),ac=sc||!oc?function(e){if(sc)return ic.apply(this,arguments)||0;var t=j(this),n=De(t.length),r=n-1;for(arguments.length>1&&(r=rc(r,Le(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:ic,uc=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("lastIndexOf",(function(e){return ac.apply(uc(this),arguments)}));var cc=kn.map,lc=ka.aTypedArray,hc=ka.aTypedArrayConstructor;(0,ka.exportTypedArrayMethod)("map",(function(e){return cc(lc(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(hc(Yr(e,e.constructor)))(t)}))}));var fc=function(e){return function(t,n,r,i){bn(n);var s=at(t),o=F(s),a=De(s.length),u=e?a-1:0,c=e?-1:1;if(r<2)for(;;){if(u in o){i=o[u],u+=c;break}if(u+=c,e?u<0:a<=u)throw TypeError("Reduce of empty array with no initial value")}for(;e?u>=0:a>u;u+=c)u in o&&(i=n(i,o[u],u,s));return i}},dc={left:fc(!1),right:fc(!0)},gc=dc.left,pc=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("reduce",(function(e){return gc(pc(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var vc=dc.right,yc=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("reduceRight",(function(e){return vc(yc(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}));var mc=ka.aTypedArray,Ec=ka.exportTypedArrayMethod,_c=Math.floor;Ec("reverse",(function(){for(var e,t=this,n=mc(t).length,r=_c(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t}));var Tc=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("set",(function(e){Tc(this);var t=Tu(arguments.length>1?arguments[1]:void 0,1),n=this.length,r=at(e),i=De(r.length),s=0;if(i+t>n)throw RangeError("Wrong length");for(;s<i;)this[t+s]=r[s++]}),A((function(){new Int8Array(1).set({})})));var Rc=ka.aTypedArray,Ic=ka.aTypedArrayConstructor,Cc=[].slice;(0,ka.exportTypedArrayMethod)("slice",(function(e,t){for(var n=Cc.call(Rc(this),e,t),r=Yr(this,this.constructor),i=0,s=n.length,o=new(Ic(r))(s);s>i;)o[i]=n[i++];return o}),A((function(){new Int8Array(1).slice()})));var Sc=kn.some,bc=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("some",(function(e){return Sc(bc(this),e,arguments.length>1?arguments[1]:void 0)}));var wc=ka.aTypedArray,Oc=[].sort;(0,ka.exportTypedArrayMethod)("sort",(function(e){return Oc.call(wc(this),e)}));var Nc=ka.aTypedArray;(0,ka.exportTypedArrayMethod)("subarray",(function(e,t){var n=Nc(this),r=n.length,i=Fe(e,r);return new(Yr(n,n.constructor))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,De((void 0===t?r:Fe(t,r))-i))}));var kc=k.Int8Array,Ac=ka.aTypedArray,Mc=ka.exportTypedArrayMethod,xc=[].toLocaleString,Uc=[].slice,Lc=!!kc&&A((function(){xc.call(new kc(1))}));Mc("toLocaleString",(function(){return xc.apply(Lc?Uc.call(Ac(this)):Ac(this),arguments)}),A((function(){return[1,2].toLocaleString()!=new kc([1,2]).toLocaleString()}))||!A((function(){kc.prototype.toLocaleString.call([1,2])})));var Pc=ka.exportTypedArrayMethod,Dc=k.Uint8Array,Vc=Dc&&Dc.prototype||{},Bc=[].toString,Fc=[].join;A((function(){Bc.call({})}))&&(Bc=function(){return Fc.call(this)});var Yc=Vc.toString!=Bc;Pc("toString",Bc,Yc);var jc=_u.ArrayBuffer,qc=_u.DataView,Gc=jc.prototype.slice,Hc=A((function(){return!new jc(2).slice(1,void 0).byteLength}));st({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Hc},{slice:function(e,t){if(void 0!==Gc&&void 0===t)return Gc.call(X(this),e);for(var n=X(this).byteLength,r=Fe(e,n),i=Fe(void 0===t?n:t,n),s=new(Yr(this,jc))(De(i-r)),o=new qc(this),a=new qc(s),u=0;r<i;)a.setUint8(u++,o.getUint8(r++));return s}});var Kc,Wc,Qc,zc,Jc="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",Zc=RegExp("^"+Jc+Jc+"*"),$c=RegExp(Jc+Jc+"*$"),Xc=function(e){return function(t){var n=String(Y(t));return 1&e&&(n=n.replace(Zc,"")),2&e&&(n=n.replace($c,"")),n}},el={start:Xc(1),end:Xc(2),trim:Xc(3)},tl=We.f,nl=$.f,rl=te.f,il=el.trim,sl="Number",ol=k.Number,al=ol.prototype,ul=V(Do(al))==sl,cl=function(e){var t,n,r,i,s,o,a,u,c=G(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=il(c)).charCodeAt(0))||45===t){if(88===(n=c.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=(s=c.slice(2)).length,a=0;a<o;a++)if((u=s.charCodeAt(a))<48||u>i)return NaN;return parseInt(s,r)}return+c};if(rt(sl,!ol(" 0o1")||!ol("0b1")||ol("+0x1"))){for(var ll,hl=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof hl&&(ul?A((function(){al.valueOf.call(n)})):V(n)!=sl)?qs(new ol(cl(t)),n,hl):cl(t)},fl=M?tl(ol):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),dl=0;fl.length>dl;dl++)K(ol,ll=fl[dl])&&!K(hl,ll)&&rl(hl,ll,nl(ol,ll));hl.prototype=al,al.constructor=hl,Ne(k,sl,hl)}!function(e){e[e.AT_MOST_ONCE=0]="AT_MOST_ONCE",e[e.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",e[e.EXACTLY_ONCE=2]="EXACTLY_ONCE",e[e.DEFAULT=3]="DEFAULT"}(Kc||(Kc={})),function(e){e[e.SYMMETRIC=0]="SYMMETRIC",e[e.CONNECT=1]="CONNECT",e[e.CONN_ACK=2]="CONN_ACK",e[e.PUBLISH=3]="PUBLISH",e[e.PUB_ACK=4]="PUB_ACK",e[e.QUERY=5]="QUERY",e[e.QUERY_ACK=6]="QUERY_ACK",e[e.QUERY_CONFIRM=7]="QUERY_CONFIRM",e[e.SUBSCRIBE=8]="SUBSCRIBE",e[e.SUB_ACK=9]="SUB_ACK",e[e.UNSUBSCRIBE=10]="UNSUBSCRIBE",e[e.UNSUB_ACK=11]="UNSUB_ACK",e[e.PING_REQ=12]="PING_REQ",e[e.PING_RESP=13]="PING_RESP",e[e.DISCONNECT=14]="DISCONNECT",e[e.RESERVER2=15]="RESERVER2"}(Wc||(Wc={})),function(e){e.CONN_ACK="ConnAckMessage",e.DISCONNECT="DisconnectMessage",e.PING_REQ="PingReqMessage",e.PING_RESP="PingRespMessage",e.PUBLISH="PublishMessage",e.PUB_ACK="PubAckMessage",e.QUERY="QueryMessage",e.QUERY_CON="QueryConMessage",e.QUERY_ACK="QueryAckMessage"}(Qc||(Qc={})),function(e){e.PUB="pub",e.QUERY="qry"}(zc||(zc={}));var gl,pl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kc.AT_LEAST_ONCE,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o(this,e),this._retain=!1,this.qos=Kc.AT_LEAST_ONCE,this._dup=!1,this.syncMsg=!1;var s=t>0;t&&s&&1===arguments.length?(this._retain=(1&t)>0,this.qos=(6&t)>>1,this._dup=(8&t)>0,this.type=t>>4&15,this.syncMsg=8==(8&t)):(this.type=t,this._retain=n,this.qos=r,this._dup=i)}return u(e,[{key:"encode",value:function(){var e=this.type<<4;return e|=this._retain?1:0,e|=this.qos<<1,e|=this._dup?8:0}}]),e}(),vl=function(){function e(){o(this,e)}return u(e,null,[{key:"writeUTF",value:function(e,t){var n=[],r=0;if(or(e))for(var i=0,s=e.length;i<s;i++){var o=e.charCodeAt(i);o>=0&&o<=127?(r+=1,n.push(o)):o>=128&&o<=2047?(r+=2,n.push(192|31&o>>6),n.push(128|63&o)):o>=2048&&o<=65535&&(r+=3,n.push(224|15&o>>12),n.push(128|63&o>>6),n.push(128|63&o))}for(var a=0,u=n.length;a<u;a++)n[a]>255&&(n[a]&=255);return t?n:r<=255?[0,r].concat(n):[r>>8,255&r].concat(n)}},{key:"readUTF",value:function(e){for(var t,n,r=[],i=-1,s=e,o="";++i<s.length;){var a=Number(s[i]);if(a===(127&a)||(240==(240&a)?a=(a=(a=(a^=240)<<6|128^s[++i])<<6|128^s[++i])<<6|128^s[++i]:224==(224&a)?a=(a=(a^=224)<<6|128^s[++i])<<6|128^s[++i]:192==(192&a)&&(a=(a^=192)<<6|128^s[++i])),!isFinite(a)||a<0||a>1114111||Math.floor(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(t=(a-=65536)>>10|55296,n=a%1024|56320,r.push(t,n)),(i+1===s.length||r.length>16384)&&(o+=String.fromCharCode.apply(null,r),r.length=0)}return o}}]),e}(),yl=function(){function e(t){o(this,e),this._position=0,this._poolLen=0,this._pool=t,this._poolLen=t.length}return u(e,[{key:"check",value:function(){return this._position>=this._pool.length}},{key:"readInt",value:function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<4;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r.toString()}return parseInt(t,16)}},{key:"readLong",value:function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<8;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r}return parseInt(t,16)}},{key:"readByte",value:function(){if(this.check())return-1;var e=this._pool[this._position++];return e>255&&(e&=255),e}},{key:"readUTF",value:function(){if(this.check())return"";var e=this.readByte()<<8|this.readByte(),t=this._pool.subarray(this._position,this._position+=e);return vl.readUTF(t)}},{key:"readAll",value:function(){return this._pool.subarray(this._position,this._poolLen)}}]),e}(),ml=function(){function e(){o(this,e),this._pool=[],this._position=0,this._writen=0}return u(e,[{key:"write",value:function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")?this._pool=this._pool.concat(e):e>=0&&(e>255&&(e&=255),this._pool.push(e),this._writen++),e}},{key:"writeArr",value:function(e){return this._pool=this._pool.concat(e),e}},{key:"writeUTF",value:function(e){var t=vl.writeUTF(e);this._pool=this._pool.concat(t),this._writen+=t.length}},{key:"getBytesArray",value:function(){return this._pool}}]),e}(),El="UpStreamMessage",_l="PushExtra",Tl="DownStreamMessage",Rl="DownStreamMessages",Il="SessionsAttQryInput",Cl="SessionsAttOutput",Sl="SyncRequestMsg",bl="ChrmPullMsg",wl="NotifyMsg",Ol="HistoryMsgInput",Nl="HistoryMsgOuput",kl="RelationQryInput",Al="RelationsOutput",Ml="DeleteSessionsInput",xl="SessionInfo",Ul="DeleteSessionsOutput",Ll="RelationsInput",Pl="DeleteMsgInput",Dl="CleanHisMsgInput",Vl="SessionMsgReadInput",Bl="ChrmInput",Fl="QueryChatRoomInfoInput",Yl="QueryChatRoomInfoOutput",jl="RtcInput",ql="RtcUserListOutput",Gl="SetUserStatusInput",Hl="RtcSetDataInput",Kl="RtcUserSetDataInput",Wl="RtcDataInput",Ql="RtcSetOutDataInput",zl="MCFollowInput",Jl="RtcTokenOutput",Zl="RtcQryOutput",$l="RtcQryUserOutDataInput",Xl="RtcUserOutDataOutput",eh="RtcQueryListInput",th="RtcRoomInfoOutput",nh="RtcValueInfo",rh="RtcKeyDeleteInput",ih="GetQNupTokenInput",sh="GetQNupTokenOutput",oh="GetQNdownloadUrlInput",ah="GetDownloadUrlInput",uh="GetQNdownloadUrlOutput",ch="GetDownloadUrlOutput",lh="SetChrmKV",hh="ChrmKVOutput",fh="QueryChrmKV",dh="SetUserSettingInput",gh="SetUserSettingOutput",ph="PullUserSettingInput",vh="PullUserSettingOutput",yh="UserSettingNotification",mh="SessionReq",Eh="SessionStates",_h="SessionState",Th="SessionStateItem",Rh="SessionStateModifyReq",Ih="SessionStateModifyResp",Ch="GrpReadReceiptMsg",Sh="GrpReadReceiptQryReq",bh="GrpReadReceiptQryResp",wh="GrpMsgReadUser",Oh="SessionTagAddInput",Nh="SessionTagItem",kh="SessionTagDelInput",Ah="SessionDisTagReq",Mh="ReportSDKInput",xh="ReportSDKOutput",Uh=(c(gl={},El,["sessionId","classname","content","pushText","userId","configFlag","appData","extraContent","pushExt"]),c(gl,Rl,["list","syncTime","finished"]),c(gl,Tl,["fromUserId","type","groupId","classname","content","dataTime","status","msgId","extraContent","pushContent","configFlag","pushExt"]),c(gl,_l,["title","templateIdNoUse","pushId","pushConfigs","templateId"]),c(gl,Il,["nothing"]),c(gl,Cl,["inboxTime","sendboxTime","totalUnreadCount"]),c(gl,Sl,["syncTime","ispolling","isweb","isPullSend","isKeeping","sendBoxSyncTime"]),c(gl,bl,["syncTime","count"]),c(gl,wl,["type","time","chrmId"]),c(gl,Ol,["targetId","time","count","order"]),c(gl,Nl,["list","syncTime","hasMsg"]),c(gl,kl,["type","count","startTime","order"]),c(gl,Al,["info"]),c(gl,Ml,["sessions"]),c(gl,xl,["type","channelId"]),c(gl,Ul,["nothing"]),c(gl,Ll,["type","msg","count","offset","startTime","endTime"]),c(gl,Pl,["type","conversationId","msgs"]),c(gl,Dl,["targetId","dataTime","conversationType"]),c(gl,Vl,["type","msgTime","channelId"]),c(gl,Bl,["nothing"]),c(gl,Fl,["count","order"]),c(gl,Yl,["userTotalNums","userInfos"]),c(gl,ih,["type","key","httpMethod","queryString"]),c(gl,oh,["type","key","fileName"]),c(gl,ah,["type","key","fileName"]),c(gl,sh,["deadline","token","bosToken","bosDate","path","osskeyId","ossPolicy","ossSign","ossBucketName"]),c(gl,uh,["downloadUrl"]),c(gl,ch,["downloadUrl"]),c(gl,lh,["entry","bNotify","notification","type"]),c(gl,hh,["entries","bFullUpdate","syncTime"]),c(gl,fh,["timestamp"]),c(gl,dh,["version","value"]),c(gl,gh,["version","reserve"]),c(gl,ph,["version","reserve"]),c(gl,vh,["items","version"]),c(gl,"UserSettingItem",["targetId","type","key","value","version","status","tags"]),c(gl,mh,["time"]),c(gl,Eh,["version","state"]),c(gl,_h,["type","channelId","time","stateItem"]),c(gl,Th,["sessionStateType","value","tags"]),c(gl,Rh,["version","state"]),c(gl,Ih,["version"]),c(gl,Ch,["msgId","busChannel"]),c(gl,Sh,["msgId","busChannel"]),c(gl,bh,["totalMemberNum","list"]),c(gl,wh,["readTime","userId"]),c(gl,Oh,["version","tags"]),c(gl,Nh,["tagId","name","createdTime","isTop"]),c(gl,kh,["version","tags"]),c(gl,Ah,["tagId"]),c(gl,yh,["version","reserve"]),c(gl,Mh,["sdkInfo"]),c(gl,xh,["nothing"]),gl),Lh={},Ph=function(e){var t=Uh[e];Lh[e]=function(){for(var e={},n={getArrayData:function(){return e}},r=function(r){var i=t[r],s="set".concat(jn(i,0,1));n[s]=function(t){e[i]=t}},i=0;i<t.length;i++)r(i);return n},Lh[e].decode=function(e){var t={};or(e)&&(e=JSON.parse(e));var n=function(n){var r="get".concat(jn(n,0,1));t[n]=e[n],t[r]=function(){return e[n]}};for(var r in e)n(r);return t}};for(var Dh in Uh)Ph(Dh);Lh.getModule=function(e){return Lh[e]()},Cu("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var Vh="\npackage Modules;\nmessage probuf {\n  message ".concat(Gl,"\n  {\n    optional int32 status=1;\n  }\n\n  message SetUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusInput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusOutput\n  {\n    optional string status=1;\n    optional string subUserId=2;\n  }\n\n  message SubUserStatusInput\n  {\n    repeated string userid =1;\n  }\n\n  message SubUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n  message VoipDynamicInput\n  {\n    required int32  engineType = 1;\n    required string channelName = 2;\n    optional string channelExtra = 3;\n  }\n\n  message VoipDynamicOutput\n  {\n      required string dynamicKey=1;\n  }\n  message ").concat(wl," {\n    required int32 type = 1;\n    optional int64 time = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(Sl," {\n    required int64 syncTime = 1;\n    required bool ispolling = 2;\n    optional bool isweb=3;\n    optional bool isPullSend=4;\n    optional bool isKeeping=5;\n    optional int64 sendBoxSyncTime=6;\n  }\n  message ").concat(El," {\n    required int32 sessionId = 1;\n    required string classname = 2;\n    required bytes content = 3;\n    optional string pushText = 4;\n    optional string appData = 5;\n    repeated string userId = 6;\n    optional int64 delMsgTime = 7;\n    optional string delMsgId = 8;\n    optional int32 configFlag = 9;\n    optional int64 clientUniqueId = 10;\n    optional string extraContent = 11;\n    optional PushExtra pushExt = 12;\n  }\n  message ").concat(_l," {\n    optional string title = 1;\n    optional int32  templateIdNoUse= 2;\n    optional string pushId = 3;\n    optional string pushConfigs = 4;\n    optional string templateId = 5;\n  }\n  message ").concat(Rl," {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    optional bool finished = 3;\n  }\n  message ").concat(Tl," {\n    required string fromUserId = 1;\n    required ChannelType type = 2;\n    optional string groupId = 3;\n    required string classname = 4;\n    required bytes content = 5;\n    required int64 dataTime = 6;\n    required int64 status = 7;\n    optional int64 extra = 8;\n    optional string msgId = 9;\n    optional int32 direction = 10;\n    optional int32 plantform =11;\n    optional int32 isRemoved = 12;\n    optional string source = 13;\n    optional int64 clientUniqueId = 14;\n    optional string extraContent = 15;\n    optional string pushContent = 16;\n    optional int32 configFlag = 17;\n    optional PushExtra pushExt = 18;\n  }\n  enum ChannelType {\n    PERSON = 1;\n    PERSONS = 2;\n    GROUP = 3;\n    TEMPGROUP = 4;\n    CUSTOMERSERVICE = 5;\n    NOTIFY = 6;\n    MC=7;\n    MP=8;\n  }\n  message CreateDiscussionInput {\n    optional string name = 1;\n  }\n  message CreateDiscussionOutput {\n    required string id = 1;\n  }\n  message ChannelInvitationInput {\n    repeated string users = 1;\n  }\n  message LeaveChannelInput {\n    required int32 nothing = 1;\n  }\n  message ChannelEvictionInput {\n    required string user = 1;\n  }\n  message RenameChannelInput {\n    required string name = 1;\n  }\n  message ChannelInfoInput {\n    required int32 nothing = 1;\n  }\n  message ChannelInfoOutput {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    required string channelName = 3;\n    required string adminUserId = 4;\n    repeated string firstTenUserIds = 5;\n    required int32 openStatus = 6;\n  }\n  message ChannelInfosInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message ChannelInfosOutput {\n    repeated ChannelInfoOutput channels = 1;\n    required int32 total = 2;\n  }\n  message MemberInfo {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n    required string extension = 4;\n  }\n  message GroupMembersInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message GroupMembersOutput {\n    repeated MemberInfo members = 1;\n    required int32 total = 2;\n  }\n  message GetUserInfoInput {\n    required int32 nothing = 1;\n  }\n  message GetUserInfoOutput {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n  }\n  message GetSessionIdInput {\n    required int32 nothing = 1;\n  }\n  message GetSessionIdOutput {\n    required int32 sessionId = 1;\n  }\n  enum FileType {\n    image = ").concat(sr.IMAGE,";\n    audio = ").concat(sr.AUDIO,";\n    video = ").concat(sr.VIDEO,";\n    file = ").concat(sr.FILE,";\n  }\n  message ").concat(ih," {\n    required FileType type = 1;\n    optional string key = 2;\n    optional string httpMethod = 3;\n    optional string queryString = 4;\n  }\n  message ").concat(oh," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string  fileName = 3;\n  }\n  message ").concat(ah," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string fileName = 3;\n   }\n  message ").concat(sh," {\n    required int64 deadline = 1;\n    required string token = 2;\n    optional string bosToken = 3;\n    optional string bosDate = 4;\n    optional string path = 5;\n    optional string osskeyId = 6;\n    optional string ossPolicy = 7;\n    optional string ossSign = 8;\n    optional string ossBucketName = 9;\n    optional string s3Credential = 10;\n    optional string s3Algorithm = 11;\n    optional string s3Date = 12;\n    optional string s3Policy = 13;\n    optional string s3Signature = 14;\n    optional string s3BucketName = 15;\n    optional string stcAuthorization = 16;\n    optional string stcContentSha256 = 17;\n    optional string stcDate = 18;\n    optional string stcBucketName = 19;\n  }\n  message ").concat(uh," {\n    required string downloadUrl = 1;\n  }\n  message ").concat(ch," {\n    required string downloadUrl = 1;\n  }\n  message Add2BlackListInput {\n    required string userId = 1;\n  }\n  message RemoveFromBlackListInput {\n    required string userId = 1;\n  }\n  message QueryBlackListInput {\n    required int32 nothing = 1;\n  }\n  message QueryBlackListOutput {\n    repeated string userIds = 1;\n  }\n  message BlackListStatusInput {\n    required string userId = 1;\n  }\n  message BlockPushInput {\n    required string blockeeId = 1;\n  }\n  message ModifyPermissionInput {\n    required int32 openStatus = 1;\n  }\n  message GroupInput {\n    repeated GroupInfo groupInfo = 1;\n  }\n  message GroupOutput {\n    required int32 nothing = 1;\n  }\n  message GroupInfo {\n    required string id = 1;\n    required string name = 2;\n  }\n  message GroupHashInput {\n    required string userId = 1;\n    required string groupHashCode = 2;\n  }\n  message GroupHashOutput {\n    required GroupHashType result = 1;\n  }\n  enum GroupHashType {\n    group_success = 0x00;\n    group_failure = 0x01;\n  }\n  message ").concat(Bl," {\n    required int32 nothing = 1;\n  }\n  message ChrmOutput {\n    required int32 nothing = 1;\n  }\n  message ").concat(bl," {\n    required int64 syncTime = 1;\n    required int32 count = 2;\n  }\n\n  message ChrmPullMsgNew\n  {\n    required int32 count = 1;\n    required int64 syncTime = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(kl,"\n  {\n    optional ChannelType type = 1;\n    optional int32 count = 2;\n    optional int64 startTime = 3;\n    optional int32 order = 4;\n  }\n  message ").concat(Ll,"\n  {\n    required ChannelType type = 1;\n    optional DownStreamMessage msg =2;\n    optional int32 count = 3;\n    optional int32 offset = 4;\n    optional int64 startTime = 5;\n    optional int64 endTime = 6;\n  }\n  message ").concat(Al,"\n  {\n    repeated RelationInfo info = 1;\n  }\n  message RelationInfo\n  {\n    required ChannelType type = 1;\n    required string userId = 2;\n    optional DownStreamMessage msg =3;\n    optional int64 readMsgTime= 4;\n    optional int64 unreadCount= 5;\n    optional string channelId = 6;\n  }\n  message RelationInfoReadTime\n  {\n    required ChannelType type = 1;\n    required int64 readMsgTime= 2;\n    required string targetId = 3;\n  }\n  message ").concat(Dl,"\n  {\n      required string targetId = 1;\n      required int64 dataTime = 2;\n      optional int32 conversationType= 3;\n  }\n  message HistoryMessageInput\n  {\n    required string targetId = 1;\n    required int64 dataTime =2;\n    required int32 size  = 3;\n  }\n\n  message HistoryMessagesOuput\n  {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    required int32 hasMsg = 3;\n  }\n  message ").concat(Fl,"\n  {\n    required int32 count= 1;\n    optional int32 order= 2;\n  }\n\n  message ").concat(Yl,"\n  {\n    optional int32 userTotalNums = 1;\n    repeated ChrmMember userInfos = 2;\n  }\n  message ChrmMember\n  {\n    required int64 time = 1;\n    required string id = 2;\n  }\n  message MPFollowInput\n  {\n    required string id = 1;\n  }\n\n  message MPFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message ").concat(zl,"\n  {\n    required string id = 1;\n  }\n\n  message MCFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message MpInfo\n  {\n    required string mpid=1;\n    required string name = 2;\n    required string type = 3;\n    required int64 time=4;\n    optional string portraitUrl=5;\n    optional string extra =6;\n  }\n\n  message SearchMpInput\n  {\n    required int32 type=1;\n    required string id=2;\n  }\n\n  message SearchMpOutput\n  {\n    required int32 nothing=1;\n    repeated MpInfo info = 2;\n  }\n\n  message PullMpInput\n  {\n    required int64 time=1;\n    required string mpid=2;\n  }\n\n  message PullMpOutput\n  {\n    required int32 status=1;\n    repeated MpInfo info = 2;\n  }\n  message ").concat(Ol,"\n  {\n    optional string targetId = 1;\n    optional int64 time = 2;\n    optional int32 count  = 3;\n    optional int32 order = 4;\n  }\n\n  message ").concat(Nl,"\n  {\n    repeated DownStreamMessage list=1;\n    required int64 syncTime=2;\n    required int32 hasMsg=3;\n  }\n  message ").concat(eh,"{\n    optional int32 order=1;\n  }\n\n  message ").concat(rh,"{\n    repeated string key=1;\n  }\n\n  message ").concat(nh,"{\n    required string key=1;\n    required string value=2;\n  }\n\n  message RtcUserInfo{\n    required string userId=1;\n    repeated ").concat(nh," userData=2;\n  }\n\n  message ").concat(ql,"{\n    repeated RtcUserInfo list=1;\n    optional string token=2;\n    optional string sessionId=3;\n  }\n  message RtcRoomInfoOutput{\n    optional string roomId = 1;\n    repeated ").concat(nh," roomData = 2;\n    optional int32 userCount = 3;\n    repeated RtcUserInfo list=4;\n  }\n  message ").concat(jl,"{\n    required int32 roomType=1;\n    optional int32 broadcastType=2;\n  }\n  message RtcQryInput{\n    required bool isInterior=1;\n    required targetType target=2;\n    repeated string key=3;\n  }\n  message ").concat(Zl,"{\n    repeated ").concat(nh," outInfo=1;\n  }\n  message RtcDelDataInput{\n    repeated string key=1;\n    required bool isInterior=2;\n    required targetType target=3;\n  }\n  message ").concat(Wl,"{\n    required bool interior=1;\n    required targetType target=2;\n    repeated string key=3;\n    optional string objectName=4;\n    optional string content=5;\n  }\n  message ").concat(Hl,"{\n    required bool interior=1;\n    required targetType target=2;\n    required string key=3;\n    required string value=4;\n    optional string objectName=5;\n    optional string content=6;\n  }\n  message ").concat(Kl," {\n    repeated ").concat(nh," valueInfo = 1;\n    required string objectName = 2;\n    repeated ").concat(nh," content = 3;\n  }\n  message RtcOutput\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(Jl,"{\n    required string rtcToken=1;\n  }\n  enum targetType {\n    ROOM =1 ;\n    PERSON = 2;\n  }\n  message ").concat(Ql,"{\n    required targetType target=1;\n    repeated ").concat(nh," valueInfo=2;\n    optional string objectName=3;\n    optional string content=4;\n  }\n  message ").concat($l,"{\n    repeated string userId = 1;\n  }\n  message ").concat(Xl,"{\n    repeated RtcUserInfo user = 1;\n  }\n  message ").concat(Il,"{\n    required int32 nothing = 1;\n  }\n  message ").concat(Cl,"{\n    required int64 inboxTime = 1;\n    required int64 sendboxTime = 2;\n    required int64 totalUnreadCount = 3;\n  }\n  message ").concat(Vl,"\n  {\n    required ChannelType type = 1;\n    required int64 msgTime = 2;\n    required string channelId = 3;\n  }\n  message SessionMsgReadOutput\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(Ml,"\n  {\n    repeated SessionInfo sessions = 1;\n  }\n  message ").concat(xl,"\n  {\n    required ChannelType type = 1;\n    required string channelId = 2;\n  }\n  message ").concat(Ul,"\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(Pl,"\n  {\n    optional ChannelType type = 1;\n    optional string conversationId = 2;\n    repeated DeleteMsg msgs = 3;\n  }\n  message DeleteMsg\n  {\n    optional string msgId = 1;\n    optional int64 msgDataTime = 2;\n    optional int32 direct = 3;\n  }\n  message ChrmKVEntity {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n  }\n  message ").concat(lh," {\n    required ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(hh," {\n    repeated ChrmKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3;\n  }\n  message ").concat(fh," {\n    required int64 timestamp = 1;\n  }\n  message ").concat(dh," {\n    required int64 version=1;\n    required string value=2;\n  }\n  message ").concat(gh," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(ph," {\n    required int64 version=1;\n    optional bool reserve=2;\n  }\n  message ").concat(vh," {\n    repeated UserSettingItem items = 1;\n    required int64 version=2;\n  }\n  message UserSettingItem {\n    required string targetId= 1;\n    required ChannelType type = 2;\n    required string key = 4;\n    required bytes value = 5;\n    required int64 version=6;\n    required int32 status=7;\n    repeated SessionTagItem tags= 8;\n  }\n  message ").concat(mh," {\n    required int64 time = 1;\n  }\n  message ").concat(Eh," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(_h," {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    optional int64 time = 3;\n    repeated SessionStateItem stateItem = 4;\n  }\n  message ").concat(Th," {\n    required SessionStateType sessionStateType = 1;\n    required string value = 2;\n    repeated SessionTagItem tags = 3;\n  }\n  enum SessionStateType {\n    IsSilent = 1;\n    IsTop = 2;\n    Tags = 3;\n  }\n  message ").concat(Rh," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(Ih," {\n    required int64 version=1;\n  }\n  message ").concat(Ch," {\n    repeated string msgId=1; //å·²è¯»æ¶æ¯ID\n    optional string busChannel = 2; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(Sh," {\n    repeated string msgId=1; //å·²è¯»æ¶æ¯ID\n    optional string busChannel = 2; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(bh," {\n    required int32 totalMemberNum = 1;//ç¾¤åæ»äººæ°\n    repeated GrpMsgReadUser list = 2;//å·²è¯»ç¨æ·åè¡¨ï¼listå¤ç±»åï¼\n  }\n  message ").concat(wh," {\n    required int64 readTime = 1;//å·²è¯»æ¶é´\n    required string userId = 2;//å·²è¯»ç¨æ·id\n  }\n  message ").concat(Oh," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(Nh," {\n    required string tagId=1;\n    optional string name=2;\n    optional int64 createdTime=3;\n    optional bool isTop=4;\n  }\n  message ").concat(kh," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(Ah," {\n    repeated string tagId=1;\n  }\n  message ").concat(yh," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(Mh,' {\n    required string sdkInfo=1; // ç¨æ·éæç sdk ä¿¡æ¯,json æ ¼å¼ {"web-rtc": "4.0.3.7"}\n  }\n  message ').concat(xh,"\n  {\n    optional int32 nothing=1; //å ä½\n  }\n}\n"),Bh=/"/g;st({target:"String",proto:!0,forced:function(e){return A((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}("sub")},{sub:function(){return e="sub",t="",n="",r=String(Y(this)),i="<"+e,""!==t&&(i+=" "+t+'="'+String(n).replace(Bh,"&quot;")+'"'),i+">"+r+"</"+e+">";var e,t,n,r,i}});var Fh="ArrayBuffer",Yh=_u.ArrayBuffer,jh=k.ArrayBuffer;st({global:!0,forced:jh!==Yh},{ArrayBuffer:Yh}),ii(Fh),st({target:"Array",proto:!0},{fill:qa}),ea("fill");var qh,Gh,Hh,Kh=(qh=Vh,function(e,t){var n,i,s={};return s.ByteBuffer=e,s.c=e,n=e,s.Long=t||null,s.VERSION="5.0.1",s.WIRE_TYPES={},s.WIRE_TYPES.VARINT=0,s.WIRE_TYPES.BITS64=1,s.WIRE_TYPES.LDELIM=2,s.WIRE_TYPES.STARTGROUP=3,s.WIRE_TYPES.ENDGROUP=4,s.WIRE_TYPES.BITS32=5,s.PACKABLE_WIRE_TYPES=[s.WIRE_TYPES.VARINT,s.WIRE_TYPES.BITS64,s.WIRE_TYPES.BITS32],s.TYPES={int32:{name:"int32",wireType:s.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:s.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:s.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:s.WIRE_TYPES.VARINT,defaultValue:s.Long?s.Long.ZERO:void 0},uint64:{name:"uint64",wireType:s.WIRE_TYPES.VARINT,defaultValue:s.Long?s.Long.UZERO:void 0},sint64:{name:"sint64",wireType:s.WIRE_TYPES.VARINT,defaultValue:s.Long?s.Long.ZERO:void 0},bool:{name:"bool",wireType:s.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:s.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:s.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:s.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:s.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:s.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:s.WIRE_TYPES.BITS64,defaultValue:s.Long?s.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:s.WIRE_TYPES.BITS64,defaultValue:s.Long?s.Long.ZERO:void 0},float:{name:"float",wireType:s.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:s.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:s.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:s.WIRE_TYPES.STARTGROUP,defaultValue:null}},s.MAP_KEY_TYPES=[s.TYPES.int32,s.TYPES.sint32,s.TYPES.sfixed32,s.TYPES.uint32,s.TYPES.fixed32,s.TYPES.int64,s.TYPES.sint64,s.TYPES.sfixed64,s.TYPES.uint64,s.TYPES.fixed64,s.TYPES.bool,s.TYPES.string,s.TYPES.bytes],s.ID_MIN=1,s.ID_MAX=536870911,s.convertFieldsToCamelCase=!1,s.populateAccessors=!0,s.populateDefaults=!0,s.Util=function(){var e={};return e.IS_NODE=!("object"!==("undefined"==typeof process?"undefined":r(process))||process+""!="[object process]"||process.browser),e.XHR=function(){var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=null;for(e=0;e<t.length;e++){try{n=t[e]()}catch(e){continue}break}if(!n)throw Error("XMLHttpRequest is not supported");return n},e.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),e.IS_NODE)if(n)g.readFile(t,(function(e,t){n(e?null:""+t)}));else try{return g.readFileSync(t)}catch(e){return null}else{var r=e.XHR();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},e}(),s.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},s.DotProto=function(e,t){function n(e,n){var r=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=parseInt(e);else if(t.NUMBER_HEX.test(e))r=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(i<0?"-":"")+e);r=parseInt(e.substring(1),8)}if(r=0|i*r,!n&&r<0)throw Error("illegal id value: "+(i<0?"-":"")+e);return r}function r(e){var n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return n*parseInt(e,10);if(t.NUMBER_HEX.test(e))return n*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return n*parseInt(e.substring(1),8);if("inf"===e)return 1/0*n;if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return n*parseFloat(e);throw Error("illegal number value: "+(n<0?"-":"")+e)}function i(e,t,n){void 0===e[t]?e[t]=n:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(n))}var s,o,a={},u=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},c=u.prototype;return c._readString=function(){var e,n='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;if(n.lastIndex=this.index-1,!(e=n.exec(this.source)))throw Error("unterminated string");return this.index=n.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,e[1]},c.next=function(){var e,n,r,i,s;if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null;n=r,r=this.source.charAt(this.index)}while("*"!==n||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;if(i=this.index,t.DELIM.lastIndex=0,!t.DELIM.test(this.source.charAt(i++)))for(;i<this.source.length&&!t.DELIM.test(this.source.charAt(i));)++i;return('"'===(s=this.source.substring(this.index,this.index=i))||"'"===s)&&(this._stringOpen=s),s},c.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},c.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},c.omit=function(e){return this.peek()===e&&(this.next(),!0)},c.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},a.Tokenizer=u,(o=(s=function(e){this.tn=new u(e),this.proto3=!1}).prototype).parse=function(){var e,n={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},r=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!r||null!==n.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),n.package=e;break;case"import":if(!r)throw Error("unexpected 'import'");"public"===(e=this.tn.peek())&&this.tn.next(),e=this._readString(),this.tn.skip(";"),n.imports.push(e);break;case"syntax":if(!r)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(n.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(n,null),r=!1;break;case"enum":this._parseEnum(n),r=!1;break;case"option":this._parseOption(n);break;case"service":this._parseService(n);break;case"extend":this._parseExtend(n);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete n.name,n},s.parse=function(e){return new s(e).parse()},o._readString=function(){var e,t,n="";do{if("'"!==(t=this.tn.next())&&'"'!==t)throw Error("illegal string delimiter: "+t);n+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return n},o._readValue=function(e){var n=this.tn.peek();if('"'===n||"'"===n)return this._readString();if(this.tn.next(),t.NUMBER.test(n))return r(n);if(t.BOOL.test(n))return"true"===n.toLowerCase();if(e&&t.TYPEREF.test(n))return n;throw Error("illegal value: "+n)},o._parseOption=function(e,n){var r,i=this.tn.next(),s=!1;if("("===i&&(s=!0,i=this.tn.next()),!t.TYPEREF.test(i))throw Error("illegal option name: "+i);r=i,s&&(this.tn.skip(")"),r="("+r+")",i=this.tn.peek(),t.FQTYPEREF.test(i)&&(r+=i,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,r),n||this.tn.skip(";")},o._parseOptionValue=function(e,n){var r=this.tn.peek();if("{"!==r)i(e.options,n,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+n+"."+r);this.tn.omit(":")?i(e.options,n+"."+r,this._readValue(!0)):this._parseOptionValue(e,n+"."+r)}},o._parseService=function(e){var n,r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal service name at line "+this.tn.line+": "+r);for(n={name:r,rpc:{},options:{}},this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if("rpc"!==r)throw Error("illegal service token: "+r);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},o._parseServiceRPC=function(e){var n,r,i="rpc",s=this.tn.next();if(!t.NAME.test(s))throw Error("illegal rpc service method name: "+s);if(n=s,r={request:null,response:null,request_stream:!1,response_stream:!1,options:{}},this.tn.skip("("),"stream"===(s=this.tn.next()).toLowerCase()&&(r.request_stream=!0,s=this.tn.next()),!t.TYPEREF.test(s))throw Error("illegal rpc service request type: "+s);if(r.request=s,this.tn.skip(")"),"returns"!==(s=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+s);if(this.tn.skip("("),"stream"===(s=this.tn.next()).toLowerCase()&&(r.response_stream=!0,s=this.tn.next()),r.response=s,this.tn.skip(")"),"{"===(s=this.tn.peek())){for(this.tn.next();"}"!==(s=this.tn.next());){if("option"!==s)throw Error("illegal rpc service token: "+s);this._parseOption(r)}this.tn.omit(";")}else this.tn.skip(";");void 0===e[i]&&(e[i]={}),e[i][n]=r},o._parseMessage=function(e,r){var i=!!r,s=this.tn.next(),o={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(s))throw Error("illegal "+(i?"group":"message")+" name: "+s);for(o.name=s,i&&(this.tn.skip("="),r.id=n(this.tn.next()),o.isGroup=!0),"["===(s=this.tn.peek())&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(s=this.tn.next());)if(t.RULE.test(s))this._parseMessageField(o,s);else if("oneof"===s)this._parseMessageOneOf(o);else if("enum"===s)this._parseEnum(o);else if("message"===s)this._parseMessage(o);else if("option"===s)this._parseOption(o);else if("service"===s)this._parseService(o);else if("extensions"===s)o.extensions=this._parseExtensionRanges();else if("reserved"===s)this._parseIgnored();else if("extend"===s)this._parseExtend(o);else{if(!t.TYPEREF.test(s))throw Error("illegal message token: "+s);if(!this.proto3)throw Error("illegal field rule: "+s);this._parseMessageField(o,"optional",s)}return this.tn.omit(";"),e.messages.push(o),o},o._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},o._parseMessageField=function(e,r,i){var s,o,a;if(!t.RULE.test(r))throw Error("illegal message field rule: "+r);if(s={rule:r,type:"",name:"",options:{},id:0},"map"===r){if(i)throw Error("illegal type: "+i);if(this.tn.skip("<"),o=this.tn.next(),!t.TYPE.test(o)&&!t.TYPEREF.test(o))throw Error("illegal message field type: "+o);if(s.keytype=o,this.tn.skip(","),o=this.tn.next(),!t.TYPE.test(o)&&!t.TYPEREF.test(o))throw Error("illegal message field: "+o);if(s.type=o,this.tn.skip(">"),o=this.tn.next(),!t.NAME.test(o))throw Error("illegal message field name: "+o);s.name=o,this.tn.skip("="),s.id=n(this.tn.next()),"["===(o=this.tn.peek())&&this._parseFieldOptions(s),this.tn.skip(";")}else if("group"===(i=void 0!==i?i:this.tn.next())){if(a=this._parseMessage(e,s),!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);s.type=a.name,s.name=a.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field type: "+i);if(s.type=i,o=this.tn.next(),!t.NAME.test(o))throw Error("illegal message field name: "+o);s.name=o,this.tn.skip("="),s.id=n(this.tn.next()),"["===(o=this.tn.peek())&&this._parseFieldOptions(s),this.tn.skip(";")}return e.fields.push(s),s},o._parseMessageOneOf=function(e){var n,r,i,s=this.tn.next();if(!t.NAME.test(s))throw Error("illegal oneof name: "+s);for(r=s,i=[],this.tn.skip("{");"}"!==(s=this.tn.next());)(n=this._parseMessageField(e,"optional",s)).oneof=r,i.push(n.id);this.tn.omit(";"),e.oneofs[r]=i},o._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},o._parseEnum=function(e){var r,i={name:"",values:[],options:{}},s=this.tn.next();if(!t.NAME.test(s))throw Error("illegal name: "+s);for(i.name=s,this.tn.skip("{");"}"!==(s=this.tn.next());)if("option"===s)this._parseOption(i);else{if(!t.NAME.test(s))throw Error("illegal name: "+s);this.tn.skip("="),r={name:s,id:n(this.tn.next(),!0)},"["===(s=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),i.values.push(r)}this.tn.omit(";"),e.enums.push(i)},o._parseExtensionRanges=function(){var t,n,i,s=[];do{for(n=[];;){switch(t=this.tn.next()){case"min":i=e.ID_MIN;break;case"max":i=e.ID_MAX;break;default:i=r(t)}if(n.push(i),2===n.length)break;if("to"!==this.tn.peek()){n.push(i);break}this.tn.next()}s.push(n)}while(this.tn.omit(","));return this.tn.skip(";"),s},o._parseExtend=function(e){var n,r=this.tn.next();if(!t.TYPEREF.test(r))throw Error("illegal extend reference: "+r);for(n={ref:r,fields:[]},this.tn.skip("{");"}"!==(r=this.tn.next());)if(t.RULE.test(r))this._parseMessageField(n,r);else{if(!t.TYPEREF.test(r))throw Error("illegal extend token: "+r);if(!this.proto3)throw Error("illegal field rule: "+r);this._parseMessageField(n,"optional",r)}return this.tn.omit(";"),e.messages.push(n),n},o.toString=function(){return"Parser at line "+this.tn.line},a.Parser=s,a}(s,s.Lang),s.Reflect=function(t){function i(e,n){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low==e.low&&e.high==e.high)return new t.Long(e.low,e.high,void 0===n?e.unsigned:n);if("string"==typeof e)return t.Long.fromString(e,n||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,n||!1);throw Error("not convertible to Long")}function s(e,n){var r=n.readVarint32(),i=7&r,o=r>>>3;switch(i){case t.WIRE_TYPES.VARINT:do{r=n.readUint8()}while(128==(128&r));break;case t.WIRE_TYPES.BITS64:n.offset+=8;break;case t.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case t.WIRE_TYPES.STARTGROUP:s(o,n);break;case t.WIRE_TYPES.ENDGROUP:if(o===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+i)}return!0}var o,a,u,c,l,h,f,d,g,p,v,y,m,E,_,T,R={},I=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className},C=I.prototype;return C.fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},C.toString=function(e){return(e?this.className+" ":"")+this.fqn()},C.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},R.T=I,(a=(o=function(e,t,n,r,i){I.call(this,e,t,n),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=i||"proto2"}).prototype=Object.create(I.prototype)).getChildren=function(e){var t,n,r;if(null==(e=e||null))return this.children.slice();for(t=[],n=0,r=this.children.length;r>n;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},a.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof l.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof l.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},a.getChild=function(e){var t,n,r="number"==typeof e?"id":"name";for(t=0,n=this.children.length;n>t;++t)if(this.children[t][r]===e)return this.children[t];return null},a.resolve=function(e,t){var n,r="string"==typeof e?e.split("."):e,i=this,s=0;if(""===r[s]){for(;null!==i.parent;)i=i.parent;s++}do{do{if(!(i instanceof R.Namespace)){i=null;break}if(!((n=i.getChild(r[s]))&&n instanceof R.T&&(!t||n instanceof R.Namespace))){i=null;break}i=n,s++}while(s<r.length);if(null!=i)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=i);return i},a.qn=function(e){var t,n,r=[],i=e;do{r.unshift(i.name),i=i.parent}while(null!==i);for(t=1;t<=r.length;t++)if(n=r.slice(r.length-t),e===this.resolve(n,e instanceof R.Namespace))return n.join(".");return e.fqn()},a.build=function(){var e,t,n,r={},i=this.children;for(t=0,n=i.length;n>t;++t)(e=i[t])instanceof o&&(r[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(r,"$options",{value:this.buildOpt()}),r},a.buildOpt=function(){var e,t,n,r,i={},s=Object.keys(this.options);for(e=0,t=s.length;t>e;++e)n=s[e],r=this.options[s[e]],i[n]=r;return i},a.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},R.Namespace=o,c=(u=function(e,n,r,i){if(this.type=e,this.resolvedType=n,this.isMapKey=r,this.syntax=i,r&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)}).prototype,u.defaultFieldValue=function(e){if("string"==typeof e&&(e=t.TYPES[e]),void 0===e.defaultValue)throw Error("default value for type "+e.name+" is not supported");return e==t.TYPES.bytes?new n(0):e.defaultValue},c.verifyValue=function(n){var s,o,a,u=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof n||n==n&&n%1!=0)&&u(r(n),"not an integer"),n>4294967295?0|n:n;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof n||n==n&&n%1!=0)&&u(r(n),"not an integer"),n<0?n>>>0:n;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return i(n,!1)}catch(e){u(r(n),e.message)}else u(r(n),"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return i(n,!0)}catch(e){u(r(n),e.message)}else u(r(n),"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof n&&u(r(n),"not a boolean"),n;case t.TYPES.float:case t.TYPES.double:return"number"!=typeof n&&u(r(n),"not a number"),n;case t.TYPES.string:return"string"==typeof n||n&&n instanceof String||u(r(n),"not a string"),""+n;case t.TYPES.bytes:return e.isByteBuffer(n)?n:e.wrap(n);case t.TYPES.enum:for(s=this.resolvedType.getChildren(t.Reflect.Enum.Value),a=0;a<s.length;a++){if(s[a].name==n)return s[a].id;if(s[a].id==n)return s[a].id}if("proto3"===this.syntax)return("number"!=typeof n||n==n&&n%1!=0)&&u(r(n),"not an integer"),(n>4294967295||n<0)&&u(r(n),"not in range for uint32"),n;u(n,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(n&&"object"===r(n)||u(r(n),"object expected"),n instanceof this.resolvedType.clazz)return n;if(n instanceof t.Builder.Message){for(a in o={},n)n.hasOwnProperty(a)&&(o[a]=n[a]);n=o}return new this.resolvedType.clazz(n)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+n+" (undefined type "+this.type+")")},c.calculateLength=function(e,r){if(null===r)return 0;var i;switch(this.type){case t.TYPES.int32:return r<0?n.calculateVarint64(r):n.calculateVarint32(r);case t.TYPES.uint32:return n.calculateVarint32(r);case t.TYPES.sint32:return n.calculateVarint32(n.zigZagEncode32(r));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES.float:return 4;case t.TYPES.int64:case t.TYPES.uint64:return n.calculateVarint64(r);case t.TYPES.sint64:return n.calculateVarint64(n.zigZagEncode64(r));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES.enum:return n.calculateVarint32(r);case t.TYPES.double:return 8;case t.TYPES.string:return i=n.calculateUTF8Bytes(r),n.calculateVarint32(i)+i;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return n.calculateVarint32(r.remaining())+r.remaining();case t.TYPES.message:return i=this.resolvedType.calculate(r),n.calculateVarint32(i)+i;case t.TYPES.group:return(i=this.resolvedType.calculate(r))+n.calculateVarint32(e<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},c.encodeValue=function(e,r,i){var s,o;if(null===r)return i;switch(this.type){case t.TYPES.int32:r<0?i.writeVarint64(r):i.writeVarint32(r);break;case t.TYPES.uint32:i.writeVarint32(r);break;case t.TYPES.sint32:i.writeVarint32ZigZag(r);break;case t.TYPES.fixed32:i.writeUint32(r);break;case t.TYPES.sfixed32:i.writeInt32(r);break;case t.TYPES.int64:case t.TYPES.uint64:i.writeVarint64(r);break;case t.TYPES.sint64:i.writeVarint64ZigZag(r);break;case t.TYPES.fixed64:i.writeUint64(r);break;case t.TYPES.sfixed64:i.writeInt64(r);break;case t.TYPES.bool:"string"==typeof r?i.writeVarint32("false"===r.toLowerCase()?0:!!r):i.writeVarint32(r?1:0);break;case t.TYPES.enum:i.writeVarint32(r);break;case t.TYPES.float:i.writeFloat32(r);break;case t.TYPES.double:i.writeFloat64(r);break;case t.TYPES.string:i.writeVString(r);break;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");s=r.offset,i.writeVarint32(r.remaining()),i.append(r),r.offset=s;break;case t.TYPES.message:o=(new n).LE(),this.resolvedType.encode(r,o),i.writeVarint32(o.offset),i.append(o.flip());break;case t.TYPES.group:this.resolvedType.encode(r,i),i.writeVarint32(e<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return i},c.decode=function(e,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,s;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES.enum:return e.readVarint32();case t.TYPES.float:return e.readFloat();case t.TYPES.double:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(s=e.readVarint32(),e.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+e.remaining());return(i=e.clone()).limit=i.offset+s,e.offset+=s,i;case t.TYPES.message:return s=e.readVarint32(),this.resolvedType.decode(e,s);case t.TYPES.group:return this.resolvedType.decode(e,-1,r)}throw Error("[INTERNAL] Illegal decode type")},c.valueFromString=function(e){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(e));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(e);case t.TYPES.bool:return"true"===e;case t.TYPES.string:return this.verifyValue(e);case t.TYPES.bytes:return n.fromBinary(e)}},c.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},R.Element=u,(h=(l=function(e,t,n,r,i,s){o.call(this,e,t,n,r,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null}).prototype=Object.create(o.prototype)).build=function(i){var s,o,a,u;if(this.clazz&&!i)return this.clazz;for(s=function(t,i){function s(e,i,o,a){var u,c,l,h,f,d,g;if(null===e||"object"!==r(e))return a&&a instanceof t.Reflect.Enum&&null!==(u=t.Reflect.Enum.getName(a.object,e))?u:e;if(n.isByteBuffer(e))return i?e.toBase64():e.toBuffer();if(t.Long.isLong(e))return o?e.toString():t.Long.fromValue(e);if(Array.isArray(e))return c=[],e.forEach((function(e,t){c[t]=s(e,i,o,a)})),c;if(c={},e instanceof t.Map){for(h=(l=e.entries()).next();!h.done;h=l.next())c[e.keyElem.valueToString(h.value[0])]=s(h.value[1],i,o,e.valueElem.resolvedType);return c}for(g in f=e.$type,d=void 0,e)e.hasOwnProperty(g)&&(c[g]=f&&(d=f.getChild(g))?s(e[g],i,o,d.resolvedType):s(e[g],i,o));return c}var o,a,u=i.getChildren(t.Reflect.Message.Field),c=i.getChildren(t.Reflect.Message.OneOf),l=function e(s){var o,a,l,h;for(t.Builder.Message.call(this),o=0,a=c.length;a>o;++o)this[c[o].name]=null;for(o=0,a=u.length;a>o;++o)this[(l=u[o]).name]=l.repeated?[]:l.map?new t.Map(l):null,!l.required&&"proto3"!==i.syntax||null===l.defaultValue||(this[l.name]=l.defaultValue);if(arguments.length>0)if(1!==arguments.length||null===s||"object"!==r(s)||!("function"!=typeof s.encode||s instanceof e)||Array.isArray(s)||s instanceof t.Map||n.isByteBuffer(s)||s instanceof ArrayBuffer||t.Long&&s instanceof t.Long)for(o=0,a=arguments.length;a>o;++o)void 0!==(h=arguments[o])&&this.$set(u[o].name,h);else this.$set(s)},h=l.prototype=Object.create(t.Builder.Message.prototype);for(h.add=function(e,n,r){var s=i._fieldsByName[e];if(!r){if(!s)throw Error(this+"#"+e+" is undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));if(!s.repeated)throw Error(this+"#"+e+" is not a repeated field");n=s.verifyValue(n,!0)}return null===this[e]&&(this[e]=[]),this[e].push(n),this},h.$add=h.add,h.set=function(e,n,s){var o,a,u;if(e&&"object"===r(e)){for(o in s=n,e)e.hasOwnProperty(o)&&void 0!==(n=e[o])&&this.$set(o,n,s);return this}if(a=i._fieldsByName[e],s)this[e]=n;else{if(!a)throw Error(this+"#"+e+" is not a field: undefined");if(!(a instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+a.toString(!0));this[a.name]=n=a.verifyValue(n)}return a&&a.oneof&&(u=this[a.oneof.name],null!==n?(null!==u&&u!==a.name&&(this[u]=null),this[a.oneof.name]=a.name):u===e&&(this[a.oneof.name]=null)),this},h.$set=h.set,h.get=function(e,n){if(n)return this[e];var r=i._fieldsByName[e];if(!(r&&r instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(r instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+r.toString(!0));return this[r.name]},h.$get=h.get,o=0;o<u.length;o++)(a=u[o])instanceof t.Reflect.Message.ExtensionField||i.builder.options.populateAccessors&&function(e){var t,n,r,s=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}));s=s.substring(0,1).toUpperCase()+s.substring(1),t=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),n=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},r=function(){return this[e.name]},null===i.getChild("set"+s)&&(h["set"+s]=n),null===i.getChild("set_"+t)&&(h["set_"+t]=n),null===i.getChild("get"+s)&&(h["get"+s]=r),null===i.getChild("get_"+t)&&(h["get_"+t]=r)}(a);return h.encode=function(t,n){var r,s;"boolean"==typeof t&&(n=t,t=void 0),r=!1,t||(t=new e,r=!0),s=t.littleEndian;try{return i.encode(this,t.LE(),n),(r?t.flip():t).LE(s)}catch(e){throw t.LE(s),e}},l.encode=function(e,t,n){return new l(e).encode(t,n)},h.calculate=function(){return i.calculate(this)},h.encodeDelimited=function(e){var t,r=!1;return e||(e=new n,r=!0),t=(new n).LE(),i.encode(this,t).flip(),e.writeVarint32(t.remaining()),e.append(t),r?e.flip():e},h.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},h.toArrayBuffer=h.encodeAB,h.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},h.toBuffer=h.encodeNB,h.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},h.toBase64=h.encode64,h.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},h.toHex=h.encodeHex,h.toRaw=function(e,t){return s(this,!!e,!!t,this.$type)},h.encodeJSON=function(){return JSON.stringify(s(this,!0,!0,this.$type))},l.decode=function(e,t){var r,s;"string"==typeof e&&(e=n.wrap(e,t||"base64")),r=(e=n.isByteBuffer(e)?e:n.wrap(e)).littleEndian;try{return s=i.decode(e.LE()),e.LE(r),s}catch(t){throw e.LE(r),t}},l.decodeDelimited=function(e,t){var r,s,o;if("string"==typeof e&&(e=n.wrap(e,t||"base64")),(e=n.isByteBuffer(e)?e:n.wrap(e)).remaining()<1)return null;if(r=e.offset,s=e.readVarint32(),e.remaining()<s)return e.offset=r,null;try{return o=i.decode(e.slice(e.offset,e.offset+s).LE()),e.offset+=s,o}catch(t){throw e.offset+=s,t}},l.decode64=function(e){return l.decode(e,"base64")},l.decodeHex=function(e){return l.decode(e,"hex")},l.decodeJSON=function(e){return new l(JSON.parse(e))},h.toString=function(){return i.toString()},Object.defineProperty&&(Object.defineProperty(l,"$options",{value:i.buildOpt()}),Object.defineProperty(h,"$options",{value:l.$options}),Object.defineProperty(l,"$type",{value:i}),Object.defineProperty(h,"$type",{value:i})),l}(t,this),this._fields=[],this._fieldsById={},this._fieldsByName={},a=0,u=this.children.length;u>a;a++)if((o=this.children[a])instanceof v||o instanceof l||o instanceof E){if(s.hasOwnProperty(o.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+o.toString(!0)+" cannot override static property '"+o.name+"'");s[o.name]=o.build()}else if(o instanceof l.Field)o.build(),this._fields.push(o),this._fieldsById[o.id]=o,this._fieldsByName[o.name]=o;else if(!(o instanceof l.OneOf||o instanceof m))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[a].toString(!0));return this.clazz=s},h.encode=function(e,t,n){var r,i,s,o,a,u=null;for(s=0,o=this._fields.length;o>s;++s)i=e[(r=this._fields[s]).name],r.required&&null===i?null===u&&(u=r):r.encode(n?i:r.verifyValue(i),t,e);if(null!==u)throw(a=Error("Missing at least one required field for "+this.toString(!0)+": "+u)).encoded=t,a;return t},h.calculate=function(e){for(var t,n,r=0,i=0,s=this._fields.length;s>i;++i){if(n=e[(t=this._fields[i]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},h.decode=function(e,n,r){var i,o,a,u,c,l,h,f,d,g,p,v;for(n="number"==typeof n?n:-1,c=e.offset,l=new this.clazz;e.offset<c+n||-1===n&&e.remaining()>0;){if(a=(i=e.readVarint32())>>>3,(o=7&i)===t.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(u=this._fieldsById[a])u.repeated&&!u.options.packed?l[u.name].push(u.decode(o,e)):u.map?(f=u.decode(o,e),l[u.name].set(f[0],f[1])):(l[u.name]=u.decode(o,e),u.oneof&&(null!==(d=l[u.oneof.name])&&d!==u.name&&(l[d]=null),l[u.oneof.name]=u.name));else switch(o){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:h=e.readVarint32(),e.offset+=h;break;case t.WIRE_TYPES.STARTGROUP:for(;s(a,e););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+o)}}for(g=0,p=this._fields.length;p>g;++g)if(null===l[(u=this._fields[g]).name])if("proto3"===this.syntax)l[u.name]=u.defaultValue;else{if(u.required)throw(v=Error("Missing at least one required field for "+this.toString(!0)+": "+u.name)).decoded=l,v;t.populateDefaults&&null!==u.defaultValue&&(l[u.name]=u.defaultValue)}return l},R.Message=l,(d=(f=function(e,n,r,i,s,o,a,u,c,h){I.call(this,e,n,o),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=i||null,this.type=s,this.resolvedType=null,this.id=a,this.options=u||{},this.defaultValue=null,this.oneof=c||null,this.syntax=h||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof l.ExtensionField||(this.name=t.Util.toCamelCase(this.name))}).prototype=Object.create(I.prototype)).build=function(){this.element=new u(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new u(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=u.defaultFieldValue(this.type)},d.verifyValue=function(e,n){var i,s,o;if(n=n||!1,i=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this),null===e)return this.required&&i(r(e),"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&i(r(e),"proto3 field without field presence cannot be null"),null;if(this.repeated&&!n){for(Array.isArray(e)||(e=[e]),o=[],s=0;s<e.length;s++)o.push(this.element.verifyValue(e[s]));return o}return this.map&&!n?e instanceof t.Map?e:(e instanceof Object||i(r(e),"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&i(r(e),"no array expected"),this.element.verifyValue(e))},d.hasWirePresence=function(e,n){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES.float:case t.TYPES.double:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES.enum:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},d.encode=function(e,i,s){var o,a,u,c,l;if(null===this.type||"object"!==r(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return i;try{if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(i.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i.ensureCapacity(i.offset+=1),a=i.offset,o=0;o<e.length;o++)this.element.encodeValue(this.id,e[o],i);u=i.offset-a,(c=n.calculateVarint32(u))>1&&(l=i.slice(a,i.offset),a+=c-1,i.offset=a,i.append(l)),i.writeVarint32(u,a-c)}else for(o=0;o<e.length;o++)i.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e[o],i);else this.map?e.forEach((function(e,r){var s=n.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+n.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);i.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i.writeVarint32(s),i.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,r,i),i.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,e,i)}),this):this.hasWirePresence(e,s)&&(i.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e,i))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+e+" ("+t+")")}return i},d.calculate=function(e,i){var s,o,a;if(e=this.verifyValue(e),null===this.type||"object"!==r(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return 0;s=0;try{if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(s+=n.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),a=0,o=0;o<e.length;o++)a+=this.element.calculateLength(this.id,e[o]);s+=n.calculateVarint32(a),s+=a}else for(o=0;o<e.length;o++)s+=n.calculateVarint32(this.id<<3|this.type.wireType),s+=this.element.calculateLength(this.id,e[o]);else this.map?e.forEach((function(e,r){var i=n.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+n.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);s+=n.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),s+=n.calculateVarint32(i),s+=i}),this):this.hasWirePresence(e,i)&&(s+=n.calculateVarint32(this.id<<3|this.type.wireType),s+=this.element.calculateLength(this.id,e))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+e+" ("+t+")")}return s},d.decode=function(e,n,r){var i,s,o,a,c,l,h;if(!(!this.map&&e==this.type.wireType||!r&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){for(s=n.readVarint32(),s=n.offset+s,o=[];n.offset<s;)o.push(this.decode(this.type.wireType,n,!0));return o}if(this.map){if(a=u.defaultFieldValue(this.keyType),i=u.defaultFieldValue(this.type),s=n.readVarint32(),n.remaining()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+n.remaining());for((c=n.clone()).limit=c.offset+s,n.offset+=s;c.remaining()>0;)if(e=7&(l=c.readVarint32()),1==(h=l>>>3))a=this.keyElement.decode(c,e,h);else{if(2!==h)throw Error("Unexpected tag in map field key/value submessage");i=this.element.decode(c,e,h)}return[a,i]}return this.element.decode(n,e,this.id)},R.Message.Field=f,(g=function(e,t,n,r,i,s,o){f.call(this,e,t,n,null,r,i,s,o),this.extension}).prototype=Object.create(f.prototype),R.Message.ExtensionField=g,p=function(e,t,n){I.call(this,e,t,n),this.fields=[]},R.Message.OneOf=p,(v=function(e,t,n,r,i){o.call(this,e,t,n,r,i),this.className="Enum",this.object=null}).getName=function(e,t){var n,r,i=Object.keys(e);for(r=0;r<i.length;++r)if(e[n=i[r]]===t)return n;return null},(v.prototype=Object.create(o.prototype)).build=function(e){var n,r,i,s;if(this.object&&!e)return this.object;for(n=new t.Builder.Enum,i=0,s=(r=this.getChildren(v.Value)).length;s>i;++i)n[r[i].name]=r[i].id;return Object.defineProperty&&Object.defineProperty(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},R.Enum=v,(y=function(e,t,n,r){I.call(this,e,t,n),this.className="Enum.Value",this.id=r}).prototype=Object.create(I.prototype),R.Enum.Value=y,(m=function(e,t,n,r){I.call(this,e,t,n),this.field=r}).prototype=Object.create(I.prototype),R.Extension=m,((E=function(e,t,n,r){o.call(this,e,t,n,r),this.className="Service",this.clazz=null}).prototype=Object.create(o.prototype)).build=function(e){return this.clazz&&!e?this.clazz:this.clazz=function(e,t){var i,s=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},o=s.prototype=Object.create(e.Builder.Service.prototype),a=t.getChildren(e.Reflect.Service.RPCMethod);for(i=0;i<a.length;i++)!function(e){o[e.name]=function(i,s){try{try{i=e.resolvedRequestType.clazz.decode(n.wrap(i))}catch(e){if(!(e instanceof TypeError))throw e}if(null===i||"object"!==r(i))throw Error("Illegal arguments");i instanceof e.resolvedRequestType.clazz||(i=new e.resolvedRequestType.clazz(i)),this.rpcImpl(e.fqn(),i,(function(n,r){if(!n){try{r=e.resolvedResponseType.clazz.decode(r)}catch(e){}return r&&r instanceof e.resolvedResponseType.clazz?void s(null,r):void s(Error("Illegal response type received in service method "+t.name+"#"+e.name))}s(n)}))}catch(e){setTimeout(s.bind(this,e),0)}},s[e.name]=function(t,n,r){new s(t)[e.name](n,r)},Object.defineProperty&&(Object.defineProperty(s[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(o[e.name],"$options",{value:s[e.name].$options}))}(a[i]);return Object.defineProperty&&(Object.defineProperty(s,"$options",{value:t.buildOpt()}),Object.defineProperty(o,"$options",{value:s.$options}),Object.defineProperty(s,"$type",{value:t}),Object.defineProperty(o,"$type",{value:t})),s}(t,this)},R.Service=E,((_=function(e,t,n,r){I.call(this,e,t,n),this.className="Service.Method",this.options=r||{}}).prototype=Object.create(I.prototype)).buildOpt=a.buildOpt,R.Service.Method=_,(T=function(e,t,n,r,i,s,o,a){_.call(this,e,t,n,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=s,this.responseStream=o,this.resolvedRequestType=null,this.resolvedResponseType=null}).prototype=Object.create(_.prototype),R.Service.RPCMethod=T,R}(s),s.Builder=function(e,t,n){function i(e){e.messages&&e.messages.forEach((function(t){t.syntax=e.syntax,i(t)})),e.enums&&e.enums.forEach((function(t){t.syntax=e.syntax}))}var s=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},o=s.prototype;return s.isMessage=function(e){return"string"==typeof e.name&&void 0===e.values&&void 0===e.rpc},s.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},s.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},s.isService=function(e){return!("string"!=typeof e.name||"object"!==r(e.rpc)||!e.rpc)},s.isExtend=function(e){return"string"==typeof e.ref},o.reset=function(){return this.ptr=this.ns,this},o.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},o.create=function(t){var i,o,a,u,c;if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(i=[t];i.length>0;){if(t=i.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){if(o=t.shift(),s.isMessage(o)){if(a=new n.Message(this,this.ptr,o.name,o.options,o.isGroup,o.syntax),u={},o.oneofs&&Object.keys(o.oneofs).forEach((function(e){a.addChild(u[e]=new n.Message.OneOf(this,a,e))}),this),o.fields&&o.fields.forEach((function(e){if(null!==a.getChild(0|e.id))throw Error("duplicate or invalid field id in "+a.name+": "+e.id);if(e.options&&"object"!==r(e.options))throw Error("illegal field options in "+a.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=u[e.oneof]))throw Error("illegal oneof in "+a.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,a,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,o.syntax),t&&t.fields.push(e),a.addChild(e)}),this),c=[],o.enums&&o.enums.forEach((function(e){c.push(e)})),o.messages&&o.messages.forEach((function(e){c.push(e)})),o.services&&o.services.forEach((function(e){c.push(e)})),o.extensions&&(a.extensions="number"==typeof o.extensions[0]?[o.extensions]:o.extensions),this.ptr.addChild(a),c.length>0){i.push(t),t=c,c=null,this.ptr=a,a=null;continue}c=null}else if(s.isEnum(o))a=new n.Enum(this,this.ptr,o.name,o.options,o.syntax),o.values.forEach((function(e){a.addChild(new n.Enum.Value(this,a,e.name,e.id))}),this),this.ptr.addChild(a);else if(s.isService(o))a=new n.Service(this,this.ptr,o.name,o.options),Object.keys(o.rpc).forEach((function(e){var t=o.rpc[e];a.addChild(new n.Service.RPCMethod(this,a,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(a);else{if(!s.isExtend(o))throw Error("not a valid definition: "+JSON.stringify(o));if(a=this.ptr.resolve(o.ref,!0))o.fields.forEach((function(t){var r,i,s,o;if(null!==a.getChild(0|t.id))throw Error("duplicate extended field id in "+a.name+": "+t.id);if(a.extensions&&(r=!1,a.extensions.forEach((function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)})),!r))throw Error("illegal extended field id in "+a.name+": "+t.id+" (not within valid ranges)");i=t.name,this.options.convertFieldsToCamelCase&&(i=e.Util.toCamelCase(i)),s=new n.Message.ExtensionField(this,a,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),o=new n.Extension(this,this.ptr,t.name,s),s.extension=o,this.ptr.addChild(o),a.addChild(s)}),this);else if(!/\.?google\.protobuf\./.test(o.ref))throw Error("extended message "+o.ref+" is not defined")}o=null,a=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},o.import=function(t,n){var s,o,a,u,c,l,h,f,d="/";if("string"==typeof n){if(e.Util.IS_NODE,!0===this.files[n])return this.reset();this.files[n]=!0}else if("object"===r(n)){if(s=n.root,e.Util.IS_NODE,(s.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(d="\\"),o=s+d+n.file,!0===this.files[o])return this.reset();this.files[o]=!0}if(t.imports&&t.imports.length>0){for(u=!1,"object"===r(n)?(this.importRoot=n.root,u=!0,a=this.importRoot,n=n.file,(a.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(d="\\")):"string"==typeof n?this.importRoot?a=this.importRoot:n.indexOf("/")>=0?""===(a=n.replace(/\/[^\/]*$/,""))&&(a="/"):n.indexOf("\\")>=0?(a=n.replace(/\\[^\\]*$/,""),d="\\"):a=".":a=null,c=0;c<t.imports.length;c++)if("string"==typeof t.imports[c]){if(!a)throw Error("cannot determine import root");if("google/protobuf/descriptor.proto"===(l=t.imports[c]))continue;if(l=a+d+l,!0===this.files[l])continue;if(/\.proto$/i.test(l)&&!e.DotProto&&(l=l.replace(/\.proto$/,".json")),null===(h=e.Util.fetch(l)))throw Error("failed to import '"+l+"' in '"+n+"': file not found");/\.json$/i.test(l)?this.import(JSON.parse(h+""),l):this.import(e.DotProto.Parser.parse(h),l)}else n?/\.(\w+)$/.test(n)?this.import(t.imports[c],n.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+c+"."+n}))):this.import(t.imports[c],n+"_import"+c):this.import(t.imports[c]);u&&(this.importRoot=null)}return t.package&&this.define(t.package),t.syntax&&i(t),f=this.ptr,t.options&&Object.keys(t.options).forEach((function(e){f.options[e]=t.options[e]})),t.messages&&(this.create(t.messages),this.ptr=f),t.enums&&(this.create(t.enums),this.ptr=f),t.services&&(this.create(t.services),this.ptr=f),t.extends&&this.create(t.extends),this.reset()},o.resolveAll=function(){var i;if(null==this.ptr||"object"===r(this.ptr.type))return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(i=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=i,i instanceof n.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==i.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(i instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=i.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((i=this.ptr.parent.resolve(this.ptr.requestName,!0))&&i instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=i,!((i=this.ptr.parent.resolve(this.ptr.responseName,!0))&&i instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=i}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+r(this.ptr)+": "+this.ptr);return this.reset()},o.build=function(e){var t,n,r;if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},o.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},o.toString=function(){return"Builder"},s.Message=function(){},s.Enum=function(){},s.Service=function(){},s}(s,s.Lang,s.Reflect),s.Map=function(e,t){function n(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var r=function(e,n){var r,i,s,o;if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),n)for(r=Object.keys(n),i=0;i<r.length;i++)s=this.keyElem.valueFromString(r[i]),o=this.valueElem.verifyValue(n[r[i]]),this.map[this.keyElem.valueToString(s)]={key:s,value:o}},i=r.prototype;return i.clear=function(){this.map={}},i.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},i.entries=function(){var e,t,r=[],i=Object.keys(this.map);for(t=0;t<i.length;t++)r.push([(e=this.map[i[t]]).key,e.value]);return n(r)},i.keys=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].key);return n(t)},i.values=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].value);return n(t)},i.forEach=function(e,t){var n,r,i=Object.keys(this.map);for(r=0;r<i.length;r++)e.call(t,(n=this.map[i[r]]).value,n.key,this)},i.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},i.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map?this.map[t].value:void 0},i.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},r}(0,s.Reflect),s.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),s.loadJson(s.DotProto.Parser.parse(e),t,n)},s.protoFromString=s.loadProto,s.loadProtoFile=function(e,t,n){if(t&&"object"===r(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return s.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,s.loadProto(r,n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var i=s.Util.fetch("object"===r(e)?e.root+"/"+e.file:e);return null===i?null:s.loadProto(i,n,e)},s.protoFromFile=s.loadProtoFile,s.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=s.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=s.populateAccessors),new s.Builder(e)},s.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"===r(t)||(t=s.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},s.loadJsonFile=function(e,t,n){if(t&&"object"===r(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return s.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,s.loadJson(JSON.parse(r),n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var i=s.Util.fetch("object"===r(e)?e.root+"/"+e.file:e);return null===i?null:s.loadJson(JSON.parse(i),n,e)},i=qh,s.loadProto(i,void 0,"").build("Modules").probuf}(function(e){function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function n(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+u.apply(String,e):(e.length+arguments.length>1024&&(t.push(u.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}function i(e,t,n,r,i){var s,o,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,s=d&(1<<-l)-1,d>>=-l,l+=a;l>0;s=256*s+e[t+h],h+=f,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=r;l>0;o=256*o+e[t+h],h+=f,l-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),s-=c}return(d?-1:1)*o*Math.pow(2,s-r)}function s(e,t,n,r,i,s){var o,a,u,c=8*s-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,g=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(a=0,o=l):o+h>=1?(a=(t*u-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+d]=255&a,d+=g,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[n+d]=255&o,d+=g,o/=256,c-=8);e[n+d-g]|=128*p}var o,a,u,c,l,h=function e(t,n,r){if(void 0===t&&(t=e.DEFAULT_CAPACITY),void 0===n&&(n=e.DEFAULT_ENDIAN),void 0===r&&(r=e.DEFAULT_NOASSERT),!r){if((t|=0)<0)throw RangeError("Illegal capacity");n=!!n,r=!!r}this.buffer=0===t?a:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=n,this.noAssert=r};return h.VERSION="5.0.1",h.LITTLE_ENDIAN=!0,h.BIG_ENDIAN=!1,h.DEFAULT_CAPACITY=16,h.DEFAULT_ENDIAN=h.BIG_ENDIAN,h.DEFAULT_NOASSERT=!1,h.Long=e||null,(o=h.prototype).__isByteBuffer__,Object.defineProperty(o,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1}),a=new ArrayBuffer(0),u=String.fromCharCode,h.accessor=function(){return Uint8Array},h.allocate=function(e,t,n){return new h(e,t,n)},h.concat=function(e,t,n,r){var i,s,o,a,u,c;for(("boolean"==typeof t||"string"!=typeof t)&&(r=n,n=t,t=void 0),i=0,o=0,a=e.length;a>o;++o)h.isByteBuffer(e[o])||(e[o]=h.wrap(e[o],t)),(s=e[o].limit-e[o].offset)>0&&(i+=s);if(0===i)return new h(0,n,r);for(c=new h(i,n,r),o=0;a>o;)(s=(u=e[o++]).limit-u.offset)<=0||(c.view.set(u.view.subarray(u.offset,u.limit),c.offset),c.offset+=s);return c.limit=c.offset,c.offset=0,c},h.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},h.type=function(){return ArrayBuffer},h.wrap=function(e,t,n,i){var s,a;if("string"!=typeof t&&(i=n,n=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return h.fromBase64(e,n);case"hex":return h.fromHex(e,n);case"binary":return h.fromBinary(e,n);case"utf8":return h.fromUTF8(e,n);case"debug":return h.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!==r(e))throw TypeError("Illegal buffer");if(h.isByteBuffer(e))return(s=o.clone.call(e)).markedOffset=-1,s;if(e instanceof Uint8Array)s=new h(0,n,i),e.length>0&&(s.buffer=e.buffer,s.offset=e.byteOffset,s.limit=e.byteOffset+e.byteLength,s.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)s=new h(0,n,i),e.byteLength>0&&(s.buffer=e,s.offset=0,s.limit=e.byteLength,s.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");for((s=new h(e.length,n,i)).limit=e.length,a=0;a<e.length;++a)s.view[a]=e[a]}return s},o.writeBitSet=function(e,t){var n,r,i,s,o,a,u=void 0===t;if(u&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for(r=t,s=(i=e.length)>>3,o=0,t+=this.writeVarint32(i,t);s--;)n=1&!!e[o++]|(1&!!e[o++])<<1|(1&!!e[o++])<<2|(1&!!e[o++])<<3|(1&!!e[o++])<<4|(1&!!e[o++])<<5|(1&!!e[o++])<<6|(1&!!e[o++])<<7,this.writeByte(n,t++);if(i>o){for(a=0,n=0;i>o;)n|=(1&!!e[o++])<<a++;this.writeByte(n,t++)}return u?(this.offset=t,this):t-r},o.readBitSet=function(e){var t,n,r,i,s,o,a,u=void 0===e;for(u&&(e=this.offset),i=(r=(n=this.readVarint32(e)).value)>>3,s=0,o=[],e+=n.length;i--;)t=this.readByte(e++),o[s++]=!!(1&t),o[s++]=!!(2&t),o[s++]=!!(4&t),o[s++]=!!(8&t),o[s++]=!!(16&t),o[s++]=!!(32&t),o[s++]=!!(64&t),o[s++]=!!(128&t);if(r>s)for(a=0,t=this.readByte(e++);r>s;)o[s++]=!!(1&t>>a++);return u&&(this.offset=e),o},o.readBytes=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}return n=this.slice(t,t+e),r&&(this.offset+=e),n},o.writeBytes=o.append,o.writeInt8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},o.writeByte=o.writeInt8,o.readInt8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return 128==(128&(t=this.view[e]))&&(t=-(255-t+1)),n&&(this.offset+=1),t},o.readByte=o.readInt8,o.writeUint8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},o.writeUInt8=o.writeUint8,o.readUint8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=this.view[e],n&&(this.offset+=1),t},o.readUInt8=o.readUint8,o.writeInt16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},o.writeShort=o.writeInt16,o.readInt16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),32768==(32768&t)&&(t=-(65535-t+1)),n&&(this.offset+=2),t},o.readShort=o.readInt16,o.writeUint16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},o.writeUInt16=o.writeUint16,o.readUint16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),n&&(this.offset+=2),t},o.readUInt16=o.readUint16,o.writeInt32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},o.writeInt=o.writeInt32,o.readInt32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),t|=0,n&&(this.offset+=4),t},o.readInt=o.readInt32,o.writeUint32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},o.writeUInt32=o.writeUint32,o.readUint32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),n&&(this.offset+=4),t},o.readUInt32=o.readUint32,e&&(o.writeInt64=function(t,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,s=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&s>>>24,this.view[n+2]=255&s>>>16,this.view[n+1]=255&s>>>8,this.view[n]=255&s):(this.view[n]=255&s>>>24,this.view[n+1]=255&s>>>16,this.view[n+2]=255&s>>>8,this.view[n+3]=255&s,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),o&&(this.offset+=8),this},o.writeLong=o.writeInt64,o.readInt64=function(t){var n,r,i,s=void 0===t;if(s&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!1),s&&(this.offset+=8),i},o.readLong=o.readInt64,o.writeUint64=function(t,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,s=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&s>>>24,this.view[n+2]=255&s>>>16,this.view[n+1]=255&s>>>8,this.view[n]=255&s):(this.view[n]=255&s>>>24,this.view[n+1]=255&s>>>16,this.view[n+2]=255&s>>>8,this.view[n+3]=255&s,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),o&&(this.offset+=8),this},o.writeUInt64=o.writeUint64,o.readUint64=function(t){var n,r,i,s=void 0===t;if(s&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!0),s&&(this.offset+=8),i},o.readUInt64=o.readUint64),o.writeFloat32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,s(this.view,e,t,this.littleEndian,23,4),r&&(this.offset+=4),this},o.writeFloat=o.writeFloat32,o.readFloat32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=i(this.view,e,this.littleEndian,23,4),n&&(this.offset+=4),t},o.readFloat=o.readFloat32,o.writeFloat64=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=8)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=8,s(this.view,e,t,this.littleEndian,52,8),r&&(this.offset+=8),this},o.writeDouble=o.writeFloat64,o.readFloat64=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return t=i(this.view,e,this.littleEndian,52,8),n&&(this.offset+=8),t},o.readDouble=o.readFloat64,h.MAX_VARINT32_BYTES=5,h.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:1<<21>e?3:1<<28>e?4:5},h.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},h.zigZagDecode32=function(e){return 0|e>>>1^-(1&e)},o.writeVarint32=function(e,t){var n,r,i,s=void 0===t;if(s&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for((t+=r=h.calculateVarint32(e))>(i=this.buffer.byteLength)&&this.resize((i*=2)>t?i:t),t-=r,e>>>=0;e>=128;)n=128|127&e,this.view[t++]=n,e>>>=7;return this.view[t++]=e,s?(this.offset=t,this):r},o.writeVarint32ZigZag=function(e,t){return this.writeVarint32(h.zigZagEncode32(e),t)},o.readVarint32=function(e){var t,n,r,i,s=void 0===e;if(s&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}n=0,r=0;do{if(!this.noAssert&&e>this.limit)throw(i=Error("Truncated")).truncated=!0,i;t=this.view[e++],n<5&&(r|=(127&t)<<7*n),++n}while(0!=(128&t));return r|=0,s?(this.offset=e,r):{value:r,length:n}},o.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"===r(t)?t.value=h.zigZagDecode32(t.value):t=h.zigZagDecode32(t),t},e&&(h.MAX_VARINT64_BYTES=10,h.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?n<16384?n<128?1:2:1<<21>n?3:4:r<16384?r<128?5:6:1<<21>r?7:8:i<128?9:10},h.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},h.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},o.writeVarint64=function(t,n){var r,i,s,o,a,u=void 0===n;if(u&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}switch("number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),r=h.calculateVarint64(t),i=t.toInt()>>>0,s=t.shiftRightUnsigned(28).toInt()>>>0,o=t.shiftRightUnsigned(56).toInt()>>>0,(n+=r)>(a=this.buffer.byteLength)&&this.resize((a*=2)>n?a:n),n-=r,r){case 10:this.view[n+9]=1&o>>>7;case 9:this.view[n+8]=9!==r?128|o:127&o;case 8:this.view[n+7]=8!==r?128|s>>>21:127&s>>>21;case 7:this.view[n+6]=7!==r?128|s>>>14:127&s>>>14;case 6:this.view[n+5]=6!==r?128|s>>>7:127&s>>>7;case 5:this.view[n+4]=5!==r?128|s:127&s;case 4:this.view[n+3]=4!==r?128|i>>>21:127&i>>>21;case 3:this.view[n+2]=3!==r?128|i>>>14:127&i>>>14;case 2:this.view[n+1]=2!==r?128|i>>>7:127&i>>>7;case 1:this.view[n]=1!==r?128|i:127&i}return u?(this.offset+=r,this):r},o.writeVarint64ZigZag=function(e,t){return this.writeVarint64(h.zigZagEncode64(e),t)},o.readVarint64=function(t){var n,r,i,s,o,a,u=void 0===t;if(u&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}if(n=t,r=0,i=0,s=0,o=0,r=127&(o=this.view[t++]),128&o&&(r|=(127&(o=this.view[t++]))<<7,(128&o||this.noAssert&&void 0===o)&&(r|=(127&(o=this.view[t++]))<<14,(128&o||this.noAssert&&void 0===o)&&(r|=(127&(o=this.view[t++]))<<21,(128&o||this.noAssert&&void 0===o)&&(i=127&(o=this.view[t++]),(128&o||this.noAssert&&void 0===o)&&(i|=(127&(o=this.view[t++]))<<7,(128&o||this.noAssert&&void 0===o)&&(i|=(127&(o=this.view[t++]))<<14,(128&o||this.noAssert&&void 0===o)&&(i|=(127&(o=this.view[t++]))<<21,(128&o||this.noAssert&&void 0===o)&&(s=127&(o=this.view[t++]),(128&o||this.noAssert&&void 0===o)&&(s|=(127&(o=this.view[t++]))<<7,128&o||this.noAssert&&void 0===o))))))))))throw Error("Buffer overrun");return a=e.fromBits(r|i<<28,i>>>4|s<<24,!1),u?(this.offset=t,a):{value:a,length:t-n}},o.readVarint64ZigZag=function(t){var n=this.readVarint64(t);return n&&n.value instanceof e?n.value=h.zigZagDecode64(n.value):n=h.zigZagDecode64(n),n}),o.writeCString=function(e,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),i=e.length,!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;i>r;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=l.calculateUTF16asUTF8(t(e))[1],n+=i+1,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=i+1,l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),this.view[n++]=0,o?(this.offset=n,this):i},o.readCString=function(e){var t,r,i,s=void 0===e;if(s&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,i=-1,l.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view[e++])?null:i}.bind(this),r=n(),!0),s?(this.offset=e,r()):{string:r(),length:e-t}},o.writeIString=function(e,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(i=n,r=l.calculateUTF16asUTF8(t(e),this.noAssert)[1],n+=4+r,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=4+r,this.littleEndian?(this.view[n+3]=255&r>>>24,this.view[n+2]=255&r>>>16,this.view[n+1]=255&r>>>8,this.view[n]=255&r):(this.view[n]=255&r>>>24,this.view[n+1]=255&r>>>16,this.view[n+2]=255&r>>>8,this.view[n+3]=255&r),n+=4,l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==i+4+r)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+4+r));return o?(this.offset=n,this):n-i},o.readIString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=e,n=this.readUint32(e),r=this.readUTF8String(n,h.METRICS_BYTES,e+=4),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},h.METRICS_CHARS="c",h.METRICS_BYTES="b",o.writeUTF8String=function(e,n){var r,i,s,o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=n,r=l.calculateUTF16asUTF8(t(e))[1],n+=r,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=r,l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),o?(this.offset=n,this):n-i},o.writeString=o.writeUTF8String,h.calculateUTF8Chars=function(e){return l.calculateUTF16asUTF8(t(e))[0]},h.calculateString=h.calculateUTF8Bytes=function(e){return l.calculateUTF16asUTF8(t(e))[1]},o.readUTF8String=function(e,t,r){var i,s,o,a,u;if("number"==typeof t&&(r=t,t=void 0),(i=void 0===r)&&(r=this.offset),void 0===t&&(t=h.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}if(o=0,a=r,t===h.METRICS_CHARS){if(s=n(),l.decodeUTF8(function(){return e>o&&r<this.limit?this.view[r++]:null}.bind(this),(function(e){++o,l.UTF8toUTF16(e,s)})),o!==e)throw RangeError("Illegal range: Truncated data, "+o+" == "+e);return i?(this.offset=r,s()):{string:s(),length:r-a}}if(t===h.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}if(u=r+e,l.decodeUTF8toUTF16(function(){return u>r?this.view[r++]:null}.bind(this),s=n(),this.noAssert),r!==u)throw RangeError("Illegal range: Truncated data, "+r+" == "+u);return i?(this.offset=r,s()):{string:s(),length:r-a}}throw TypeError("Unsupported metrics: "+t)},o.readString=o.readUTF8String,o.writeVString=function(e,n){var r,i,s,o,a=void 0===n;if(a&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(s=n,r=l.calculateUTF16asUTF8(t(e),this.noAssert)[1],i=h.calculateVarint32(r),n+=i+r,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=i+r,n+=this.writeVarint32(r,n),l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==s+r+i)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+r+i));return a?(this.offset=n,this):n-s},o.readVString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,n=this.readVarint32(e),r=this.readUTF8String(n.value,h.METRICS_BYTES,e+=n.length),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},o.append=function(e,t,n){var r,i,s;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof h||(e=h.wrap(e,t)),(i=e.limit-e.offset)<=0||((n+=i)>(s=this.buffer.byteLength)&&this.resize((s*=2)>n?s:n),n-=i,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=i,r&&(this.offset+=i)),this},o.appendTo=function(e,t){return e.append(this,t),this},o.assert=function(e){return this.noAssert=!e,this},o.capacity=function(){return this.buffer.byteLength},o.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},o.clone=function(e){var t=new h(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},o.compact=function(e,t){var n,r,i;if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return 0===e&&t===this.buffer.byteLength?this:0==(n=t-e)?(this.buffer=a,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this):(r=new ArrayBuffer(n),(i=new Uint8Array(r)).set(this.view.subarray(e,t)),this.buffer=r,this.view=i,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this)},o.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new h(0,this.littleEndian,this.noAssert);var n=t-e,r=new h(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,r.markedOffset>=0&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},o.copyTo=function(e,t,n,r){var i,s,o;if(!this.noAssert&&!h.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(s=void 0===t)?e.offset:0|t,n=(i=void 0===n)?this.offset:0|n,r=void 0===r?this.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);return 0==(o=r-n)?e:(e.ensureCapacity(t+o),e.view.set(this.view.subarray(n,r),t),i&&(this.offset+=o),s&&(e.offset+=o),this)},o.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},o.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;n>t;)this.view[t++]=e;return r&&(this.offset=t),this},o.flip=function(){return this.limit=this.offset,this.offset=0,this},o.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},o.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},o.LE=function(e){return this.littleEndian=void 0===e||!!e,this},o.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},o.prepend=function(e,t,n){var r,i,s,o,a;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof h||(e=h.wrap(e,t)),(i=e.limit-e.offset)<=0||((s=i-n)>0?(o=new ArrayBuffer(this.buffer.byteLength+s),(a=new Uint8Array(o)).set(this.view.subarray(n,this.buffer.byteLength),i),this.buffer=o,this.view=a,this.offset+=s,this.markedOffset>=0&&(this.markedOffset+=s),this.limit+=s,n+=s):new Uint8Array(this.buffer),this.view.set(e.view.subarray(e.offset,e.limit),n-i),e.offset=e.limit,r&&(this.offset-=i)),this},o.prependTo=function(e,t){return e.prepend(this,t),this},o.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},o.remaining=function(){return this.limit-this.offset},o.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},o.resize=function(e){var t,n;if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}return this.buffer.byteLength<e&&(t=new ArrayBuffer(e),(n=new Uint8Array(t)).set(this.view),this.buffer=t,this.view=n),this},o.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},o.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},o.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},o.toBuffer=function(e){var t,n=this.offset,r=this.limit;if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: Not an integer");if(n>>>=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal limit: Not an integer");if(r>>>=0,n<0||n>r||r>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+n+" <= "+r+" <= "+this.buffer.byteLength)}return e||0!==n||r!==this.buffer.byteLength?n===r?a:(t=new ArrayBuffer(r-n),new Uint8Array(t).set(new Uint8Array(this.buffer).subarray(n,r),0),t):this.buffer},o.toArrayBuffer=o.toBuffer,o.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}},c=function(){var e,t,n={},r=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[];for(e=0,t=r.length;t>e;++e)i[r[e]]=e;return n.encode=function(e,t){for(var n,i;null!==(n=e());)t(r[63&n>>2]),i=(3&n)<<4,null!==(n=e())?(t(r[63&((i|=15&n>>4)|15&n>>4)]),i=(15&n)<<2,null!==(n=e())?(t(r[63&(i|3&n>>6)]),t(r[63&n])):(t(r[63&i]),t(61))):(t(r[63&i]),t(61),t(61))},n.decode=function(e,t){function n(e){throw Error("Illegal character code: "+e)}for(var r,s,o;null!==(r=e());)if(void 0===(s=i[r])&&n(r),null!==(r=e())&&(void 0===(o=i[r])&&n(r),t(s<<2>>>0|(48&o)>>4),null!==(r=e()))){if(void 0===(s=i[r])){if(61===r)break;n(r)}if(t((15&o)<<4>>>0|(60&s)>>2),null!==(r=e())){if(void 0===(o=i[r])){if(61===r)break;n(r)}t((3&s)<<6>>>0|o)}}},n.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},n}(),o.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||e>t)throw RangeError("begin, end");var r;return c.encode(function(){return t>e?this.view[e++]:null}.bind(this),r=n()),r()},h.fromBase64=function(e,n){if("string"!=typeof e)throw TypeError("str");var r=new h(e.length/4*3,n),i=0;return c.decode(t(e),(function(e){r.view[i++]=e})),r.limit=i,r},h.btoa=function(e){return h.fromBinary(e).toBase64()},h.atob=function(e){return h.fromBase64(e).toBinary()},o.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];t>e;)n.push(this.view[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},h.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,i=e.length,s=new h(i,t);i>r;){if((n=e.charCodeAt(r))>255)throw RangeError("illegal char code: "+n);s.view[r++]=n}return s.limit=i,s},o.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",s="",o="";r>n;){if(-1!==n&&(i+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(s+=t>32&&t<127?String.fromCharCode(t):".")),++n,e&&n>0&&n%16==0&&n!==r){for(;i.length<51;)i+=" ";o+=i+s+"\n",i=s=""}i+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";o+=i+s+"\n"}return e?o:i},h.fromDebug=function(e,t,n){for(var r,i,s=e.length,o=new h(0|(s+1)/3,t,n),a=0,u=0,c=!1,l=!1,f=!1,d=!1,g=!1;s>a;){switch(r=e.charAt(a++)){case"!":if(!n){if(l||f||d){g=!0;break}l=f=d=!0}o.offset=o.markedOffset=o.limit=u,c=!1;break;case"|":if(!n){if(l||d){g=!0;break}l=d=!0}o.offset=o.limit=u,c=!1;break;case"[":if(!n){if(l||f){g=!0;break}l=f=!0}o.offset=o.markedOffset=u,c=!1;break;case"<":if(!n){if(l){g=!0;break}l=!0}o.offset=u,c=!1;break;case"]":if(!n){if(d||f){g=!0;break}d=f=!0}o.limit=o.markedOffset=u,c=!1;break;case">":if(!n){if(d){g=!0;break}d=!0}o.limit=u,c=!1;break;case"'":if(!n){if(f){g=!0;break}f=!0}o.markedOffset=u,c=!1;break;case" ":c=!1;break;default:if(!n&&c){g=!0;break}if(i=parseInt(r+e.charAt(a++),16),!n&&(isNaN(i)||i<0||i>255))throw TypeError("Illegal str: Not a debug encoded string");o.view[u++]=i,c=!0}if(g)throw TypeError("Illegal str: Invalid symbol at "+a)}if(!n){if(!l||!d)throw TypeError("Illegal str: Missing offset or limit");if(u<o.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+s)}return o},o.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);t>e;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},h.fromHex=function(e,t,n){var r,i,s,o,a;if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(i=e.length,s=new h(0|i/2,t),o=0,a=0;i>o;o+=2){if(r=parseInt(e.substring(o,o+2),16),!n&&(!isFinite(r)||r<0||r>255))throw TypeError("Illegal str: Contains non-hex characters");s.view[a++]=r}return s.limit=a,s},l=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(192|31&n>>6),t(128|63&n)):n<65536?(t(224|15&n>>12),t(128|63&n>>6),t(128|63&n)):(t(240|7&n>>18),t(128|63&n>>12),t(128|63&n>>6),t(128|63&n)),n=null},decodeUTF8:function(e,t){for(var n,r,i,s,o=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&o([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))(null===(r=e())||null===(i=e()))&&o([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(s=e()))&&o([n,r,i,s]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&s)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(t,n){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,n)}))},decodeUTF8toUTF16:function(t,n){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,n)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(t){var n=0,r=0;return e.UTF16toUTF8(t,(function(e){++n,r+=e<128?1:e<2048?2:e<65536?3:4})),[n,r]}};return e}(),o.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{l.decodeUTF8toUTF16(function(){return t>e?this.view[e++]:null}.bind(this),r=n())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},h.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var i=new h(l.calculateUTF16asUTF8(t(e),!0)[1],n,r),s=0;return l.encodeUTF16toUTF8(t(e),(function(e){i.view[s++]=e})),i.limit=s,i},h}(Gh=function(){function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return!0===(e&&e.__isLong__)}function n(e,t){var n,r,s;return t?(s=(e>>>=0)>=0&&e<256)&&(r=u[e])?r:(n=i(e,(0|e)<0?-1:0,!0),s&&(u[e]=n),n):(s=(e|=0)>=-128&&e<128)&&(r=a[e])?r:(n=i(e,e<0?-1:0,!1),s&&(a[e]=n),n)}function r(e,t){if(isNaN(e)||!isFinite(e))return t?p:g;if(t){if(e<0)return p;if(e>=h)return _}else{if(-f>=e)return T;if(e+1>=f)return E}return e<0?r(-e,t).neg():i(0|e%l,0|e/l,t)}function i(t,n,r){return new e(t,n,r)}function s(e,t,n){var i,o,a,u,l,h,f;if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||n>36)throw RangeError("radix");if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return s(e.substring(1),t,n).neg();for(o=r(c(n,8)),a=g,u=0;u<e.length;u+=8)l=Math.min(8,e.length-u),h=parseInt(e.substring(u,u+l),n),l<8?(f=r(c(n,l)),a=a.mul(f).add(r(h))):a=(a=a.mul(o)).add(r(h));return a.unsigned=t,a}function o(t){return t instanceof e?t:"number"==typeof t?r(t):"string"==typeof t?s(t):i(t.low,t.high,t.unsigned)}var a,u,c,l,h,f,d,g,p,v,y,m,E,_,T,R;return e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t,a={},u={},e.fromInt=n,e.fromNumber=r,e.fromBits=i,c=Math.pow,e.fromString=s,e.fromValue=o,f=(h=(l=4294967296)*l)/2,d=n(16777216),g=n(0),e.ZERO=g,p=n(0,!0),e.UZERO=p,v=n(1),e.ONE=v,y=n(1,!0),e.UONE=y,m=n(-1),e.NEG_ONE=m,E=i(-1,2147483647,!1),e.MAX_VALUE=E,_=i(-1,-1,!0),e.MAX_UNSIGNED_VALUE=_,T=i(0,-2147483648,!1),e.MIN_VALUE=T,(R=e.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},R.toString=function(e){var t,n,i,s,o,a,u,l;if((e=e||10)<2||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())return this.eq(T)?(t=r(e),i=(n=this.div(t)).mul(t).sub(this),n.toString(e)+i.toInt().toString(e)):"-"+this.neg().toString(e);for(s=r(c(e,6),this.unsigned),o=this,a="";;){if(u=o.div(s),l=(o.sub(u.mul(s)).toInt()>>>0).toString(e),(o=u).isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){var e,t;if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},R.isZero=function(){return 0===this.high&&0===this.low},R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||this.high>=0},R.isOdd=function(){return 1==(1&this.low)},R.isEven=function(){return 0==(1&this.low)},R.equals=function(e){return t(e)||(e=o(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},R.eq=R.equals,R.notEquals=function(e){return!this.eq(e)},R.neq=R.notEquals,R.lessThan=function(e){return this.comp(e)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(e){return this.comp(e)<=0},R.lte=R.lessThanOrEqual,R.greaterThan=function(e){return this.comp(e)>0},R.gt=R.greaterThan,R.greaterThanOrEqual=function(e){return this.comp(e)>=0},R.gte=R.greaterThanOrEqual,R.compare=function(e){if(t(e)||(e=o(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(v)},R.neg=R.negate,R.add=function(e){var n,r,s,a,u,c,l,h,f,d,g;return t(e)||(e=o(e)),n=this.high>>>16,r=65535&this.high,s=this.low>>>16,a=65535&this.low,u=e.high>>>16,c=65535&e.high,l=e.low>>>16,h=0,f=0,d=0,g=0,d+=(g+=a+(65535&e.low))>>>16,f+=(d+=s+l)>>>16,h+=(f+=r+c)>>>16,h+=n+u,i((d&=65535)<<16|(g&=65535),(h&=65535)<<16|(f&=65535),this.unsigned)},R.subtract=function(e){return t(e)||(e=o(e)),this.add(e.neg())},R.sub=R.subtract,R.multiply=function(e){var n,s,a,u,c,l,h,f,p,v,y,m;return this.isZero()?g:(t(e)||(e=o(e)),e.isZero()?g:this.eq(T)?e.isOdd()?T:g:e.eq(T)?this.isOdd()?T:g:this.isNegative()?e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg():e.isNegative()?this.mul(e.neg()).neg():this.lt(d)&&e.lt(d)?r(this.toNumber()*e.toNumber(),this.unsigned):(n=this.high>>>16,s=65535&this.high,a=this.low>>>16,u=65535&this.low,c=e.high>>>16,l=65535&e.high,h=e.low>>>16,p=0,v=0,y=0,m=0,y+=(m+=u*(f=65535&e.low))>>>16,v+=(y+=a*f)>>>16,y&=65535,v+=(y+=u*h)>>>16,p+=(v+=s*f)>>>16,v&=65535,p+=(v+=a*h)>>>16,v&=65535,p+=(v+=u*l)>>>16,p+=n*f+s*h+a*l+u*c,i((y&=65535)<<16|(m&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)))},R.mul=R.multiply,R.divide=function(e){var n,i,s,a,u,l,h;if(t(e)||(e=o(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?p:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return p;if(e.gt(this.shru(1)))return y;s=p}else{if(this.eq(T))return e.eq(v)||e.eq(m)?T:e.eq(T)?v:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?v:m:(i=this.sub(e.mul(n)),s=n.add(i.div(e)));if(e.eq(T))return this.unsigned?p:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=g}for(i=this;i.gte(e);){for(n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())),u=(a=Math.ceil(Math.log(n)/Math.LN2))<=48?1:c(2,a-48),h=(l=r(n)).mul(e);h.isNegative()||h.gt(i);)h=(l=r(n-=u,this.unsigned)).mul(e);l.isZero()&&(l=v),s=s.add(l),i=i.sub(h)}return s},R.div=R.divide,R.modulo=function(e){return t(e)||(e=o(e)),this.sub(this.div(e).mul(e))},R.mod=R.modulo,R.not=function(){return i(~this.low,~this.high,this.unsigned)},R.and=function(e){return t(e)||(e=o(e)),i(this.low&e.low,this.high&e.high,this.unsigned)},R.or=function(e){return t(e)||(e=o(e)),i(this.low|e.low,this.high|e.high,this.unsigned)},R.xor=function(e){return t(e)||(e=o(e)),i(this.low^e.low,this.high^e.high,this.unsigned)},R.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):i(0,this.low<<e-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):i(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(e){var n;return t(e)&&(e=e.toInt()),0==(e&=63)?this:(n=this.high,e<32?i(this.low>>>e|n<<32-e,n>>>e,this.unsigned):i(32===e?n:n>>>e-32,0,this.unsigned))},R.shru=R.shiftRightUnsigned,R.toSigned=function(){return this.unsigned?i(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:i(this.low,this.high,!0)},R.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,255&t>>>8,255&t>>>16,255&t>>>24,255&e,255&e>>>8,255&e>>>16,255&e>>>24]},R.toBytesBE=function(){var e=this.high,t=this.low;return[255&e>>>24,255&e>>>16,255&e>>>8,255&e,255&t>>>24,255&t>>>16,255&t>>>8,255&t]},e}()),Gh));Kh.getModule=function(e){var t=new Kh[e];return t.getArrayData=function(){var e=t.toArrayBuffer();return e=lr(e)?[].slice.call(new Int8Array(e)):e},t},function(e){e[e.ALL=1]="ALL",e[e.SINGAL=2]="SINGAL"}(Hh||(Hh={}));var Wh,Qh=Hh;!function(e){e.TextMessage="RC:TxtMsg",e.VOICE="RC:VcMsg",e.HQ_VOICE="RC:HQVCMsg",e.IMAGE="RC:ImgMsg",e.GIF="RC:GIFMsg",e.RICH_CONTENT="RC:ImgTextMsg",e.LOCATION="RC:LBSMsg",e.FILE="RC:FileMsg",e.SIGHT="RC:SightMsg",e.COMBINE="RC:CombineMsg",e.CHRM_KV_NOTIFY="RC:chrmKVNotiMsg",e.LOG_COMMAND="RC:LogCmdMsg",e.EXPANSION_NOTIFY="RC:MsgExMsg",e.REFERENCE="RC:ReferenceMsg",e.RECALL="RC:RcCmd",e.READ_RECEIPT="RC:ReadNtf",e.READ_RECEIPT_REQUEST="RC:RRReqMsg",e.READ_RECEIPT_RESPONSE="RC:RRRspMsg",e.SYNC_READ_STATUS="RC:SRSMsg",e.GROUP_READ_RECEIPT_REQUEST="RC:RRMsg"}(Wh||(Wh={}));var zh,Jh=Wh;!function(e){e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE"}(zh||(zh={}));var Zh,$h,Xh,ef,tf=zh,nf="pgMsgP",rf="chatMsg",sf="pcMsgP",of={PRIVATE:"ppMsgS",GROUP:"pgMsgS",CHATROOM:"chatMsgS"},af="delMsg",uf="joinChrm",cf="joinChrmR",lf="exitChrm",hf="setKV",ff="delKV",df="qryRelationR",gf="delRelation",pf="setSeAtt",vf={PRIVATE:"cleanPMsg",GROUP:"cleanGMsg",CUSTOMER_SERVICE:"cleanCMsg",SYSTEM:"cleanSMsg"},yf="qryPMsg",mf="qryGMsg",Ef="qryCHMsg",_f="qryCMsg",Tf="qrySMsg",Rf=(c(Zh={},"ppMsgP",rr.PRIVATE),c(Zh,nf,rr.GROUP),c(Zh,rf,rr.CHATROOM),c(Zh,sf,rr.CUSTOMER_SERVICE),Zh),If=(c($h={},rr.PRIVATE,yf),c($h,rr.GROUP,mf),c($h,rr.CHATROOM,Ef),c($h,rr.CUSTOMER_SERVICE,_f),c($h,rr.SYSTEM,Tf),$h),Cf=(c(Xh={},rr.PRIVATE,vf.PRIVATE),c(Xh,rr.GROUP,vf.GROUP),c(Xh,rr.CUSTOMER_SERVICE,vf.CUSTOMER_SERVICE),c(Xh,rr.SYSTEM,vf.SYSTEM),Xh),Sf="1",bf="0",wf=1,Of=2,Nf=3;!function(e){e[e.SEND=1]="SEND",e[e.RECEIVE=2]="RECEIVE"}(ef||(ef={}));var kf=ef,Af=function(){function e(t){o(this,e),this._codec="websocket"===t?Kh:Lh,this._connectType=t}return u(e,[{key:"decodeByPBName",value:function(e,t,n){var r,i=this,s=e,o=(c(r={},Rl,i._formatSyncMessages),c(r,Tl,i._formatReceivedMessage),c(r,El,i._formatSentMessage),c(r,Nl,i._formatHistoryMessages),c(r,Al,i._formatConversationList),c(r,Yl,i._formatChatRoomInfos),c(r,ql,i._formatRTCUserList),c(r,Zl,i._formatRTCData),c(r,hh,i._formatChatRoomKVList),c(r,vh,i._formatUserSetting),c(r,Eh,i._formatConversationStatus),c(r,bh,i._formatGrpReadReceiptQryResp),c(r,gh,i._formatSetUserSettingOutput),c(r,yh,i._formatUserSettingNotification),r)[t];try{s=e.length>0&&i._codec[t].decode(e),fr(s)&&(s=function(e){for(var t in e)fr(e[t])&&(e[t]=oo(e[t]));return e}(s)),dr(o)&&(s=o.call(this,s,n))}catch(n){_r.error("PB parse error\n",n,e,t)}return s}},{key:"_readBytes",value:function(e){var t=e.offset,n=e.buffer,r=e.limit;if(t)try{var i=lr(n)?new Uint8Array(n):n;return vl.readUTF(i.subarray(t,r))}catch(e){_r.info("readBytes error\n",e)}return e}},{key:"_formatBytes",value:function(e){var t=this._readBytes(e);try{t=JSON.parse(t)}catch(e){_r.info("formatBytes error\n",e)}return t||e}},{key:"_formatSyncMessages",value:function(e,t){t=t||{};var n=this,r=e.list,i=e.syncTime,s=e.finished;return(gr(s)||null===s)&&(e.finished=!0),e.syncTime=oo(i),e.list=fo(r,(function(e){return n._formatReceivedMessage(e,t)})),e}},{key:"_formatReceivedMessage",value:function(e,t){var r,i=t=t||{},s=i.currentUserId,o=i.connectedTime,a=e.content,u=e.fromUserId,c=e.type,l=e.groupId,h=e.status,f=e.dataTime,d=e.classname,g=e.msgId,p=e.extraContent,v=e.pushContent,y=e.pushExt,m=e.configFlag,E=(e.direction||kf.RECEIVE)===kf.SEND,_=function(e){var t=n.READ;return{isPersited:!!(16&e),isCounted:!!(32&e),isMentioned:!!(64&e),disableNotification:!!(512&e),receivedStatus:t=2&e?n.RETRIEVED:t,canIncludeExpansion:!!(1024&e)}}(h),T=_.isPersited,R=_.isCounted,I=_.isMentioned,C=_.disableNotification,S=_.receivedStatus,b=_.canIncludeExpansion,w=c===rr.GROUP||c===rr.CHATROOM?l:u,O=E?s:u,N=oo(f),k=N<o,A=c===rr.CHATROOM,M=this._formatBytes(a),x=E?kf.SEND:kf.RECEIVE;return A&&u===s&&(x=kf.SEND),p&&(r={},r=Eo(p)),{conversationType:c,targetId:w,senderUserId:O,messageType:d,messageUId:g,isPersited:T,isCounted:R,isMentioned:I,sentTime:N,isOffLineMessage:k,messageDirection:x,receivedTime:_o.getTime(),disableNotification:C,receivedStatus:S,canIncludeExpansion:b,content:M,expansion:r,pushContent:v,pushExt:y,configFlag:m}}},{key:"_formatSentMessage",value:function(e,t){var n,r=e.content,i=e.classname,s=e.sessionId,o=e.msgId,a=e.extraContent,u=t.signal,c=t.currentUserId,l=u.date,h=u.topic,f=u.targetId,d=function(e){return{isPersited:!!(1&e),isCounted:!!(2&e),disableNotification:!!(32&e),canIncludeExpansion:!!(64&e)}}(s),g=d.isPersited,p=d.isCounted,v=d.disableNotification,y=d.canIncludeExpansion,m=Rf[h]||rr.PRIVATE,E=po(of,h);return a&&(n={},n=Eo(a)),{conversationType:m,targetId:f,messageType:i,messageUId:o,isPersited:g,isCounted:p,isStatusMessage:E,senderUserId:c,content:this._formatBytes(r),sentTime:1e3*l,receivedTime:_o.getTime(),messageDirection:kf.SEND,isOffLineMessage:!1,disableNotification:v,canIncludeExpansion:y,expansion:n}}},{key:"_formatHistoryMessages",value:function(e,t){var n=this,r=t.conversation||{},i=e.list,s=e.hasMsg,o=r.targetId,a=oo(e.syncTime),u=[];return ho(i,(function(e){var r=n._formatReceivedMessage(e,t);r.targetId=o,u.push(r)}),{isReverse:!0}),{syncTime:a,list:u,hasMore:!!s}}},{key:"_formatConversationList",value:function(e,t){var n=this,r=e.info,i=t.afterDecode||function(){};return(r=fo(r,(function(e){var r=e.msg,s=e.userId,o=e.type,a=e.unreadCount,u=e.channelId,c=n._formatReceivedMessage(r,t);c.targetId=s;var l={targetId:s,conversationType:o,unreadMessageCount:a,latestMessage:c,channelId:u||""};return i(l)||l})))||[]}},{key:"_formatSetUserSettingOutput",value:function(e){return e}},{key:"_formatChatRoomInfos",value:function(e){var t=e.userTotalNums,n=e.userInfos;return{userCount:t,userInfos:fo(n,(function(e){var t=e.id,n=e.time;return{id:t,time:oo(n)}}))}}},{key:"_formatChatRoomKVList",value:function(e){var t=e.entries,n=e.bFullUpdate,r=e.syncTime;return{kvEntries:t=fo(t=t||[],(function(e){var t=e.key,n=e.value,r=e.status,i=e.timestamp,s=e.uid,o=function(e){return{isAutoDelete:!!(1&e),isOverwrite:!!(2&e),type:4&e?mo.DELETE:mo.UPDATE}}(r);return{key:t,value:n,isAutoDelete:o.isAutoDelete,isOverwrite:o.isOverwrite,type:o.type,userId:s,timestamp:oo(i)}})),isFullUpdate:n,syncTime:r}}},{key:"_formatUserSetting",value:function(e){var t=this,n=e.items,r=e.version,i={};return ho(n||[],(function(e){var n=e.key,r=e.version,s=e.value;e.version=oo(r),e.value=t._readBytes(s),"Tag"===n&&e.tags.forEach((function(e){e.createdTime=oo(e.createdTime),e.tagName=e.name})),i[n]=e})),{settings:i,version:r}}},{key:"_formatConversationStatus",value:function(e){var t=e.state,n=[];return ho(t,(function(e){var t=e.type,r=e.channelId,i=e.time,s=e.stateItem,o=tf.CLOSE,a=!1,u=[];ho(s,(function(e){var t=e.sessionStateType,n=e.value,r=e.tags;switch(t){case wf:o=n===Sf?tf.OPEN:tf.CLOSE;break;case Of:a=n===Sf;break;case Nf:u=r}})),n.push({type:t,targetId:r,notificationStatus:o,isTop:a,updatedTime:oo(i),tags:u})})),n}},{key:"_formatRTCUserList",value:function(e){var t=e.list,n=e.token,r=e.sessionId,i={};return ho(t,(function(e){var t=e.userId,n=e.userData,r={};ho(n,(function(e){var t=e.key,n=e.value;r[t]=n})),i[t]=r})),{users:i,token:n,sessionId:r}}},{key:"_formatRTCData",value:function(e){var t=e.outInfo,n={};return ho(t,(function(e){n[e.key]=e.value})),n}},{key:"_formatRTCRoomInfo",value:function(e){var t=e.roomId,n=e.userCount,r=e.roomData,i={id:t,total:n};return ho(r,(function(e){i[e.key]=e.value})),i}},{key:"_formatGrpReadReceiptQryResp",value:function(e){var t=e.totalMemberNum,n=e.list;return n.forEach((function(e){e.readTime=oo(e.readTime)})),{totalMemberCount:t,list:n}}},{key:"_formatUserSettingNotification",value:function(e){return e}},{key:"encodeServerConfParams",value:function(){var e=this._codec.getModule(Il);return e.setNothing(1),e.getArrayData()}},{key:"_getUpMsgModule",value:function(e,t){var n="comet"===this._connectType,r=e.type,i=t.messageType,s=t.isMentioned,o=t.mentionedType,a=t.mentionedUserIdList,u=t.content,c=t.pushContent,l=t.directionalUserIdList,h=t.isFilerWhiteBlacklist,f=t.isVoipPush,d=t.canIncludeExpansion,g=t.expansion,p=t.pushConfig,v=r===rr.GROUP,y=this._codec.getModule(El),m=function(e){var t=e.isStatusMessage,n=e.isPersited,r=e.isCounted;t&&(n=r=!1);var i=0;return n&&(i|=1),r&&(i|=2),e.isMentioned&&(i|=4),e.disableNotification&&(i|=32),e.canIncludeExpansion&&(i|=64),i}(t),E=p||{},_=E.pushTitle,T=E.pushData,R=E.iOSConfig,I=E.androidConfig,C=E.templateId,S=E.disablePushTitle,b=E.forceShowDetailContent,w=0;if(y.setSessionId(m),v&&s&&u&&(u.mentionedInfo={userIdList:a,type:o||Qh.ALL}),c&&y.setPushText(c),T&&y.setAppData(T),l&&y.setUserId(l),w|=f?1:0,w|=h?2:0,w|=S?4:0,w|=b?8:0,y.setConfigFlag(w),y.setClassname(i),y.setContent(JSON.stringify(u)),d&&g){var O={};ho(g,(function(e,t){O[t]={v:e}})),y.setExtraContent(JSON.stringify(O))}if(p){var N=this._codec.getModule(_l);if(_&&N.setTitle(_),R&&I){var k=uo(R,I);N.setPushConfigs(k)}(null==I?void 0:I.notificationId)&&N.setPushId(null==I?void 0:I.notificationId),N.setTemplateId(C||""),y.setPushExt(n?N.getArrayData():N)}return y}},{key:"encodeUpMsg",value:function(e,t){return this._getUpMsgModule(e,t).getArrayData()}},{key:"encodeSyncMsg",value:function(e){var t=e.sendboxTime,n=e.inboxTime,r=this._codec.getModule(Sl);return r.setIspolling(!1),r.setIsPullSend(!0),r.setSendBoxSyncTime(t),r.setSyncTime(n),r.getArrayData()}},{key:"encodeChrmSyncMsg",value:function(e,t){e=e||0,t=t||0;var n=this._codec.getModule(bl);return n.setCount(t),n.setSyncTime(e),n.getArrayData()}},{key:"encodeGetHistoryMsg",value:function(e,t){var n=t.count,r=t.order,i=t.timestamp,s=this._codec.getModule(Ol);return s.setTargetId(e),s.setTime(i),s.setCount(n),s.setOrder(r),s.getArrayData()}},{key:"encodeGetConversationList",value:function(e){var t=e=e||{},n=t.count,r=t.startTime,i=this._codec.getModule(kl);return i.setType(1),i.setCount(n),i.setStartTime(r),i.getArrayData()}},{key:"encodeOldConversationList",value:function(e){var t=e=e||{},n=t.count,r=t.type,i=t.startTime,s=t.order;n=n||0,i=i||0,s=s||0;var o=this._codec.getModule(kl);return o.setType(r),o.setCount(n),o.setStartTime(i),o.setOrder(s),o.getArrayData()}},{key:"encodeRemoveConversationList",value:function(e){var t=this,n=this._codec.getModule(Ml),r=[];return ho(e,(function(e){var n=e.type,i=e.targetId,s=t._codec.getModule(xl);s.setType(n),s.setChannelId(i),r.push(s)})),n.setSessions(r),n.getArrayData()}},{key:"encodeDeleteMessages",value:function(e,t,n){var r=this._codec.getModule(Pl),i=[];return ho(n,(function(e){i.push({msgId:e.messageUId,msgDataTime:e.sentTime,direct:e.messageDirection})})),r.setType(e),r.setConversationId(t),r.setMsgs(i),r.getArrayData()}},{key:"encodeClearMessages",value:function(e,t){var n=this._codec.getModule(Dl);return t=t||(new Date).getTime(),n.setDataTime(t),n.setTargetId(e),n.getArrayData()}},{key:"encodeClearUnreadCount",value:function(e,t){var n=e.type,r=e.targetId,i=t.timestamp,s=this._codec.getModule(Vl);return i=i||+new Date,s.setType(n),s.setChannelId(r),s.setMsgTime(i),s.getArrayData()}},{key:"encodeJoinOrQuitChatRoom",value:function(){var e=this._codec.getModule(Bl);return e.setNothing(1),e.getArrayData()}},{key:"encodeGetChatRoomInfo",value:function(e,t){var n=this._codec.getModule(Fl);return n.setCount(e),n.setOrder(t),n.getArrayData()}},{key:"encodeGetFileToken",value:function(e,t,n,r){var i=this._codec.getModule(ih);return i.setType(e),i.setKey(t),i.setHttpMethod(n),i.setQueryString(r),i.getArrayData()}},{key:"encodeGetFileUrl",value:function(e,t,n,r){var i=this._codec.getModule(e);return i.setType(t),i.setKey(n),r&&i.setFileName(r),i.getArrayData()}},{key:"encodeModifyChatRoomKV",value:function(e,t,n){var r="comet"===this._connectType,i=this._codec.getModule(lh),s=t.key,o=t.value,a=t.notificationExtra,u=t.isSendNotification,c=t.type||mo.UPDATE,l=function(e,t){var n=0;return e.isAutoDelete&&(n|=1),e.isOverwrite&&(n|=2),2===t&&(n|=4),n}(t,c),h={key:s,value:o||"",uid:n};if(gr(l)||(h.status=l),i.setEntry(h),u){var f={type:rr.CHATROOM,targetId:e},d={key:s,value:o,extra:a,type:c},g=this._getUpMsgModule(f,{messageType:Jh.CHRM_KV_NOTIFY,content:d,isPersited:!1,isCounted:!1});r?i.setNotification(g.getArrayData()):i.setNotification(g),i.setBNotify(!0),i.setType(rr.CHATROOM)}return i.getArrayData()}},{key:"encodePullChatRoomKV",value:function(e){var t=this._codec.getModule(fh);return t.setTimestamp(e),t.getArrayData()}},{key:"encodePullUserSetting",value:function(e){var t=this._codec.getModule(ph);return t.setVersion(e),t.getArrayData()}},{key:"encodeGetConversationStatus",value:function(e){var t=this._codec.getModule(mh);return t.setTime(e),t.getArrayData()}},{key:"encodeSetConversationStatus",value:function(e){var t=this,n="comet"===this._connectType,r=this._codec.getModule(Rh),i=_o.getTime(),s=[];return ho(e,(function(e){var r=t._codec.getModule(_h),o=e.conversationType,a=e.targetId,u=e.notificationStatus,c=e.isTop,l=[];r.setType(o),r.setChannelId(a),r.setTime(i);var h=u===tf.OPEN,f={};gr(u)||(f[wf]=h),gr(c)||(f[Of]=c),ho(f,(function(e,r){if(!gr(e)){var i=t._codec.getModule(Th);e=e?Sf:bf,i.setSessionStateType(Number(r)),i.setValue(e);var s=n?i.getArrayData():i;l.push(s)}})),r.setStateItem(l);var d=n?r.getArrayData():r;s.push(d)})),r.setVersion(i),r.setState(s),r.getArrayData()}},{key:"encodeReadReceipt",value:function(e,t){var n=this._codec.getModule(Ch);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()}},{key:"encodeCreateTag",value:function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(Oh),s=[];return e.forEach((function(e){var t=n._codec.getModule(Nh);t.setTagId(e.tagId),t.setName(e.tagName),s.push(r?t.getArrayData():t)})),i.setTags(s),i.setVersion(t),i.getArrayData()}},{key:"encodeMessageReader",value:function(e,t){var n=this._codec.getModule(Ch);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()}},{key:"encodeRemoveTag",value:function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(kh),s=[];return e.forEach((function(e){var t=n._codec.getModule(Nh);t.setTagId(e),s.push(r?t.getArrayData():t)})),i.setTags(s),i.setVersion(t),i.getArrayData()}},{key:"encodeDisConversationTag",value:function(e){var t=this._codec.getModule(Ah);return t.setTagId(e),t.getArrayData()}},{key:"encodeUpdateConversationTag",value:function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(Rh),s=[];return t.forEach((function(t){var i=n._codec.getModule(_h),o=n._codec.getModule(Th),a=[];e.forEach((function(e){var t=n._codec.getModule(Nh);t.setTagId(e.tagId),gr(e.isTop)||t.setIsTop(e.isTop),a.push(r?t.getArrayData():t)})),o.setSessionStateType(Nf),o.setValue(JSON.stringify(a)),o.setTags(a),i.setType(t.type),i.setChannelId(t.targetId),i.setTime(Date.now()),i.setStateItem([r?o.getArrayData():o]),s.push(r?i.getArrayData():i)})),i.setState(s),i.setVersion(_o.getTime()),i.getArrayData()}},{key:"encodeReportSDKInfo",value:function(e){var t=this._codec.getModule(Mh);return t.setSdkInfo(e),t.getArrayData()}},{key:"encodeJoinRTCRoom",value:function(e,t){var n=this._codec.getModule(jl);return e=e||0,n.setRoomType(e),gr(t)||n.setBroadcastType(t),n.getArrayData()}},{key:"encodeQuitRTCRoom",value:function(){return this._codec.getModule(Gl).getArrayData()}},{key:"encodeSetRTCData",value:function(e,t,n,r,i){var s=this._codec.getModule(Hl);if(s.setInterior(n),s.setTarget(r),s.setKey(e),s.setValue(t),i){i.name&&s.setObjectName(i.name);var o=i.content;o&&(fr(o)&&(o=JSON.stringify(o)),s.setContent(o))}return s.getArrayData()}},{key:"encodeUserSetRTCData",value:function(e,t,n){var r=this._codec.getModule(Kl);r.setObjectName(n);var i=this._codec.getModule(nh);return i.setKey(e.name),i.setValue(e.content),r.setContent(i),(i=this._codec.getModule(nh)).setKey("uris"),i.setValue(t),r.setValueInfo(i),r.getArrayData()}},{key:"encodeGetRTCData",value:function(e,t,n){var r=this._codec.getModule(Wl);return r.setInterior(t),r.setTarget(n),r.setKey(e),r.getArrayData()}},{key:"encodeRemoveRTCData",value:function(e,t,n,r){var i=this._codec.getModule(Wl);i.setInterior(t),i.setTarget(n),i.setKey(e);var s=r=r||{},o=s.name,a=s.content;return!gr(o)&&i.setObjectName(o),gr(a)||(fr(a)&&(a=JSON.stringify(a)),i.setContent(a)),i.getArrayData()}},{key:"encodeSetRTCOutData",value:function(e,t,n){var r=this._codec.getModule(Ql);r.setTarget(t),cr(e)||(e=[e]),ho(e,(function(t,n){t.key=t.key?t.key.toString():t.key,t.value=t.value?t.value.toString():t.value,e[n]=t})),r.setValueInfo(e);var i=n=n||{},s=i.name,o=i.content;return!gr(s)&&r.setObjectName(s),gr(o)||(fr(o)&&(o=JSON.stringify(o)),r.setContent(o)),r.getArrayData()}},{key:"ecnodeGetRTCOutData",value:function(e){var t=this._codec.getModule($l);return t.setUserId(e),t.getArrayData()}},{key:"encodeSetRTCState",value:function(e){var t=this._codec.getModule(zl);return t.setId(e),t.getArrayData()}},{key:"encodeGetRTCRoomInfo",value:function(){var e=this._codec.getModule(eh);return e.setOrder(2),e.getArrayData()}},{key:"encodeSetRTCUserInfo",value:function(e,t){var n=this._codec.getModule(nh);return n.setKey(e),n.setValue(t),n.getArrayData()}},{key:"encodeRemoveRTCUserInfo",value:function(e){var t=this._codec.getModule(rh);return t.setKey(e),t.getArrayData()}}]),e}(),Mf=function e(t,n){o(this,e),this._watcher=n,this.codec=new Af(t)},xf=function(e,t){return e&&t?t+"_"+e:e||Date.now()},Uf=function(){function e(t){o(this,e),this.header=t,this._name=null,this.lengthSize=0,this.messageId=0,this.timestamp=0,this.syncMsg=!1,this.identifier=""}return u(e,[{key:"getIdentifier",value:function(){var e=this.messageId,t=this.identifier;return xf(e,t)}},{key:"read",value:function(e,t){this.readMessage(e,t)}},{key:"readMessage",value:function(e,t){return{stream:e,length:t}}}]),e}(),Lf=function(){function e(t){o(this,e),this.lengthSize=0,this.messageId=0,this.topic="",this.targetId="",this.identifier="",this._header=new pl(t,!1,Kc.AT_MOST_ONCE,!1)}return u(e,[{key:"getIdentifier",value:function(){var e=this.messageId,t=this.identifier;return xf(e,t)}},{key:"write",value:function(e){var t=this.getHeaderFlag();e.write(t),this.writeMessage(e)}},{key:"setHeaderQos",value:function(e){this._header.qos=e}},{key:"getHeaderFlag",value:function(){return this._header.encode()}},{key:"getLengthSize",value:function(){return this.lengthSize}},{key:"getBufferData",value:function(){var e=new ml;this.write(e);var t=e.getBytesArray();return new Int8Array(t)}},{key:"getCometData",value:function(){var e=this.data||{};return JSON.stringify(e)}}]),e}(),Pf=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.apply(this,arguments))._name=Qc.CONN_ACK,e.status=null,e.userId=null,e.timestamp=0,e}return u(n,[{key:"readMessage",value:function(e,t){return e.readByte(),this.status=+e.readByte(),t>n.MESSAGE_LENGTH&&(this.userId=e.readUTF(),e.readUTF(),this.timestamp=e.readLong()),{stream:e,length:t}}}]),n}(Uf);Pf.MESSAGE_LENGTH=2;var Df=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.apply(this,arguments))._name=Qc.DISCONNECT,e.status=0,e}return u(n,[{key:"readMessage",value:function(e,t){return e.readByte(),this.status=+e.readByte(),{stream:e,length:t}}}]),n}(Uf);Df.MESSAGE_LENGTH=2;var Vf,Bf=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.call(this,Wc.PING_REQ))._name=Qc.PING_REQ,e}return u(n,[{key:"writeMessage",value:function(e){}}]),n}(Lf),Ff=function(e){f(n,e);var t=T(n);function n(e){var r;return o(this,n),(r=t.call(this,e))._name=Qc.PING_RESP,r}return n}(Uf),Yf=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.apply(this,arguments)).messageId=0,e}return u(n,[{key:"readMessage",value:function(e,t){var n=256*e.readByte()+e.readByte();return this.messageId=parseInt(n.toString(),10),{stream:e,length:t}}}]),n}(Uf),jf=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.apply(this,arguments)).messageId=0,e}return u(n,[{key:"writeMessage",value:function(e){var t=this.messageId,n=255&t,r=(65280&t)>>8;e.write(r),e.write(n)}}]),n}(Lf),qf=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.apply(this,arguments))._name=Qc.PUBLISH,e.topic="",e.targetId="",e.syncMsg=!1,e.identifier=zc.PUB,e}return u(n,[{key:"readMessage",value:function(e,t){return this.date=e.readInt(),this.topic=e.readUTF(),this.targetId=e.readUTF(),R(d(n.prototype),"readMessage",this).call(this,e,t),this.data=e.readAll(),{stream:e,length:t}}}]),n}(Yf),Gf=function(e){f(n,e);var t=T(n);function n(e,r,i){var s;return o(this,n),(s=t.call(this,Wc.PUBLISH))._name=Qc.PUBLISH,s.syncMsg=!1,s.identifier=zc.PUB,s.topic=e,s.data=or(r)?vl.writeUTF(r):r,s.targetId=i,s}return u(n,[{key:"writeMessage",value:function(e){e.writeUTF(this.topic),e.writeUTF(this.targetId),R(d(n.prototype),"writeMessage",this).call(this,e),e.write(this.data)}}]),n}(jf),Hf=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.apply(this,arguments))._name=Qc.PUB_ACK,e.status=0,e.date=0,e.millisecond=0,e.messageUId="",e.timestamp=0,e.identifier=zc.PUB,e.topic="",e.targetId="",e}return u(n,[{key:"readMessage",value:function(e,t){return R(d(n.prototype),"readMessage",this).call(this,e,t),this.date=e.readInt(),this.status=256*e.readByte()+e.readByte(),this.millisecond=256*e.readByte()+e.readByte(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=e.readUTF(),{stream:e,length:t}}}]),n}(Yf),Kf=function(e){f(n,e);var t=T(n);function n(e){var r;return o(this,n),(r=t.call(this,Wc.PUB_ACK))._name=Qc.PUB_ACK,r.status=0,r.date=0,r.millisecond=0,r.messageUId="",r.timestamp=0,r.messageId=e,r}return u(n,[{key:"writeMessage",value:function(e){R(d(n.prototype),"writeMessage",this).call(this,e)}}]),n}(jf),Wf=function(e){f(n,e);var t=T(n);function n(e,r,i){var s;return o(this,n),(s=t.call(this,Wc.QUERY)).name=Qc.QUERY,s.identifier=zc.QUERY,s.topic=e,s.data=or(r)?vl.writeUTF(r):r,s.targetId=i,s}return u(n,[{key:"writeMessage",value:function(e){e.writeUTF(this.topic),e.writeUTF(this.targetId),R(d(n.prototype),"writeMessage",this).call(this,e),e.write(this.data)}}]),n}(jf),Qf=function(e){f(n,e);var t=T(n);function n(e){var r;return o(this,n),(r=t.call(this,Wc.QUERY_CONFIRM))._name=Qc.QUERY_CON,r.messageId=e,r}return n}(jf),zf=function(e){f(n,e);var t=T(n);function n(){var e;return o(this,n),(e=t.apply(this,arguments))._name=Qc.QUERY_ACK,e.status=0,e.identifier=zc.QUERY,e.topic="",e.targetId="",e}return u(n,[{key:"readMessage",value:function(e,t){return R(d(n.prototype),"readMessage",this).call(this,e,t),this.date=e.readInt(),this.status=256*e.readByte()+e.readByte(),this.data=e.readAll(),{stream:e,length:t}}}]),n}(Yf),Jf=function(e){var t,n=e.type;switch(n){case Wc.CONN_ACK:t=new Pf(e);break;case Wc.PUBLISH:(t=new qf(e)).syncMsg=e.syncMsg;break;case Wc.PUB_ACK:t=new Hf(e);break;case Wc.QUERY_ACK:t=new zf(e);break;case Wc.SUB_ACK:case Wc.UNSUB_ACK:case Wc.PING_RESP:t=new Ff(e);break;case Wc.DISCONNECT:t=new Df(e);break;default:t=new Uf(e),_r.error("No support for deserializing "+n+" messages")}return t},Zf=function(e){var t=new Uint8Array(e),n=new yl(t),r=n.readByte(),i=new pl(r),s=Jf(i);return s.read(n,t.length-1),s},$f=function(e){var t=e.headerCode,n=new pl(t),r=Jf(n);for(var i in e)r[i]=e[i];return r},Xf={ACCEPTED:0,UNACCEPTABLE_PROTOCOL_VERSION:1,IDENTIFIER_REJECTED:2,SERVER_UNAVAILABLE:3,TOKEN_INCORRECT:4,NOT_AUTHORIZED:5,REDIRECT:6,PACKAGE_ERROR:7,APP_BLOCK_OR_DELETE:8,BLOCK:9,TOKEN_EXPIRE:10,DEVICE_ERROR:11,HOSTNAME_ERROR:12,HASOHTERSAMECLIENTONLINE:13};!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.NETWORK_UNAVAILABLE=3]="NETWORK_UNAVAILABLE",e[e.CONNECTION_CLOSED=4]="CONNECTION_CLOSED",e[e.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",e[e.WEBSOCKET_UNAVAILABLE=7]="WEBSOCKET_UNAVAILABLE",e[e.WEBSOCKET_ERROR=8]="WEBSOCKET_ERROR",e[e.BLOCKED=9]="BLOCKED",e[e.DOMAIN_INCORRECT=12]="DOMAIN_INCORRECT",e[e.DISCONNECT_BY_SERVER=13]="DISCONNECT_BY_SERVER",e[e.REDIRECT=14]="REDIRECT",e[e.APPKEY_IS_FAKE=20]="APPKEY_IS_FAKE",e[e.ULTRALIMIT=1101]="ULTRALIMIT",e[e.REQUEST_NAVI=201]="REQUEST_NAVI",e[e.RESPONSE_NAVI=202]="RESPONSE_NAVI",e[e.RESPONSE_NAVI_ERROR=203]="RESPONSE_NAVI_ERROR",e[e.RESPONSE_NAVI_TIMEOUT=204]="RESPONSE_NAVI_TIMEOUT"}(Vf||(Vf={}));var ed,td=Vf;!function(e){e[e.ppMsgP=1]="ppMsgP",e[e.ppMsgN=2]="ppMsgN",e[e.ppMsgS=3]="ppMsgS",e[e.pgMsgP=4]="pgMsgP",e[e.chatMsg=5]="chatMsg",e[e.pcMsgP=6]="pcMsgP",e[e.qryPMsg=7]="qryPMsg",e[e.qryGMsg=8]="qryGMsg",e[e.qryCHMsg=9]="qryCHMsg",e[e.qryCMsg=10]="qryCMsg",e[e.qrySMsg=11]="qrySMsg",e[e.recallMsg=12]="recallMsg",e[e.prMsgS=13]="prMsgS",e[e.rrMsg=14]="rrMsg",e[e.rrList=15]="rrList",e[e.s_ntf=16]="s_ntf",e[e.s_msg=17]="s_msg",e[e.s_stat=18]="s_stat",e[e.s_cmd=19]="s_cmd",e[e.s_us=20]="s_us",e[e.pullUS=21]="pullUS",e[e.pgMsgS=22]="pgMsgS",e[e.chatMsgS=23]="chatMsgS",e[e.qrySessionsAtt=24]="qrySessionsAtt",e[e.pullMsg=25]="pullMsg",e[e.qrySessions=26]="qrySessions",e[e.delSessions=27]="delSessions",e[e.delMsg=28]="delMsg",e[e.updRRTime=29]="updRRTime",e[e.chrmPull=30]="chrmPull",e[e.joinChrm=31]="joinChrm",e[e.joinChrmR=32]="joinChrmR",e[e.exitChrm=33]="exitChrm",e[e.queryChrmI=34]="queryChrmI",e[e.setKV=35]="setKV",e[e.delKV=36]="delKV",e[e.pullKV=37]="pullKV",e[e.qryRelation=38]="qryRelation",e[e.delRelation=39]="delRelation",e[e.pullSeAtts=40]="pullSeAtts",e[e.setSeAtt=41]="setSeAtt",e[e.qnTkn=42]="qnTkn",e[e.qnUrl=43]="qnUrl",e[e.aliUrl=44]="aliUrl",e[e.s3Url=45]="s3Url",e[e.stcUrl=46]="stcUrl",e[e.cleanPMsg=47]="cleanPMsg",e[e.cleanGMsg=48]="cleanGMsg",e[e.cleanCMsg=49]="cleanCMsg",e[e.cleanSMsg=50]="cleanSMsg",e[e.rtcRJoin_data=51]="rtcRJoin_data",e[e.rtcRExit=52]="rtcRExit",e[e.rtcPing=53]="rtcPing",e[e.rtcSetData=54]="rtcSetData",e[e.userSetData=55]="userSetData",e[e.rtcQryData=56]="rtcQryData",e[e.rtcDelData=57]="rtcDelData",e[e.rtcSetOutData=58]="rtcSetOutData",e[e.rtcQryUserOutData=59]="rtcQryUserOutData",e[e.rtcToken=60]="rtcToken",e[e.rtcUserState=61]="rtcUserState",e[e.rtcRInfo=62]="rtcRInfo",e[e.rtcUData=63]="rtcUData",e[e.rtcUPut=64]="rtcUPut",e[e.rtcUDel=65]="rtcUDel",e[e.rtcUList=66]="rtcUList",e[e.addSeTag=67]="addSeTag",e[e.delSeTag=68]="delSeTag",e[e.addTag=69]="addTag",e[e.delTag=70]="delTag",e[e.disTag=71]="disTag",e[e.reportsdk=72]="reportsdk"}(ed||(ed={}));var nd,rd,id=ed,sd=(nd=s(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=s(regeneratorRuntime.mark((function e(t){var i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Date.now(),s="".concat(n,"://").concat(t,"/ping?r=").concat(Zr(1e3,9999)),e.next=4,r.httpReq({url:s,timeout:5e3});case 4:return o=e.sent,e.abrupt("return",{status:o.status,host:t,cost:Date.now()-i});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return(i=(i=e.sent).filter((function(e){return 200===e.status}))).length>1&&(i=i.sort((function(e,t){return e.cost-t.cost}))),e.abrupt("return",i.map((function(e){return e.host})));case 6:case"end":return e.stop()}}),e)}))),function(e,t,n){return nd.apply(this,arguments)}),od=function(e,t,n,r,i,s,o){return"".concat(e,"://").concat(t,"/websocket?appId=").concat(n,"&token=").concat(encodeURIComponent(r),"&sdkVer=").concat(s,"&pid=").concat(o,"&apiVer=").concat(i.isFromUniapp?"uniapp":"normal").concat(i.connectPlatform?"&platform="+i.connectPlatform:"")},ad=function(e){return[id.ppMsgS,id.pgMsgS,id.chatMsgS].map((function(e){return id[e]})).indexOf(e)>=0};!function(e){e[e.REDIRECT=0]="REDIRECT",e[e.OTHER_DEVICE_LOGIN=1]="OTHER_DEVICE_LOGIN",e[e.BLOCK=2]="BLOCK",e[e.REMOTE_CLOSE=3]="REMOTE_CLOSE",e[e.LOGOUT=4]="LOGOUT",e[e.BLOCK_NEW=5]="BLOCK_NEW",e[e.REDIRECT_NEW=6]="REDIRECT_NEW"}(rd||(rd={}));var ud,cd=function(e,t){_r.debug("websocket send -> messageId: ".concat(e.messageId));var n=e.getBufferData();t.send(n.buffer)},ld=function(e){f(l,e);var t,n,i,a,c=T(l);function l(e,t){var n;return o(this,l),(n=c.call(this,"websocket",t))._runtime=e,n._socket=null,n._messageIds={},n._syncMessageIds={},n._failedCount=0,n.ALLOW_FAILED_TIMES=2,n._timer=null,n._idCount=0,n._generateMessageId=function(){return n._idCount>=65535&&(n._idCount=0),++n._idCount},n}return u(l,[{key:"connect",value:(a=s(regeneratorRuntime.mark((function e(t,n,i,s,o){var a,u,c,l,h,f,d=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=qn(o),this._watcher.status(td.CONNECTING),_r.debug("ping -> protocol: ".concat(s,", hosts: ").concat(JSON.stringify(i))),e.next=5,sd(i,s,this._runtime);case 5:if(a=e.sent,_r.debug("valid hosts -> ".concat(a.join(","))),0!==a.length){e.next=10;break}return _r.error("No valid websocket server hosts!"),e.abrupt("return",so.RC_SOCKET_NOT_CREATED);case 10:u=s.replace("http","ws"),c=regeneratorRuntime.mark((function e(r,i){var s,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=od(u,a[r],t,n,d._runtime,o),_r.debug("conenct start -> ".concat(s)),c=d._runtime.createWebSocket(s),l=function(e){d._timer&&(clearTimeout(d._timer),d._timer=null),d._socket===c&&(d._socket=null,d._watcher.status(e))},e.next=6,new Promise((function(e){c.onMessage((function(t){if("[object ArrayBuffer]"===Object.prototype.toString.call(t)){var n=Zf(t);if(n instanceof Ff&&d._pingResolve)return d._pingResolve(so.SUCCESS),void(d._pingResolve=void 0);if(n instanceof Pf)return _r.debug("recv connect ack -> ".concat(n.status)),n.status!==Xf.ACCEPTED?(_r.warn("connect failed: ".concat(n.status)),void e(n.status)):(_r.info("connect success -> ".concat(s)),d.connectedTime=n.timestamp,d.userId=n.userId||"",void e(so.SUCCESS));if(n instanceof Df){var r=n.status;switch(_r.warn("recv disconnect signal -> status: ".concat(r)),r){case rd.BLOCK:d._watcher.status(td.BLOCKED);break;case rd.OTHER_DEVICE_LOGIN:d._watcher.status(td.KICKED_OFFLINE_BY_OTHER_CLIENT);break;case rd.REDIRECT_NEW:case rd.REDIRECT:d._watcher.status(td.REDIRECT);break;default:d._watcher.status(td.DISCONNECT_BY_SERVER)}}else d._onReceiveSignal(n)}else _r.error("Socket received invalid data:",t)})),c.onClose((function(t,n){_r.warn("websocket closed! code:",t,"reason:",n),l(td.CONNECTION_CLOSED),e(t)})),c.onError((function(t){_r.error("websocket error!",null==t?void 0:t.stack),l(td.WEBSOCKET_ERROR),e(so.NETWORK_ERROR)})),c.onOpen((function(){return _r.debug("websocket open =>",s)})),setTimeout((function(){e(so.TIMEOUT)}),xt)}));case 6:if((h=e.sent)!==Xf.REDIRECT){e.next=9;break}return e.abrupt("return",{v:h});case 9:if(h!==so.SUCCESS){e.next=16;break}return d._socket=c,d._checkAlive(),d._watcher.status(td.CONNECTED),e.abrupt("return",{v:h});case 16:_r.warn("connect result -> code: ".concat(h,", url: ").concat(s));case 17:c.close();case 18:case"end":return e.stop()}}),e)})),l=0,h=a.length;case 13:if(!(l<h)){e.next=21;break}return e.delegateYield(c(l,h),"t0",15);case 15:if("object"!==r(f=e.t0)){e.next=18;break}return e.abrupt("return",f.v);case 18:l+=1,e.next=13;break;case 21:return e.abrupt("return",so.RC_NET_UNAVAILABLE);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return a.apply(this,arguments)})},{key:"_checkAlive",value:(i=s(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._socket){e.next=2;break}return e.abrupt("return");case 2:return _r.debug("send ping ->"),this.sendOnly(new Bf),e.next=6,new Promise((function(e){r._pingResolve=e,r._timer=setTimeout((function(){r._pingResolve=void 0,e(so.TIMEOUT)}),Dt)}));case 6:if((t=e.sent)===so.SUCCESS){e.next=12;break}return this._failedCount+=1,_r.warn("ping failed count: ".concat(this._failedCount,", code: ").concat(t)),this._failedCount>=this.ALLOW_FAILED_TIMES?(this._failedCount=0,_r.warn("ping timeout, close current websocket to reconnect!"),null===(n=this._socket)||void 0===n||n.close()):this._checkAlive(),e.abrupt("return");case 12:_r.debug("recv pong <-"),this._failedCount=0,setTimeout((function(){return r._checkAlive()}),3e4);case 15:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_onReceiveSignal",value:(n=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.messageId,t.header&&t.header.qos!==Kc.AT_MOST_ONCE&&(t instanceof qf&&!t.syncMsg&&(_r.debug("send pubAck -> ".concat(n)),this.sendOnly(new Kf(n))),t instanceof zf&&(_r.debug("send queryCon -> ".concat(n)),this.sendOnly(new Qf(n)))),n>0&&(_r.debug("recv ack -> messageId: ".concat(n)),(r=this._messageIds[n])&&(r(t),delete this._messageIds[n]),(i=this._syncMessageIds[n])&&(delete this._syncMessageIds[n],i(t))),!(t instanceof qf)){e.next=16;break}if(s=t.syncMsg,(o=t.topic)!==id[id.userSetData]){e.next=8;break}return e.abrupt("return");case 8:if(s&&!ad(o)){e.next=11;break}return this._watcher.signal(t),e.abrupt("return");case 11:return e.next=13,new Promise((function(e){u._syncMessageIds[n]=e}));case 13:a=e.sent,delete this._syncMessageIds[n],this._watcher.signal(t,a);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"sendOnly",value:function(e){this._socket&&cd(e,this._socket)}},{key:"send",value:(t=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u=this,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>3&&void 0!==c[3]?c[3]:Dt,!this._socket){e.next=16;break}return s=this._generateMessageId(),t.messageId=s,cd(t,this._socket),e.next=7,new Promise((function(e){u._messageIds[s]=e,setTimeout((function(){u._messageIds[s]&&delete u._messageIds[s],e()}),i)}));case 7:if(o=e.sent){e.next=11;break}return _r.warn("send timeout -> message: ".concat(s,", respPBName: ").concat(n,", timeout: ").concat(i)),e.abrupt("return",{code:so.TIMEOUT});case 11:if(0===o.status){e.next=14;break}return _r.warn("send failed -> message: ".concat(s,", respPBName: ").concat(n,", status: ").concat(o.status)),e.abrupt("return",{code:o.status});case 14:return a=n?this.codec.decodeByPBName(o.data,n,r):o,e.abrupt("return",{code:so.SUCCESS,data:a});case 16:return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 17:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"close",value:function(){this._socket&&(this._socket.close(),this._socket=null,this._watcher.status(td.DISCONNECTED))}}]),l}(Mf);e.HttpMethod=void 0,(ud=e.HttpMethod||(e.HttpMethod={})).GET="GET",ud.POST="POST";var hd=function(e){if(fr(e))return!0;var t=!1;try{var n=JSON.parse(e);t=JSON.stringify(n)===e}catch(e){t=!1}return t},fd=function(t){f(l,t);var n,r,i,a,c=T(l);function l(e,t){var n;return o(this,l),(n=c.call(this,"comet",t))._runtime=e,n._messageIds={},n._syncMessageIds={},n._idCount=0,n._generateMessageId=function(){return++n._idCount},n._pid=encodeURIComponent((new Date).getTime()+Math.random()+""),n}return u(l,[{key:"handleCometRes",value:function(e){var t=this;if(200!==e.status&&202!==e.status)return!1;var n=or(e.data)?JSON.parse(e.data):e.data;return n?!cr(n)||(ho(n,function(){var e=s(regeneratorRuntime.mark((function e(n){var r,i,s,o,a,u,c,l,h,f,d,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.sessionid)&&(t._sessionid=r),i=$f(n),s=i.messageId,o=i._header,a=i.status,i.identifier,u=o&&o.qos!==Kc.AT_MOST_ONCE,s&&i.getIdentifier&&((c=t._messageIds[s])&&c(i),t._syncMessageIds[s]&&t._syncMessageIds[s](i)),u&&(i instanceof qf&&!i.syncMsg&&(l=new Kf(s),t.sendOnly(l)),i instanceof zf&&(h=new Qf(s),t.sendOnly(h))),!(i instanceof Df)){e.next=20;break}e.t0=a,e.next=e.t0===rd.OTHER_DEVICE_LOGIN?11:e.t0===rd.BLOCK?13:e.t0===rd.REDIRECT_NEW||e.t0===rd.REDIRECT?15:17;break;case 11:return t._watcher.status(td.KICKED_OFFLINE_BY_OTHER_CLIENT),e.abrupt("break",19);case 13:return t._watcher.status(td.BLOCKED),e.abrupt("break",19);case 15:return t._watcher.status(td.REDIRECT),e.abrupt("break",19);case 17:return t._watcher.status(td.DISCONNECT_BY_SERVER),e.abrupt("break",19);case 19:return e.abrupt("return");case 20:if(!(i instanceof qf)){e.next=30;break}if(f=i.syncMsg,d=i.topic,f&&!ad(d)){e.next=25;break}return t._watcher.signal(i),e.abrupt("return",!1);case 25:return e.next=27,new Promise((function(e){t._syncMessageIds[s]=e}));case 27:g=e.sent,delete t._syncMessageIds[s],t._watcher.signal(i,g);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),!0):(_r.error("received data is not a validJson",n),!1)}},{key:"_startPullSignal",value:(a=s(regeneratorRuntime.mark((function e(t){var n,r,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).getTime(),r="".concat(t,"://").concat(this._domain,"/pullmsg.js?sessionid=").concat(this._sessionid,"&timestrap=").concat(n,"&pid=").concat(this._pid),e.next=4,this._runtime.httpReq({url:r,body:{pid:this._pid},timeout:45e3});case 4:i=e.sent,s=this.handleCometRes(i),this._isDisconnected||(s?this._startPullSignal(t):(this._watcher.status(td.NETWORK_UNAVAILABLE),this.close()));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"connect",value:(i=s(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c,l,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=qn(s),this._protocol=i,this._isDisconnected=!1,this._watcher.status(td.CONNECTING),e.next=6,sd(r,i,this._runtime);case 6:if(0!==(o=e.sent).length){e.next=10;break}return _r.error("No valid comet server hosts!"),e.abrupt("return",so.RC_SOCKET_NOT_CREATED);case 10:a=function(e){return(200===e.status||202===e.status)&&!!e.data&&(hd(e.data)?fr(e.data)?e.data:JSON.parse(e.data):(_r.error("received data is not a validJson",e.data),!1))},u=0,c=o.length;case 12:if(!(u<c)){e.next=31;break}return l=od(i,o[u],t,n,this._runtime,s,this._pid),e.next=16,this._runtime.httpReq({url:l,body:{pid:this._pid},timeout:xt});case 16:if(h=e.sent,f=a(h),this._domain=o[u],!f||f.status!==Xf.REDIRECT){e.next=21;break}return e.abrupt("return",f.status);case 21:if(!f||0!==f.status){e.next=28;break}return this._watcher.status(td.CONNECTED),this._sessionid=f.sessionid,this._startPullSignal(i),this.userId=f.userId,this.connectedTime=f.timestamp,e.abrupt("return",f.status);case 28:u+=1,e.next=12;break;case 31:return e.abrupt("return",so.RC_NET_UNAVAILABLE);case 32:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,s){return i.apply(this,arguments)})},{key:"sendCometData",value:(r=s(regeneratorRuntime.mark((function t(n){var r,i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this._domain,i=this._sessionid,s=this._pid,o=n.messageId,a=n.topic,u=n.targetId,n.identifier,c=n.getHeaderFlag(),l=a?"".concat(this._protocol,"://").concat(r,"/websocket?messageid=").concat(o,"&header=").concat(c,"&sessionid=").concat(i,"&topic=").concat(a,"&targetid=").concat(u,"&pid=").concat(s):"".concat(this._protocol,"://").concat(r,"/websocket?messageid=").concat(o,"&header=").concat(c,"&sessionid=").concat(i,"&pid=").concat(s),t.next=7,this._runtime.httpReq({url:l,method:e.HttpMethod.POST,body:n.getCometData()});case 7:h=t.sent,this.handleCometRes(h);case 9:case"end":return t.stop()}}),t,this)}))),function(e){return r.apply(this,arguments)})},{key:"sendOnly",value:function(e){this.sendCometData(e)}},{key:"send",value:(n=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u=this,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>3&&void 0!==c[3]?c[3]:Dt,s=this._generateMessageId(),t.messageId=s,this.sendCometData(t),e.next=6,new Promise((function(e){u._messageIds[s]=e,setTimeout((function(){delete u._messageIds[s],e()}),i)}));case 6:if(o=e.sent){e.next=9;break}return e.abrupt("return",{code:so.TIMEOUT});case 9:if(0===o.status){e.next=11;break}return e.abrupt("return",{code:o.status});case 11:return a=n?this.codec.decodeByPBName(o.data,n,r):o,e.abrupt("return",{code:so.SUCCESS,data:a});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"close",value:function(){this._isDisconnected=!0,this._watcher.status(td.DISCONNECTED)}}]),l}(Mf),dd=function e(t,n,r){o(this,e),this.runtime=t,this._watcher=n,this._options=r,this.currentUserId="",this._appkey=this._options.appkey,this._apiVer=this._options.apiVersion,this.navi=this._createNavi()},gd=function(e,t){return["navi",e,t].join("_")},pd=function(e,t,n){var r,i=gd(e,t),s=n.getItem(i);if(!s)return null;try{r=JSON.parse(s)}catch(e){return n.removeItem(i),null}return Date.now()-r.timestamp>=Mt?(n.removeItem(i),null):r.naviInfo},vd=function(){function e(t,n){o(this,e),this._runtime=t,this._options=n,this._naviInfo=null,this._appkey=this._options.appkey,this._apiVersion=qn(this._options.apiVersion)}var t;return u(e,[{key:"getInfo",value:(t=s(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&this._clear(t),!(i=pd(this._appkey,t,this._runtime.localStorage))){e.next=5;break}return this._naviInfo=i,e.abrupt("return",i);case 5:return s=this._options.navigators.slice(),n.length&&n.forEach((function(e){s.indexOf(e)<0&&s.unshift(e)})),e.next=9,this._reqNavi(s,this._appkey,t);case 9:if(!(i=e.sent)){e.next=14;break}return this._naviInfo=i,this.setNaviInfo2Cache(t,i),e.abrupt("return",i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"setNaviInfo2Cache",value:function(e,t){!function(e,t,n,r){var i=gd(e,t),s={naviInfo:n,timestamp:Date.now()};r.setItem(i,JSON.stringify(s))}(this._appkey,e,t,this._runtime.localStorage)}},{key:"getInfoFromCache",value:function(e){return this._naviInfo}},{key:"_clear",value:function(e){!function(e,t,n){n.removeItem(gd(e,t))}(this._appkey,e,this._runtime.localStorage)}}]),e}(),yd=Object.assign,md=Object.defineProperty,Ed=!yd||A((function(){if(M&&1!==yd({b:1},yd(md({},"a",{enumerable:!0,get:function(){md(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=yd({},e)[n]||Ln(yd({},t)).join("")!=r}))?function(e,t){for(var n=at(e),r=arguments.length,i=1,s=Qe.f,o=L.f;r>i;)for(var a,u=F(arguments[i++]),c=s?Ln(u).concat(s(u)):Ln(u),l=c.length,h=0;l>h;)a=c[h++],M&&!o.call(u,a)||(n[a]=u[a]);return n}:yd;st({target:"Object",stat:!0,forced:Object.assign!==Ed},{assign:Ed});var _d=je.includes;st({target:"Array",proto:!0},{includes:function(e){return _d(this,e,arguments.length>1?arguments[1]:void 0)}}),ea("includes");var Td=function(e){if(Br(e))throw TypeError("The method doesn't accept regular expressions");return e},Rd=_t("match");st({target:"String",proto:!0,forced:!function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Rd]=!1,"/./"[e](t)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~String(Y(this)).indexOf(Td(e),arguments.length>1?arguments[1]:void 0)}});var Id="outbox",Cd="inbox",Sd=function(e,t,n){return[e,t,n].join("_")},bd=function(){function e(t,n){o(this,e),this._runtime=t,this._appkey=n,this._inboxTime=0,this._outboxTime=0}return u(e,[{key:"setInboxTime",value:function(e,t){if(!(this._inboxTime>e)){this._inboxTime=e;var n=Sd(Cd,this._appkey,t);this._runtime.localStorage.setItem(n,e.toString())}}},{key:"getInboxTime",value:function(e){if(0===this._inboxTime){var t=Sd(Cd,this._appkey,e);this._inboxTime=parseInt(this._runtime.localStorage.getItem(t))||0}return this._inboxTime}},{key:"setOutboxTime",value:function(e,t){if(!(this._outboxTime>=e)){this._outboxTime=e;var n=Sd(Id,this._appkey,t);this._runtime.localStorage.setItem(n,e.toString())}}},{key:"getOutboxTime",value:function(e){if(0===this._outboxTime){var t=Sd(Id,this._appkey,e);this._outboxTime=parseInt(this._runtime.localStorage.getItem(t))||0}return this._outboxTime}}]),e}(),wd={_caches:{},set:function(e,t){this._caches[e]=t},get:function(e){return this._caches[e]||0},clear:function(e){this._caches[e]=0}},Od=function(){function e(t,n){o(this,e),this._kvCaches={},this._chatroomId=t,this._currentUserId=n}return u(e,[{key:"_add",value:function(e){var t=e.key;e.isDeleted=!1,this._kvCaches[t]=e}},{key:"_remove",value:function(e){var t=e.key,n=this._kvCaches[t];n.isDeleted=!0,this._kvCaches[t]=n}},{key:"_setEntry",value:function(e,t){var n=e.key,r=e.type,i=e.isOverwrite,s=e.userId,o=this._getSetUserId(n),a=r===mo.DELETE,u=o===s,c=!this._isExisted(n),l=a?this._remove:this._add;(t||i||u||c)&&l.call(this,e)}},{key:"getValue",value:function(e){var t=this._kvCaches[e]||{};return t.isDeleted?null:t.value}},{key:"getAllValue",value:function(){var e={};for(var t in this._kvCaches)this._kvCaches[t].isDeleted||(e[t]=this._kvCaches[t].value);return e}},{key:"_getSetUserId",value:function(e){return(this._kvCaches[e]||{}).userId}},{key:"_isExisted",value:function(e){var t=this._kvCaches[e]||{},n=t.value,r=t.isDeleted;return n&&!r}},{key:"setEntries",value:function(e){var t=this,n=e.kvEntries,r=e.isFullUpdate;n=n||[],(r=r||!1)&&this.clear(),n.forEach((function(e){t._setEntry(e,r)}))}},{key:"clear",value:function(){this._kvCaches={}}}]),e}(),Nd=function(){function e(t){o(this,e),this._pullQueue=[],this._isPulling=!1,this._storeCaches={},this._engine=t}var t;return u(e,[{key:"_startPull",value:(t=s(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isPulling&&0!==this._pullQueue.length){e.next=2;break}return e.abrupt("return");case 2:if(this._isPulling=!0,t=this._pullQueue.splice(0,1)[0],n=t.chrmId,r=t.timestamp,!((i=wd.get(n))>r)){e.next=9;break}return this._isPulling=!1,this._startPull(),e.abrupt("return");case 9:return e.next=11,this._engine.pullChatroomEntry(n,i);case 11:s=e.sent,o=s.code,a=s.data,o===so.SUCCESS?(this._isPulling=!1,wd.set(n,a.syncTime||0),this._startPull()):this._startPull();case 15:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"reset",value:function(e){wd.clear(e);var t=this._storeCaches[e];t&&t.clear()}},{key:"pullEntry",value:function(e,t){this._pullQueue.push({chrmId:e,timestamp:t}),this._startPull()}},{key:"setLocal",value:function(e,t,n){var r=this._storeCaches[e];vr(r)||(r=new Od(e,n)),r.setEntries(t),this._storeCaches[e]=r}},{key:"getValue",value:function(e,t){var n=this._storeCaches[e];return n?n.getValue(t):null}},{key:"getAll",value:function(e){var t=this._storeCaches[e],n={};return t&&(n=t.getAllValue()),n}}]),e}(),kd=function(){function e(t,n,r,i){o(this,e),this._runtime=t,this._appkey=n,this._userId=r,this._canJoinMulipleChrm=i,this._sessionKey="",this._joinedChrmsInfo={},this._sessionKey="sync-chrm-".concat(this._appkey,"-").concat(this._userId)}return u(e,[{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!this._canJoinMulipleChrm&&(this._joinedChrmsInfo={}),this._joinedChrmsInfo[e]=t,this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo))}},{key:"get",value:function(){var e,t;try{t=this._runtime.sessionStorage.getItem(this._sessionKey),e=JSON.parse(t||"{}")}catch(n){_r.error("parse rejoined chrm infos error -> ".concat(t)),e={}}return e}},{key:"remove",value:function(e){delete this._joinedChrmsInfo[e],vr(this._joinedChrmsInfo)?this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo)):this.clear()}},{key:"clear",value:function(){this._joinedChrmsInfo={},this._runtime.sessionStorage.removeItem(this._sessionKey)}}]),e}(),Ad="converStatusChanged",Md=function(){function e(t,n,r){o(this,e),this._eventEmitter=new Ur,this._pullQueue=[],this._isPulling=!1,this._storage=jt(t.runtime),this._appkey=n,this._currentUserId=r,this._engine=t,this._storagePullTimeKey="con-s-".concat(n,"-").concat(r)}var t;return u(e,[{key:"_set",value:function(e){var t=this;if(!gr(e)){var n=this._storage.get(this._storagePullTimeKey)||0,r=e.length;e.forEach((function(e,i){var s=e.updatedTime||0;n=s>n?s:n,e.conversationType=e.type,t._eventEmitter.emit(Ad,{statusItem:e,isLastPull:i===r-1})})),this._storage.set(this._storagePullTimeKey,n)}}},{key:"_startPull",value:(t=s(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isPulling&&0!==this._pullQueue.length){e.next=2;break}return e.abrupt("return");case 2:return this._isPulling=!0,t=this._pullQueue.splice(0,1)[0],e.next=6,this._engine.pullConversationStatus(t);case 6:n=e.sent,r=n.code,i=n.data,r===so.SUCCESS?(this._isPulling=!1,this._set(i),this._startPull()):this._startPull();case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pull",value:function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())}},{key:"watch",value:function(e){this._eventEmitter.on(Ad,(function(t){e(t)}))}},{key:"unwatch",value:function(){this._eventEmitter.off(Ad,(function(e){}))}}]),e}(),xd={c:{keyName:"unreadMessageCount",defaultVal:0},hm:{keyName:"hasMentioned",defaultVal:!1},m:{keyName:"mentionedInfo",defaultVal:null},t:{keyName:"lastUnreadTime",defaultVal:0},nc:{keyName:"notificationStatus",defaultVal:2},to:{keyName:"isTop",defaultVal:!1},tg:{keyName:"tags",defaultVal:{}}},Ud={};for(var Ld in xd){var Pd=xd[Ld].keyName;Ud[Pd]=Ld}var Dd,Vd=function(){function e(t,n,r){o(this,e),this._appkey=n,this._currentUserId=r;var i="con-".concat(n,"-").concat(r);this.storage=new Gt(t,i)}return u(e,[{key:"_getStoreKey",value:function(e,t){return"".concat(e,"_").concat(t)}},{key:"_getConOptionByKey",value:function(e){var t=(e=e||"").split("_");return t.length>=2?{conversationType:t[0],targetId:e.match(/_.*/g)[0].substring(1)}:{conversationType:rr.PRIVATE,targetId:""}}},{key:"updateMentionedData",value:function(e){var t,n=this,r=e.conversationType,i=e.targetId,s=e.messageType,o=e.isMentioned,a=e.content,u=e.senderUserId,c=this._getStoreKey(r,i),l=this.storage.get(c)||{},h=Ud.mentionedInfo,f=Ud.hasMentioned,d=l[h]||{},g=d.userIdList||[],p=a.mentionedInfo;o&&r===rr.GROUP&&((p.userIdList||[]).forEach((function(e){e===n._currentUserId&&g.indexOf(u)<0&&g.push(u)})),p.type===Qh.ALL&&g.indexOf(u)<0&&g.push(u));if(s===Jh.RECALL&&r===rr.GROUP){var v=g.indexOf(u);v>=0&&g.splice(v,1)}p={userIdList:g,type:(null===(t=p)||void 0===t?void 0:t.type)||d.type},0!==g.length?(l[h]=p,l[f]=!0):(delete l[h],delete l[f]),vr(l)?this.storage.set(c,l):this.storage.remove(c)}},{key:"set",value:function(e,t,n){var r=this._getStoreKey(e,t),i=this.storage.get(r)||{};for(var s in n){var o=Ud[s],a=n[s];if(!gr(o)&&!gr(a)&&"hasMentioned"!==s&&"MentionedInfo"!==s){if(a===xd[o].defaultVal||"tags"===s&&!vr(a))delete i[o];else if("tags"===s){var u=a;for(var c in u)u[c].isTop||delete u[c].isTop;i[o]=a}else i[o]=a;i.c||(delete i.t,delete i.hm,delete i.m)}}vr(i)?this.storage.set(r,i):this.storage.remove(r)}},{key:"get",value:function(e,t){var n=this._getStoreKey(e,t),r=this.storage.get(n)||{},i={};for(var s in xd){var o=xd[s],a=o.keyName,u=o.defaultVal;i[a]=r[s]||vo(u)}return i}},{key:"getValue",value:function(e){var t=this.storage.getValues()||{},n=[];for(var r in t){var i=this._getConOptionByKey(r),s={conversationType:i.conversationType,targetId:i.targetId},o=t[r];for(var a in o){var u=xd[a],c=u.keyName,l=u.defaultVal;s[c]=o[a]||vo(l)}s=e?e(s):s,n.push(s)}return n}},{key:"getValueForTag",value:function(){var e=this.storage.getValues()||{},t={};for(var n in e){var r=this._getConOptionByKey(n),i=r.conversationType,s=r.targetId,o={},a=e[n];for(var u in a){var c=xd[u],l=c.keyName,h=c.defaultVal;o[l]=a[u]||vo(h)}for(var f in o.tags){gr(t[f])&&(t[f]=[]);var d=Object.assign({},o,{conversationType:i,targetId:s});delete d.tags,t[f].push(d)}}return t}}]),e}(),Bd=[rr.PRIVATE,rr.GROUP,rr.SYSTEM],Fd="conversationChanged",Yd=function(){function e(t,n,r,i){var s=this;o(this,e),this._updatedConversations={},this._eventEmitter=new Ur,this._draftMap={},this._appkey=n,this._loginUserId=r,this._store=new Vd(t.runtime,n,r),this._statusManager=new Md(t,n,r),this._statusManager.watch((function(e){var t=e.statusItem,n=e.isLastPull;s.addStatus(t,n)})),this._eventEmitter.on(Fd,(function(e){i(e)}))}return u(e,[{key:"_calcUnreadCount",value:function(e,t){var n=e.content,r=e.messageType,i=e.sentTime,s=e.isCounted,o=e.messageDirection,a=e.senderUserId,u=o===kf.SEND&&a===this._loginUserId,c=r===Jh.RECALL,l=fr(n),h=!1,f=t.lastUnreadTime||0,d=t.unreadMessageCount||0;if(f>i||u)return{hasChanged:h,localConversation:t};(s&&(t.unreadMessageCount=d+1,t.lastUnreadTime=i,h=!0),c&&l)&&(f>=n.sentTime&&d&&(t.unreadMessageCount=d-1,h=!0));return{hasChanged:h,localConversation:t}}},{key:"_calcMentionedInfo",value:function(e,t){var n=e.content,r=(e.messageDirection,e.isMentioned);kf.SEND;var i=fr(n),s=!1;return r&&i&&n.mentionedInfo&&(t.hasMentioned=!0,s=!0),{hasChanged:s,localConversation:t}}},{key:"_setUpdatedConversation",value:function(e){if(fr(e)){var t=e.conversationType,n=e.targetId,r="".concat(t,"_").concat(n),i=this._store.get(t,n)||{};this._updatedConversations[r]=Object.assign(i,e)}}},{key:"addStatus",value:function(e,t){var n=e.conversationType,r=e.targetId,i=e.updatedTime,s=e.notificationStatus,o=e.isTop,a=e.tags,u={},c={};gr(s)||(c.notificationStatus={time:i,val:s}),gr(o)||(c.isTop={time:i,val:o}),gr(a)||(c.tags={time:i,val:a},null==a||a.forEach((function(e){u[e.tagId]={isTop:e.isTop}}))),this._store.set(n,r,{notificationStatus:s,isTop:o,tags:u}),this._setUpdatedConversation({conversationType:n,targetId:r,updatedItems:c}),t&&this._notifyConversationChanged()}},{key:"_notifyConversationChanged",value:function(){var e=[];for(var t in this._updatedConversations)e.push(this._updatedConversations[t]);this._eventEmitter.emit(Fd,e),this._updatedConversations={}}},{key:"setConversationCacheByMessage",value:function(e,t){var n=this,r=e.conversationType,i=e.isPersited,s=e.targetId;if(Bd.indexOf(r)>=0){var o=!1,a=this._store.get(r,s);if([this._calcUnreadCount,this._calcMentionedInfo].forEach((function(t){var r=t.call(n,e,a),i=r.hasChanged,s=r.localConversation;o=o||i,a=vo(s)})),o&&this._store.set(r,s,a),this._store.updateMentionedData(e),i){var u=this._store.get(r,s);u.updatedItems={latestMessage:{time:e.sentTime,val:e}},u.latestMessage=e;var c=Object.assign(u,{conversationType:r,targetId:s});this._setUpdatedConversation(c)}t&&this._notifyConversationChanged()}}},{key:"get",value:function(e,t){return this._store.get(e,t)}},{key:"getAllUnreadCount",value:function(e,t,n){var r=this._store.getValue(),i=0;return r.forEach((function(e){var t=e.unreadMessageCount;t=t||0,i+=Number(t)})),i}},{key:"getUnreadCountByTag",value:function(e,t){var n=this._store.getValueForTag()[e]||[],r=0;return n.forEach((function(e){var n=e.unreadMessageCount,i=e.notificationStatus;(t||1!==i)&&(n=n||0,r+=Number(n))})),r}},{key:"getUnreadCount",value:function(e,t){return this._store.get(e,t).unreadMessageCount||0}},{key:"clearUnreadCount",value:function(e,t){var n=this._store.get(e,t),r=n.unreadMessageCount,i=n.hasMentioned;(r||i)&&(n.unreadMessageCount=0,n.hasMentioned=!1),this._store.set(e,t,n);var s=Object.assign(n,{conversationType:e,targetId:t});this._setUpdatedConversation(s),this._notifyConversationChanged()}},{key:"startPullConversationStatus",value:function(e){this._statusManager.pull(e)}},{key:"setDraft",value:function(e,t,n){var r="".concat(e,"_").concat(t);this._draftMap[r]=n}},{key:"getDraft",value:function(e,t){var n="".concat(e,"_").concat(t);return this._draftMap[n]}},{key:"clearDraft",value:function(e,t){var n="".concat(e,"_").concat(t);delete this._draftMap[n]}},{key:"addTagStatus",value:function(e,t,n){var r=this._store.get(e,t).tags;r=Object.assign(r,n),this._store.set(e,t,{tags:r})}},{key:"deleteTagStatus",value:function(e,t,n){var r=this._store.get(e,t).tags;n.forEach((function(e){delete r[e]})),this._store.set(e,t,{tags:r})}},{key:"getConversationListForTag",value:function(){return this._store.getValueForTag()}}]),e}();!function(e){e[e.QINIU=1]="QINIU",e[e.ALI=2]="ALI",e[e.AWS=3]="AWS",e[e.STC=4]="STC"}(Dd||(Dd={}));var jd,qd,Gd,Hd=Dd;e.RTCMode=void 0,(jd=e.RTCMode||(e.RTCMode={}))[jd.RTC=0]="RTC",jd[jd.LIVE=2]="LIVE",e.LiveType=void 0,(qd=e.LiveType||(e.LiveType={}))[qd.AUDIO_AND_VIDEO=0]="AUDIO_AND_VIDEO",qd[qd.AUDIO=1]="AUDIO",e.LiveRole=void 0,(Gd=e.LiveRole||(e.LiveRole={}))[Gd.ANCHOR=1]="ANCHOR",Gd[Gd.AUDIENCE=2]="AUDIENCE";var Kd,Wd={"RC:VCAccept":"RC:VCAccept","RC:VCRinging":"RC:VCRinging","RC:VCSummary":"RC:VCSummary","RC:VCHangup":"RC:VCHangup","RC:VCInvite":"RC:VCInvite","RC:VCModifyMedia":"RC:VCModifyMedia","RC:VCModifyMem":"RC:VCModifyMem"};e.RTCApiType=void 0,(Kd=e.RTCApiType||(e.RTCApiType={}))[Kd.ROOM=1]="ROOM",Kd[Kd.PERSON=2]="PERSON";var Qd=function(){function e(t,n,r,i){o(this,e),this._pullQueue=[],this._isPulling=!1,this._storageTagKey="tag-".concat(n,"-").concat(r),this._storagePullTimeKey="us-s-".concat(n,"-").concat(r),this._storage=jt(t.runtime),this._engine=t,this._tagWatcherFunc=i}var t;return u(e,[{key:"_updateTag",value:function(e){var t=e.tags,n={};t.forEach((function(e){n[e.tagId]={tagName:e.tagName,createdTime:e.createdTime}})),this._storage.set(this._storageTagKey,n),this._tagWatcherFunc()}},{key:"addTag",value:function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){var t,r=(null===(t=n[e.tagId])||void 0===t?void 0:t.createdTime)||e.createdTime||0;n[e.tagId]={tagName:e.tagName,createdTime:r}})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)}},{key:"deleteTag",value:function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){delete n[e]})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)}},{key:"getTagsInfo",value:function(){return this._storage.get(this._storageTagKey)||{}}},{key:"getTags",value:function(){var e=this._storage.get(this._storageTagKey)||{},t=[];for(var n in e)t.push({tagId:n,tagName:e[n].tagName,createdTime:e[n].createdTime,conversationCount:0});return t.sort((function(e,t){return(e.createdTime||0)-(t.createdTime||0)}))}},{key:"getTagById",value:function(e){var t=this._storage.get(this._storageTagKey)||{};return t[e]?{tagId:e,tagName:t[e].tagName,createdTime:t[e].createdTime,conversationCount:0}:null}},{key:"_startPull",value:(t=s(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isPulling&&0!==this._pullQueue.length){e.next=2;break}return e.abrupt("return");case 2:return this._isPulling=!0,t=this._pullQueue.splice(0,1)[0],e.next=6,this._engine.pullUserSettings(t);case 6:n=e.sent,r=n.code,i=n.data,r!==so.SUCCESS||gr(i)?(this._isPulling=!1,this._startPull()):(s=i.settings,o=i.version,a=s.Tag,gr(a)||this._updateTag(a),this._storage.set(this._storagePullTimeKey,o),this._isPulling=!1,this._startPull());case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"pullUserSettings",value:function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())}},{key:"getVersion",value:function(){return this._storage.get(this._storagePullTimeKey)||0}}]),e}(),zd=function(e){f(i,e);var t,n,r=T(i);function i(e,t){var n;return o(this,i),(n=r.call(this,e,t))._connectType=t.connectionType,n}return u(i,[{key:"_formatJSONPUrl",value:function(e,t,n,r){var i=this._runtime.isSupportSocket()&&"websocket"===this._connectType?"navi":"cometnavi";return"".concat(e,"/").concat(i,".js?appId=").concat(n,"&token=").concat(encodeURIComponent(t),"&callBack=").concat(r,"&v=").concat(this._apiVersion,"&r=").concat(Date.now())}},{key:"getInfo",value:(n=s(regeneratorRuntime.mark((function e(t,n,r){var s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._runtime.useNavi){e.next=5;break}return o=this._runtime.isSupportSocket()?Lt.join(","):Pt.join(","),a={code:200,protocol:"https",server:"",voipCallInfo:"",kvStorage:0,openHttpDNS:!1,historyMsg:!1,chatroomMsg:!1,uploadServer:"https://upload.qiniup.com",bosAddr:"https://gz.bcebos.com",location:"",monitor:0,joinMChrm:!1,openMp:0,openUS:0,grpMsgLimit:0,isFormatted:0,gifSize:2048,logSwitch:0,logPolicy:"",compDays:0,msgAck:"",activeServer:"",qnAddr:"",extkitSwitch:0,alone:!1,voipServer:"",offlinelogserver:"",backupServer:null!==(s=this._options.miniCMPProxy)&&void 0!==s&&s.length?this._options.miniCMPProxy.join(","):o},this.setNaviInfo2Cache(t,a),e.abrupt("return",a);case 5:return e.abrupt("return",R(d(i.prototype),"getInfo",this).call(this,t,n,r));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_reqNavi",value:(t=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="getServerEndpoint",s=0,o=t.length;case 2:if(!(s<o)){e.next=24;break}return a=this._formatJSONPUrl(t[s],r,n,i),_r.debug("req navi => ".concat(a)),e.next=7,this._runtime.httpReq({url:a,timeout:1e4});case 7:if(200===(u=e.sent).status){e.next=10;break}return e.abrupt("continue",21);case 10:return e.prev=10,c=u.data.replace("".concat(i,"("),"").replace(/\);?$/,""),l=JSON.parse(c),h=/^https/.test(a)?"https":"http",l.protocol=h,e.abrupt("return",l);case 18:e.prev=18,e.t0=e.catch(10),_r.error("parse navi err =>",e.t0);case 21:s+=1,e.next=2;break;case 24:return e.abrupt("return",null);case 25:case"end":return e.stop()}}),e,this,[[10,18]])}))),function(e,n,r){return t.apply(this,arguments)})}]),i}(vd),Jd=function(e){var t;return(t={},c(t,rr.PRIVATE,id.ppMsgP),c(t,rr.GROUP,id.pgMsgP),c(t,rr.CHATROOM,id.chatMsg),c(t,rr.CUSTOMER_SERVICE,id.pcMsgP),c(t,rr.RTC_ROOM,id.prMsgS),t)[e]},Zd=function(e,t,r,i,s,o){return{conversationType:e,targetId:t,senderUserId:o,messageDirection:kf.SEND,isCounted:!!r.isCounted,isMentioned:!!r.isMentioned,content:r.content,messageType:r.messageType,isOffLineMessage:!1,isPersited:!!r.isPersited,messageUId:i,sentTime:s,receivedTime:0,disableNotification:!!r.disableNotification,isStatusMessage:!!r.isStatusMessage,canIncludeExpansion:!!r.canIncludeExpansion,expansion:r.canIncludeExpansion?r.expansion:null,receivedStatus:n.UNREAD}},$d=function(e,t){return"RC:SRSMsg"===e.messageType&&Object.assign(e,{directionalUserIdList:[t]}),e},Xd=function(e){f(de,e);var t,n,r,i,a,l,d,g,p,v,y,m,_,R,I,S,b,w,O,N,k,A,M,x,U,L,P,D,V,B,F,Y,j,q,G,H,K,W,Q,z,J,Z,$,X,ee,te,ne,re,ie,se,oe,ae,ue,ce,le,he,fe=T(de);function de(e,t,n){var r;return o(this,de),(r=fe.call(this,e,t,n))._customMessageType={},r._connectedTime=0,r._localConnectedTime=0,r._pullingMsg=!1,r._pullQueue=[],r._chrmsQueue={},r._latestSyncTimestamp=0,r._intervalTimer=-1,r._sentMessageMap={},r._letterbox=new bd(e,n.appkey),r._chrmEntryHandler=new Nd(E(r)),r}return u(de,[{key:"_createNavi",value:function(){return new zd(this.runtime,this._options)}},{key:"getConnectedTime",value:function(){return this._connectedTime}},{key:"connect",value:(he=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],this._naviInfo=n,n.server?r.push(n.server):_r.warn("navi.server is invalid"),(i=n.backupServer)&&i.split(",").forEach((function(e){r.indexOf(e)<0&&r.push(e)})),0!==r.length){e.next=8;break}return _r.error("navi invaild.",r),e.abrupt("return",so.UNKNOWN);case 8:return s=this.runtime.createDataChannel({status:function(e){a._connectionStatusHandler(e,t,r,n.protocol)},signal:this._signalHandler.bind(this)},this._options.connectionType),e.next=11,s.connect(this._appkey,t,r,n.protocol,this._apiVer);case 11:return(o=e.sent)===so.SUCCESS?(this._channel=s,this.currentUserId=s.userId,this._connectedTime=s.connectedTime,this._localConnectedTime=Date.now(),this._conversationManager=new Yd(this,this._appkey,this.currentUserId,this._watcher.conversation),this._conversationManager.startPullConversationStatus(0),this._userSettingManager=new Qd(this,this._appkey,this.currentUserId,this._watcher.tag),this._userSettingManager.pullUserSettings(0),this._joinedChrmManager=new kd(this.runtime,this._appkey,this.currentUserId,n.joinMChrm),this._startSyncInterval()):s.close(),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return he.apply(this,arguments)})},{key:"_connectionStatusHandler",value:function(e,t,n,r){if(_r.warn("connection status changed:",e),e!==td.CONNECTING&&e!==td.CONNECTED){if(this._channel&&e!==td.DISCONNECTED)return e===td.BLOCKED||e===td.KICKED_OFFLINE_BY_OTHER_CLIENT||e===td.DISCONNECT_BY_SERVER?(this.disconnect(),void this._watcher.status(e)):void(e!==td.REDIRECT?this._try2Reconnect(t,n,r):this._watcher.status(e));this._watcher.status(e)}else this._watcher.status(e)}},{key:"_try2Reconnect",value:(le=s(regeneratorRuntime.mark((function e(t,n,r){var i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._channel.connect(this._appkey,t,n,r,this._apiVer);case 4:if(e.sent!==so.SUCCESS){e.next=8;break}return this._rejoinChrm(),e.abrupt("return");case 8:this._watcher.status(td.WEBSOCKET_UNAVAILABLE),setTimeout((function(){i._try2Reconnect(t,n,r)}),5e3);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return le.apply(this,arguments)})},{key:"_signalHandler",value:function(e,t){var n=e.syncMsg,r=e.topic;if(n)this._receiveSyncMsg(e,t);else{var i=id[r];if(i)switch(i){case id.s_ntf:_r.debug("recv s_ntf -> signal.messageId: ".concat(e.messageId)),this._pullMsg(e);break;case id.s_msg:this._receiveMsg(e);break;case id.s_cmd:this._receiveStateNotify(e);break;case id.s_us:this._receiveSettingNotify(e)}else _r.error("unknown topic:",r)}}},{key:"_receiveStateNotify",value:function(e){var t,n=null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,wl),r=n.time,i=n.type,s=n.chrmId;switch(i){case 2:this._chrmEntryHandler.pullEntry(s,r);break;case 3:this._conversationManager.startPullConversationStatus(r)}}},{key:"_receiveSettingNotify",value:function(e){var t,n=(null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,yh)).version;this._userSettingManager.pullUserSettings(n)}},{key:"_receiveMessageExpansion",value:function(e){var t=e.content,n=t.put,r=t.del,i=t.mid;n&&this._watcher.expansion({updatedExpansion:{messageUId:i,expansion:n}}),r&&this._watcher.expansion({deletedExpansion:{messageUId:i,deletedKeys:r}})}},{key:"_receiveSyncMsg",value:function(e,t){var n,r=null===(n=this._channel)||void 0===n?void 0:n.codec.decodeByPBName(e.data,El,{currentUserId:this.currentUserId,signal:e});(r=this._handleMsgProperties(r)).sentTime=t.timestamp,r.messageUId=t.messageUId,this._pullingMsg?this._pullQueue.push(t.timestamp):(this._sentMessageMap[t.messageUId]=t.timestamp,r.messageType!==Jh.EXPANSION_NOTIFY?(this._watcher.message(r),this._conversationManager.setConversationCacheByMessage(r,!0)):this._receiveMessageExpansion(r))}},{key:"_pullMsg",value:function(e){if(this._channel){var t=this._channel.codec.decodeByPBName(e.data,wl),n=t.type,r=t.chrmId,i=t.time;if(_r.debug("s_ntf -> type: ".concat(n,", chrmId: ").concat(r,", time: ").concat(i)),2===n){var s=this._chrmsQueue[r];if(!s)return;s.queue.push(i),this._pullChrmMsg(r)}else this._pullQueue.push(i),this._syncMsg()}}},{key:"_startSyncInterval",value:function(){var e=this;this._stopSyncInterval();this._intervalTimer=setInterval((function(){Date.now()-e._latestSyncTimestamp>=18e4&&e._syncMsg()}),3e4),this._latestSyncTimestamp=Date.now(),this._syncMsg()}},{key:"_stopSyncInterval",value:function(){-1!==this._intervalTimer&&(clearInterval(this._intervalTimer),this._intervalTimer=-1)}},{key:"_syncMsg",value:(ce=s(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a,u,c,l,h,f,d,g=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._pullingMsg){e.next=2;break}return e.abrupt("return");case 2:if(this._channel){e.next=5;break}return this._pullingMsg=!1,e.abrupt("return");case 5:return this._pullingMsg=!0,n=this._letterbox.getOutboxTime(this.currentUserId),r=this._letterbox.getInboxTime(this.currentUserId),_r.debug("pullMsg -> sendboxTime: ".concat(n,", inboxTime: ").concat(r)),i=this._channel.codec.encodeSyncMsg({sendboxTime:n,inboxTime:r}),s=new Wf(id[id.pullMsg],i,this.currentUserId),e.next=13,this._channel.send(s,Rl,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId});case 13:if(o=e.sent,a=o.code,u=o.data,this._latestSyncTimestamp=Date.now(),a===so.SUCCESS&&u){e.next=21;break}return _r.warn("pullMsg failed -> code:",a,", data: ",u),this._pullingMsg=!1,e.abrupt("return");case 21:c=u.list,l=u.finished,h=u.syncTime,_r.debug("pullMsg success -> syncTime: ".concat(h,", finished: ").concat(l)),f=0,c.forEach((function(e){if(e.messageDirection===kf.SEND&&(f=Math.max(e.sentTime,f),g._sentMessageMap[e.messageUId]))delete g._sentMessageMap[e.messageUId];else if(e.messageType!==Jh.EXPANSION_NOTIFY){var t=g._handleMsgProperties(e);g._conversationManager.setConversationCacheByMessage(t,!0),g._watcher.message(t)}else g._receiveMessageExpansion(e)})),this._letterbox.setInboxTime(h,this.currentUserId),this._letterbox.setOutboxTime(f,this.currentUserId),this._pullingMsg=!1,d=this._pullQueue.filter((function(e){return e>h})),this._pullQueue.length=0,(t=this._pullQueue).push.apply(t,C(d)),(!l||d.length>0)&&this._syncMsg();case 32:case"end":return e.stop()}}),e,this)}))),function(){return ce.apply(this,arguments)})},{key:"_receiveMsg",value:function(e){if(this._channel&&!this._pullingMsg){var t=this._channel.codec.decodeByPBName(e.data,Tl,{currentUserId:this.currentUserId,connectedTime:this._channel.connectedTime});(t=this._handleMsgProperties(t)).isStatusMessage||this._letterbox.setInboxTime(t.sentTime,this.currentUserId),t.messageType!==Jh.EXPANSION_NOTIFY?(this._watcher.message(t),this._conversationManager.setConversationCacheByMessage(t,!0)):this._receiveMessageExpansion(t)}}},{key:"_handleMsgProperties",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.messageType,i=e.isCounted,s=e.isPersited,o=e.isStatusMessage,a=r in Ft,u=r in this._customMessageType;return t=a?Ft[r]:u?this._customMessageType[r]:{isCounted:!pr(i)&&i,isPersited:!pr(s)&&s},Object.assign(e,{isCounted:t.isCounted,isPersited:t.isPersited,isStatusMessage:Yt.includes(r)}),n&&(e.isStatusMessage=o),e}},{key:"getHistoryMessage",value:(ue=s(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c,l,h,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.currentUserId,a=this._channel,u=If[t]||yf,c=1===i&&0===r,!a){e.next=14;break}return l=a.codec.encodeGetHistoryMsg(n,{timestamp:r,count:c?2:i,order:s}),e.next=7,a.send(new Wf(u,l,o),Nl,{currentUserId:o,connectedTime:a.connectedTime,conversation:{targetId:n}});case 7:if(h=e.sent,(f=h.code)===so.SUCCESS){e.next=11;break}return e.abrupt("return",{code:f});case 11:return d=h.data,c&&2===d.list.length&&(d.hasMore=!0,0===s?d.list.shift():d.list.pop()),e.abrupt("return",{code:f,data:{list:d.list,hasMore:d.hasMore}});case 14:return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return ue.apply(this,arguments)})},{key:"reportSDKInfo",value:function(e){var t=this.currentUserId,n=this._channel;if(n){_r.debug("reportSDKInfo ->",e);var r=n.codec.encodeReportSDKInfo(JSON.stringify(e)),i=new Wf(id[id.reportsdk],r,t);n.send(i).then((function(e){var t=e.code;t!==so.SUCCESS&&_r.warn("reportSDKInfo failed -> code: ".concat(t))}))}}},{key:"deleteRemoteMessage",value:(ae=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.currentUserId,!(s=this._channel)){e.next=11;break}return o=s.codec.encodeDeleteMessages(t,n,r),a=new Wf(af,o,i),e.next=6,s.send(a);case 6:if(u=e.sent,(c=u.code)===so.SUCCESS){e.next=10;break}return e.abrupt("return",c);case 10:return e.abrupt("return",c);case 11:return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return ae.apply(this,arguments)})},{key:"deleteRemoteMessageByTimestamp",value:(oe=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.currentUserId,!(s=this._channel)){e.next=12;break}return o=s.codec.encodeClearMessages(n,r),a=new Wf(Cf[t],o,i),e.next=7,s.send(a);case 7:if(u=e.sent,(c=u.code)===so.SUCCESS){e.next=11;break}return e.abrupt("return",c);case 11:return e.abrupt("return",c);case 12:return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return oe.apply(this,arguments)})},{key:"getConversationList",value:(se=s(regeneratorRuntime.mark((function e(){var t,n,r,i,s,o,a,u,c,l,h,f=this,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:300,n=d.length>1?d[1]:void 0,r=d.length>2?d[2]:void 0,i=d.length>3?d[3]:void 0,s=this.currentUserId,o=this._channel,n=n||rr.PRIVATE,!o){e.next=17;break}return a=o.codec.encodeOldConversationList({count:t,type:n,startTime:r,order:i}),u=new Wf(df,a,s),e.next=12,o.send(u,Al,{currentUserId:s,connectedTime:o.connectedTime,afterDecode:function(e){var t=e.conversationType,n=e.targetId,r=f._conversationManager.get(t,n);return Object.assign(e,r),e}});case 12:if(c=e.sent,l=c.code,h=c.data,l===so.SUCCESS){e.next=16;break}return e.abrupt("return",{code:l});case 16:return e.abrupt("return",{code:l,data:h});case 17:return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 18:case"end":return e.stop()}}),e,this)}))),function(){return se.apply(this,arguments)})},{key:"removeConversation",value:(ie=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this._channel)){e.next=12;break}return i=r.codec.encodeOldConversationList({type:t}),s=new Wf(gf,i,n),e.next=6,r.send(s);case 6:if(o=e.sent,_r.info("RemoveConversation =>",o),(a=o.code)===so.SUCCESS){e.next=11;break}return e.abrupt("return",a);case 11:return e.abrupt("return",a);case 12:return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return ie.apply(this,arguments)})},{key:"getConversation",value:(re=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._conversationManager.get(t,n)){e.next=3;break}return e.abrupt("return",{code:so.CONVER_GET_ERROR});case 3:return e.next=5,this.getHistoryMessage(t,n,0,1,0);case 5:if(s=e.sent,o=s.code,a=s.data,o===so.SUCCESS){e.next=10;break}return e.abrupt("return",{code:so.CONVER_GET_ERROR});case 10:return u=(null==a?void 0:a.list[0])||null,c={conversationType:t,targetId:n,channelId:r,unreadMessageCount:i.unreadMessageCount||0,latestMessage:u,notificationStatus:i.notificationStatus||tf.CLOSE,isTop:i.isTop||!1,lastUnreadTime:i.lastUnreadTime||0},e.abrupt("return",{code:so.SUCCESS,data:c});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return re.apply(this,arguments)})},{key:"getAllConversationUnreadCount",value:function(e,t,n){var r=this._conversationManager.getAllUnreadCount(e,t,n);return Promise.resolve({code:so.SUCCESS,data:r})}},{key:"getConversationUnreadCount",value:function(e,t){var n=this._conversationManager.getUnreadCount(e,t);return Promise.resolve({code:so.SUCCESS,data:n})}},{key:"clearConversationUnreadCount",value:function(e,t){return this._conversationManager.clearUnreadCount(e,t),Promise.resolve(so.SUCCESS)}},{key:"saveConversationMessageDraft",value:function(e,t,n){return this._conversationManager.setDraft(e,t,n),Promise.resolve(so.SUCCESS)}},{key:"getConversationMessageDraft",value:function(e,t){var n=this._conversationManager.getDraft(e,t);return Promise.resolve({code:so.SUCCESS,data:n})}},{key:"clearConversationMessageDraft",value:function(e,t){return this._conversationManager.clearDraft(e,t),Promise.resolve(so.SUCCESS)}},{key:"pullConversationStatus",value:(ne=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._channel,r=this.currentUserId,!n){e.next=11;break}return i=n.codec.encodeGetConversationStatus(t),s=new Wf(id[id.pullSeAtts],i,r),e.next=6,n.send(s,Eh);case 6:if(o=e.sent,a=o.code,u=o.data,a===so.SUCCESS){e.next=10;break}return e.abrupt("return",{code:a});case 10:return e.abrupt("return",{code:a,data:u});case 11:return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 12:case"end":return e.stop()}}),e,this)}))),function(e){return ne.apply(this,arguments)})},{key:"batchSetConversationStatus",value:(te=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.currentUserId,!(r=this._channel)){e.next=13;break}return i=r.codec.encodeSetConversationStatus(t),s=new Wf(pf,i,n),e.next=6,r.send(s,Ih);case 6:if(o=e.sent,a=o.code,u=o.data,a!==so.SUCCESS){e.next=12;break}return c=u,t.forEach((function(e){l._conversationManager.addStatus(h(h({},e),{},{updatedTime:c.version}),!0)})),e.abrupt("return",a);case 12:return e.abrupt("return",a);case 13:return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return te.apply(this,arguments)})},{key:"_joinChrm",value:(ee=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._channel){e.next=3;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 3:return s=i.codec.encodeJoinOrQuitChatRoom(),o=new Wf(r?cf:uf,s,t),e.next=8,i.send(o);case 8:return a=e.sent,u=a.code,a.data,u===so.SUCCESS&&(this._chrmsQueue[t]||(this._chrmsQueue[t]={pulling:!1,queue:[],timestamp:0}),this._pullChrmMsg(t,n),this._naviInfo.kvStorage&&this._chrmEntryHandler.pullEntry(t,0),this._joinedChrmManager.set(t,n)),e.abrupt("return",u);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return ee.apply(this,arguments)})},{key:"_rejoinChrm",value:(X=s(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._joinedChrmManager.get(),e.t0=regeneratorRuntime.keys(t);case 2:if((e.t1=e.t0()).done){e.next=10;break}return n=e.t1.value,e.next=6,this._joinChrm(n,t[n]||10,!0);case 6:(r=e.sent)===so.SUCCESS?this._watcher.chatroom({rejoinedRoom:{chatroomId:n,count:t[n]}}):this._watcher.chatroom({rejoinedRoom:{chatroomId:n,errorCode:r}}),e.next=2;break;case 10:case"end":return e.stop()}}),e,this)}))),function(){return X.apply(this,arguments)})},{key:"_pullChrmMsg",value:($=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l,h,f,d,g=this,p=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.length>1&&void 0!==p[1]?p[1]:10,this._channel){e.next=3;break}return e.abrupt("return");case 3:if(r=this._chrmsQueue[t],i=r.pulling,s=r.timestamp,!i){e.next=7;break}return e.abrupt("return");case 7:return r.pulling=!0,o=this._channel.codec.encodeChrmSyncMsg(s,n),a=new Wf(id[id.chrmPull],o,t),e.next=12,this._channel.send(a,Rl,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId});case 12:if(u=e.sent,c=u.code,l=u.data,r.pulling=!1,c===so.SUCCESS&&l){e.next=19;break}return _r.warn("pull chatroom msg failed, code:",c,", data:",l),e.abrupt("return");case 19:h=l.list,f=l.syncTime,d=l.finished,r.timestamp=f,r.queue=r.queue.filter((function(e){return e>f})),h.forEach((function(e){e.sentTime<s||g._watcher.message(e)})),(!d||r.queue.length>0)&&this._pullChrmMsg(t);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return $.apply(this,arguments)})},{key:"joinChatroom",value:(Z=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._joinChrm(t,n,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return Z.apply(this,arguments)})},{key:"joinExistChatroom",value:(J=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._joinChrm(t,n,!0));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return J.apply(this,arguments)})},{key:"quitChatroom",value:(z=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._channel){e.next=3;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 3:return r=n.codec.encodeJoinOrQuitChatRoom(),i=new Wf(lf,r,t),e.next=7,n.send(i);case 7:return s=e.sent,(o=s.code)===so.SUCCESS&&(delete this._chrmsQueue[t],this._chrmEntryHandler.reset(t),this._joinedChrmManager.remove(t)),e.abrupt("return",o);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return z.apply(this,arguments)})},{key:"getChatroomInfo",value:(Q=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._channel){e.next=3;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 3:return s=i.codec.encodeGetChatRoomInfo(n,r),o=new Wf(id[id.queryChrmI],s,t),e.next=7,i.send(o,Yl);case 7:if(a=e.sent,u=a.code,c=a.data,u===so.SUCCESS){e.next=11;break}return e.abrupt("return",{code:u});case 11:return e.abrupt("return",{code:u,data:c});case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return Q.apply(this,arguments)})},{key:"getChatroomHistoryMessages",value:(W=s(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this._channel){e.next=3;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 3:return o=s.codec.encodeGetHistoryMsg(t,{timestamp:n,count:r,order:i}),a=new Wf(Ef,o,t),e.next=7,s.send(a,Nl,{conversation:{targetId:t}});case 7:if(u=e.sent,c=u.code,l=u.data,c===so.SUCCESS){e.next=12;break}return e.abrupt("return",{code:c});case 12:return e.abrupt("return",{code:c,data:{list:l.list,hasMore:l.hasMore}});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return W.apply(this,arguments)})},{key:"_modifyChatroomKV",value:(K=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._channel,i=this.currentUserId,r){e.next=3;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 3:return s=r.codec.encodeModifyChatRoomKV(t,n,i),o=n.type===mo.UPDATE?hf:ff,a=new Wf(o,s,t),e.next=8,r.send(a);case 8:if(u=e.sent,(c=u.code)!==so.SUCCESS){e.next=13;break}return this._chrmEntryHandler.setLocal(t,{kvEntries:[n],syncTime:(new Date).getTime()},i),e.abrupt("return",c);case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return K.apply(this,arguments)})},{key:"setChatroomEntry",value:(H=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=mo.UPDATE,e.abrupt("return",this._modifyChatroomKV(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return H.apply(this,arguments)})},{key:"forceSetChatroomEntry",value:(G=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=mo.UPDATE,n.isOverwrite=!0,e.abrupt("return",this._modifyChatroomKV(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return G.apply(this,arguments)})},{key:"removeChatroomEntry",value:(q=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=mo.DELETE,e.abrupt("return",this._modifyChatroomKV(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return q.apply(this,arguments)})},{key:"forceRemoveChatroomEntry",value:(j=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.type=mo.DELETE,n.isOverwrite=!0,e.abrupt("return",this._modifyChatroomKV(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"getChatroomEntry",value:function(e,t){var n=this._chrmEntryHandler.getValue(e,t);return n?Promise.resolve({code:so.SUCCESS,data:n}):Promise.resolve({code:so.CHATROOM_KEY_NOT_EXIST})}},{key:"getAllChatroomEntry",value:function(e){var t=this._chrmEntryHandler.getAll(e);return Promise.resolve({code:so.SUCCESS,data:t})}},{key:"pullChatroomEntry",value:(Y=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._channel,i=this.currentUserId,r){e.next=3;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 3:return s=r.codec.encodePullChatRoomKV(n),o=new Wf(id[id.pullKV],s,t),e.next=7,r.send(o,hh);case 7:if(a=e.sent,u=a.code,c=a.data,u!==so.SUCCESS){e.next=15;break}return this._chrmEntryHandler.setLocal(t,c,i),l=c.kvEntries,h=[],l.length>0&&(l.forEach((function(e){var n=e.key,r=e.value,i=e.type,s=e.timestamp;h.push({key:n,value:r,type:i,timestamp:s,chatroomId:t})})),this._watcher.chatroom({updatedEntries:h})),e.abrupt("return",{code:u,data:c});case 15:return e.abrupt("return",{code:u});case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return Y.apply(this,arguments)})},{key:"sendMessage",value:(F=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,l,f,d,g,p,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:if(r=$d(r,this.currentUserId),r=this._handleMsgProperties(r,!0),s=!![rr.PRIVATE,rr.GROUP].includes(t)&&r.isStatusMessage,o=s?(y=t,m=void 0,(m={},c(m,rr.PRIVATE,id.ppMsgS),c(m,rr.GROUP,id.pgMsgS),m)[y]):Jd(t)||id.ppMsgP,s&&(r.isPersited=!1,r.isCounted=!1),r.pushContent=(null===(i=r.pushConfig)||void 0===i?void 0:i.pushContent)||r.pushContent||"",a=this._channel.codec.encodeUpMsg({type:t,targetId:n},r),(u=new Gf(id[o],a,n)).setHeaderQos(Kc.AT_LEAST_ONCE),!s){e.next=14;break}return this._channel.sendOnly(u),e.abrupt("return",{code:so.SUCCESS,data:Zd(t,n,h({},r),"",0,this.currentUserId)});case 14:return l=Date.now()-this._localConnectedTime+this._connectedTime,f=Zd(t,n,h({},r),"",l,this.currentUserId),e.next=18,this._channel.send(u);case 18:if(d=e.sent,g=d.code,p=d.data,g===so.SUCCESS){e.next=23;break}return e.abrupt("return",{code:g,data:f});case 23:return v=p,this._sentMessageMap[v.messageUId]=v.timestamp,f.sentTime=v.timestamp,f.messageUId=v.messageUId,this._conversationManager.setConversationCacheByMessage(f,!0),e.abrupt("return",{code:so.SUCCESS,data:f});case 29:case"end":return e.stop()}var y,m}),e,this)}))),function(e,t,n){return F.apply(this,arguments)})},{key:"recallMsg",value:(B=s(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c,l,f,d,g,p,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return a=s.user,u={content:{conversationType:t,targetId:n,messageUId:r,sentTime:i,user:a},messageType:"RC:RcCmd",disableNotification:null==s?void 0:s.disableNotification,pushConfig:null==s?void 0:s.pushConfig,pushContent:(null===(o=s.pushConfig)||void 0===o?void 0:o.pushContent)||s.pushContent||""},c=id[id.recallMsg],l=this._channel.codec.encodeUpMsg({type:t,targetId:n},u),(f=new Gf(c,l,this.currentUserId)).setHeaderQos(Kc.AT_LEAST_ONCE),e.next=10,this._channel.send(f);case 10:if(d=e.sent,g=d.code,p=d.data,g===so.SUCCESS){e.next=15;break}return e.abrupt("return",{code:g});case 15:return v=p,e.abrupt("return",{code:so.SUCCESS,data:Zd(t,n,h({},u),v.messageUId,v.timestamp,this.currentUserId)});case 17:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i){return B.apply(this,arguments)})},{key:"sendReadReceiptMessage",value:(V=s(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeReadReceipt(n,r),s=new Wf(id[id.rrMsg],i,t),e.next=6,this._channel.send(s);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return V.apply(this,arguments)})},{key:"getMessageReader",value:(D=s(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeMessageReader(n,r),s=new Wf(id[id.rrList],i,t),e.next=6,this._channel.send(s,bh);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return D.apply(this,arguments)})},{key:"pullUserSettings",value:(P=s(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return n=this._channel.codec.encodePullUserSetting(t),r=new Wf(id[id.pullUS],n,this.currentUserId),e.abrupt("return",this._channel.send(r,vh));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"getFileToken",value:(L=s(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return s=i&&"uploads"!==i?n||"":ao(t,n),o=this._channel.codec.encodeGetFileToken(t,s,r||"",i||""),a=new Wf(id[id.qnTkn],o,this.currentUserId),e.next=7,this._channel.send(a,sh);case 7:if(u=e.sent,c=u.code,l=u.data,l=Object.assign(l,{fileName:s}),c!==so.SUCCESS){e.next=13;break}return e.abrupt("return",{code:c,data:l});case 13:return e.abrupt("return",{code:c});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return L.apply(this,arguments)})},{key:"getFileUrl",value:(U=s(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l,h,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return s="",o="",a="",n===Hd.QINIU?(o=oh,a=uh):(o=ah,a=ch),s=n===Hd.QINIU?id[id.qnUrl]:n===Hd.AWS?id[id.s3Url]:n===Hd.STC?id[id.stcUrl]:id[id.aliUrl],u=this._channel.codec.encodeGetFileUrl(o,t,r,i),c=new Wf(s,u,this.currentUserId),e.next=11,this._channel.send(c,a);case 11:if(l=e.sent,h=l.code,f=l.data,d=f,h!==so.SUCCESS){e.next=17;break}return e.abrupt("return",{code:h,data:d});case 17:return e.abrupt("return",{code:h});case 18:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return U.apply(this,arguments)})},{key:"disconnect",value:function(){this._channel&&(this._channel.close(),this._channel=void 0),this._stopSyncInterval()}},{key:"destroy",value:function(){throw new Error("JSEngine's method not implemented.")}},{key:"registerMessageType",value:function(e,t,n,r){this._customMessageType[e]={isPersited:t,isCounted:n}}},{key:"createTag",value:(x=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return n=this._userSettingManager.getVersion(),r=this._channel.codec.encodeCreateTag([t],n),i=new Wf(id[id.addSeTag],r,this.currentUserId),e.next=7,this._channel.send(i,gh);case 7:if(s=e.sent,o=s.code,a=s.data,o===so.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return u=a.version,this._userSettingManager.addTag([h(h({},t),{},{createdTime:u})],u),e.abrupt("return",{code:so.SUCCESS,data:a});case 15:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"removeTag",value:(M=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return n=this._userSettingManager.getVersion(),r=this._channel.codec.encodeRemoveTag([t],n),i=new Wf(id[id.delSeTag],r,this.currentUserId),e.next=7,this._channel.send(i,gh);case 7:if(s=e.sent,o=s.code,a=s.data,o===so.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return u=a.version,this._userSettingManager.deleteTag([t],u),e.abrupt("return",{code:so.SUCCESS});case 15:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)})},{key:"updateTag",value:(A=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return n=this._userSettingManager.getVersion(),r=this._channel.codec.encodeCreateTag([t],n),i=new Wf(id[id.addSeTag],r,this.currentUserId),e.next=7,this._channel.send(i,gh);case 7:if(s=e.sent,o=s.code,a=s.data,o===so.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return u=a.version,this._userSettingManager.addTag([t],u),e.abrupt("return",{code:so.SUCCESS,data:a});case 15:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"getTagList",value:(k=s(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._userSettingManager.getTags(),n=this._conversationManager.getConversationListForTag(),t.forEach((function(e){e.conversationCount=n[e.tagId]?n[e.tagId].length:0})),e.abrupt("return",{code:so.SUCCESS,data:t});case 4:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"addTagForConversations",value:(N=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:if(this._userSettingManager.getTagById(t)){e.next=4;break}return e.abrupt("return",{code:so.TAG_NOT_EXIST});case 4:return r=this._channel.codec.encodeUpdateConversationTag([{tagId:t}],n),i=new Wf(id[id.addTag],r,this.currentUserId),e.next=8,this._channel.send(i);case 8:if(s=e.sent,(o=s.code)===so.SUCCESS){e.next=12;break}return e.abrupt("return",{code:o});case 12:return(a={})[t]={},n.forEach((function(e){u._conversationManager.addTagStatus(e.type,e.targetId,a)})),e.abrupt("return",{code:so.SUCCESS});case 16:case"end":return e.stop()}}),e,this)}))),function(e,t){return N.apply(this,arguments)})},{key:"removeTagForConversations",value:(O=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return r=this._channel.codec.encodeUpdateConversationTag([{tagId:t}],n),i=new Wf(id[id.delTag],r,this.currentUserId),e.next=6,this._channel.send(i);case 6:if(s=e.sent,(o=s.code)===so.SUCCESS){e.next=10;break}return e.abrupt("return",{code:o});case 10:return n.forEach((function(e){a._conversationManager.deleteTagStatus(e.type,e.targetId,[t])})),e.abrupt("return",{code:so.SUCCESS});case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"removeTagsForConversation",value:(w=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return r=t.type,i=t.targetId,s=n.map((function(e){return{tagId:e}})),o=this._channel.codec.encodeUpdateConversationTag(s,[t]),a=new Wf(id[id.delTag],o,this.currentUserId),e.next=8,this._channel.send(a);case 8:if(u=e.sent,(c=u.code)===so.SUCCESS){e.next=12;break}return e.abrupt("return",{code:c});case 12:return this._conversationManager.deleteTagStatus(r,i,n),e.abrupt("return",{code:so.SUCCESS});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return w.apply(this,arguments)})},{key:"getConversationListByTag",value:(b=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.currentUserId,s=this._channel){e.next=3;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 3:return o=s.codec.encodeOldConversationList({count:r,type:rr.PRIVATE,startTime:n}),a=new Wf(df,o,i),e.next=7,s.send(a,Al,{currentUserId:i,connectedTime:s.connectedTime});case 7:if(u=e.sent,c=u.code,l=u.data,h=this._conversationHasTagFilter(t,l),_r.info("GetConversationListByTag",h),c===so.SUCCESS){e.next=13;break}return e.abrupt("return",{code:c});case 13:return e.abrupt("return",{code:c,data:h});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return b.apply(this,arguments)})},{key:"_conversationHasTagFilter",value:function(e,t){var n=this,r=[],i=[];function s(e,t){return e.latestMessage&&t.latestMessage?e.latestMessage.sentTime-t.latestMessage.sentTime:0}return t.forEach((function(t){var s=t.conversationType,o=t.targetId,a=n._conversationManager.get(s,o),u=a.hasMentioned,c=a.mentionedInfo,l=a.lastUnreadTime,f=a.notificationStatus,d=a.isTop,g=a.tags,p=a.unreadMessageCount,v=g&&g[e];if(v){var y=h(h({},t),{},{hasMentioned:u,mentionedInfo:c,lastUnreadTime:l,notificationStatus:f,isTop:d,unreadMessageCount:p});v.isTop?r.push(h(h({},y),{},{isTopInTag:!0})):i.push(h(h({},y),{},{isTopInTag:!1}))}})),[].concat(C(r.sort(s)),C(i.sort(s)))}},{key:"getUnreadCountByTag",value:(S=s(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return r=this._conversationManager.getUnreadCountByTag(t,n),e.abrupt("return",{code:so.SUCCESS,data:r});case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"setConversationStatusInTag",value:(I=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a,u,c,l,h,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:if(i=n.targetId,s=n.type,o=r.isTop,a=[{tagId:t,isTop:o}],(u=this._conversationManager.get(s,i)).tags&&Object.hasOwnProperty.call(u.tags,t)){e.next=8;break}return e.abrupt("return",{code:so.NO_TAG_IN_CONVER});case 8:return c=this._channel.codec.encodeUpdateConversationTag(a,[n]),l=new Wf(id[id.addTag],c,this.currentUserId),e.next=12,this._channel.send(l);case 12:if(h=e.sent,(f=h.code)===so.SUCCESS){e.next=16;break}return e.abrupt("return",{code:f});case 16:return(d={})[t]={},o&&(d[t].isTop=!0),this._conversationManager.addTagStatus(s,i,d),e.abrupt("return",{code:so.SUCCESS});case 21:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return I.apply(this,arguments)})},{key:"getTagsForConversation",value:(R=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:if(n=this._conversationManager.get(t.type,t.targetId),r=this._userSettingManager.getTagsInfo(),i=[],n.tags)for(s in n.tags)i.push({tagId:s,tagName:null===(o=r[s])||void 0===o?void 0:o.tagName});return e.abrupt("return",{code:so.SUCCESS,data:i});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"joinRTCRoom",value:(_=s(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeJoinRTCRoom(n,r),s=new Wf(id[id.rtcRJoin_data],i,t),e.abrupt("return",this._channel.send(s,ql));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return _.apply(this,arguments)})},{key:"quitRTCRoom",value:(m=s(regeneratorRuntime.mark((function e(t){var n,r,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return n=this._channel.codec.encodeQuitRTCRoom(),r=new Wf(id[id.rtcRExit],n,t),e.next=6,this._channel.send(r);case 6:return i=e.sent,s=i.code,e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"rtcPing",value:(y=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return i=this._channel.codec.encodeJoinRTCRoom(n,r),s=new Wf(id[id.rtcPing],i,t),e.next=6,this._channel.send(s);case 6:return o=e.sent,a=o.code,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return y.apply(this,arguments)})},{key:"getRTCRoomInfo",value:(v=s(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return n=this._channel.codec.encodeGetRTCRoomInfo(),r=new Wf(id[id.rtcRInfo],n,t),e.abrupt("return",this._channel.send(r,th));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getRTCUserInfoList",value:(p=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return n=this._channel.codec.encodeGetRTCRoomInfo(),r=new Wf(id[id.rtcUData],n,t),e.next=6,this._channel.send(r,ql);case 6:return i=e.sent,s=i.code,o=i.data,e.abrupt("return",{code:s,data:o?{users:o.users}:o});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setRTCUserInfo",value:(g=s(regeneratorRuntime.mark((function e(t,n,r){var i,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return i=this._channel.codec.encodeSetRTCUserInfo(n,r),s=new Wf(id[id.rtcUPut],i,t),e.next=6,this._channel.send(s);case 6:return o=e.sent,a=o.code,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"removeRTCUserInfo",value:(d=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return r=this._channel.codec.encodeRemoveRTCUserInfo(n),i=new Gf(id[id.rtcUDel],r,t),e.next=6,this._channel.send(i);case 6:return s=e.sent,o=s.code,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"setRTCData",value:(l=s(regeneratorRuntime.mark((function e(t,n,r,i,s,o){var a,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return a=this._channel.codec.encodeSetRTCData(n,r,i,s,o),u=new Gf(id[id.rtcSetData],a,t),e.next=6,this._channel.send(u);case 6:return c=e.sent,l=c.code,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,i,s){return l.apply(this,arguments)})},{key:"setRTCTotalRes",value:(a=s(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return s=this._channel.codec.encodeUserSetRTCData(n,r,i),o=new Wf(id[id.userSetData],s,t),e.next=6,this._channel.send(o);case 6:return a=e.sent,u=a.code,e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"getRTCData",value:function(e,t,n,r){if(!this._channel)return Promise.resolve({code:so.RC_NET_CHANNEL_INVALID});var i=this._channel.codec.encodeGetRTCData(t,n,r),s=new Wf(id[id.rtcQryData],i,e);return this._channel.send(s,Zl)}},{key:"removeRTCData",value:(i=s(regeneratorRuntime.mark((function e(t,n,r,i,s){var o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return o=this._channel.codec.encodeRemoveRTCData(n,r,i,s),a=new Gf(id[id.rtcDelData],o,t),e.next=6,this._channel.send(a);case 6:return u=e.sent,c=u.code,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,s){return i.apply(this,arguments)})},{key:"setRTCOutData",value:function(e,t,n,r){throw new Error("JSEngine's method not implemented.")}},{key:"getRTCOutData",value:function(e,t){throw new Error("JSEngine's method not implemented.")}},{key:"getRTCToken",value:(r=s(regeneratorRuntime.mark((function e(t,n,r){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",{code:so.RC_NET_CHANNEL_INVALID});case 2:return i=this._channel.codec.encodeJoinRTCRoom(n,r),s=new Wf(id[id.rtcToken],i,t),e.abrupt("return",this._channel.send(s,Jl));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"setRTCState",value:(n=s(regeneratorRuntime.mark((function e(t,n){var r,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._channel){e.next=2;break}return e.abrupt("return",so.RC_NET_CHANNEL_INVALID);case 2:return r=this._channel.codec.encodeSetRTCState(n),i=new Wf(id[id.rtcUserState],r,t),e.next=6,this._channel.send(i);case 6:return s=e.sent,o=s.code,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getRTCUserInfo",value:(t=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"getRTCUserList",value:function(e){if(!this._channel)return Promise.resolve({code:so.RC_NET_CHANNEL_INVALID});var t=this._channel.codec.encodeGetRTCRoomInfo(),n=new Wf(id[id.rtcUList],t,e);return this._channel.send(n,ql)}},{key:"callExtra",value:function(e){return Promise.resolve({code:so.EXTRA_METHOD_UNDEFINED})}},{key:"clearConversations",value:function(){throw new Error("Method not implemented.")}},{key:"setUserStatusListener",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setUserStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"subscribeUserStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"getUserStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"addToBlacklist",value:function(e){throw new Error("Method not implemented.")}},{key:"removeFromBlacklist",value:function(e){throw new Error("Method not implemented.")}},{key:"getBlacklist",value:function(){throw new Error("Method not implemented.")}},{key:"getBlacklistStatus",value:function(e){throw new Error("Method not implemented.")}},{key:"insertMessage",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"deleteMessages",value:function(e){throw new Error("Method not implemented.")}},{key:"deleteMessagesByTimestamp",value:function(e,t,n,r,i){throw new Error("Method not implemented.")}},{key:"clearMessages",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"getMessage",value:function(e){throw new Error("Method not implemented.")}},{key:"setMessageContent",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"setMessageSearchField",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"searchConversationByContent",value:function(e,t,n,r){throw new Error("Method not implemented.")}},{key:"searchMessageByContent",value:function(e,t,n,r,i,s){throw new Error("Method not implemented.")}},{key:"getUnreadMentionedMessages",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setMessageSentStatus",value:function(e,t){throw new Error("Method not implemented.")}},{key:"setMessageReceivedStatus",value:function(e,t){throw new Error("Method not implemented.")}},{key:"clearUnreadCountByTimestamp",value:function(e,t,n,r){throw new Error("Method not implemented.")}},{key:"getConversationNotificationStatus",value:function(e,t,n){throw new Error("Method not implemented.")}},{key:"getRemoteHistoryMessages",value:function(e,t,n,r,i,s){throw new Error("Method not implemented.")}}]),de}(dd),eg=function(){function e(t){o(this,e),this._context=t}return u(e,[{key:"getCoreVersion",value:function(){return this._context.coreVersion}},{key:"getAPIVersion",value:function(){return this._context.apiVersion}},{key:"getAppkey",value:function(){return this._context.appkey}},{key:"getCurrentId",value:function(){return this._context.getCurrentUserId()}},{key:"getConnectionStatus",value:function(){return this._context.getConnectionStatus()}},{key:"sendMessage",value:function(e,t,n){return this._context.sendMessage(e,t,n)}},{key:"registerMessageType",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this._context.registerMessageType(e,t,n,r)}}]),e}(),tg=function(e){f(n,e);var t=T(n);function n(){return o(this,n),t.apply(this,arguments)}return u(n,[{key:"getNaviInfo",value:function(){return this._context.getInfoFromCache()}},{key:"joinRTCRoom",value:function(e,t,n){return this._context.joinRTCRoom(e,t,n)}},{key:"quitRTCRoom",value:function(e){return this._context.quitRTCRoom(e)}},{key:"rtcPing",value:function(e,t,n){return this._context.rtcPing(e,t,n)}},{key:"getRTCRoomInfo",value:function(e){return this._context.getRTCRoomInfo(e)}},{key:"getRTCUserInfoList",value:function(e){return this._context.getRTCUserInfoList(e)}},{key:"getRTCUserInfo",value:function(e){return this._context.getRTCUserInfo(e)}},{key:"setRTCUserInfo",value:function(e,t,n){return this._context.setRTCUserInfo(e,t,n)}},{key:"removeRTCUserInfo",value:function(e,t){return this._context.removeRTCUserInfo(e,t)}},{key:"setRTCData",value:function(e,t,n,r,i,s){return this._context.setRTCData(e,t,n,r,i,s)}},{key:"setRTCTotalRes",value:function(e,t,n,r){return this._context.setRTCTotalRes(e,t,n,r)}},{key:"getRTCData",value:function(e,t,n,r){return this._context.getRTCData(e,t,n,r)}},{key:"removeRTCData",value:function(e,t,n,r,i){return this._context.removeRTCData(e,t,n,r,i)}},{key:"setRTCOutData",value:function(e,t,n,r){return this._context.setRTCOutData(e,t,n,r)}},{key:"getRTCOutData",value:function(e,t){return this._context.getRTCOutData(e,t)}},{key:"getRTCToken",value:function(e,t,n){return this._context.getRTCToken(e,t,n)}},{key:"setRTCState",value:function(e,t){return this._context.setRTCState(e,t)}},{key:"getRTCUserList",value:function(e){return this._context.getRTCUserList(e)}}]),n}(eg);function ng(e){return Object.assign({},e)}var rg,ig=function(){function e(t,n){var r;(o(this,e),this._runtime=t,this._token="",this._pluginContextQueue=[],this.coreVersion="4.3.3",this._versionInfo={},this._connectionStatus=td.DISCONNECTED,this._watcher={message:void 0,conversationState:void 0,chatroomState:void 0,connectionState:void 0,rtcInnerWatcher:void 0,expansion:void 0,tag:void 0,conversationTagChanged:void 0},this._options=Object.assign({},n),this.appkey=this._options.appkey,this.apiVersion=this._options.apiVersion,this._options.navigators=this._options.navigators.filter((function(e){return/^https?:\/\//.test(e)})),0===this._options.navigators.length)&&(r=this._options.navigators).push.apply(r,C(Ut));var i={status:this._connectionStatusListener.bind(this),message:this._messageReceiver.bind(this),chatroom:this._chatroomInfoListener.bind(this),conversation:this._conversationInfoListener.bind(this),expansion:this._expansionInfoListener.bind(this),tag:this._tagListener.bind(this),conversationTag:this._conversationTagListener.bind(this)};this._engine=yo()?new RCCppEngine(t,i,this._options):new Xd(t,i,this._options)}var t,n,r,i,a,c,l,f,d,g,p,v,y,m,E,_,T,R,S,b,w,O,N,k,A,M,x,U,L,P,D,V,B,F,Y,j,q,G;return u(e,[{key:"install",value:function(e,t){var n="RCRTC"===e.tag?new tg(this):new eg(this),r=null;try{if(!e.verify(this._runtime))return null;r=e.setup(n,this._runtime,t)}catch(e){_r.error("install plugin error!\n",e)}return["RCRTC","RCCall"].includes(e.tag)&&e.version&&e.name&&(this._versionInfo[e.name]=e.version),r&&this._pluginContextQueue.push(n),r}},{key:"_connectionStatusListener",value:(G=s(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==td.REDIRECT){e.next=8;break}return e.next=3,this.connect(this._token,!0);case 3:if(r=e.sent,(i=r.code)===so.SUCCESS?t=td.CONNECTED:_r.error("Reconnect failed after service redirect",i),t!==td.REDIRECT){e.next=8;break}return e.abrupt("return");case 8:this._connectionStatus=t,(null===(n=this._watcher.rtcInnerWatcher)||void 0===n?void 0:n.status)&&this._watcher.rtcInnerWatcher.status(t),this._pluginContextQueue.forEach((function(e){e.onconnectionstatechange&&e.onconnectionstatechange(t)})),this._watcher.connectionState&&this._watcher.connectionState(t);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"_messageReceiver",value:function(e){(e.conversationType===rr.RTC_ROOM||Object.prototype.hasOwnProperty.call(Wd,e.messageType))&&this._watcher.rtcInnerWatcher&&this._watcher.rtcInnerWatcher.message?this._watcher.rtcInnerWatcher.message(ng(e)):this._pluginContextQueue.some((function(t){if(!t.onmessage)return!1;try{return t.onmessage(ng(e))}catch(e){return _r.error("plugin error =>",e),!1}}))||this._watcher.message&&this._watcher.message(ng(e))}},{key:"_chatroomInfoListener",value:function(e){this._watcher.chatroomState&&this._watcher.chatroomState(e)}},{key:"_conversationInfoListener",value:function(e){this._watcher.conversationState&&this._watcher.conversationState(e)}},{key:"_expansionInfoListener",value:function(e){this._watcher.expansion&&this._watcher.expansion(e)}},{key:"_tagListener",value:function(){this._watcher.tag&&this._watcher.tag()}},{key:"_conversationTagListener",value:function(){this._watcher.conversationTagChanged&&this._watcher.conversationTagChanged()}},{key:"assignWatcher",value:function(e){var t=this;Object.keys(this._watcher).forEach((function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t._watcher[n]=dr(r)||fr(r)?r:void 0}}))}},{key:"getConnectedTime",value:function(){return this._engine.getConnectedTime()}},{key:"getCurrentUserId",value:function(){return this._engine.currentUserId}},{key:"getConnectionStatus",value:function(){return this._connectionStatus}},{key:"connect",value:(q=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]&&l[1],this._connectionStatus!==td.CONNECTED){e.next=3;break}return e.abrupt("return",{code:so.SUCCESS,userId:this._engine.currentUserId});case 3:if(this._connectionStatus!==td.CONNECTING){e.next=5;break}return e.abrupt("return",{code:so.BIZ_ERROR_CONNECTING});case 5:if("string"==typeof t&&0!==t.length){e.next=7;break}return e.abrupt("return",{code:so.RC_CONN_USER_OR_PASSWD_ERROR});case 7:return this._token=t,r=t.split("@"),i=I(r,2),s=i[1],o=s?s.split(";").map((function(e){return/^https?:/.test(e)?e:"https://".concat(e)})):[],e.next=12,this._engine.navi.getInfo(this._getTokenWithoutNavi(),o,n);case 12:if((a=e.sent)||yo()){e.next=15;break}return e.abrupt("return",{code:so.RC_NAVI_RESOURCE_ERROR});case 15:return u=h({engine:this.coreVersion,imlib:this.apiVersion},this._versionInfo),e.next=18,this._engine.connect(this._getTokenWithoutNavi(),a);case 18:if((c=e.sent)!==Xf.REDIRECT){e.next=24;break}return this._connectionStatus=td.REDIRECT,e.next=23,this.connect(t,!0);case 23:return e.abrupt("return",e.sent);case 24:return c===so.SUCCESS&&this._engine.reportSDKInfo&&this._engine.reportSDKInfo(u),c!==so.SUCCESS||yo()||1===a.openUS&&this._pullUserSettings(),e.abrupt("return",{code:c,userId:this._engine.currentUserId});case 27:case"end":return e.stop()}}),e,this)}))),function(e){return q.apply(this,arguments)})},{key:"_pullUserSettings",value:(j=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)}))),function(){return j.apply(this,arguments)})},{key:"disconnect",value:function(){return this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondisconnect)try{e.ondisconnect()}catch(e){_r.error("plugin error =>",e)}})),Promise.resolve()}},{key:"reconnect",value:function(){return this.connect(this._getTokenWithoutNavi())}},{key:"_getTokenWithoutNavi",value:function(){return this._token.replace(/@.+$/,"@")}},{key:"getInfoFromCache",value:function(){return this._engine.navi.getInfoFromCache(this._getTokenWithoutNavi())}},{key:"registerMessageType",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this._engine.registerMessageType(e,t,n,r)}},{key:"sendMessage",value:function(e,t,n,r){var i=this.getInfoFromCache();return 1===((null==i?void 0:i.grpRRVer)||0)&&n.messageType===Jh.READ_RECEIPT_RESPONSE?Promise.resolve({code:so.READ_RECEIPT_ERROR}):e===rr.SYSTEM?Promise.resolve({code:so.BIZ_ERROR_INVALID_PARAMETER}):function(e){var t,n=0;if("utf-16"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8"))for(var r=0,i=e.length;r<i;r++)n+=(t=e.charCodeAt(r))<=65535?2:4;else for(var s=0,o=e.length;s<o;s++)n+=(t=e.charCodeAt(s))<127?1:t<=2047?2:t<=65535?3:4;return n}(JSON.stringify(n.content))>Vt?Promise.resolve({code:so.RC_MSG_CONTENT_EXCEED_LIMIT}):this._engine.sendMessage(e,t,n,r)}},{key:"sendExpansionMessage",value:(Y=s(regeneratorRuntime.mark((function e(t){var n,r,i,s,o,a,u,c,l,h,f,d,g,p,v,y,m,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.channelId,r=t.conversationType,i=t.targetId,s=t.messageUId,o=t.keys,a=t.expansion,u=t.originExpansion,c=t.removeAll,t.canIncludeExpansion){e.next=3;break}return e.abrupt("return",{code:so.MESSAGE_KV_NOT_SUPPORT});case 3:if(l=!1,h=!1,fr(a))for(p in u=u||{},f=Object.keys(a).length,d=Object.assign(u,a),g=Object.keys(d).length,l=g>300||f>20,a)v=a[p],l=p.length>32||v.length>64,h=!/^[A-Za-z0-9_=+-]+$/.test(p);if(!l){e.next=8;break}return e.abrupt("return",{code:so.EXPANSION_LIMIT_EXCEET});case 8:if(!h){e.next=10;break}return e.abrupt("return",{code:so.BIZ_ERROR_INVALID_PARAMETER});case 10:return y={mid:s},a&&(y.put=a),o&&(y.del=o),c&&(y.removeAll=1),e.next=16,this._engine.sendMessage(r,i,{content:y,messageType:Jh.EXPANSION_NOTIFY,channelId:n});case 16:return m=e.sent,E=m.code,e.abrupt("return",{code:E});case 19:case"end":return e.stop()}}),e,this)}))),function(e){return Y.apply(this,arguments)})},{key:"sendReadReceiptMessage",value:(F=s(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==((null==(i=this.getInfoFromCache())?void 0:i.grpRRVer)||0)){e.next=4;break}return e.abrupt("return",{code:so.READ_RECEIPT_ERROR,data:"The read receipt switch is not on, please call the sendMessage method!"});case 4:return e.abrupt("return",this._engine.sendReadReceiptMessage(t,n,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return F.apply(this,arguments)})},{key:"getMessageReader",value:(B=s(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==((null==(i=this.getInfoFromCache())?void 0:i.grpRRVer)||0)){e.next=4;break}return e.abrupt("return",{code:so.READ_RECEIPT_ERROR});case 4:return e.abrupt("return",this._engine.getMessageReader(t,n,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return B.apply(this,arguments)})},{key:"_destroy",value:function(){this._watcher={},this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondestroy)try{e.ondestroy()}catch(e){_r.error("plugin error =>",e)}})),this._pluginContextQueue.length=0}},{key:"getHistoryMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";return this._engine.getHistoryMessage(e,t,n,r,i,s,o||"")}},{key:"getConversationList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return this._engine.getConversationList(e,t,n,r,i)}},{key:"getConversation",value:function(e,t,n){return this._engine.getConversation(e,t,n)}},{key:"removeConversation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.removeConversation(e,t,n)}},{key:"clearUnreadCount",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.clearConversationUnreadCount(e,t,n)}},{key:"getUnreadCount",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.getConversationUnreadCount(e,t,n)}},{key:"getTotalUnreadCount",value:function(e,t,n){return this._engine.getAllConversationUnreadCount(e,t&&t.length>0?t:[rr.PRIVATE,rr.GROUP,rr.SYSTEM,rr.PUBLIC_SERVICE],!!n)}},{key:"setConversationStatus",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=[{conversationType:e,targetId:t,isTop:n,notificationStatus:r,channelId:i}];return this._engine.batchSetConversationStatus(s)}},{key:"saveConversationMessageDraft",value:function(e,t,n){return this._engine.saveConversationMessageDraft(e,t,n)}},{key:"getConversationMessageDraft",value:function(e,t){return this._engine.getConversationMessageDraft(e,t)}},{key:"clearConversationMessageDraft",value:function(e,t){return this._engine.clearConversationMessageDraft(e,t)}},{key:"recallMessage",value:function(e,t,n,r,i){return this._engine.recallMsg(e,t,n,r,i)}},{key:"deleteRemoteMessage",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this._engine.deleteRemoteMessage(e,t,n,r)}},{key:"deleteRemoteMessageByTimestamp",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this._engine.deleteRemoteMessageByTimestamp(e,t,n,r)}},{key:"joinChatroom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return this._engine.joinChatroom(e,t)}},{key:"joinExistChatroom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return this._engine.joinExistChatroom(e,t)}},{key:"quitChatroom",value:function(e){return this._engine.quitChatroom(e)}},{key:"getChatroomInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._engine.getChatroomInfo(e,t,n)}},{key:"setChatroomEntry",value:function(e,t){var n=t.key,r=t.value;return co(n)&&lo(r)?this._engine.setChatroomEntry(e,t):Promise.resolve(so.BIZ_ERROR_INVALID_PARAMETER)}},{key:"forceSetChatroomEntry",value:function(e,t){var n=t.key,r=t.value;return co(n)&&lo(r)?this._engine.forceSetChatroomEntry(e,t):Promise.resolve(so.BIZ_ERROR_INVALID_PARAMETER)}},{key:"removeChatroomEntry",value:function(e,t){var n=t.key;return co(n)?this._engine.removeChatroomEntry(e,t):Promise.resolve(so.BIZ_ERROR_INVALID_PARAMETER)}},{key:"forceRemoveChatroomEntry",value:function(e,t){var n=t.key;return co(n)?this._engine.forceRemoveChatroomEntry(e,t):Promise.resolve(so.BIZ_ERROR_INVALID_PARAMETER)}},{key:"getChatroomEntry",value:function(e,t){return this._engine.getChatroomEntry(e,t)}},{key:"getAllChatroomEntries",value:function(e){return this._engine.getAllChatroomEntry(e)}},{key:"getChatRoomHistoryMessages",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this._engine.getChatroomHistoryMessages(e,r,t,n)}},{key:"getFileToken",value:(V=s(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.getInfoFromCache(),o=(null==s?void 0:s.bosAddr)||"",a=(null==s?void 0:s.uploadServer)||"",u=(null==s?void 0:s.ossConfig)||"",e.next=6,this._engine.getFileToken(t,n,r,i);case 6:if(c=e.sent,l=c.code,h=c.data,l!==so.SUCCESS){e.next=11;break}return e.abrupt("return",Promise.resolve(Object.assign(h,{bos:o,qiniu:a,ossConfig:u})));case 11:return e.abrupt("return",Promise.reject(l));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return V.apply(this,arguments)})},{key:"getFileUrl",value:(D=s(regeneratorRuntime.mark((function e(t,n,r,i){var s,o,a,u,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=c.length>4&&void 0!==c[4]?c[4]:Hd.QINIU,null==i||!i.isBosRes){e.next=3;break}return e.abrupt("return",Promise.resolve(i));case 3:return e.next=5,this._engine.getFileUrl(t,s,n,r);case 5:if(o=e.sent,a=o.code,u=o.data,a!==so.SUCCESS){e.next=10;break}return e.abrupt("return",Promise.resolve(u));case 10:return e.abrupt("return",Promise.reject(a));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return D.apply(this,arguments)})},{key:"createTag",value:(P=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.createTag(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return P.apply(this,arguments)})},{key:"removeTag",value:(L=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeTag(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return L.apply(this,arguments)})},{key:"updateTag",value:(U=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.updateTag(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return U.apply(this,arguments)})},{key:"getTagList",value:(x=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getTagList());case 1:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"addTagForConversations",value:(M=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>1e3)){e.next=2;break}return e.abrupt("return",Promise.reject(so.CONVER_OUT_LIMIT_ERROR));case 2:return e.abrupt("return",this._engine.addTagForConversations(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return M.apply(this,arguments)})},{key:"removeTagForConversations",value:(A=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeTagForConversations(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return A.apply(this,arguments)})},{key:"removeTagsForConversation",value:(k=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeTagsForConversation(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return k.apply(this,arguments)})},{key:"getConversationListByTag",value:(N=s(regeneratorRuntime.mark((function e(t,n,r,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getConversationListByTag(t,n,r,i));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return N.apply(this,arguments)})},{key:"getUnreadCountByTag",value:(O=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getUnreadCountByTag(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"setConversationStatusInTag",value:(w=s(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setConversationStatusInTag(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return w.apply(this,arguments)})},{key:"getTagsForConversation",value:(b=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getTagsForConversation(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"callExtra",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this._engine).callExtra.apply(t,[e].concat(r))}},{key:"clearConversations",value:(S=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._engine.clearConversations(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"setUserStatusListener",value:function(e,t){return this._engine.setUserStatusListener(e,(function(e){try{t(e)}catch(e){_r.error(e)}}))}},{key:"addToBlacklist",value:(R=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.addToBlacklist(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"removeFromBlacklist",value:(T=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.removeFromBlacklist(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"getBlacklist",value:(_=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getBlacklist());case 1:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"getBlacklistStatus",value:(E=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getBlacklistStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"insertMessage",value:(m=s(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.insertMessage(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return m.apply(this,arguments)})},{key:"deleteMessages",value:(y=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.deleteMessages(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"deleteMessagesByTimestamp",value:(v=s(regeneratorRuntime.mark((function e(t,n,r,i){var s,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=o.length>4&&void 0!==o[4]?o[4]:"",e.abrupt("return",this._engine.deleteMessagesByTimestamp(t,n,r,i,s));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return v.apply(this,arguments)})},{key:"clearMessages",value:(p=s(regeneratorRuntime.mark((function e(t,n){var r,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:"",e.abrupt("return",this._engine.clearMessages(t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"getMessage",value:(g=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getMessage(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"setMessageContent",value:(d=s(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageContent(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"setMessageSearchField",value:(f=s(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageSearchField(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return f.apply(this,arguments)})},{key:"setMessageSentStatus",value:(l=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageSentStatus(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"setMessageReceivedStatus",value:(c=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setMessageReceivedStatus(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"setUserStatus",value:(a=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.setUserStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"subscribeUserStatus",value:(i=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.subscribeUserStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getUserStatus",value:(r=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._engine.getUserStatus(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"searchConversationByContent",value:(n=s(regeneratorRuntime.mark((function e(t){var n,r,i,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:[],r=s.length>2&&void 0!==s[2]?s[2]:"",i=s.length>3?s[3]:void 0,e.abrupt("return",this._engine.searchConversationByContent(t,n,r,i));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"searchMessageByContent",value:(t=s(regeneratorRuntime.mark((function e(t,n,r,i,s,o){var a,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>6&&void 0!==u[6]?u[6]:"",e.abrupt("return",this._engine.searchMessageByContent(t,n,r,i,s,o,a));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n,r,i,s,o){return t.apply(this,arguments)})},{key:"getUnreadMentionedMessages",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.getUnreadMentionedMessages(e,t,n)}},{key:"clearUnreadCountByTimestamp",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this._engine.clearUnreadCountByTimestamp(e,t,n,r)}},{key:"getConversationNotificationStatus",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._engine.getConversationNotificationStatus(e,t,n)}},{key:"getRemoteHistoryMessages",value:function(e,t,n,r,i,s){return this._engine.getRemoteHistoryMessages(e,t,n,r,i,s)}},{key:"joinRTCRoom",value:function(e,t,n){return this._engine.joinRTCRoom(e,t,n)}},{key:"quitRTCRoom",value:function(e){return this._engine.quitRTCRoom(e)}},{key:"rtcPing",value:function(e,t,n){return this._engine.rtcPing(e,t,n)}},{key:"getRTCRoomInfo",value:function(e){return this._engine.getRTCRoomInfo(e)}},{key:"getRTCUserInfoList",value:function(e){return this._engine.getRTCUserInfoList(e)}},{key:"getRTCUserInfo",value:function(e){return this._engine.getRTCUserInfo(e)}},{key:"setRTCUserInfo",value:function(e,t,n){return this._engine.setRTCUserInfo(e,t,n)}},{key:"removeRTCUserInfo",value:function(e,t){return this._engine.removeRTCUserInfo(e,t)}},{key:"setRTCData",value:function(e,t,n,r,i,s){return this._engine.setRTCData(e,t,n,r,i,s)}},{key:"setRTCTotalRes",value:function(e,t,n,r){return this._engine.setRTCTotalRes(e,t,n,r)}},{key:"getRTCData",value:function(e,t,n,r){return this._engine.getRTCData(e,t,n,r)}},{key:"removeRTCData",value:function(e,t,n,r,i){return this._engine.removeRTCData(e,t,n,r,i)}},{key:"setRTCOutData",value:function(e,t,n,r){return this._engine.setRTCOutData(e,t,n,r)}},{key:"getRTCOutData",value:function(e,t){return this._engine.getRTCOutData(e,t)}},{key:"getRTCToken",value:function(e,t,n){return this._engine.getRTCToken(e,t,n)}},{key:"setRTCState",value:function(e,t){return this._engine.setRTCState(e,t)}},{key:"getRTCUserList",value:function(e){return this._engine.getRTCUserList(e)}}],[{key:"init",value:function(t,n){return _r.setLogLevel(n.logLevel),_r.setLogStdout(n.logStdout),_r.debug("APIContext.init =>",n.appkey,n.navigators),this._context?(_r.error("Repeat initialize!"),this._context):(_r.warn("RCEngine Commit:","717d00e6b9d1195e0f186b5200d34fd8e5ac6a31"),this._context=new e(t,n),this._context)}},{key:"destroy",value:function(){this._context&&(this._context._destroy(),this._context=void 0)}}]),e}();e.TagChangeType=void 0,(rg=e.TagChangeType||(e.TagChangeType={}))[rg.add=1]="add",rg[rg.update=2]="update",rg[rg.delete=3]="delete";e.AEngine=dd,e.ANavi=vd,e.APIContext=ig,e.AppStorage=Gt,e.CPP_PROTOCAL_MSGTYPE_OPTION={"RC:DizNtf":{isCounted:!1,isPersited:!1}},e.CallLibMsgType=Wd,e.ChatroomEntryType=mo,e.CometChannel=fd,e.ConnectResultCode=Xf,e.ConnectionStatus=td,e.ConversationType=rr,e.DelayTimer=_o,e.ErrorCode=so,e.EventEmitter=Ur,e.FileType=sr,e.IM_COMET_PULLMSG_TIMEOUT=45e3,e.IM_PING_INTERVAL_TIME=3e4,e.IM_PING_MAX_TIMEOUT=6e3,e.IM_PING_MIN_TIMEOUT=2e3,e.IM_SIGNAL_TIMEOUT=Dt,e.Logger=Er,e.MAX_MESSAGE_CONTENT_BYTES=Vt,e.MINI_COMET_CONNECT_URIS=Pt,e.MINI_SOCKET_CONNECT_URIS=Lt,e.MentionedType=Qh,e.MessageDirection=kf,e.MessageType=Jh,e.NAVI_CACHE_DURATION=Mt,e.NAVI_REQ_TIMEOUT=1e4,e.NotificationStatus=tf,e.PING_REQ_TIMEOUT=5e3,e.PUBLIC_CLOUD_NAVI_URIS=Ut,e.PluginContext=eg,e.RCAssertError=Pr,e.RTCPluginContext=tg,e.ReceivedStatus=n,e.SEND_MESSAGE_TYPE_OPTION=Ft,e.STATUS_MESSAGE=Yt,e.STORAGE_ROOT_KEY=Bt,e.UploadMethod=Hd,e.WEB_SOCKET_TIMEOUT=xt,e.WebSocketChannel=ld,e.appendUrl=function(e,t){if(e=e.replace(/\?$/,""),!t)return e;var n=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).filter((function(e){return!!e}));return n.length?[e,n.join("&")].join("?"):e},e.assert=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Dr(e,t,n,r))throw new Pr("'".concat(e,"' is invalid: ").concat(JSON.stringify(t)))},e.cloneByJSON=vo,e.forEach=ho,e.getMimeKey=function(e){var t="application/octet-stream";switch(e){case sr.IMAGE:t="image/jpeg";break;case sr.AUDIO:t="audio/amr";break;case sr.VIDEO:t="video/3gpp";break;case sr.SIGHT:t="video/mpeg4";break;case sr.COMBINE_HTML:t="text/html"}return t},e.getUploadFileName=ao,e.indexOf=go,e.isArray=cr,e.isArrayBuffer=lr,e.isBoolean=ar,e.isFunction=dr,e.isHttpUrl=function(e){return or(e)&&/https?:\/\//.test(e)},e.isInObject=po,e.isInclude=function(e,t){return-1!==go(e,t)},e.isNull=pr,e.isNumber=ur,e.isObject=fr,e.isString=or,e.isUndefined=gr,e.isValidChrmEntryKey=co,e.isValidChrmEntryValue=lo,e.isValidConversationType=function(e){return ur(e)&&Object.prototype.hasOwnProperty.call(rr,e)},e.isValidFileType=function(e){return ur(e)&&Object.prototype.hasOwnProperty.call(sr,e)},e.map=fo,e.notEmptyArray=function(e){return cr(e)&&e.length>0},e.notEmptyObject=vr,e.notEmptyString=hr,e.pushConfigsToJSON=uo,e.todo=function(e){return new Ht(e)},e.usingCppEngine=yo,e.validate=Dr,e.version="4.3.3",Object.defineProperty(e,"__esModule",{value:!0})}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@rongcloud/engine")):"function"==typeof define&&define.amd?define(["exports","@rongcloud/engine"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).RongIMLib={},e.RCEngine)}(this,(function(e,t){"use strict";var n;!function(e){e[e.SENDING=10]="SENDING",e[e.FAILED=20]="FAILED",e[e.SENT=30]="SENT",e[e.RECEIVED=40]="RECEIVED",e[e.READ=50]="READ",e[e.DESTROYED=60]="DESTROYED"}(n||(n={}));var s,r=n;!function(e){e[e.NONE=0]="NONE",e[e.SQQUENCE=1]="SQQUENCE",e[e.REVERSE=2]="REVERSE"}(s||(s={}));var o=s;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n,s,r,o,a){try{var i=e[o](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(s,r)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(s,r){var o=e.apply(t,n);function a(e){i(o,s,r,a,c,"next",e)}function c(e){i(o,s,r,a,c,"throw",e)}a(void 0)}))}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}var v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function R(e){var t={exports:{}};return e(t,t.exports),t.exports}R((function(e){var t=function(e){var t,n=Object.prototype,s=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,s){var r=t&&t.prototype instanceof p?t:p,o=Object.create(r.prototype),a=new k(s||[]);return o._invoke=function(e,t,n){var s=f;return function(r,o){if(s===g)throw new Error("Generator is already running");if(s===h){if("throw"===r)throw o;return U()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var i=I(a,n);if(i){if(i===C)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===f)throw s=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=g;var c=l(e,t,n);if("normal"===c.type){if(s=n.done?h:d,c.arg===C)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(s=h,n.method="throw",n.arg=c.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var f="suspendedStart",d="suspendedYield",g="executing",h="completed",C={};function p(){}function v(){}function R(){}var y={};y[o]=function(){return this};var S=Object.getPrototypeOf,m=S&&S(S(N([])));m&&m!==n&&s.call(m,o)&&(y=m);var M=R.prototype=p.prototype=Object.create(y);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(r,o,a,i){var c=l(e[r],e,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==typeof f&&s.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(f).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,i)}))}i(c.arg)}var r;this._invoke=function(e,s){function o(){return new t((function(t,r){n(e,s,t,r)}))}return r=r?r.then(o,o):o()}}function I(e,n){var s=e.iterator[n.method];if(s===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method))return C;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var r=l(s,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,C;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,C):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,C)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function N(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(s.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:U}}function U(){return{value:t,done:!0}}return v.prototype=M.constructor=R,R.constructor=v,v.displayName=c(R,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,R):(e.__proto__=R,c(e,i,"GeneratorFunction")),e.prototype=Object.create(M),e},e.awrap=function(e){return{__await:e}},E(T.prototype),T.prototype[a]=function(){return this},e.AsyncIterator=T,e.async=function(t,n,s,r,o){void 0===o&&(o=Promise);var a=new T(u(t,n,s,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(M),c(M,i,"Generator"),M[o]=function(){return this},M.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var s=t.pop();if(s in e)return n.value=s,n.done=!1,n}return n.done=!0,n}},e.values=N,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(b),!e)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(s,r){return i.type="throw",i.arg=e,n.next=s,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=s.call(a,"catchLoc"),u=s.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,C):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),C},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),C}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var s=n.completion;if("throw"===s.type){var r=s.arg;b(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,s){return this.delegate={iterator:N(e),resultName:n,nextLoc:s},"next"===this.method&&(this.arg=t),C}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var y,S,m=function(e){return e&&e.Math==Math&&e},M=m("object"==typeof globalThis&&globalThis)||m("object"==typeof window&&window)||m("object"==typeof self&&self)||m("object"==typeof v&&v)||function(){return this}()||Function("return this")(),E={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},T=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},I=function(e,t,n){if(T(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,s){return e.call(t,n,s)};case 3:return function(n,s,r){return e.call(t,n,s,r)}}return function(){return e.apply(t,arguments)}},A=function(e){try{return!!e()}catch(e){return!0}},b={}.toString,k=function(e){return b.call(e).slice(8,-1)},N="".split,U=A((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==k(e)?N.call(e,""):Object(e)}:Object,x=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},L=function(e){return Object(x(e))},_=Math.ceil,P=Math.floor,O=function(e){return isNaN(e=+e)?0:(e>0?P:_)(e)},w=Math.min,B=function(e){return e>0?w(O(e),9007199254740991):0},j=function(e){return"object"==typeof e?null!==e:"function"==typeof e},G=Array.isArray||function(e){return"Array"==k(e)},D=!A((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),F=M.document,K=j(F)&&j(F.createElement),V=function(e){return K?F.createElement(e):{}},H=!D&&!A((function(){return 7!=Object.defineProperty(V("div"),"a",{get:function(){return 7}}).a})),q=function(e){if(!j(e))throw TypeError(String(e)+" is not an object");return e},Y=function(e,t){if(!j(e))return e;var n,s;if(t&&"function"==typeof(n=e.toString)&&!j(s=n.call(e)))return s;if("function"==typeof(n=e.valueOf)&&!j(s=n.call(e)))return s;if(!t&&"function"==typeof(n=e.toString)&&!j(s=n.call(e)))return s;throw TypeError("Can't convert object to primitive value")},W=Object.defineProperty,J={f:D?W:function(e,t,n){if(q(e),t=Y(t,!0),q(n),H)try{return W(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},Q=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},X=D?function(e,t,n){return J.f(e,t,Q(1,n))}:function(e,t,n){return e[t]=n,e},z=function(e,t){try{X(M,e,t)}catch(n){M[e]=t}return t},$="__core-js_shared__",Z=M[$]||z($,{}),ee=R((function(e){(e.exports=function(e,t){return Z[e]||(Z[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.9.1",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})})),te={}.hasOwnProperty,ne=function(e,t){return te.call(e,t)},se=0,re=Math.random(),oe=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++se+re).toString(36)},ae="process"==k(M.process),ie=M,ce=function(e){return"function"==typeof e?e:void 0},ue=function(e,t){return arguments.length<2?ce(ie[e])||ce(M[e]):ie[e]&&ie[e][t]||M[e]&&M[e][t]},le=ue("navigator","userAgent")||"",fe=M.process,de=fe&&fe.versions,ge=de&&de.v8;ge?S=(y=ge.split("."))[0]+y[1]:le&&(!(y=le.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=le.match(/Chrome\/(\d+)/))&&(S=y[1]);var he=S&&+S,Ce=!!Object.getOwnPropertySymbols&&!A((function(){return!Symbol.sham&&(ae?38===he:he>37&&he<41)})),pe=Ce&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ve=ee("wks"),Re=M.Symbol,ye=pe?Re:Re&&Re.withoutSetter||oe,Se=function(e){return ne(ve,e)&&(Ce||"string"==typeof ve[e])||(Ce&&ne(Re,e)?ve[e]=Re[e]:ve[e]=ye("Symbol."+e)),ve[e]},me=Se("species"),Me=function(e,t){var n;return G(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!G(n.prototype)?j(n)&&null===(n=n[me])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Ee=[].push,Te=function(e){var t=1==e,n=2==e,s=3==e,r=4==e,o=6==e,a=7==e,i=5==e||o;return function(c,u,l,f){for(var d,g,h=L(c),C=U(h),p=I(u,l,3),v=B(C.length),R=0,y=f||Me,S=t?y(c,v):n||a?y(c,0):void 0;v>R;R++)if((i||R in C)&&(g=p(d=C[R],R,h),e))if(t)S[R]=g;else if(g)switch(e){case 3:return!0;case 5:return d;case 6:return R;case 2:Ee.call(S,d)}else switch(e){case 4:return!1;case 7:Ee.call(S,d)}return o?-1:s||r?r:S}},Ie={forEach:Te(0),map:Te(1),filter:Te(2),some:Te(3),every:Te(4),find:Te(5),findIndex:Te(6),filterOut:Te(7)},Ae=Ie.forEach,be=function(e,t){var n=[][e];return!!n&&A((function(){n.call(null,t||function(){throw 1},1)}))}("forEach")?[].forEach:function(e){return Ae(this,e,arguments.length>1?arguments[1]:void 0)};for(var ke in E){var Ne=M[ke],Ue=Ne&&Ne.prototype;if(Ue&&Ue.forEach!==be)try{X(Ue,"forEach",be)}catch(e){Ue.forEach=be}}var xe={}.propertyIsEnumerable,Le=Object.getOwnPropertyDescriptor,_e={f:Le&&!xe.call({1:2},1)?function(e){var t=Le(this,e);return!!t&&t.enumerable}:xe},Pe=function(e){return U(x(e))},Oe=Object.getOwnPropertyDescriptor,we={f:D?Oe:function(e,t){if(e=Pe(e),t=Y(t,!0),H)try{return Oe(e,t)}catch(e){}if(ne(e,t))return Q(!_e.f.call(e,t),e[t])}},Be=Function.toString;"function"!=typeof Z.inspectSource&&(Z.inspectSource=function(e){return Be.call(e)});var je,Ge,De,Fe=Z.inspectSource,Ke=M.WeakMap,Ve="function"==typeof Ke&&/native code/.test(Fe(Ke)),He=ee("keys"),qe=function(e){return He[e]||(He[e]=oe(e))},Ye={},We=M.WeakMap;if(Ve){var Je=Z.state||(Z.state=new We),Qe=Je.get,Xe=Je.has,ze=Je.set;je=function(e,t){return t.facade=e,ze.call(Je,e,t),t},Ge=function(e){return Qe.call(Je,e)||{}},De=function(e){return Xe.call(Je,e)}}else{var $e=qe("state");Ye[$e]=!0,je=function(e,t){return t.facade=e,X(e,$e,t),t},Ge=function(e){return ne(e,$e)?e[$e]:{}},De=function(e){return ne(e,$e)}}var Ze,et={set:je,get:Ge,has:De,enforce:function(e){return De(e)?Ge(e):je(e,{})},getterFor:function(e){return function(t){var n;if(!j(t)||(n=Ge(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},tt=R((function(e){var t=et.get,n=et.enforce,s=String(String).split("String");(e.exports=function(e,t,r,o){var a,i=!!o&&!!o.unsafe,c=!!o&&!!o.enumerable,u=!!o&&!!o.noTargetGet;"function"==typeof r&&("string"!=typeof t||ne(r,"name")||X(r,"name",t),(a=n(r)).source||(a.source=s.join("string"==typeof t?t:""))),e!==M?(i?!u&&e[t]&&(c=!0):delete e[t],c?e[t]=r:X(e,t,r)):c?e[t]=r:z(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||Fe(this)}))})),nt=Math.max,st=Math.min,rt=function(e,t){var n=O(e);return n<0?nt(n+t,0):st(n,t)},ot=function(e){return function(t,n,s){var r,o=Pe(t),a=B(o.length),i=rt(s,a);if(e&&n!=n){for(;a>i;)if((r=o[i++])!=r)return!0}else for(;a>i;i++)if((e||i in o)&&o[i]===n)return e||i||0;return!e&&-1}},at={includes:ot(!0),indexOf:ot(!1)}.indexOf,it=function(e,t){var n,s=Pe(e),r=0,o=[];for(n in s)!ne(Ye,n)&&ne(s,n)&&o.push(n);for(;t.length>r;)ne(s,n=t[r++])&&(~at(o,n)||o.push(n));return o},ct=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ut=ct.concat("length","prototype"),lt={f:Object.getOwnPropertyNames||function(e){return it(e,ut)}},ft={f:Object.getOwnPropertySymbols},dt=ue("Reflect","ownKeys")||function(e){var t=lt.f(q(e)),n=ft.f;return n?t.concat(n(e)):t},gt=function(e,t){for(var n=dt(t),s=J.f,r=we.f,o=0;o<n.length;o++){var a=n[o];ne(e,a)||s(e,a,r(t,a))}},ht=/#|\.prototype\./,Ct=function(e,t){var n=vt[pt(e)];return n==yt||n!=Rt&&("function"==typeof t?A(t):!!t)},pt=Ct.normalize=function(e){return String(e).replace(ht,".").toLowerCase()},vt=Ct.data={},Rt=Ct.NATIVE="N",yt=Ct.POLYFILL="P",St=Ct,mt=we.f,Mt=function(e,t){var n,s,r,o,a,i=e.target,c=e.global,u=e.stat;if(n=c?M:u?M[i]||z(i,{}):(M[i]||{}).prototype)for(s in t){if(o=t[s],r=e.noTargetGet?(a=mt(n,s))&&a.value:n[s],!St(c?s:i+(u?".":"#")+s,e.forced)&&void 0!==r){if(typeof o==typeof r)continue;gt(o,r)}(e.sham||r&&r.sham)&&X(o,"sham",!0),tt(n,s,o,e)}},Et=Object.keys||function(e){return it(e,ct)},Tt=D?Object.defineProperties:function(e,t){q(e);for(var n,s=Et(t),r=s.length,o=0;r>o;)J.f(e,n=s[o++],t[n]);return e},It=ue("document","documentElement"),At=qe("IE_PROTO"),bt=function(){},kt=function(e){return"<script>"+e+"</"+"script>"},Nt=function(){try{Ze=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;Nt=Ze?function(e){e.write(kt("")),e.close();var t=e.parentWindow.Object;return e=null,t}(Ze):((t=V("iframe")).style.display="none",It.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(kt("document.F=Object")),e.close(),e.F);for(var n=ct.length;n--;)delete Nt.prototype[ct[n]];return Nt()};Ye[At]=!0;var Ut=Object.create||function(e,t){var n;return null!==e?(bt.prototype=q(e),n=new bt,bt.prototype=null,n[At]=e):n=Nt(),void 0===t?n:Tt(n,t)},xt=Se("unscopables"),Lt=Array.prototype;null==Lt[xt]&&J.f(Lt,xt,{configurable:!0,value:Ut(null)});var _t=function(e){Lt[xt][e]=!0},Pt=Ie.find,Ot="find",wt=!0;Ot in[]&&Array(1).find((function(){wt=!1})),Mt({target:"Array",proto:!0,forced:wt},{find:function(e){return Pt(this,e,arguments.length>1?arguments[1]:void 0)}}),_t(Ot);var Bt=A((function(){Et(1)}));Mt({target:"Object",stat:!0,forced:Bt},{keys:function(e){return Et(L(e))}});var jt=M.Promise,Gt=J.f,Dt=Se("toStringTag"),Ft=function(e,t,n){e&&!ne(e=n?e:e.prototype,Dt)&&Gt(e,Dt,{configurable:!0,value:t})},Kt=Se("species"),Vt={},Ht=Se("iterator"),qt=Array.prototype,Yt={};Yt[Se("toStringTag")]="z";var Wt="[object z]"===String(Yt),Jt=Se("toStringTag"),Qt="Arguments"==k(function(){return arguments}()),Xt=Wt?k:function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Jt))?n:Qt?k(t):"Object"==(s=k(t))&&"function"==typeof t.callee?"Arguments":s},zt=Se("iterator"),$t=function(e){var t=e.return;if(void 0!==t)return q(t.call(e)).value},Zt=function(e,t){this.stopped=e,this.result=t},en=function(e,t,n){var s,r,o,a,i,c,u,l,f=n&&n.that,d=!(!n||!n.AS_ENTRIES),g=!(!n||!n.IS_ITERATOR),h=!(!n||!n.INTERRUPTED),C=I(t,f,1+d+h),p=function(e){return s&&$t(s),new Zt(!0,e)},v=function(e){return d?(q(e),h?C(e[0],e[1],p):C(e[0],e[1])):h?C(e,p):C(e)};if(g)s=e;else{if("function"!=typeof(r=function(e){if(null!=e)return e[zt]||e["@@iterator"]||Vt[Xt(e)]}(e)))throw TypeError("Target is not iterable");if(void 0!==(l=r)&&(Vt.Array===l||qt[Ht]===l)){for(o=0,a=B(e.length);a>o;o++)if((i=v(e[o]))&&i instanceof Zt)return i;return new Zt(!1)}s=r.call(e)}for(c=s.next;!(u=c.call(s)).done;){try{i=v(u.value)}catch(e){throw $t(s),e}if("object"==typeof i&&i&&i instanceof Zt)return i}return new Zt(!1)},tn=Se("iterator"),nn=!1;try{var sn=0,rn={next:function(){return{done:!!sn++}},return:function(){nn=!0}};rn[tn]=function(){return this},Array.from(rn,(function(){throw 2}))}catch(e){}var on,an,cn,un=Se("species"),ln=/(iphone|ipod|ipad).*applewebkit/i.test(le),fn=M.location,dn=M.setImmediate,gn=M.clearImmediate,hn=M.process,Cn=M.MessageChannel,pn=M.Dispatch,vn=0,Rn={},yn="onreadystatechange",Sn=function(e){if(Rn.hasOwnProperty(e)){var t=Rn[e];delete Rn[e],t()}},mn=function(e){return function(){Sn(e)}},Mn=function(e){Sn(e.data)},En=function(e){M.postMessage(e+"",fn.protocol+"//"+fn.host)};dn&&gn||(dn=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Rn[++vn]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},on(vn),vn},gn=function(e){delete Rn[e]},ae?on=function(e){hn.nextTick(mn(e))}:pn&&pn.now?on=function(e){pn.now(mn(e))}:Cn&&!ln?(cn=(an=new Cn).port2,an.port1.onmessage=Mn,on=I(cn.postMessage,cn,1)):M.addEventListener&&"function"==typeof postMessage&&!M.importScripts&&fn&&"file:"!==fn.protocol&&!A(En)?(on=En,M.addEventListener("message",Mn,!1)):on=yn in V("script")?function(e){It.appendChild(V("script")).onreadystatechange=function(){It.removeChild(this),Sn(e)}}:function(e){setTimeout(mn(e),0)});var Tn,In,An,bn,kn,Nn,Un,xn,Ln={set:dn,clear:gn},_n=/web0s(?!.*chrome)/i.test(le),Pn=we.f,On=Ln.set,wn=M.MutationObserver||M.WebKitMutationObserver,Bn=M.document,jn=M.process,Gn=M.Promise,Dn=Pn(M,"queueMicrotask"),Fn=Dn&&Dn.value;Fn||(Tn=function(){var e,t;for(ae&&(e=jn.domain)&&e.exit();In;){t=In.fn,In=In.next;try{t()}catch(e){throw In?bn():An=void 0,e}}An=void 0,e&&e.enter()},ln||ae||_n||!wn||!Bn?Gn&&Gn.resolve?(Un=Gn.resolve(void 0),xn=Un.then,bn=function(){xn.call(Un,Tn)}):bn=ae?function(){jn.nextTick(Tn)}:function(){On.call(M,Tn)}:(kn=!0,Nn=Bn.createTextNode(""),new wn(Tn).observe(Nn,{characterData:!0}),bn=function(){Nn.data=kn=!kn}));var Kn,Vn,Hn,qn,Yn=Fn||function(e){var t={fn:e,next:void 0};An&&(An.next=t),In||(In=t,bn()),An=t},Wn=function(e){var t,n;this.promise=new e((function(e,s){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=s})),this.resolve=T(t),this.reject=T(n)},Jn={f:function(e){return new Wn(e)}},Qn=function(e,t){if(q(e),j(t)&&t.constructor===e)return t;var n=Jn.f(e);return(0,n.resolve)(t),n.promise},Xn=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},zn=Ln.set,$n=Se("species"),Zn="Promise",es=et.get,ts=et.set,ns=et.getterFor(Zn),ss=jt,rs=M.TypeError,os=M.document,as=M.process,is=ue("fetch"),cs=Jn.f,us=cs,ls=!!(os&&os.createEvent&&M.dispatchEvent),fs="function"==typeof PromiseRejectionEvent,ds="unhandledrejection",gs=St(Zn,(function(){if(!(Fe(ss)!==String(ss))){if(66===he)return!0;if(!ae&&!fs)return!0}if(he>=51&&/native code/.test(ss))return!1;var e=ss.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[$n]=t,!(e.then((function(){}))instanceof t)})),hs=gs||!function(e,t){if(!t&&!nn)return!1;var n=!1;try{var s={};s[tn]=function(){return{next:function(){return{done:n=!0}}}},e(s)}catch(e){}return n}((function(e){ss.all(e).catch((function(){}))})),Cs=function(e){var t;return!(!j(e)||"function"!=typeof(t=e.then))&&t},ps=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;Yn((function(){for(var s=e.value,r=1==e.state,o=0;n.length>o;){var a,i,c,u=n[o++],l=r?u.ok:u.fail,f=u.resolve,d=u.reject,g=u.domain;try{l?(r||(2===e.rejection&&Ss(e),e.rejection=1),!0===l?a=s:(g&&g.enter(),a=l(s),g&&(g.exit(),c=!0)),a===u.promise?d(rs("Promise-chain cycle")):(i=Cs(a))?i.call(a,f,d):f(a)):d(s)}catch(e){g&&!c&&g.exit(),d(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Rs(e)}))}},vs=function(e,t,n){var s,r;ls?((s=os.createEvent("Event")).promise=t,s.reason=n,s.initEvent(e,!1,!0),M.dispatchEvent(s)):s={promise:t,reason:n},!fs&&(r=M["on"+e])?r(s):e===ds&&function(e,t){var n=M.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Rs=function(e){zn.call(M,(function(){var t,n=e.facade,s=e.value;if(ys(e)&&(t=Xn((function(){ae?as.emit("unhandledRejection",s,n):vs(ds,n,s)})),e.rejection=ae||ys(e)?2:1,t.error))throw t.value}))},ys=function(e){return 1!==e.rejection&&!e.parent},Ss=function(e){zn.call(M,(function(){var t=e.facade;ae?as.emit("rejectionHandled",t):vs("rejectionhandled",t,e.value)}))},ms=function(e,t,n){return function(s){e(t,s,n)}},Ms=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ps(e,!0))},Es=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw rs("Promise can't be resolved itself");var s=Cs(t);s?Yn((function(){var n={done:!1};try{s.call(t,ms(Es,n,e),ms(Ms,n,e))}catch(t){Ms(n,t,e)}})):(e.value=t,e.state=1,ps(e,!1))}catch(t){Ms({done:!1},t,e)}}};gs&&(ss=function(e){!function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation")}(this,ss,Zn),T(e),Kn.call(this);var t=es(this);try{e(ms(Es,t),ms(Ms,t))}catch(e){Ms(t,e)}},(Kn=function(e){ts(this,{type:Zn,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(e,t,n){for(var s in t)tt(e,s,t[s],n);return e}(ss.prototype,{then:function(e,t){var n,s,r,o=ns(this),a=cs((n=ss,void 0===(r=q(this).constructor)||null==(s=q(r)[un])?n:T(s)));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=ae?as.domain:void 0,o.parent=!0,o.reactions.push(a),0!=o.state&&ps(o,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),Vn=function(){var e=new Kn,t=es(e);this.promise=e,this.resolve=ms(Es,t),this.reject=ms(Ms,t)},Jn.f=cs=function(e){return e===ss||e===Hn?new Vn(e):us(e)},"function"==typeof jt&&(qn=jt.prototype.then,tt(jt.prototype,"then",(function(e,t){var n=this;return new ss((function(e,t){qn.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof is&&Mt({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Qn(ss,is.apply(M,arguments))}}))),Mt({global:!0,wrap:!0,forced:gs},{Promise:ss}),Ft(ss,Zn,!1),function(e){var t=ue(e),n=J.f;D&&t&&!t[Kt]&&n(t,Kt,{configurable:!0,get:function(){return this}})}(Zn),Hn=ue(Zn),Mt({target:Zn,stat:!0,forced:gs},{reject:function(e){var t=cs(this);return t.reject.call(void 0,e),t.promise}}),Mt({target:Zn,stat:!0,forced:gs},{resolve:function(e){return Qn(this,e)}}),Mt({target:Zn,stat:!0,forced:hs},{all:function(e){var t=this,n=cs(t),s=n.resolve,r=n.reject,o=Xn((function(){var n=T(t.resolve),o=[],a=0,i=1;en(e,(function(e){var c=a++,u=!1;o.push(void 0),i++,n.call(t,e).then((function(e){u||(u=!0,o[c]=e,--i||s(o))}),r)})),--i||s(o)}));return o.error&&r(o.value),n.promise},race:function(e){var t=this,n=cs(t),s=n.reject,r=Xn((function(){var r=T(t.resolve);en(e,(function(e){r.call(t,e).then(n.resolve,s)}))}));return r.error&&s(r.value),n.promise}});var Ts=Wt?{}.toString:function(){return"[object "+Xt(this)+"]"};Wt||tt(Object.prototype,"toString",Ts,{unsafe:!0});var Is=[].slice,As=/MSIE .\./.test(le),bs=function(e){return function(t,n){var s=arguments.length>2,r=s?Is.call(arguments,2):void 0;return e(s?function(){("function"==typeof t?t:Function(t)).apply(this,r)}:t,n)}};Mt({global:!0,bind:!0,forced:As},{setTimeout:bs(M.setTimeout),setInterval:bs(M.setInterval)});var ks,Ns,Us=new t.Logger("RCIM"),xs=function(){return!("undefined"==typeof uni||!function(e){for(var t=["canIUse","getSystemInfo"],n=0,s=t.length;n<s;n++)if(!e[t[n]])return!1;return!0}(uni))},Ls=xs();var _s={tag:"browser",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,i=e.body,c=t.appendUrl(e.url,o);return new Promise((function(e){var t,o=(t="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,"undefined"!=typeof XMLHttpRequest&&t?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")),u="[object XDomainRequest]"===Object.prototype.toString.call(o);if(o.open(n,c),r&&o.setRequestHeader)for(var l in r)o.setRequestHeader(l,r[l]);if(u){o.timeout=s,o.onload=function(){e({data:o.responseText,status:o.status||200})},o.onerror=function(){e({status:o.status||0})},o.ontimeout=function(){e({status:o.status||0})};var f="object"===a(i)?JSON.stringify(i):i;o.send(f)}else o.onreadystatechange=function(){4===o.readyState&&e({data:o.responseText,status:o.status})},o.onerror=function(){e({status:o.status||0})},setTimeout((function(){return e({status:o.status||0})}),s),o.send(i)}))},localStorage:null===(ks=window)||void 0===ks?void 0:ks.localStorage,sessionStorage:null===(Ns=window)||void 0===Ns?void 0:Ns.sessionStorage,isSupportSocket:function(){var e="undefined"!=typeof WebSocket;return e||Us.warn("websocket not support"),e},useNavi:!0,connectPlatform:"",isFromUniapp:Ls,createWebSocket:function(e,t){var n=new WebSocket(e,t);return n.binaryType="arraybuffer",{onClose:function(e){n.onclose=function(t){var n=t.code,s=t.reason;e(n,s)}},onError:function(e){n.onerror=e},onMessage:function(e){n.onmessage=function(t){e(t.data)}},onOpen:function(e){n.onopen=e},send:function(e){n.send(e)},close:function(e,t){n.close(e,t)}}},createDataChannel:function(e,n){return this.isSupportSocket()&&"websocket"===n?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},Ps=xs(),Os=function(e){return function(){try{var t;return(t=wx)[e].apply(t,arguments)}catch(e){Us.error(e)}}},ws={setItem:Os("setStorageSync"),getItem:Os("getStorageSync"),removeItem:Os("removeStorageSync"),clear:Os("clearStorageSync")},Bs={tag:"wechat",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,a=e.body,i=t.appendUrl(e.url,o);return new Promise((function(e){wx.request({url:i,method:n,headers:r,timeout:s,data:a,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:ws,sessionStorage:ws,isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:Ps,createWebSocket:function(e,t){var n=wx.connectSocket({url:e,protocols:t});return{onClose:function(e){n.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){e(t.data)}))},onOpen:function(e){n.onOpen(e)},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e){return new t.WebSocketChannel(this,e)}},js=xs(),Gs=function(e){return function(){try{var t;return(t=my)[e].apply(t,arguments)}catch(e){Us.error(e)}}},Ds={setItem:Gs("setStorageSync"),getItem:Gs("getStorageSync"),removeItem:Gs("removeStorageSync"),clear:Gs("clearStorageSync")},Fs={tag:"alipay",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,a=e.body,i=t.appendUrl(e.url,o);return new Promise((function(e){my.request({url:i,method:n,headers:r,timeout:s,data:a,success:function(t){e({data:t.data,status:t.status})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:Ds,sessionStorage:Ds,isSupportSocket:function(){return!1},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:js,createDataChannel:function(e){return new t.CometChannel(this,e)}},Ks=function(e){return function(){try{var t;return(t=uni)[e].apply(t,arguments)}catch(e){Us.error(e)}}},Vs={setItem:Ks("setStorageSync"),getItem:Ks("getStorageSync"),removeItem:Ks("removeStorageSync"),clear:Ks("clearStorageSync")},Hs={tag:"uniapp",httpReq:function(e){var n=e.method||t.HttpMethod.GET,s=e.timeout||6e4,r=e.headers,o=e.query,a=e.body,i=t.appendUrl(e.url,o);return new Promise((function(e){uni.request({url:i,method:n,headers:r,timeout:s,data:a,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:Vs,sessionStorage:Vs,isSupportSocket:function(){return!0},useNavi:!0,connectPlatform:"",isFromUniapp:!0,createWebSocket:function(e,t){var n={complete:function(){},url:e,protocols:t},s=uni.connectSocket(n);return{onClose:function(e){s.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){s.onError((function(t){e(t.errMsg)}))},onMessage:function(e){s.onMessage((function(t){e(t.data)}))},onOpen:function(e){s.onOpen(e)},send:function(e){s.send({data:e})},close:function(e,t){s.close({code:e,reason:t})}}},createDataChannel:function(e){return new t.WebSocketChannel(this,e)}},qs=function(e){return e&&e.canIUse&&e.getSystemInfo},Ys="undefined"!=typeof uni&&qs(uni)?function(){switch(process.env.VUE_APP_PLATFORM){case"app-plus":return Hs;case"mp-alipay":return Fs;case"mp-weixin":return Bs;case"h5":default:return _s}}():"undefined"!=typeof wx&&qs(wx)?Bs:"undefined"!=typeof my&&qs(my)?Fs:_s,Ws=Se("species"),Js=function(e){return he>=51||!A((function(){var t=[];return(t.constructor={})[Ws]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Qs=Ie.map,Xs=Js("map");Mt({target:"Array",proto:!0,forced:!Xs},{map:function(e){return Qs(this,e,arguments.length>1?arguments[1]:void 0)}});var zs=function(e,t,n){var s=Y(t);s in e?J.f(e,s,Q(0,n)):e[s]=n},$s=Se("isConcatSpreadable"),Zs=9007199254740991,er="Maximum allowed index exceeded",tr=he>=51||!A((function(){var e=[];return e[$s]=!1,e.concat()[0]!==e})),nr=Js("concat"),sr=function(e){if(!j(e))return!1;var t=e[$s];return void 0!==t?!!t:G(e)};Mt({target:"Array",proto:!0,forced:!tr||!nr},{concat:function(e){var t,n,s,r,o,a=L(this),i=Me(a,0),c=0;for(t=-1,s=arguments.length;t<s;t++)if(sr(o=-1===t?a:arguments[t])){if(c+(r=B(o.length))>Zs)throw TypeError(er);for(n=0;n<r;n++,c++)n in o&&zs(i,c,o[n])}else{if(c>=Zs)throw TypeError(er);zs(i,c++,o)}return i.length=c,i}});var rr,or,ar,ir=!A((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),cr=qe("IE_PROTO"),ur=Object.prototype,lr=ir?Object.getPrototypeOf:function(e){return e=L(e),ne(e,cr)?e[cr]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ur:null},fr=Se("iterator"),dr=!1;[].keys&&("next"in(ar=[].keys())?(or=lr(lr(ar)))!==Object.prototype&&(rr=or):dr=!0),(null==rr||A((function(){var e={};return rr[fr].call(e)!==e})))&&(rr={}),ne(rr,fr)||X(rr,fr,(function(){return this}));var gr={IteratorPrototype:rr,BUGGY_SAFARI_ITERATORS:dr},hr=gr.IteratorPrototype,Cr=function(){return this},pr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,s){return q(n),function(e){if(!j(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(s),t?e.call(n,s):n.__proto__=s,n}}():void 0),vr=gr.IteratorPrototype,Rr=gr.BUGGY_SAFARI_ITERATORS,yr=Se("iterator"),Sr="keys",mr="values",Mr="entries",Er=function(){return this},Tr="Array Iterator",Ir=et.set,Ar=et.getterFor(Tr),br=function(e,t,n,s,r,o,a){!function(e,t,n){var s=t+" Iterator";e.prototype=Ut(hr,{next:Q(1,n)}),Ft(e,s,!1),Vt[s]=Cr}(n,t,s);var i,c,u,l=function(e){if(e===r&&C)return C;if(!Rr&&e in g)return g[e];switch(e){case Sr:case mr:case Mr:return function(){return new n(this,e)}}return function(){return new n(this)}},f=t+" Iterator",d=!1,g=e.prototype,h=g[yr]||g["@@iterator"]||r&&g[r],C=!Rr&&h||l(r),p="Array"==t&&g.entries||h;if(p&&(i=lr(p.call(new e)),vr!==Object.prototype&&i.next&&(lr(i)!==vr&&(pr?pr(i,vr):"function"!=typeof i[yr]&&X(i,yr,Er)),Ft(i,f,!0))),r==mr&&h&&h.name!==mr&&(d=!0,C=function(){return h.call(this)}),g[yr]!==C&&X(g,yr,C),Vt[t]=C,r)if(c={values:l(mr),keys:o?C:l(Sr),entries:l(Mr)},a)for(u in c)(Rr||d||!(u in g))&&tt(g,u,c[u]);else Mt({target:t,proto:!0,forced:Rr||d},c);return c}(Array,"Array",(function(e,t){Ir(this,{type:Tr,target:Pe(e),index:0,kind:t})}),(function(){var e=Ar(this),t=e.target,n=e.kind,s=e.index++;return!t||s>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:s,done:!1}:"values"==n?{value:t[s],done:!1}:{value:[s,t[s]],done:!1}}),"values");Vt.Arguments=Vt.Array,_t("keys"),_t("values"),_t("entries");var kr=Se("iterator"),Nr=Se("toStringTag"),Ur=br.values;for(var xr in E){var Lr=M[xr],_r=Lr&&Lr.prototype;if(_r){if(_r[kr]!==Ur)try{X(_r,kr,Ur)}catch(e){_r[kr]=Ur}if(_r[Nr]||X(_r,Nr,xr),E[xr])for(var Pr in br)if(_r[Pr]!==br[Pr])try{X(_r,Pr,br[Pr])}catch(e){_r[Pr]=br[Pr]}}}var Or=function(){var e=q(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},wr="toString",Br=RegExp.prototype,jr=Br.toString,Gr=A((function(){return"/a/b"!=jr.call({source:"a",flags:"b"})})),Dr=jr.name!=wr;(Gr||Dr)&&tt(RegExp.prototype,wr,(function(){var e=q(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in Br)?Or.call(e):n)}),{unsafe:!0});var Fr={"RC:TxtMsg":"TextMessage","RC:ImgMsg":"ImageMessage","RC:VcMsg":"VoiceMessage","RC:ImgTextMsg":"RichContentMessage","RC:ReferenceMsg":"ReferenceMessage","RC:FileMsg":"FileMessage","RC:HQVCMsg":"HQVoiceMessage","RC:GIFMsg":"GIFMessage","RC:SightMsg":"SightMessage","RC:LBSMsg":"LocationMessage","RC:InfoNtf":"InformationNotificationMessage","RC:ContactNtf":"ContactNotificationMessage","RC:ProfileNtf":"ProfileNotificationMessage","RC:CmdNtf":"CommandNotificationMessage","RC:DizNtf":"DiscussionNotificationMessage","RC:CmdMsg":"CommandMessage","RC:TypSts":"TypingStatusMessage","RC:CsChaR":"ChangeModeResponseMessage","RC:CsHsR":"HandShakeResponseMessage","RC:CsEnd":"TerminateMessage","RC:CsSp":"SuspendMessage","RC:CsUpdate":"CustomerStatusUpdateMessage","RC:ReadNtf":"ReadReceiptMessage","RC:VCAccept":"AcceptMessage","RC:VCRinging":"RingingMessage","RC:VCSummary":"SummaryMessage","RC:VCHangup":"HungupMessage","RC:VCInvite":"InviteMessage","RC:VCModifyMedia":"MediaModifyMessage","RC:VCModifyMem":"MemberModifyMessage","RC:CsContact":"CustomerContact","RC:PSImgTxtMsg":"PublicServiceRichContentMessage","RC:PSMultiImgTxtMsg":"PublicServiceMultiRichContentMessage","RC:GrpNtf":"GroupNotificationMessage","RC:PSCmd":"PublicServiceCommandMessage","RC:RcCmd":"RecallCommandMessage","RC:SRSMsg":"SyncReadStatusMessage","RC:RRReqMsg":"ReadReceiptRequestMessage","RC:RRRspMsg":"ReadReceiptResponseMessage","RCJrmf:RpMsg":"JrmfRedPacketMessage","RCJrmf:RpOpendMsg":"JrmfRedPacketOpenedMessage","RC:CombineMsg":"RCCombineMessage","RC:chrmKVNotiMsg":"ChrmKVNotificationMessage","RC:LogCmdMsg":"LogCommandMessage","RC:MsgExMsg":"ExpansionCommandMessage","RC:RRMsg":"GroupReadReceiptResponseMessage"},Kr={},Vr=new t.AppStorage(Ys,"API-V2");function Hr(e){var t=e.channelId,n=e.conversationType,s=e.targetId,r=e.unreadMessageCount,o=e.latestMessage,a=e.isTop,i=e.notificationStatus,c=o?qr(o):null;return{channelId:t||"",conversationType:n,targetId:s,unreadMessageCount:r,latestMessage:c,latestMessageId:null==c?void 0:c.messageId,objectName:null==c?void 0:c.messageType,sentTime:null==c?void 0:c.sentTime,isTop:a,notificationStatus:i,receivedStatus:null==c?void 0:c.receivedStatus}}function qr(e){var n=e.conversationType,s=e.targetId,o=e.senderUserId,a=e.content,i=e.messageType,c=e.messageUId,u=e.messageDirection,l=e.isOffLineMessage,f=e.sentTime,d=e.receivedStatus,g=e.receivedTime,h=e.canIncludeExpansion,C=e.disableNotification,p=e.expansion,v=e.messageId,R=e.sentStatus,y=e.channelId,S=e.readReceiptInfo,m="";return i in Fr?m=Fr[i]:i in Kr?m=Kr[i]:(a={message:{content:a,objectName:i},messageName:"UnknownMessage"},m="UnknownMessage"),d||(d=t.ReceivedStatus.UNREAD),void 0===v&&(v=~~(16777215*Math.random())),{channelId:y||"",conversationType:n,targetId:s,senderUserId:o,content:a,messageType:m,messageUId:c,messageDirection:u,offLineMessage:l,sentTime:f,receivedStatus:d,receivedTime:g,objectName:i,messageId:v,sentStatus:R||r.SENT,disableNotification:C,canIncludeExpansion:h,expansion:p,readReceiptInfo:S}}function Yr(e,n){var s=new Date,r=s.getMonth()+1,o=s.getFullYear()+"/"+(1===r.toString().length?"0"+r:r)+"/"+s.getDate(),a=new Date(o).getTime()-e.sentTime<0,i=e.messageType,c=e.messageDirection;if("ReadReceiptRequestMessage"===i&&a&&c===t.MessageDirection.SEND){var u="".concat(n).concat(e.content.messageUId,"SENT");Vr.set(u,{count:0,dealtime:e.sentTime,userIds:{}})}else if("ReadReceiptRequestMessage"===i&&a){var l="".concat(n).concat(e.conversationType).concat(e.targetId,"RECEIVED"),f=Vr.get(l);if(f)if(e.senderUserId in f)f[e.senderUserId].uIds&&-1===f[e.senderUserId].uIds.indexOf(e.content.messageUId)&&(f[e.senderUserId].uIds.push(e.content.messageUId),f[e.senderUserId].dealtime=e.sentTime,f[e.senderUserId].isResponse=!1,Vr.set(l,f));else{var d={uIds:[e.content.messageUId],dealtime:e.sentTime,isResponse:!1};f[e.senderUserId]=d,Vr.set(l,f)}else{var g={};g[e.senderUserId]={uIds:[e.content.messageUId],dealtime:e.sentTime,isResponse:!1},Vr.set(l,g)}}}function Wr(e,t,n){try{e(t,n)}catch(e){Us.error(e)}}function Jr(e,t,n){try{e(t,n)}catch(e){Us.error(e)}}var Qr=Object.assign,Xr=Object.defineProperty,zr=!Qr||A((function(){if(D&&1!==Qr({b:1},Qr(Xr({},"a",{enumerable:!0,get:function(){Xr(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),s="abcdefghijklmnopqrst";return e[n]=7,s.split("").forEach((function(e){t[e]=e})),7!=Qr({},e)[n]||Et(Qr({},t)).join("")!=s}))?function(e,t){for(var n=L(e),s=arguments.length,r=1,o=ft.f,a=_e.f;s>r;)for(var i,c=U(arguments[r++]),u=o?Et(c).concat(o(c)):Et(c),l=u.length,f=0;l>f;)i=u[f++],D&&!a.call(c,i)||(n[i]=c[i]);return n}:Qr;Mt({target:"Object",stat:!0,forced:Object.assign!==zr},{assign:zr});var $r=Js("splice"),Zr=Math.max,eo=Math.min,to=9007199254740991,no="Maximum allowed length exceeded";Mt({target:"Array",proto:!0,forced:!$r},{splice:function(e,t){var n,s,r,o,a,i,c=L(this),u=B(c.length),l=rt(e,u),f=arguments.length;if(0===f?n=s=0:1===f?(n=0,s=u-l):(n=f-2,s=eo(Zr(O(t),0),u-l)),u+n-s>to)throw TypeError(no);for(r=Me(c,s),o=0;o<s;o++)(a=l+o)in c&&zs(r,o,c[a]);if(r.length=s,n<s){for(o=l;o<u-s;o++)i=o+n,(a=o+s)in c?c[i]=c[a]:delete c[i];for(o=u;o>u-s+n;o--)delete c[o-1]}else if(n>s)for(o=u-s;o>l;o--)i=o+n-1,(a=o+s-1)in c?c[i]=c[a]:delete c[i];for(o=0;o<n;o++)c[o+l]=arguments[o+2];return c.length=u-s+n,r}});var so=function e(t,n,s){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];u(this,e),this.messageType=t,this.objectName=n,this.content=s,this.isPersited=r,this.isCounted=o};function ro(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=function(r){return new so(e,t,r,n,s)};return r.MessageType=e,r.ObjectName=t,r}var oo,ao,io,co=ro("ReadReceiptResponseMessage","RC:RRRspMsg"),uo=function(){function e(t,n,s){u(this,e),this._context=t,this.channelId=n,this._isCPPMode=s,this._storage=Vr,this._draftMap={}}return f(e,[{key:"getConversationList",value:function(e,n,s){t.assert("callback",e,t.AssertRules.CALLBACK),t.assert("conversationTypes",n,t.AssertRules.ARRAY),t.assert("count",s,t.AssertRules.NUMBER),this._context.getConversationList(s,void 0,0,0,this.channelId).then((function(s){var r=s.code,o=s.data,a=[];o=o||[],r===t.ErrorCode.SUCCESS?(n?o.forEach((function(e){n.indexOf(e.conversationType)>-1&&a.push(Hr(e))})):o.forEach((function(e){a.push(Hr(e))})),Wr(e.onSuccess,a)):Jr(e.onError,r)}))}},{key:"getConversation",value:function(e,n,s){var r=this;t.assert("callback",s,t.AssertRules.CALLBACK),t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),c(regeneratorRuntime.mark((function o(){var a,i,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r._context.getConversation(e,n,r.channelId);case 2:if(a=o.sent,i=a.code,c=a.data,i===t.ErrorCode.SUCCESS){o.next=8;break}return s.onError(i),o.abrupt("return");case 8:s.onSuccess(c?Hr(c):null);case 9:case"end":return o.stop()}}),o)})))()}},{key:"removeConversation",value:function(e,n,s){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.removeConversation(e,n,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,e)}))}},{key:"saveTextMessageDraft",value:function(e,n,s){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("draftText",s,t.AssertRules.STRING,!0);var r=this._context.getCurrentUserId();return!!r&&((this._draftMap[r]=this._draftMap[r]||{})["".concat(e,"_").concat(n,"_").concat(this.channelId)]=s,!0)}},{key:"getTextMessageDraft",value:function(e,n){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0);var s=this._context.getCurrentUserId();if(s)return(this._draftMap[s]||{})["".concat(e,"_").concat(n,"_").concat(this.channelId)]}},{key:"clearTextMessageDraft",value:function(e,n){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0);var s=this._context.getCurrentUserId();return!!s&&delete(this._draftMap[s]||{})["".concat(e,"_").concat(n,"_").concat(this.channelId)]}},{key:"getTotalUnreadCount",value:function(e,n,s){t.assert("callback",e,t.AssertRules.CALLBACK),this._context.getTotalUnreadCount(this.channelId,n,s).then((function(n){var s=n.code,r=n.data;s===t.ErrorCode.SUCCESS?Wr(e.onSuccess,r):Jr(e.onError,s)}))}},{key:"getUnreadCount",value:function(e,n,s){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.getUnreadCount(e,n,this.channelId).then((function(e){var n=e.code,r=e.data;n===t.ErrorCode.SUCCESS?Wr(s.onSuccess,r):Jr(s.onError,n)}))}},{key:"clearConversations",value:function(e,n){this._isCPPMode?this._context.clearConversations(n,this.channelId).then((function(n){n===t.ErrorCode.SUCCESS?Wr(e.onSuccess,!0):Jr(e.onError,n)})):Us.error("Method is only available in cppProtocol mode")}},{key:"clearUnreadCount",value:function(e,n,s){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.clearUnreadCount(e,n,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess,!0):Jr(s.onError,e)}))}},{key:"setConversationStatus",value:function(e,n,s,r){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",r,t.AssertRules.CALLBACK),t.assert("status",s,t.AssertRules.OBJECT,!0);var o=s.isTop,a=s.notificationStatus;this._context.setConversationStatus(e,n,o,a,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(r.onSuccess):Jr(r.onError,e)}))}},{key:"sendMessage",value:function(e,n,s,r,o,a,i,c){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("msg",s,t.AssertRules.OBJECT,!0),t.assert("callback",r,t.AssertRules.CALLBACK),t.assert("isMentioned",o,t.AssertRules.BOOLEAN),t.assert("pushContent",a,t.AssertRules.ONLY_STRING),t.assert("pushData",i,t.AssertRules.ONLY_STRING),t.assert("options.userIds",null==c?void 0:c.userIds,t.AssertRules.ARRAY),t.assert("options.isVoipPush",null==c?void 0:c.isVoipPush,t.AssertRules.BOOLEAN),t.assert("options.disableNotification",null==c?void 0:c.disableNotification,t.AssertRules.BOOLEAN),t.assert("options.canIncludeExpansion",null==c?void 0:c.canIncludeExpansion,t.AssertRules.BOOLEAN),t.assert("options.expansion",null==c?void 0:c.expansion,t.AssertRules.OBJECT),t.assert("options.pushConfig",null==c?void 0:c.pushConfig,t.AssertRules.OBJECT);var u=!!(null!=c&&c.isStatusMessage||null!=c&&c.isStatus),l=function(e,t,n){var s,r=e||{},o=r.userIds,a=r.isVoipPush,i=r.disableNotification,c=r.isFilerWhiteBlacklist,u=r.expansion,l=r.canIncludeExpansion,f=r.pushConfig,d=[];if(t){var g=(n||{}).content.mentionedInfo;d=g.userIdList,s=g.type}return{mentionedType:s,mentionedUserIdList:d,directionalUserIdList:o,isVoipPush:a,disableNotification:i,isFilerWhiteBlacklist:c,expansion:u,canIncludeExpansion:l,pushConfig:f}}(c,o,s),f=Object.assign(s,h(h({isMentioned:o,pushContent:a,pushData:i},l),{},{messageType:s.objectName,channelId:this.channelId,isStatusMessage:u})),d=this._context.getCurrentUserId();this._context.sendMessage(e,n,f,r.onBefore).then((function(o){var a=o.code,i=o.data;a===t.ErrorCode.SUCCESS?(Yr(qr(i),d),Wr(r.onSuccess,qr(i))):Jr(r.onError,a,qr({isMentioned:!!f.isMentioned,content:s.content,messageType:s.messageType,isPersited:s.isPersited,isCounted:s.isCounted,disableNotification:!(null==c||!c.disableNotification),canIncludeExpansion:!(null==c||!c.canIncludeExpansion),expansion:(null==c?void 0:c.expansion)||null,conversationType:e,targetId:n,senderUserId:d,messageUId:"",messageDirection:t.MessageDirection.SEND,isOffLineMessage:!1,sentTime:(null==i?void 0:i.sentTime)||0,receivedTime:0,isStatusMessage:u,receivedStatus:t.ReceivedStatus.UNREAD}))}))}},{key:"sendRecallMessage",value:function(e,n,s){t.assert("message.conversationType",e.conversationType,t.AssertRules.NUMBER,!0),t.assert("message.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("message.messageUId",e.messageUId,t.AssertRules.STRING,!0),t.assert("message.sentTime",e.sentTime,t.AssertRules.NUMBER,!0),t.assert("callback",n,t.AssertRules.CALLBACK),t.assert("options.disableNotification",null==s?void 0:s.disableNotification,t.AssertRules.BOOLEAN),t.assert("options.pushConfig",null==s?void 0:s.pushConfig,t.AssertRules.OBJECT);var r=e.conversationType,o=e.targetId,a=e.messageUId,i=e.sentTime,c=e.content,u=h({channelId:this.channelId,oriContent:c},s);this._context.recallMessage(r,o,a,i,u).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?Wr(n.onSuccess,qr(r)):Jr(n.onError,s)}))}},{key:"sendTypingStatusMessage",value:function(e,n,s,r){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("typingContentType",s,t.AssertRules.STRING,!0),t.assert("callback",r,t.AssertRules.CALLBACK);var o={messageType:"RC:TypSts",content:{typingContentType:s},isStatusMessage:!0};this._context.sendMessage(e,n,o).then((function(e){var n=e.code,s=e.data;n===t.ErrorCode.SUCCESS?Wr(r.onSuccess,qr(s)):Jr(r.onError,n)}))}},{key:"sendReceiptResponse",value:function(e,t,n){var s=this,r=this._context.getCurrentUserId(),o="".concat(r).concat(e).concat(t,"RECEIVED"),a=this._storage.get(o);if(a){var i=[];for(var c in a){var u={};u[c]=a[c].uIds,a[c].isResponse||i.push(u)}if(0===i.length)return void n.onSuccess(null);var l=setInterval((function(){1===i.length&&clearInterval(l);var r=i.splice(0,1)[0],c=new co({receiptMessageDic:r});s.sendMessage(e,t,c,{onSuccess:function(e){var t=Object.keys(r)[0];a[t].isResponse=!0,s._storage.set(o,a),Wr(n.onSuccess,e)},onError:function(e){Jr(n.onError,e)}})}),200)}else n.onSuccess(null)}},{key:"sendReadReceiptMessage",value:function(e,n,s){t.assert("messageUIds",e,t.AssertRules.ARRAY,!0),t.assert("targetId",n,t.AssertRules.STRING,!0);var r,o=p(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;t.assert("messageUId",a,t.AssertRules.STRING)}}catch(e){o.e(e)}finally{o.f()}this._context.sendReadReceiptMessage(n,e,this.channelId).then((function(e){var n=e.code;n===t.ErrorCode.SUCCESS?s.onSuccess():s.onError(n)})).catch((function(e){s.onError(e)}))}},{key:"getMessageReader",value:function(e,n,s){t.assert("messageUId",e,t.AssertRules.STRING,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),this._context.getMessageReader(n,e,this.channelId).then((function(e){var n=e.code,r=e.data;n===t.ErrorCode.SUCCESS?s.onSuccess(r):s.onError(n)})).catch((function(e){s.onError(e)}))}},{key:"updateMessageExpansion",value:function(e,n,s){t.assert("expansion",e,t.AssertRules.OBJECT,!0),t.assert("message",n,t.AssertRules.OBJECT,!0);var r=n.conversationType,o=n.targetId,a=n.messageUId,i=n.canIncludeExpansion,c=n.expansion;this._context.sendExpansionMessage({conversationType:r,targetId:o,messageUId:a,canIncludeExpansion:i,originExpansion:c,expansion:e,channelId:this.channelId}).then((function(e){var n=e.code;n===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,n)}))}},{key:"removeMessageExpansionForKey",value:function(e,n,s){t.assert("keys",e,t.AssertRules.ARRAY,!0),t.assert("message",n,t.AssertRules.OBJECT,!0);var r=n.conversationType,o=n.targetId,a=n.messageUId,i=n.canIncludeExpansion;this._context.sendExpansionMessage({conversationType:r,targetId:o,messageUId:a,canIncludeExpansion:i,keys:e,channelId:this.channelId}).then((function(e){var n=e.code;n===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,n)}))}},{key:"getHistoryMessages",value:function(e,n,s,r,o,a,i){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),t.assert("count",r,t.AssertRules.NUMBER,!0),t.assert("callback",o,t.AssertRules.CALLBACK,!0),t.assert("order",i,t.AssertRules.NUMBER),this._context.getHistoryMessage(e,n,s,r,i,this.channelId,a).then((function(e){var n=e.code,s=e.data;if(n===t.ErrorCode.SUCCESS)if(s){var r=s.list,a=s.hasMore,i=r.map((function(e){return qr(e)}));Wr(o.onSuccess,i,a)}else Wr(o.onSuccess,[],!1);else Jr(o.onError,n)}))}},{key:"deleteRemoteMessages",value:function(e,n,s,r){t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("messages",s,t.AssertRules.ARRAY,!0),t.assert("callback",r,t.AssertRules.CALLBACK),this._context.deleteRemoteMessage(e,n,s,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(r.onSuccess):Jr(r.onError,e)}))}},{key:"clearRemoteHistoryMessages",value:function(e,n){t.assert("param.conversationType",e.conversationType,t.AssertRules.NUMBER,!0),t.assert("param.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("param.timestamp",e.timestamp,t.AssertRules.NUMBER,!0),t.assert("callback",n,t.AssertRules.CALLBACK);var s=e.conversationType,r=e.targetId,o=e.timestamp;this._context.deleteRemoteMessageByTimestamp(s,r,o,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(n.onSuccess):Jr(n.onError,e)}))}},{key:"insertMessage",value:function(e,n,s,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=s.senderUserId,i=s.objectName,c=s.content,u=s.messageDirection,l=s.messageUId,f=s.canIncludeExpansion,d=s.expansion,g=s.disableNotification,h=s.sentTime,C=s.sentStatus,p=o.isUnread,v=o.searchContent,R={senderUserId:a,messageType:i,content:c,messageDirection:u,sentTime:h,sentStatus:C,searchContent:v,isUnread:p,messageUId:l,disableNotification:g,canIncludeExpansion:f,expansionMsg:JSON.stringify(d),channelId:this.channelId};this._context.insertMessage(e,n,R).then((function(e){var n=e.code,s=e.data;n===t.ErrorCode.SUCCESS?Wr(r.onSuccess,qr(s)):Jr(r.onError,n)}))}},{key:"deleteLocalMessagesByTimestamp",value:function(e,n,s,r,o){this._context.deleteMessagesByTimestamp(e,n,s,r,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(o.onSuccess,!0):Jr(o.onError,e)}))}},{key:"getRemoteHistoryMessages",value:function(e,n,s,r,o,a){var i=a.order||0;this._context.getRemoteHistoryMessages(e,n,s,r,i,this.channelId).then((function(e){var n=e.code,s=e.data;if(n===t.ErrorCode.SUCCESS)if(s){var r=s.list,a=s.hasMore,i=r.map((function(e){return qr(e)}));Wr(o.onSuccess,i,a)}else Wr(o.onSuccess,[],!1);else Jr(o.onError,n)}))}},{key:"clearMessages",value:function(e,n,s){this._context.clearMessages(e,n,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess,!0):Jr(s.onError,e)}))}},{key:"searchConversationByContent",value:function(e,n,s,r){this._context.searchConversationByContent(e,r,this.channelId,s).then((function(e){var s=e.code,r=e.data,o=[];r=r||[],s===t.ErrorCode.SUCCESS?(r.forEach((function(e){o.push(Hr(e))})),Wr(n.onSuccess,o)):Jr(n.onError,s)}))}},{key:"searchMessageByContent",value:function(e,n,s,r,o,a,i){this._context.searchMessageByContent(e,n,s,r,o,a,this.channelId).then((function(e){var n=e.code,s=e.data,r=[];if(n===t.ErrorCode.SUCCESS){var o=s=s||{},a=o.messages,c=o.count;a.forEach((function(e){r.push(qr(e))})),Wr(i.onSuccess,r,c)}else Jr(i.onError,n)}))}},{key:"getUnreadMentionedMessages",value:function(e,t){return this._context.getUnreadMentionedMessages(e,t,this.channelId).map((function(e){return qr(e)}))}},{key:"clearUnreadCountByTimestamp",value:function(e,n,s,r){this._context.clearUnreadCountByTimestamp(e,n,s,this.channelId).then((function(e){e===t.ErrorCode.SUCCESS?Wr(r.onSuccess,!0):Jr(r.onError,e)}))}},{key:"getConversationNotificationStatus",value:function(e,n,s){this._context.getConversationNotificationStatus(e,n,this.channelId).then((function(e){var n=e.code,r=e.data;n===t.ErrorCode.SUCCESS?Wr(s.onSuccess,r):Jr(s.onError,n)}))}}]),e}(),lo=function(){function e(n){u(this,e),this._context=n,this._channelClient={},this._isCPPMode=t.usingCppEngine(),this._defaultChannelClient=new uo(n,"",this._isCPPMode)}var n;return f(e,[{key:"assertCPPMode",value:function(e,n,s){if(!this._isCPPMode)return s&&s.onError(t.ErrorCode.NOT_SUPPORT),void Us.error("'".concat(n,"' is unusable!"));e()}},{key:"install",value:function(e,t){return this._context.install(e,t)}},{key:"getChannel",value:function(e){return this._isCPPMode?(t.assert("channelId",e,t.AssertRules.STRING,!0),e.length>20?(Us.error("The channelId cannot exceed 20 characters"),null):e in this._channelClient?this._channelClient[e]:Object.keys(this._channelClient).length>1e3?(Us.error("Only 1000 channels can be obtained"),null):(this._channelClient[e]=new uo(this._context,e,this._isCPPMode),this._channelClient[e])):(Us.error("getChannel method is only available in protocol stack mode"),null)}},{key:"deleteChannels",value:function(e){var n=this;t.assert("channelIds",e,t.AssertRules.ARRAY,!0),this.assertCPPMode((function(){e.forEach((function(e){delete n._channelClient[e]}))}),"deleteChannels")}},{key:"getNavi",value:function(){return this._context.getInfoFromCache()||{}}},{key:"getSDKInfo",value:function(){return{version:this._context.apiVersion}}},{key:"getAppInfo",value:function(){return{appKey:this._context.appkey}}},{key:"getCurrentUserId",value:function(){return this._context.getCurrentUserId()}},{key:"disconnect",value:(n=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.disconnect();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"logout",value:function(){return this.disconnect()}},{key:"clearCache",value:function(){}},{key:"getConversationList",value:function(e,t,n){this._defaultChannelClient.getConversationList(e,t,n)}},{key:"getConversation",value:function(e,t,n){return this._defaultChannelClient.getConversation(e,t,n)}},{key:"removeConversation",value:function(e,t,n){return this._defaultChannelClient.removeConversation(e,t,n)}},{key:"saveTextMessageDraft",value:function(e,t,n){return this._defaultChannelClient.saveTextMessageDraft(e,t,n)}},{key:"getTextMessageDraft",value:function(e,t){return this._defaultChannelClient.getTextMessageDraft(e,t)}},{key:"clearTextMessageDraft",value:function(e,t){return this._defaultChannelClient.clearTextMessageDraft(e,t)}},{key:"getTotalUnreadCount",value:function(e,t,n){return this._defaultChannelClient.getTotalUnreadCount(e,t,n)}},{key:"getUnreadCount",value:function(e,t,n){return this._defaultChannelClient.getUnreadCount(e,t,n)}},{key:"getConversationUnreadCount",value:function(e,t){Us.error("Method is deprecated")}},{key:"clearConversations",value:function(e,t){return this._defaultChannelClient.clearConversations(e,t)}},{key:"clearUnreadCount",value:function(e,t,n){this._defaultChannelClient.clearUnreadCount(e,t,n)}},{key:"setConversationStatus",value:function(e,t,n,s){return this._defaultChannelClient.setConversationStatus(e,t,n,s)}},{key:"sendMessage",value:function(e,t,n,s,r,o,a,i,c){return this._defaultChannelClient.sendMessage(e,t,n,s,r,o,a,c)}},{key:"sendRecallMessage",value:function(e,t,n){return this._defaultChannelClient.sendRecallMessage(e,t,n)}},{key:"sendTypingStatusMessage",value:function(e,t,n,s){return this._defaultChannelClient.sendTypingStatusMessage(e,t,n,s)}},{key:"sendReceiptResponse",value:function(e,t,n){return this._defaultChannelClient.sendReceiptResponse(e,t,n)}},{key:"sendReadReceiptMessage",value:function(e,t,n){return this._defaultChannelClient.sendReadReceiptMessage(e,t,n)}},{key:"getMessageReader",value:function(e,t,n){this._defaultChannelClient.getMessageReader(e,t,n)}},{key:"updateMessageExpansion",value:function(e,t,n){this._defaultChannelClient.updateMessageExpansion(e,t,n)}},{key:"removeMessageExpansionForKey",value:function(e,t,n){this._defaultChannelClient.removeMessageExpansionForKey(e,t,n)}},{key:"getHistoryMessages",value:function(e,t,n,s,r,o,a){return this._defaultChannelClient.getHistoryMessages(e,t,n,s,r,o,a)}},{key:"joinChatRoom",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.joinChatroom(e,n).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,e)}))}},{key:"quitChatRoom",value:function(e,n){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),this._context.quitChatroom(e).then((function(e){e===t.ErrorCode.SUCCESS?Wr(n.onSuccess):Jr(n.onError,e)}))}},{key:"getChatRoomInfo",value:function(e,n,s,r){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("order",s,t.AssertRules.NUMBER,!0),t.assert("callback",r,t.AssertRules.CALLBACK),this._context.getChatroomInfo(e,n,s).then((function(e){var n=e.code,s=e.data;n===t.ErrorCode.SUCCESS?Wr(r.onSuccess,{userInfos:(null==s?void 0:s.userInfos)||[],userTotalNums:(null==s?void 0:s.userCount)||0}):Jr(r.onError,n)}))}},{key:"setChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.setChatroomEntry(e,n).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,e)}))}},{key:"forceSetChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.forceSetChatroomEntry(e,n).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,e)}))}},{key:"removeChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.removeChatroomEntry(e,n).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,e)}))}},{key:"forceRemoveChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("chatroomEntry",n,t.AssertRules.OBJECT,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.forceRemoveChatroomEntry(e,n).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess):Jr(s.onError,e)}))}},{key:"getChatroomEntry",value:function(e,n,s){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("key",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.getChatroomEntry(e,n).then((function(e){var n=e.code,r=e.data;n===t.ErrorCode.SUCCESS?Wr(s.onSuccess,r||""):Jr(s.onError,n)}))}},{key:"getAllChatroomEntries",value:function(e,n){t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),this._context.getAllChatroomEntries(e).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?Wr(n.onSuccess,r):Jr(n.onError,s)}))}},{key:"getChatRoomHistoryMessages",value:function(e,n,s,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;t.assert("chatRoomId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("order",s,t.AssertRules.NUMBER,!0),t.assert("callback",r,t.AssertRules.CALLBACK),t.assert("timestamp",o,t.AssertRules.NUMBER),this._context.getChatRoomHistoryMessages(e,n,s,o).then((function(e){var n=e.code,s=e.data;if(n===t.ErrorCode.SUCCESS)if(s){var o=s.list,a=s.hasMore,i=o.map((function(e){return qr(e)}));Wr(r.onSuccess,i,a)}else Wr(r.onSuccess,[],!1);else Jr(r.onError,n)}))}},{key:"setDeviceInfo",value:function(e){}},{key:"getCurrentConnectionStatus",value:function(){return this._context.getConnectionStatus()}},{key:"deleteRemoteMessages",value:function(e,t,n,s){return this._defaultChannelClient.deleteRemoteMessages(e,t,n,s)}},{key:"clearRemoteHistoryMessages",value:function(e,t){return this._defaultChannelClient.clearRemoteHistoryMessages(e,t)}},{key:"getFileToken",value:function(e,n,s,r,o){t.assert("fileType",e,t.AssertRules.NUMBER,!0),t.assert("fileName",s,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),this._context.getFileToken(e,s,r,o).then(n.onSuccess).catch(n.onError)}},{key:"getFileUrl",value:function(e,n,s,r,o,a){t.assert("fileType",e,t.AssertRules.NUMBER,!0),t.assert("fileName",n,t.AssertRules.STRING,!0),t.assert("saveName",s,t.AssertRules.STRING),t.assert("callback",r,t.AssertRules.CALLBACK),t.assert("serverType",a,t.AssertRules.NUMBER),t.assert("uploadRes",o,t.AssertRules.OBJECT),this._context.getFileUrl(e,n,s,o,a).then(r.onSuccess).catch(r.onError)}},{key:"createTag",value:function(e,n){t.assert("tag.tagId",e.tagId,t.AssertRules.STRING,!0),t.assert("tag.tagId",e.tagId,(function(e){return e.length<=10})),t.assert("tag.tagName",e.tagName,(function(e){return e.length<=15})),t.assert("tag.tagName",e.tagName,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),this._context.createTag(e).then((function(e){var s=e.code;s===t.ErrorCode.SUCCESS?n.onSuccess():n.onError(s)})).catch((function(e){n.onError(e)}))}},{key:"removeTag",value:function(e,n){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),this._context.removeTag(e).then((function(e){var s=e.code;s===t.ErrorCode.SUCCESS?n.onSuccess():n.onError(s)})).catch((function(e){n.onError(e)}))}},{key:"updateTag",value:function(e,n){t.assert("tag.tagId",e.tagId,t.AssertRules.STRING,!0),t.assert("tag.tagName",e.tagName,t.AssertRules.STRING,!0),t.assert("tag.tagName",e.tagName,(function(e){return e.length<=15})),t.assert("callback",n,t.AssertRules.CALLBACK),this._context.updateTag(e).then((function(e){var s=e.code;s===t.ErrorCode.SUCCESS?n.onSuccess():n.onError(s)})).catch((function(e){n.onError(e)}))}},{key:"getTagList",value:function(e){t.assert("callback",e,t.AssertRules.CALLBACK),this._context.getTagList().then((function(n){var s=n.code,r=n.data;s===t.ErrorCode.SUCCESS?e.onSuccess(r||[]):e.onError(s)})).catch((function(t){e.onError(t)}))}},{key:"getTagsForConversation",value:function(e,n){t.assert("conversationType",e.type,t.AssertRules.NUMBER),t.assert("targetId",e.targetId,t.AssertRules.STRING),t.assert("channelId",e.channelId,t.AssertRules.ONLY_STRING),t.assert("callback",n,t.AssertRules.CALLBACK),this._context.getTagsForConversation(e).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?n.onSuccess(r||[]):n.onError(s)})).catch((function(e){n.onError(e)}))}},{key:"addTagForConversations",value:function(e,n,s){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("conversations",n,t.AssertRules.ARRAY,!0),t.assert("callback",s,t.AssertRules.CALLBACK),n.forEach((function(e){t.assert("conversation.type",e.type,t.AssertRules.NUMBER,!0),t.assert("conversation.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("conversation.channelId",e.channelId,t.AssertRules.ONLY_STRING)})),this._context.addTagForConversations(e,n).then((function(e){var n=e.code;e.data,n===t.ErrorCode.SUCCESS?s.onSuccess():s.onError(n)})).catch((function(e){s.onError(e)}))}},{key:"removeTagForConversations",value:function(e,n,s){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("conversations",n,t.AssertRules.ARRAY,!0),t.assert("callback",s,t.AssertRules.CALLBACK),n.forEach((function(e){t.assert("conversation.type",e.type,t.AssertRules.NUMBER,!0),t.assert("conversation.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("conversation.channelId",e.channelId,t.AssertRules.ONLY_STRING)})),this._context.removeTagForConversations(e,n).then((function(e){var n=e.code;e.data,n===t.ErrorCode.SUCCESS?s.onSuccess():s.onError(n)})).catch((function(e){s.onError(e)}))}},{key:"removeTagsForConversation",value:function(e,n,s){t.assert("conversation.type",e.type,t.AssertRules.NUMBER,!0),t.assert("conversation.targetId",e.targetId,t.AssertRules.STRING,!0),t.assert("conversation.channelId",e.channelId,t.AssertRules.ONLY_STRING),t.assert("tagIds",n,t.AssertRules.ARRAY,!0),t.assert("callback",s,t.AssertRules.CALLBACK),n.forEach((function(e){t.assert("tagId",e,t.AssertRules.STRING,!0)})),this._context.removeTagsForConversation(e,n).then((function(e){var n=e.code;e.data,n===t.ErrorCode.SUCCESS?s.onSuccess():s.onError(n)})).catch((function(e){s.onError(e)}))}},{key:"getConversationListByTag",value:function(e,n,s,r){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("startTime",s,t.AssertRules.NUMBER,!0),t.assert("callback",r,t.AssertRules.CALLBACK,!0),this._context.getConversationListByTag(e,s,n).then((function(e){var n=e.code,s=e.data,o=[];n===t.ErrorCode.SUCCESS?((s=s||[]).forEach((function(e){var t,n,s,r,a,i,c,u,l,f,d;o.push((n=(t=e).channelId,s=t.conversationType,r=t.targetId,a=t.unreadMessageCount,i=t.latestMessage,c=t.isTop,u=t.notificationStatus,l=t.isTopInTag,f=i?qr(i):null,(d=f||{}).messageType,d.sentTime,d.receivedStatus,d.messageId,{channelId:n||"",conversationType:s,targetId:r,unreadMessageCount:a,latestMessage:f,isTopInTag:l,latestMessageId:null==f?void 0:f.messageId,objectName:null==f?void 0:f.messageType,sentTime:null==f?void 0:f.sentTime,isTop:c,notificationStatus:u,receivedStatus:null==f?void 0:f.receivedStatus}))})),r.onSuccess(o)):r.onError(n)})).catch((function(e){r.onError(e)}))}},{key:"getUnreadCountByTag",value:function(e,n,s){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("containMuted",n,t.AssertRules.BOOLEAN,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this._context.getUnreadCountByTag(e,n).then((function(e){var n=e.code,r=e.data;Us.info(n,r),n===t.ErrorCode.SUCCESS?s.onSuccess(r||0):s.onError(n)})).catch((function(e){s.onError(e)}))}},{key:"setConversationStatusInTag",value:function(e,n,s,r){t.assert("tagId",e,t.AssertRules.STRING,!0),t.assert("conversation.targetId",n.targetId,t.AssertRules.STRING,!0),t.assert("conversation.type",n.type,t.AssertRules.NUMBER,!0),t.assert("conversation.channelId",n.channelId,t.AssertRules.ONLY_STRING),t.assert("status.isTop",null==s?void 0:s.isTop,t.AssertRules.BOOLEAN,!0),t.assert("callback",r,t.AssertRules.CALLBACK),this._context.setConversationStatusInTag(e,n,s).then((function(e){var n=e.code;e.data,n===t.ErrorCode.SUCCESS?r.onSuccess():r.onError(n)})).catch((function(e){r.onError(e)}))}},{key:"callExtra",value:function(e,n){for(var s,r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];(s=this._context).callExtra.apply(s,[e].concat(o)).then((function(s){var r=s.code,o=s.data;if(r!==t.ErrorCode.SUCCESS)n.onError&&Jr(n.onError,r);else{if("getConversationsByPage"===e&&o.forEach((function(e){e.latestMessage=e.latestMessage?qr(e.latestMessage):null})),"getHistoryMessagesByObjectNames"===e){var a=o.list,i=o.hasMore,c=a.map((function(e){return qr(e)}));return void Wr(n.onSuccess,c,i)}n.onSuccess&&Wr(n.onSuccess,o)}}))}},{key:"hasRemoteUnreadMessages",value:function(e,n){t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){Wr(n.onSuccess,!1)}),"hasRemoteUnreadMessages",n)}},{key:"setUserStatusListener",value:function(e,t){var n=this;this.assertCPPMode((function(){n._context.setUserStatusListener(e,t)}),"setUserStatusListener")}},{key:"setUserStatus",value:function(e,n){var s=this;t.assert("status",e,t.AssertRules.NUMBER),t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){s._context.setUserStatus(e).then((function(e){e===t.ErrorCode.SUCCESS?Wr(n.onSuccess,!0):Jr(n.onError,e)}))}),"setUserStatus",n)}},{key:"getUserStatus",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){s._context.getUserStatus(e).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?Wr(n.onSuccess,r):Jr(n.onError,s)}))}),"getUserStatus",n)}},{key:"addToBlacklist",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){s._context.addToBlacklist(e).then((function(e){e===t.ErrorCode.SUCCESS?Wr(n.onSuccess):Jr(n.onError,e)}))}),"addToBlacklist",n)}},{key:"removeFromBlacklist",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){s._context.removeFromBlacklist(e).then((function(e){e===t.ErrorCode.SUCCESS?Wr(n.onSuccess):Jr(n.onError,e)}))}),"removeFromBlacklist",n)}},{key:"getBlacklist",value:function(e){var n=this;t.assert("callback",e,t.AssertRules.CALLBACK),this.assertCPPMode((function(){n._context.getBlacklist().then((function(n){var s=n.code,r=n.data;s===t.ErrorCode.SUCCESS?Wr(e.onSuccess,r):Jr(e.onError,s)}))}),"getBlacklist",e)}},{key:"getBlacklistStatus",value:function(e,n){var s=this;t.assert("userId",e,t.AssertRules.STRING),t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){s._context.getBlacklistStatus(e).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?Wr(n.onSuccess,r):Jr(n.onError,s)}))}),"getBlacklistStatus",n)}},{key:"insertMessage",value:function(e,n,s,r){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("content.senderUserId",s.senderUserId,t.AssertRules.STRING,!0),t.assert("callback",r,t.AssertRules.CALLBACK),this.assertCPPMode((function(){o._defaultChannelClient.insertMessage(e,n,s,r,a)}),"insertMessage",r)}},{key:"getRemoteHistoryMessages",value:function(e,n,s,r,o){var a=this,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),t.assert("count",r,t.AssertRules.NUMBER,!0),t.assert("callback",o,t.AssertRules.CALLBACK),t.assert("options.order",i.order,t.AssertRules.NUMBER),this.assertCPPMode((function(){a._defaultChannelClient.getRemoteHistoryMessages(e,n,s,r,o,i)}),"getRemoteHistoryMessages",o)}},{key:"deleteLocalMessages",value:function(e,n,s,r){var o=this;t.assert("messageIds",s,t.AssertRules.ARRAY,!0),t.assert("callback",r,t.AssertRules.CALLBACK),this.assertCPPMode((function(){o._context.deleteMessages(s).then((function(e){e===t.ErrorCode.SUCCESS?Wr(r.onSuccess,!0):Jr(r.onError,e)}))}),"deleteLocalMessages",r)}},{key:"deleteLocalMessagesByTimestamp",value:function(e,n,s,r,o){var a=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),t.assert("cleanSpace",r,t.AssertRules.BOOLEAN),t.assert("callback",o,t.AssertRules.CALLBACK),this.assertCPPMode((function(){a._defaultChannelClient.deleteLocalMessagesByTimestamp(e,n,s,r,o)}),"deleteLocalMessagesByTimestamp",o)}},{key:"clearMessages",value:function(e,n,s){var r=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("callback",s,t.AssertRules.CALLBACK),this.assertCPPMode((function(){r._defaultChannelClient.clearMessages(e,n,s)}),"clearMessages",s)}},{key:"getMessage",value:function(e,n){var s=this;t.assert("callback",n,t.AssertRules.CALLBACK),this.assertCPPMode((function(){s._context.getMessage(e).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS?Wr(n.onSuccess,qr(r)):Jr(n.onError,s)}))}),"getMessage",n)}},{key:"setMessageSentStatus",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("sentStatus",n,t.AssertRules.NUMBER,!0),this.assertCPPMode((function(){r._context.setMessageSentStatus(e,n).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess,!0):Jr(s.onError,e)}))}),"setMessageSentStatus",s)}},{key:"setMessageReceivedStatus",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("receivedStatus",n,t.AssertRules.NUMBER,!0),this.assertCPPMode((function(){r._context.setMessageReceivedStatus(e,n).then((function(e){e===t.ErrorCode.SUCCESS?Wr(s.onSuccess,!0):Jr(s.onError,e)}))}),"setMessageReceivedStatus",s)}},{key:"setMessageContent",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("objectName",s,t.AssertRules.ONLY_STRING,!0),this.assertCPPMode((function(){r._context.setMessageContent(e,n,s)}),"setMessageContent")}},{key:"setMessageSearchField",value:function(e,n,s){var r=this;t.assert("messageId",e,t.AssertRules.NUMBER,!0),t.assert("searchFiles",s,t.AssertRules.STRING,!0),this.assertCPPMode((function(){r._context.setMessageSearchField(e,n,s)}),"setMessageSearchField")}},{key:"searchConversationByContent",value:function(e,n,s,r){var o=this;t.assert("keyword",e,t.AssertRules.STRING,!0),t.assert("callback",n,t.AssertRules.CALLBACK),t.assert("conversationTypes",s,t.AssertRules.ARRAY),t.assert("customMessageType",r,t.AssertRules.ARRAY),this.assertCPPMode((function(){o._defaultChannelClient.searchConversationByContent(e,n,s,r)}),"searchConversationByContent",n)}},{key:"searchMessageByContent",value:function(e,n,s,r,o,a,i){var c=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("keyword",s,t.AssertRules.STRING,!0),t.assert("timestamp",r,t.AssertRules.NUMBER),t.assert("count",o,t.AssertRules.NUMBER),t.assert("total",a,t.AssertRules.NUMBER),t.assert("callback",i,t.AssertRules.CALLBACK),this.assertCPPMode((function(){c._defaultChannelClient.searchMessageByContent(e,n,s,r,o,a,i)}),"searchMessageByContent",i)}},{key:"getUnreadMentionedMessages",value:function(e,n){return this._isCPPMode?(t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),this._defaultChannelClient.getUnreadMentionedMessages(e,n)):(Us.error("getUnreadMentionedMessages method is not supported in a browser!"),null)}},{key:"clearUnreadCountByTimestamp",value:function(e,n,s,r){var o=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),t.assert("timestamp",s,t.AssertRules.NUMBER,!0),this.assertCPPMode((function(){o._defaultChannelClient.clearUnreadCountByTimestamp(e,n,s,r)}),"clearUnreadCountByTimestamp",r)}},{key:"getConversationNotificationStatus",value:function(e,n,s){var r=this;t.assert("conversationType",e,t.AssertRules.NUMBER,!0),t.assert("targetId",n,t.AssertRules.STRING,!0),this.assertCPPMode((function(){r._defaultChannelClient.getConversationNotificationStatus(e,n,s)}),"getConversationNotificationStatus",s)}},{key:"getRTCUserInfoList",value:function(e,n){this._context.getRTCUserInfoList(e.id).then((function(e){var s=e.code,r=e.data;if(s===t.ErrorCode.SUCCESS){var o=null==r?void 0:r.users;n.onSuccess(o)}n.onError(s)})).catch(n.onError)}},{key:"getRTCUserList",value:function(e,n){this._context.getRTCUserList(e.id).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS&&n.onSuccess(r),n.onError(s)})).catch(n.onError)}},{key:"setRTCUserInfo",value:function(e,n,s){this._context.setRTCUserInfo(e.id,n.key,n.value).then((function(e){e===t.ErrorCode.SUCCESS&&s.onSuccess(!0),s.onError(e)})).catch(s.onError)}},{key:"removeRTCUserInfo",value:function(e,n,s){this._context.removeRTCUserInfo(e.id,n.keys).then((function(e){e===t.ErrorCode.SUCCESS&&s.onSuccess(!0),s.onError(e)})).catch(s.onError)}},{key:"getRTCRoomInfo",value:function(e,n){this._context.getRTCRoomInfo(e.id).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS&&n.onSuccess(r),n.onError(s)})).catch(n.onError)}},{key:"setRTCRoomInfo",value:function(e,n,s){throw t.todo("setRTCRoomInfo")}},{key:"removeRTCRoomInfo",value:function(e,n,s){throw t.todo("removeRTCRoomInfo")}},{key:"joinRTCRoom",value:function(e,n){var s=e.mode||0;this._context.joinRTCRoom(e.id,s).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS&&n.onSuccess(r),n.onError(s)})).catch(n.onError)}},{key:"quitRTCRoom",value:function(e,n){this._context.quitRTCRoom(e.id).then((function(e){e===t.ErrorCode.SUCCESS&&n.onSuccess(!0),n.onError(e)})).catch(n.onError)}},{key:"RTCPing",value:function(e,n){var s=e.mode||0;this._context.rtcPing(e.id,s).then((function(e){e===t.ErrorCode.SUCCESS&&n.onSuccess(!0),n.onError(e)})).catch(n.onError)}},{key:"setRTCData",value:function(e,n,s,r,o,a,i){this._context.setRTCData(e,n,s,r,o,i).then((function(e){e===t.ErrorCode.SUCCESS&&a.onSuccess(!0),a.onError(e)})).catch(a.onError)}},{key:"getRTCData",value:function(e,n,s,r,o){this._context.getRTCData(e,n,s,r).then((function(e){var n=e.code,s=e.data;n===t.ErrorCode.SUCCESS&&o.onSuccess(s),o.onError(n)})).catch(o.onError)}},{key:"removeRTCData",value:function(e,n,s,r,o,a){this._context.removeRTCData(e,n,s,r,a).then((function(e){e===t.ErrorCode.SUCCESS&&o.onSuccess(!0),o.onError(e)})).catch(o.onError)}},{key:"setRTCUserData",value:function(e,n,s,r,o,a){this.setRTCData(e,n,s,r,t.RTCApiType.PERSON,o,a)}},{key:"setRTCUserTotalRes",value:function(e,n,s,r,o){this._context.setRTCTotalRes(e,n,s,r).then((function(e){e!==t.ErrorCode.SUCCESS?o.onError(e):o.onSuccess(!0)})).catch(o.onError)}},{key:"getRTCUserData",value:function(e,n,s,r){this.getRTCData(e,n,s,t.RTCApiType.PERSON,r)}},{key:"removeRTCUserData",value:function(e,n,s,r,o){this.removeRTCData(e,n,s,t.RTCApiType.PERSON,r,o)}},{key:"setRTCRoomData",value:function(e,n,s,r,o,a){this.setRTCData(e,n,s,r,t.RTCApiType.ROOM,o,a)}},{key:"getRTCRoomData",value:function(e,n,s,r){this.getRTCData(e,n,s,t.RTCApiType.ROOM,r)}},{key:"removeRTCRoomData",value:function(e,n,s,r,o){this.removeRTCData(e,n,s,t.RTCApiType.ROOM,r,o)}},{key:"setRTCOutData",value:function(e,n,s,r,o){throw t.todo("setRTCOutData")}},{key:"getRTCOutData",value:function(e,n,s){throw t.todo("getRTCOutData")}},{key:"getRTCToken",value:function(e,n){this._context.getRTCToken(e.id,e.mode,e.broadcastType).then((function(e){var s=e.code,r=e.data;s===t.ErrorCode.SUCCESS&&n.onSuccess(r),n.onError(s)})).catch(n.onError)}},{key:"setRTCState",value:function(e,n,s){this._context.setRTCState(e.id,n.report).then((function(e){e===t.ErrorCode.SUCCESS&&s.onSuccess(!0),s.onError(e)})).catch(s.onError)}}]),e}(),fo=[],go=[],ho={message:function(e){fo.forEach((function(t){return t(qr(e))}))},status:function(e){go.forEach((function(t){return t(e)}))}},Co={init:function(e,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Us.setLogLevel(s.logLevel),Us.setLogStdout(s.logStdout),ao=t.APIContext.init(Ys,{appkey:e,apiVersion:"2.8.2",navigators:s.navi?[s.navi]:[],miniCMPProxy:[],connectionType:(null==s?void 0:s.connectionType)||"websocket",logLevel:s.logLevel,logStdout:s.logStdout}),Us.warn("RongIMLib Version: ".concat("2.8.2",", Commit: ","75749b26e9e960a0d1652a2f7fee7cd8b28b159e")),oo=new lo(ao)},getInstance:function(){return oo},setConnectionStatusListener:function(e){ao.assignWatcher({connectionState:e.onChanged})},setOnReceiveMessageListener:function(e){ao.assignWatcher({message:function(t){try{var n=qr(t),s=ao.getCurrentUserId();Yr(n,s),n=function(e,t){var n=new Date,s=n.getMonth()+1,r=n.getFullYear()+"/"+(1===s.toString().length?"0"+s:s)+"/"+n.getDate(),o=new Date(r).getTime()-e.sentTime<0;if("ReadReceiptResponseMessage"!==e.messageType||!o)return e;var a=e.content,i=((a=a||{}).receiptMessageDic||{})[t],c="",u={};if(e.receiptResponse||(e.receiptResponse={}),i){for(var l=[],f=0;f<i.length;f++)c="".concat(t).concat(i[f],"SENT"),(u=Vr.get(c))&&!(e.senderUserId in u.userIds)&&(l.push(i[f]),u.count+=1,u.userIds[e.senderUserId]=e.sentTime,e.receiptResponse[i[f]]=u.count,Vr.set(c,u));a.receiptMessageDic[t]=l,e.content=a}return e}(n,s),e.onReceived(n,0,!1)}catch(e){Us.error(e)}}})},setConversationStatusListener:function(e){ao.assignWatcher({conversationState:function(t){try{var n=[];t.forEach((function(e){var t=e.updatedItems,s=e.conversationType,r=e.targetId,o=e.channelId,a=t=t||{},i=a.notificationStatus,c=a.isTop;i&&c&&n.push({notificationStatus:i.val,isTop:c.val,conversationType:s,targetId:r,channelId:o||"",updatedTime:i.time})})),n.length>0&&e.onChanged(n)}catch(e){Us.error(e)}}})},setMessageExpansionListener:function(e){ao.assignWatcher({expansion:function(t){try{t.updatedExpansion&&e.onUpdated(t.updatedExpansion),t.deletedExpansion&&e.onDeleted(t.deletedExpansion)}catch(e){Us.error(e)}}})},setTagListener:function(e){ao.assignWatcher({tag:function(){e.onChanged()}})},setConversationTagListener:function(e){ao.assignWatcher({conversationTagChanged:function(){e.onChanged()}})},connect:function(e,n){return c(regeneratorRuntime.mark((function s(){var r;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,ao.connect(e);case 2:(r=s.sent).code===t.ErrorCode.SUCCESS?n.onSuccess(r.userId):r.code===t.ErrorCode.RC_CONN_USER_OR_PASSWD_ERROR?n.onTokenIncorrect():n.onError(r.code);case 4:case"end":return s.stop()}}),s)})))()},reconnect:function(e,n){ao.reconnect().then((function(n){n.code===t.ErrorCode.SUCCESS?e.onSuccess(n.userId):e.onError(n.code)})).catch(e.onError)},RegisterMessage:{},RegisterMessageTypeMapping:Kr,getMessageObjectName:function(e){var t=h(h({},Fr),Kr);return Object.keys(t).find((function(n){return t[n]===e}))||e},registerMessageType:function(e,t,n,s){this.RegisterMessage[e]=ro(e,t,n.isPersited,n.isCounted),this.RegisterMessageTypeMapping[t]=e,ao.registerMessageType(t,n.isPersited,n.isCounted,s)},messageWatch:function(e){var t=this;fo.push((function(n){try{e(n),t._voipProvider.onReceived&&t._voipProvider.onReceived(n)}catch(e){Us.error(e)}})),ao.assignWatcher({rtcInnerWatcher:ho})},statusWatch:function(e){go.push((function(t){try{e(t)}catch(e){Us.error(e)}}))},MessageType:{TextMessage:"TextMessage",ImageMessage:"ImageMessage",ReferenceMessage:"ReferenceMessage",DiscussionNotificationMessage:"DiscussionNotificationMessage",VoiceMessage:"VoiceMessage",RichContentMessage:"RichContentMessage",HandshakeMessage:"HandshakeMessage",UnknownMessage:"UnknownMessage",LocationMessage:"LocationMessage",InformationNotificationMessage:"InformationNotificationMessage",ContactNotificationMessage:"ContactNotificationMessage",ProfileNotificationMessage:"ProfileNotificationMessage",CommandNotificationMessage:"CommandNotificationMessage",CommandMessage:"CommandMessage",TypingStatusMessage:"TypingStatusMessage",ChangeModeResponseMessage:"ChangeModeResponseMessage",ChangeModeMessage:"ChangeModeMessage",EvaluateMessage:"EvaluateMessage",HandShakeMessage:"HandShakeMessage",HandShakeResponseMessage:"HandShakeResponseMessage",SuspendMessage:"SuspendMessage",TerminateMessage:"TerminateMessage",CustomerContact:"CustomerContact",CustomerStatusUpdateMessage:"CustomerStatusUpdateMessage",SyncReadStatusMessage:"SyncReadStatusMessage",ReadReceiptRequestMessage:"ReadReceiptRequestMessage",ReadReceiptResponseMessage:"ReadReceiptResponseMessage",FileMessage:"FileMessage",HQVoiceMessage:"HQVoiceMessage",GIFMessage:"GIFMessage",SightMessage:"SightMessage",AcceptMessage:"AcceptMessage",RingingMessage:"RingingMessage",SummaryMessage:"SummaryMessage",HungupMessage:"HungupMessage",InviteMessage:"InviteMessage",MediaModifyMessage:"MediaModifyMessage",MemberModifyMessage:"MemberModifyMessage",JrmfRedPacketMessage:"JrmfRedPacketMessage",JrmfRedPacketOpenedMessage:"JrmfRedPacketOpenedMessage",GroupNotificationMessage:"GroupNotificationMessage",PublicServiceRichContentMessage:"PublicServiceRichContentMessage",PublicServiceMultiRichContentMessage:"PublicServiceMultiRichContentMessage",PublicServiceCommandMessage:"PublicServiceCommandMessage",RecallCommandMessage:"RecallCommandMessage",ReadReceiptMessage:"ReadReceiptMessage",RCCombineMessage:"RCCombineMessage",ChrmKVNotificationMessage:"ChrmKVNotificationMessage",LogCommandMessage:"LogCommandMessage"},_voipProvider:{}},po=ro("TextMessage","RC:TxtMsg"),vo=ro("LocationMessage","RC:LBSMsg"),Ro=ro("TypingStatusMessage","RC:TypSts"),yo=ro("ImageMessage","RC:ImgMsg"),So=ro("RichContentMessage","RC:ImgTextMsg"),mo=ro("VoiceMessage","RC:VcMsg"),Mo=ro("HQVoiceMessage","RC:HQVCMsg"),Eo=ro("FileMessage","RC:FileMsg"),To=ro("SightMessage","RC:SightMsg"),Io=ro("GIFMessage","RC:GIFMsg"),Ao=ro("ReadReceiptMessage","RC:ReadNtf"),bo=ro("ReadReceiptRequestMessage","RC:RRReqMsg"),ko=ro("RCCombineMessage","RC:CombineMsg");e.VoIPMediaType=void 0,(io=e.VoIPMediaType||(e.VoIPMediaType={}))[io.MEDIA_AUDIO=1]="MEDIA_AUDIO",io[io.MEDIA_VEDIO=2]="MEDIA_VEDIO",io[io.MEDIA_VIDEO=2]="MEDIA_VIDEO";var No,Uo=ro("AcceptMessage","RC:VCAccept"),xo=ro("RingingMessage","RC:VCRinging"),Lo=ro("SummaryMessage","RC:VCSummary"),_o=ro("HungupMessage","RC:VCHangup"),Po=ro("InviteMessage","RC:VCInvite"),Oo=ro("MediaModifyMessage","RC:VCModifyMedia"),wo=ro("MemberModifyMessage","RC:VCModifyMem"),Bo=ro("lastMessageSendTime","RC:SRSMsg"),jo=ro("ReferenceMessage","RC:ReferenceMsg");!function(e){e[e.ALL=1]="ALL",e[e.PART=2]="PART"}(No||(No={}));var Go=No,Do=ro("PublicServiceRichContentMessage","RC:PSImgTxtMsg"),Fo=ro("PublicServiceMultiRichContentMessage","RC:PSMultiImgTxtMsg"),Ko=t.ConnectResultCode;window&&(window.RongIMClient=Co),Object.defineProperty(e,"ConnectionStatus",{enumerable:!0,get:function(){return t.ConnectionStatus}}),Object.defineProperty(e,"ConversationType",{enumerable:!0,get:function(){return t.ConversationType}}),Object.defineProperty(e,"ErrorCode",{enumerable:!0,get:function(){return t.ErrorCode}}),Object.defineProperty(e,"FileType",{enumerable:!0,get:function(){return t.FileType}}),Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return t.LogLevel}}),Object.defineProperty(e,"MessageDirection",{enumerable:!0,get:function(){return t.MessageDirection}}),Object.defineProperty(e,"ReceivedStatus",{enumerable:!0,get:function(){return t.ReceivedStatus}}),Object.defineProperty(e,"UploadMethod",{enumerable:!0,get:function(){return t.UploadMethod}}),e.AcceptMessage=Uo,e.ChannelClient=uo,e.ConnectionState=Ko,e.FileMessage=Eo,e.GIFMessage=Io,e.GetChatRoomType=o,e.HQVoiceMessage=Mo,e.HungupMessage=_o,e.IMClient=lo,e.ImageMessage=yo,e.InviteMessage=Po,e.LocationMessage=vo,e.MediaModifyMessage=Oo,e.MemberModifyMessage=wo,e.MentionedInfo=function e(t,n,s){u(this,e),this.type=t,this.userIdList=n,this.mentionedContent=s},e.MentionedType=Go,e.Message=function e(t,n,s,r,o,a,i,c,l,f,d,g,h,C,p,v,R,y){u(this,e),this.conversationType=t,this.targetId=n,this.senderUserId=s,this.content=r,this.objectName=o,this.messageType=a,this.messageId=i,this.messageUId=c,this.messageDirection=l,this.offLineMessage=f,this.sentStatus=d,this.sentTime=g,this.receivedStatus=h,this.receivedTime=C,this.canIncludeExpansion=p,this.expansion=v,this.receiptResponse=R,this.disableNotification=y},e.MessageTag=function e(t,n){u(this,e),this.isCounted=t,this.isPersited=n},e.PublicServiceMultiRichContentMessage=Fo,e.PublicServiceRichContentMessage=Do,e.RCCombineMessage=ko,e.ReadReceiptMessage=Ao,e.ReadReceiptRequestMessage=bo,e.ReadReceiptResponseMessage=co,e.ReferenceMessage=jo,e.RichContentMessage=So,e.RingingMessage=xo,e.RongIMClient=Co,e.SentStatus=r,e.SightMessage=To,e.SummaryMessage=Lo,e.SyncReadStatusMessage=Bo,e.TextMessage=po,e.TypingStatusMessage=Ro,e.VoiceMessage=mo,Object.defineProperty(e,"__esModule",{value:!0})}));
